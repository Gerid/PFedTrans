============= Running time: 0th =============
Creating server and clients ...
DNN(
  (fc1): Linear(in_features=3072, out_features=100, bias=True)
  (fc): Linear(in_features=100, out_features=10, bias=True)
)
Join ratio / total clients: 1.0 / 100
Finished creating server and clients.
-------------Round number: 0-------------
Evaluate global model
Averaged Train Loss: 4.1251
Averaged Test Accurancy: 0.0995
Std Test Accurancy: 0.2408
evaluate time cost:5.844884634017944s
[running kmeans]: 4it [00:00, 333.01it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:4.752656698226929s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
form_cluster time cost:0.020018577575683594s
weights:tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5001, 0.4999],
        [0.5001, 0.4999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0836]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0830]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2552320957183838s
iter time cost:10.944868803024292s
-------------Round number: 1-------------
Evaluate global model
Averaged Train Loss: 3.7673
Averaged Test Accurancy: 0.5364
Std Test Accurancy: 0.1737
evaluate time cost:4.694518327713013s
clients training time cost:4.747067451477051s
attn_optimize time cost:0.40636515617370605s
weights:tensor([[0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000, 0.0999,
         0.1000],
        [0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000, 0.0999,
         0.1000],
        [0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000, 0.0999,
         0.1000],
        [0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1249],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1249],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1249],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1249],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1249],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1249],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1249],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5002, 0.4998],
        [0.5002, 0.4998]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1249, 0.1252, 0.1251, 0.1249, 0.1248, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1252, 0.1251, 0.1249, 0.1248, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1252, 0.1251, 0.1249, 0.1248, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1252, 0.1251, 0.1249, 0.1248, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1252, 0.1251, 0.1249, 0.1248, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1252, 0.1251, 0.1249, 0.1248, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1252, 0.1251, 0.1249, 0.1248, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1252, 0.1251, 0.1249, 0.1248, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0831]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2522294521331787s
iter time cost:10.16323184967041s
-------------Round number: 2-------------
Evaluate global model
Averaged Train Loss: 4.6842
Averaged Test Accurancy: 0.5061
Std Test Accurancy: 0.1781
evaluate time cost:4.687021970748901s
clients training time cost:4.787654876708984s
attn_optimize time cost:0.40449023246765137s
weights:tensor([[0.0999, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001,
         0.0999],
        [0.0999, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001,
         0.0999],
        [0.0999, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001,
         0.0999],
        [0.0999, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001,
         0.0999],
        [0.0999, 0.1001, 0.1001, 0.1000, 0.1000, 0.0998, 0.0999, 0.1002, 0.1001,
         0.0999],
        [0.0999, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001,
         0.0999],
        [0.0999, 0.1001, 0.1001, 0.1000, 0.1000, 0.0998, 0.0999, 0.1001, 0.1001,
         0.0999],
        [0.0999, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001,
         0.0999],
        [0.0999, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001,
         0.0999],
        [0.0999, 0.1001, 0.1001, 0.1000, 0.1000, 0.0998, 0.0999, 0.1001, 0.1001,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0772]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1252, 0.1250, 0.1249, 0.1249, 0.1250, 0.1249, 0.1250, 0.1252],
        [0.1252, 0.1250, 0.1249, 0.1249, 0.1250, 0.1249, 0.1250, 0.1252],
        [0.1252, 0.1250, 0.1249, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1252, 0.1250, 0.1249, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1252, 0.1250, 0.1249, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1252, 0.1250, 0.1249, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1252, 0.1250, 0.1249, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1252, 0.1250, 0.1249, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5004, 0.4996],
        [0.5004, 0.4996]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1250, 0.1249],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1250, 0.1249],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1250, 0.1249],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1250, 0.1249],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1250, 0.1249],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1250, 0.1249],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1250, 0.1249],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1250, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1251, 0.1247, 0.1248, 0.1254, 0.1252, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1247, 0.1248, 0.1254, 0.1252, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1247, 0.1248, 0.1254, 0.1252, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1247, 0.1248, 0.1254, 0.1252, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1247, 0.1248, 0.1254, 0.1252, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1247, 0.1248, 0.1254, 0.1252, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1247, 0.1248, 0.1254, 0.1252, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1247, 0.1248, 0.1254, 0.1252, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832,
         0.0831, 0.0834, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832,
         0.0831, 0.0834, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832,
         0.0831, 0.0834, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832,
         0.0831, 0.0834, 0.0835]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0832, 0.0831, 0.0832, 0.0834, 0.0834, 0.0832, 0.0835, 0.0833, 0.0832,
         0.0835, 0.0835, 0.0835],
        [0.0832, 0.0831, 0.0832, 0.0834, 0.0834, 0.0832, 0.0835, 0.0833, 0.0832,
         0.0835, 0.0835, 0.0835],
        [0.0832, 0.0831, 0.0832, 0.0834, 0.0834, 0.0832, 0.0835, 0.0833, 0.0832,
         0.0835, 0.0835, 0.0835],
        [0.0832, 0.0831, 0.0832, 0.0834, 0.0834, 0.0832, 0.0835, 0.0833, 0.0832,
         0.0835, 0.0835, 0.0835],
        [0.0832, 0.0831, 0.0832, 0.0834, 0.0834, 0.0832, 0.0835, 0.0833, 0.0832,
         0.0835, 0.0835, 0.0835],
        [0.0832, 0.0831, 0.0832, 0.0834, 0.0834, 0.0832, 0.0835, 0.0833, 0.0832,
         0.0835, 0.0835, 0.0835],
        [0.0832, 0.0831, 0.0832, 0.0834, 0.0834, 0.0832, 0.0835, 0.0833, 0.0832,
         0.0835, 0.0835, 0.0835],
        [0.0832, 0.0831, 0.0832, 0.0834, 0.0834, 0.0832, 0.0835, 0.0833, 0.0832,
         0.0835, 0.0835, 0.0835],
        [0.0832, 0.0831, 0.0832, 0.0834, 0.0834, 0.0832, 0.0835, 0.0833, 0.0832,
         0.0835, 0.0835, 0.0835],
        [0.0832, 0.0831, 0.0832, 0.0834, 0.0834, 0.0832, 0.0835, 0.0833, 0.0832,
         0.0835, 0.0835, 0.0835],
        [0.0832, 0.0831, 0.0832, 0.0834, 0.0834, 0.0832, 0.0835, 0.0833, 0.0832,
         0.0835, 0.0835, 0.0835],
        [0.0832, 0.0830, 0.0832, 0.0835, 0.0834, 0.0832, 0.0836, 0.0832, 0.0831,
         0.0835, 0.0836, 0.0835]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2518770694732666s
iter time cost:10.19454574584961s
-------------Round number: 3-------------
Evaluate global model
Averaged Train Loss: 4.4751
Averaged Test Accurancy: 0.5688
Std Test Accurancy: 0.1720
evaluate time cost:4.8185505867004395s
clients training time cost:5.015525817871094s
attn_optimize time cost:0.5360507965087891s
weights:tensor([[0.0998, 0.1000, 0.0999, 0.0999, 0.1002, 0.1000, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.0998, 0.1000, 0.0999, 0.0999, 0.1002, 0.1000, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.0998, 0.1000, 0.0999, 0.0999, 0.1002, 0.1000, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.0998, 0.1000, 0.0999, 0.0999, 0.1002, 0.1000, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.0998, 0.1000, 0.0999, 0.0999, 0.1002, 0.1000, 0.1001, 0.1001, 0.0999,
         0.1001],
        [0.0998, 0.1000, 0.0999, 0.0999, 0.1002, 0.1000, 0.1001, 0.1001, 0.0999,
         0.1001],
        [0.0998, 0.1000, 0.0999, 0.0999, 0.1002, 0.1000, 0.1001, 0.1001, 0.0999,
         0.1001],
        [0.0998, 0.1000, 0.0999, 0.0999, 0.1002, 0.1000, 0.1001, 0.1001, 0.0999,
         0.1001],
        [0.0998, 0.1000, 0.0999, 0.0999, 0.1002, 0.1000, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.0998, 0.1000, 0.0999, 0.0999, 0.1002, 0.1000, 0.1001, 0.1001, 0.0999,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0770, 0.0770, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0769, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1253, 0.1248, 0.1251, 0.1250, 0.1251, 0.1250, 0.1249],
        [0.1250, 0.1253, 0.1248, 0.1251, 0.1250, 0.1251, 0.1250, 0.1249],
        [0.1250, 0.1253, 0.1248, 0.1251, 0.1250, 0.1251, 0.1250, 0.1249],
        [0.1250, 0.1253, 0.1248, 0.1251, 0.1250, 0.1251, 0.1250, 0.1249],
        [0.1250, 0.1253, 0.1248, 0.1251, 0.1250, 0.1251, 0.1250, 0.1249],
        [0.1250, 0.1253, 0.1248, 0.1251, 0.1250, 0.1251, 0.1250, 0.1249],
        [0.1250, 0.1253, 0.1248, 0.1251, 0.1250, 0.1251, 0.1250, 0.1249],
        [0.1250, 0.1253, 0.1248, 0.1251, 0.1250, 0.1251, 0.1250, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5004, 0.4996],
        [0.5003, 0.4997]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1248, 0.1249, 0.1249, 0.1254, 0.1251, 0.1250, 0.1250],
        [0.1249, 0.1248, 0.1249, 0.1249, 0.1254, 0.1251, 0.1250, 0.1250],
        [0.1249, 0.1248, 0.1249, 0.1249, 0.1254, 0.1251, 0.1250, 0.1250],
        [0.1249, 0.1248, 0.1249, 0.1249, 0.1254, 0.1251, 0.1250, 0.1250],
        [0.1249, 0.1249, 0.1249, 0.1249, 0.1254, 0.1251, 0.1250, 0.1250],
        [0.1249, 0.1249, 0.1249, 0.1249, 0.1254, 0.1251, 0.1250, 0.1250],
        [0.1249, 0.1248, 0.1249, 0.1249, 0.1254, 0.1251, 0.1250, 0.1250],
        [0.1249, 0.1248, 0.1249, 0.1249, 0.1254, 0.1251, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1247, 0.1250, 0.1252, 0.1250, 0.1254, 0.1248, 0.1251, 0.1248],
        [0.1247, 0.1250, 0.1251, 0.1250, 0.1254, 0.1248, 0.1251, 0.1248],
        [0.1247, 0.1250, 0.1251, 0.1250, 0.1254, 0.1248, 0.1251, 0.1248],
        [0.1247, 0.1250, 0.1251, 0.1250, 0.1254, 0.1248, 0.1251, 0.1248],
        [0.1247, 0.1250, 0.1251, 0.1250, 0.1254, 0.1248, 0.1251, 0.1248],
        [0.1247, 0.1250, 0.1252, 0.1250, 0.1254, 0.1248, 0.1251, 0.1248],
        [0.1247, 0.1250, 0.1251, 0.1250, 0.1254, 0.1248, 0.1251, 0.1248],
        [0.1247, 0.1250, 0.1251, 0.1250, 0.1254, 0.1248, 0.1251, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0835, 0.0832, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833, 0.0832,
         0.0834, 0.0835, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0835, 0.0832, 0.0832, 0.0832, 0.0832, 0.0833, 0.0833, 0.0836,
         0.0832, 0.0832, 0.0836],
        [0.0835, 0.0835, 0.0832, 0.0832, 0.0832, 0.0832, 0.0833, 0.0833, 0.0836,
         0.0832, 0.0832, 0.0836],
        [0.0835, 0.0835, 0.0832, 0.0832, 0.0832, 0.0832, 0.0833, 0.0833, 0.0836,
         0.0832, 0.0832, 0.0836],
        [0.0835, 0.0835, 0.0832, 0.0832, 0.0832, 0.0832, 0.0833, 0.0833, 0.0836,
         0.0832, 0.0832, 0.0836],
        [0.0835, 0.0835, 0.0832, 0.0832, 0.0832, 0.0832, 0.0833, 0.0833, 0.0836,
         0.0832, 0.0832, 0.0836],
        [0.0835, 0.0835, 0.0832, 0.0832, 0.0832, 0.0832, 0.0833, 0.0833, 0.0836,
         0.0832, 0.0832, 0.0836],
        [0.0835, 0.0835, 0.0832, 0.0832, 0.0832, 0.0832, 0.0833, 0.0833, 0.0836,
         0.0832, 0.0832, 0.0836],
        [0.0835, 0.0835, 0.0832, 0.0832, 0.0832, 0.0832, 0.0833, 0.0833, 0.0836,
         0.0832, 0.0832, 0.0836],
        [0.0835, 0.0835, 0.0832, 0.0832, 0.0832, 0.0832, 0.0833, 0.0833, 0.0836,
         0.0832, 0.0832, 0.0836],
        [0.0835, 0.0835, 0.0832, 0.0832, 0.0832, 0.0832, 0.0833, 0.0833, 0.0836,
         0.0832, 0.0832, 0.0836],
        [0.0835, 0.0835, 0.0832, 0.0832, 0.0832, 0.0832, 0.0833, 0.0833, 0.0836,
         0.0832, 0.0832, 0.0836],
        [0.0835, 0.0836, 0.0832, 0.0832, 0.0831, 0.0832, 0.0833, 0.0833, 0.0837,
         0.0832, 0.0832, 0.0835]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1430, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1430, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1430, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1430, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1430, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1430, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1430, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26506900787353516s
iter time cost:10.696257591247559s
-------------Round number: 4-------------
Evaluate global model
Averaged Train Loss: 4.3074
Averaged Test Accurancy: 0.5166
Std Test Accurancy: 0.1805
evaluate time cost:4.818014621734619s
clients training time cost:5.22396993637085s
attn_optimize time cost:0.38823986053466797s
weights:tensor([[0.1002, 0.0999, 0.1001, 0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.0999, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0770, 0.0768, 0.0769, 0.0772]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1251, 0.1249, 0.1249, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1251, 0.1249, 0.1249, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1251, 0.1249, 0.1249, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1251, 0.1249, 0.1249, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1251, 0.1249, 0.1249, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1251, 0.1249, 0.1249, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1251, 0.1249, 0.1249, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1251, 0.1249, 0.1249, 0.1251, 0.1251, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5010, 0.4990],
        [0.5008, 0.4992]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1251, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1249, 0.1249, 0.1251, 0.1248, 0.1252, 0.1249, 0.1251],
        [0.1251, 0.1249, 0.1249, 0.1251, 0.1248, 0.1251, 0.1249, 0.1251],
        [0.1251, 0.1249, 0.1249, 0.1251, 0.1248, 0.1252, 0.1249, 0.1251],
        [0.1251, 0.1249, 0.1249, 0.1251, 0.1248, 0.1252, 0.1249, 0.1251],
        [0.1251, 0.1249, 0.1249, 0.1251, 0.1248, 0.1252, 0.1249, 0.1251],
        [0.1251, 0.1249, 0.1249, 0.1251, 0.1248, 0.1252, 0.1249, 0.1251],
        [0.1251, 0.1249, 0.1249, 0.1251, 0.1248, 0.1252, 0.1249, 0.1251],
        [0.1251, 0.1249, 0.1249, 0.1251, 0.1248, 0.1251, 0.1249, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0831,
         0.0834, 0.0835, 0.0837],
        [0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0831,
         0.0834, 0.0835, 0.0837],
        [0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0831,
         0.0834, 0.0835, 0.0837],
        [0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0831,
         0.0834, 0.0835, 0.0837],
        [0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0831,
         0.0834, 0.0835, 0.0837],
        [0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0831,
         0.0834, 0.0835, 0.0837],
        [0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0831,
         0.0834, 0.0835, 0.0837],
        [0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0831,
         0.0834, 0.0835, 0.0837],
        [0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0831,
         0.0834, 0.0835, 0.0837],
        [0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0831,
         0.0834, 0.0835, 0.0837],
        [0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0831,
         0.0834, 0.0835, 0.0837],
        [0.0831, 0.0831, 0.0833, 0.0835, 0.0832, 0.0834, 0.0833, 0.0834, 0.0831,
         0.0834, 0.0835, 0.0837]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431, 0.1428],
        [0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431, 0.1428],
        [0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431, 0.1428],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1430, 0.1428],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1430, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1428, 0.1428, 0.1430, 0.1428],
        [0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1430, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.24622297286987305s
iter time cost:10.740119218826294s
-------------Round number: 5-------------
Evaluate global model
Averaged Train Loss: 4.4353
Averaged Test Accurancy: 0.5579
Std Test Accurancy: 0.1647
evaluate time cost:4.8495471477508545s
clients training time cost:5.158017873764038s
attn_optimize time cost:0.4399847984313965s
weights:tensor([[0.0999, 0.1002, 0.0999, 0.1000, 0.1001, 0.1000, 0.0998, 0.1001, 0.1002,
         0.0998],
        [0.0999, 0.1002, 0.0999, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1002,
         0.0998],
        [0.0999, 0.1002, 0.0999, 0.1000, 0.1001, 0.1000, 0.0998, 0.1001, 0.1002,
         0.0998],
        [0.0999, 0.1002, 0.0999, 0.1000, 0.1001, 0.1000, 0.0998, 0.1001, 0.1002,
         0.0998],
        [0.0999, 0.1002, 0.0999, 0.1000, 0.1001, 0.1000, 0.0998, 0.1001, 0.1002,
         0.0998],
        [0.0999, 0.1002, 0.0999, 0.1000, 0.1001, 0.1000, 0.0998, 0.1001, 0.1002,
         0.0998],
        [0.0999, 0.1002, 0.0999, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001, 0.1002,
         0.0998],
        [0.0999, 0.1002, 0.0999, 0.1000, 0.1001, 0.1000, 0.0998, 0.1001, 0.1002,
         0.0998],
        [0.1000, 0.1002, 0.0999, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1002,
         0.0998],
        [0.0999, 0.1002, 0.0999, 0.1000, 0.1001, 0.1000, 0.0998, 0.1001, 0.1002,
         0.0998]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0768, 0.0769, 0.0769, 0.0771, 0.0770, 0.0770, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0770, 0.0772]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1253, 0.1249, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5005, 0.4995],
        [0.5003, 0.4997]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1248, 0.1248, 0.1251, 0.1251, 0.1249, 0.1252, 0.1250, 0.1251],
        [0.1248, 0.1249, 0.1251, 0.1251, 0.1249, 0.1251, 0.1249, 0.1251],
        [0.1248, 0.1249, 0.1251, 0.1250, 0.1249, 0.1251, 0.1249, 0.1251],
        [0.1248, 0.1249, 0.1251, 0.1250, 0.1249, 0.1251, 0.1249, 0.1251],
        [0.1248, 0.1249, 0.1251, 0.1251, 0.1249, 0.1251, 0.1249, 0.1251],
        [0.1248, 0.1249, 0.1251, 0.1250, 0.1249, 0.1251, 0.1249, 0.1251],
        [0.1248, 0.1249, 0.1251, 0.1250, 0.1249, 0.1251, 0.1249, 0.1251],
        [0.1248, 0.1249, 0.1251, 0.1250, 0.1249, 0.1251, 0.1249, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1250],
        [0.1250, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1250],
        [0.1250, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1250],
        [0.1250, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1250],
        [0.1250, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1250],
        [0.1250, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1250],
        [0.1250, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1250],
        [0.1250, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0834],
        [0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0834],
        [0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0834],
        [0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0834],
        [0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0834],
        [0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0834],
        [0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0834],
        [0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0834],
        [0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0834],
        [0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0834],
        [0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0834],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834, 0.0833,
         0.0833, 0.0834, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0832, 0.0836],
        [0.0833, 0.0835, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0832, 0.0837],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0832, 0.0836],
        [0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0832, 0.0836],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0832, 0.0836],
        [0.0833, 0.0835, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0832, 0.0837],
        [0.0833, 0.0835, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0832, 0.0837],
        [0.0833, 0.0835, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0832, 0.0837],
        [0.0833, 0.0835, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0832, 0.0837],
        [0.0833, 0.0835, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0832, 0.0837],
        [0.0833, 0.0835, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0832, 0.0837],
        [0.0833, 0.0835, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0831, 0.0836]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1429, 0.1431, 0.1428, 0.1428, 0.1428, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1428, 0.1428, 0.1428, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1428, 0.1428, 0.1429, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1428, 0.1428, 0.1428, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1428, 0.1428, 0.1429, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1428, 0.1428, 0.1428, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1428, 0.1428, 0.1428, 0.1427]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2531602382659912s
iter time cost:10.765805006027222s
-------------Round number: 6-------------
Evaluate global model
Averaged Train Loss: 4.6420
Averaged Test Accurancy: 0.4922
Std Test Accurancy: 0.1879
evaluate time cost:4.646095275878906s
clients training time cost:4.977268695831299s
attn_optimize time cost:0.4279155731201172s
weights:tensor([[0.1001, 0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1001, 0.0998,
         0.0999],
        [0.1001, 0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1001, 0.0998,
         0.0999],
        [0.1002, 0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1001, 0.0998,
         0.0999],
        [0.1002, 0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1001, 0.0998,
         0.0999],
        [0.1001, 0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1001, 0.0998,
         0.0999],
        [0.1002, 0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1001, 0.0998,
         0.0999],
        [0.1001, 0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1001, 0.0998,
         0.0999],
        [0.1001, 0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1001, 0.0998,
         0.0999],
        [0.1002, 0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1001, 0.0998,
         0.0999],
        [0.1002, 0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1001, 0.0998,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0772],
        [0.0769, 0.0767, 0.0768, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0772]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5003, 0.4997],
        [0.5000, 0.5000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1252, 0.1250, 0.1251, 0.1249, 0.1250, 0.1250, 0.1248, 0.1250],
        [0.1252, 0.1250, 0.1251, 0.1249, 0.1250, 0.1250, 0.1248, 0.1250],
        [0.1252, 0.1250, 0.1251, 0.1249, 0.1250, 0.1250, 0.1248, 0.1250],
        [0.1252, 0.1250, 0.1251, 0.1249, 0.1250, 0.1251, 0.1248, 0.1250],
        [0.1252, 0.1250, 0.1251, 0.1249, 0.1250, 0.1251, 0.1248, 0.1250],
        [0.1252, 0.1250, 0.1251, 0.1249, 0.1250, 0.1250, 0.1248, 0.1250],
        [0.1252, 0.1250, 0.1251, 0.1249, 0.1250, 0.1251, 0.1248, 0.1250],
        [0.1252, 0.1250, 0.1251, 0.1249, 0.1250, 0.1250, 0.1248, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1251, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1251, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1251, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1250, 0.1249, 0.1250, 0.1251, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1250, 0.1249, 0.1250, 0.1251, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1250, 0.1249, 0.1250, 0.1251, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1251, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1251, 0.1247, 0.1250, 0.1252, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0834, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0832, 0.0833, 0.0833, 0.0831, 0.0833, 0.0835, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0835, 0.0832, 0.0834, 0.0833, 0.0831, 0.0833, 0.0835, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0835, 0.0832, 0.0833, 0.0833, 0.0831, 0.0833, 0.0835, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0835, 0.0832, 0.0833, 0.0833, 0.0831, 0.0833, 0.0835, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0835, 0.0832, 0.0833, 0.0833, 0.0831, 0.0833, 0.0835, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0835, 0.0832, 0.0834, 0.0833, 0.0831, 0.0833, 0.0835, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0835, 0.0832, 0.0834, 0.0833, 0.0831, 0.0833, 0.0836, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0835, 0.0832, 0.0833, 0.0833, 0.0831, 0.0833, 0.0835, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0835, 0.0832, 0.0834, 0.0833, 0.0831, 0.0833, 0.0836, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0835, 0.0832, 0.0833, 0.0833, 0.0831, 0.0833, 0.0835, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0835, 0.0832, 0.0833, 0.0833, 0.0831, 0.0833, 0.0835, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0835, 0.0831, 0.0834, 0.0833, 0.0831, 0.0833, 0.0836, 0.0833, 0.0832,
         0.0832, 0.0836, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1430, 0.1428, 0.1427, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1430, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1430, 0.1428, 0.1427, 0.1428, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2550389766693115s
iter time cost:10.371235847473145s
-------------Round number: 7-------------
Evaluate global model
Averaged Train Loss: 3.6570
Averaged Test Accurancy: 0.5643
Std Test Accurancy: 0.1791
evaluate time cost:4.634196519851685s
clients training time cost:4.738615036010742s
attn_optimize time cost:0.4072871208190918s
weights:tensor([[0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999,
         0.0999],
        [0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999,
         0.0999],
        [0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999,
         0.0999],
        [0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999,
         0.0999],
        [0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999,
         0.0999],
        [0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999,
         0.0999],
        [0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999,
         0.0999],
        [0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999,
         0.0999],
        [0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999,
         0.0999],
        [0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0768, 0.0769, 0.0769, 0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0772]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1252, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1252, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1252, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1252, 0.1250, 0.1248, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1252, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1252, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1252, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1252, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5010, 0.4990],
        [0.5006, 0.4994]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1253, 0.1249, 0.1252, 0.1250, 0.1252, 0.1248, 0.1247, 0.1249],
        [0.1253, 0.1249, 0.1252, 0.1250, 0.1252, 0.1248, 0.1247, 0.1249],
        [0.1253, 0.1249, 0.1252, 0.1250, 0.1252, 0.1248, 0.1247, 0.1249],
        [0.1253, 0.1249, 0.1252, 0.1250, 0.1252, 0.1248, 0.1247, 0.1249],
        [0.1253, 0.1249, 0.1252, 0.1250, 0.1252, 0.1248, 0.1247, 0.1249],
        [0.1253, 0.1249, 0.1252, 0.1250, 0.1252, 0.1248, 0.1247, 0.1249],
        [0.1253, 0.1249, 0.1252, 0.1250, 0.1252, 0.1248, 0.1247, 0.1249],
        [0.1253, 0.1249, 0.1252, 0.1250, 0.1252, 0.1248, 0.1247, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1249],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1249],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1249],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1249],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1249],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1249],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1249],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0831],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0831],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0831],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0830]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0836],
        [0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0836],
        [0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0836],
        [0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0836],
        [0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0836],
        [0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0836],
        [0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0836],
        [0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0836],
        [0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0836],
        [0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0836],
        [0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0836],
        [0.0832, 0.0835, 0.0832, 0.0834, 0.0833, 0.0834, 0.0832, 0.0833, 0.0835,
         0.0833, 0.0833, 0.0835]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1430, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1430, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2385714054107666s
iter time cost:10.081677913665771s
-------------Round number: 8-------------
Evaluate global model
Averaged Train Loss: 4.2478
Averaged Test Accurancy: 0.5487
Std Test Accurancy: 0.1912
evaluate time cost:4.597951889038086s
clients training time cost:4.673651456832886s
attn_optimize time cost:0.4119837284088135s
weights:tensor([[0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1001],
        [0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1001],
        [0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1001,
         0.1001],
        [0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1001],
        [0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1001,
         0.1001],
        [0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1001],
        [0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1001],
        [0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1001,
         0.1001],
        [0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1001,
         0.1001],
        [0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0770, 0.0770, 0.0770, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0772]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1248, 0.1252, 0.1251, 0.1251, 0.1248],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1252, 0.1251, 0.1251, 0.1248],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1252, 0.1251, 0.1251, 0.1248],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1252, 0.1251, 0.1251, 0.1248],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1252, 0.1251, 0.1251, 0.1248],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1252, 0.1251, 0.1251, 0.1248],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1252, 0.1251, 0.1251, 0.1248],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1252, 0.1251, 0.1251, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5011, 0.4989],
        [0.5007, 0.4993]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1248, 0.1251, 0.1250, 0.1249, 0.1251, 0.1252, 0.1250, 0.1250],
        [0.1248, 0.1251, 0.1250, 0.1249, 0.1251, 0.1252, 0.1250, 0.1250],
        [0.1248, 0.1251, 0.1250, 0.1249, 0.1251, 0.1252, 0.1250, 0.1250],
        [0.1248, 0.1251, 0.1250, 0.1249, 0.1251, 0.1252, 0.1250, 0.1250],
        [0.1248, 0.1251, 0.1250, 0.1249, 0.1251, 0.1252, 0.1250, 0.1250],
        [0.1249, 0.1251, 0.1250, 0.1249, 0.1251, 0.1251, 0.1250, 0.1250],
        [0.1248, 0.1251, 0.1250, 0.1249, 0.1251, 0.1252, 0.1250, 0.1250],
        [0.1248, 0.1251, 0.1250, 0.1249, 0.1251, 0.1252, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1251, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1251, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1251, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1251, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1251, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1251, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1251, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248, 0.1249, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0832, 0.0834, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0830]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0832, 0.0832, 0.0833, 0.0833, 0.0833, 0.0835, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0835],
        [0.0834, 0.0831, 0.0832, 0.0833, 0.0833, 0.0833, 0.0835, 0.0833, 0.0832,
         0.0834, 0.0833, 0.0836],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0833, 0.0833, 0.0835, 0.0833, 0.0832,
         0.0834, 0.0833, 0.0836],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0833, 0.0833, 0.0835, 0.0833, 0.0832,
         0.0834, 0.0833, 0.0835],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0833, 0.0833, 0.0835, 0.0833, 0.0832,
         0.0834, 0.0833, 0.0836],
        [0.0834, 0.0831, 0.0832, 0.0833, 0.0833, 0.0833, 0.0835, 0.0833, 0.0832,
         0.0834, 0.0833, 0.0835],
        [0.0834, 0.0831, 0.0832, 0.0833, 0.0833, 0.0833, 0.0835, 0.0833, 0.0832,
         0.0834, 0.0833, 0.0835],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0833, 0.0833, 0.0835, 0.0833, 0.0832,
         0.0834, 0.0833, 0.0835],
        [0.0834, 0.0831, 0.0832, 0.0833, 0.0833, 0.0833, 0.0835, 0.0833, 0.0832,
         0.0834, 0.0833, 0.0835],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0833, 0.0833, 0.0835, 0.0833, 0.0832,
         0.0834, 0.0833, 0.0835],
        [0.0834, 0.0831, 0.0832, 0.0833, 0.0833, 0.0833, 0.0835, 0.0833, 0.0832,
         0.0834, 0.0833, 0.0836],
        [0.0834, 0.0831, 0.0832, 0.0834, 0.0833, 0.0833, 0.0836, 0.0834, 0.0832,
         0.0834, 0.0833, 0.0835]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1430, 0.1431, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1427, 0.1430, 0.1431, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1427, 0.1430, 0.1431, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1427, 0.1430, 0.1431, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1427, 0.1430, 0.1431, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1427, 0.1430, 0.1431, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1427, 0.1430, 0.1431, 0.1428, 0.1428, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2402195930480957s
iter time cost:9.986860036849976s
-------------Round number: 9-------------
Evaluate global model
Averaged Train Loss: 3.5461
Averaged Test Accurancy: 0.5693
Std Test Accurancy: 0.1805
evaluate time cost:4.640860080718994s
clients training time cost:4.7314677238464355s
attn_optimize time cost:0.4114501476287842s
weights:tensor([[0.0998, 0.1000, 0.1001, 0.0998, 0.1001, 0.1001, 0.0999, 0.1002, 0.1000,
         0.0999],
        [0.0998, 0.1000, 0.1001, 0.0998, 0.1001, 0.1001, 0.0999, 0.1002, 0.1000,
         0.0999],
        [0.0998, 0.1000, 0.1001, 0.0998, 0.1001, 0.1001, 0.0999, 0.1002, 0.1000,
         0.0999],
        [0.0998, 0.1000, 0.1001, 0.0998, 0.1001, 0.1001, 0.0999, 0.1002, 0.1000,
         0.0999],
        [0.0998, 0.1000, 0.1001, 0.0998, 0.1001, 0.1001, 0.0999, 0.1002, 0.1000,
         0.0999],
        [0.0998, 0.1000, 0.1001, 0.0998, 0.1001, 0.1001, 0.0999, 0.1002, 0.1000,
         0.0999],
        [0.0998, 0.1000, 0.1001, 0.0998, 0.1001, 0.1001, 0.0999, 0.1002, 0.1000,
         0.0999],
        [0.0998, 0.1000, 0.1001, 0.0998, 0.1001, 0.1001, 0.0999, 0.1002, 0.1000,
         0.0999],
        [0.0998, 0.1000, 0.1001, 0.0998, 0.1001, 0.1001, 0.0999, 0.1002, 0.1000,
         0.0999],
        [0.0998, 0.1000, 0.1001, 0.0998, 0.1001, 0.1001, 0.0999, 0.1002, 0.1000,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0767, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0771],
        [0.0769, 0.0767, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0767, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0767, 0.0768, 0.0771, 0.0770, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0771],
        [0.0769, 0.0767, 0.0768, 0.0771, 0.0769, 0.0771, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0767, 0.0770, 0.0772]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1251, 0.1251, 0.1249, 0.1251, 0.1250, 0.1247, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1251, 0.1250, 0.1247, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1251, 0.1250, 0.1248, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1251, 0.1250, 0.1247, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1251, 0.1250, 0.1247, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1251, 0.1250, 0.1247, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1251, 0.1250, 0.1247, 0.1250],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1251, 0.1250, 0.1247, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5002, 0.4998],
        [0.4998, 0.5002]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1252, 0.1250, 0.1251, 0.1251, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1252, 0.1250, 0.1251, 0.1251, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1252, 0.1250, 0.1251, 0.1251, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1252, 0.1250, 0.1251, 0.1251, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1252, 0.1250, 0.1251, 0.1251, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1252, 0.1250, 0.1251, 0.1251, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1252, 0.1250, 0.1251, 0.1251, 0.1250, 0.1248, 0.1249, 0.1248],
        [0.1252, 0.1250, 0.1251, 0.1251, 0.1250, 0.1248, 0.1249, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1252, 0.1250, 0.1247, 0.1250, 0.1250, 0.1252, 0.1251, 0.1249],
        [0.1252, 0.1250, 0.1248, 0.1250, 0.1250, 0.1252, 0.1251, 0.1249],
        [0.1252, 0.1250, 0.1247, 0.1250, 0.1250, 0.1252, 0.1251, 0.1249],
        [0.1252, 0.1250, 0.1247, 0.1250, 0.1250, 0.1252, 0.1251, 0.1249],
        [0.1252, 0.1250, 0.1247, 0.1250, 0.1250, 0.1252, 0.1251, 0.1249],
        [0.1252, 0.1250, 0.1247, 0.1250, 0.1250, 0.1252, 0.1251, 0.1249],
        [0.1252, 0.1250, 0.1247, 0.1250, 0.1250, 0.1252, 0.1251, 0.1249],
        [0.1252, 0.1250, 0.1247, 0.1250, 0.1250, 0.1252, 0.1251, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0833, 0.0835, 0.0832, 0.0833, 0.0834,
         0.0834, 0.0835, 0.0829]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0831, 0.0832, 0.0832, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0833, 0.0834, 0.0831, 0.0832, 0.0832, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0833, 0.0834, 0.0831, 0.0832, 0.0832, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0833, 0.0834, 0.0831, 0.0832, 0.0832, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0833, 0.0834, 0.0831, 0.0832, 0.0832, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0833, 0.0834, 0.0831, 0.0832, 0.0832, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0833, 0.0835, 0.0831, 0.0832, 0.0832, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0833, 0.0834, 0.0831, 0.0832, 0.0832, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0833, 0.0835, 0.0831, 0.0832, 0.0832, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0833, 0.0834, 0.0831, 0.0832, 0.0832, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0833, 0.0834, 0.0831, 0.0832, 0.0832, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0834, 0.0835, 0.0831, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0833,
         0.0832, 0.0835, 0.0836]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1430, 0.1430, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1427, 0.1430, 0.1430, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1427, 0.1430, 0.1430, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1427, 0.1430, 0.1430, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1427, 0.1430, 0.1430, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1427, 0.1430, 0.1430, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1427, 0.1430, 0.1430, 0.1428, 0.1427, 0.1428, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.24121928215026855s
iter time cost:10.08605408668518s
-------------Round number: 10-------------
Evaluate global model
Averaged Train Loss: 3.0559
Averaged Test Accurancy: 0.5701
Std Test Accurancy: 0.1821
evaluate time cost:4.590183973312378s
clients training time cost:4.6723363399505615s
[running kmeans]: 3it [00:00, 333.08it/s, center_shift=0.000000, iteration=3, tol=0.000100]
attn_optimize time cost:0.4119229316711426s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1429, 0.1427, 0.1430, 0.1431, 0.1428, 0.1429, 0.1427],
        [0.1429, 0.1427, 0.1430, 0.1431, 0.1428, 0.1429, 0.1426],
        [0.1429, 0.1427, 0.1430, 0.1431, 0.1428, 0.1429, 0.1427],
        [0.1429, 0.1427, 0.1430, 0.1431, 0.1427, 0.1429, 0.1426],
        [0.1429, 0.1427, 0.1430, 0.1431, 0.1428, 0.1429, 0.1427],
        [0.1429, 0.1427, 0.1430, 0.1431, 0.1428, 0.1429, 0.1426],
        [0.1429, 0.1427, 0.1430, 0.1431, 0.1428, 0.1429, 0.1426]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0772]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1429, 0.1430, 0.1427, 0.1427, 0.1431, 0.1427],
        [0.1428, 0.1429, 0.1430, 0.1427, 0.1427, 0.1431, 0.1428],
        [0.1428, 0.1429, 0.1430, 0.1427, 0.1427, 0.1431, 0.1428],
        [0.1428, 0.1429, 0.1430, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1429, 0.1430, 0.1427, 0.1427, 0.1430, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1001, 0.0998, 0.1000, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001,
         0.1000],
        [0.1001, 0.1001, 0.0998, 0.0999, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001,
         0.1000],
        [0.1001, 0.1001, 0.0998, 0.0999, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001,
         0.1000],
        [0.1002, 0.1001, 0.0998, 0.0999, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001,
         0.1000],
        [0.1001, 0.1001, 0.0998, 0.0999, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001,
         0.1000],
        [0.1001, 0.1001, 0.0998, 0.1000, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001,
         0.1000],
        [0.1001, 0.1001, 0.0998, 0.0999, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001,
         0.1000],
        [0.1001, 0.1001, 0.0998, 0.0999, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001,
         0.1000],
        [0.1001, 0.1001, 0.0998, 0.1000, 0.1000, 0.1001, 0.1001, 0.0998, 0.1000,
         0.1000],
        [0.1001, 0.1001, 0.0998, 0.0999, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.1997, 0.1998, 0.2004, 0.2002],
        [0.1999, 0.1997, 0.1998, 0.2004, 0.2002],
        [0.1999, 0.1997, 0.1998, 0.2004, 0.2002],
        [0.1999, 0.1998, 0.1998, 0.2004, 0.2002],
        [0.1999, 0.1998, 0.1998, 0.2004, 0.2002]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1427, 0.1429, 0.1427, 0.1430, 0.1430, 0.1429],
        [0.1429, 0.1427, 0.1429, 0.1427, 0.1430, 0.1430, 0.1429],
        [0.1429, 0.1427, 0.1429, 0.1427, 0.1430, 0.1430, 0.1429],
        [0.1429, 0.1427, 0.1429, 0.1427, 0.1430, 0.1430, 0.1429],
        [0.1429, 0.1427, 0.1429, 0.1427, 0.1430, 0.1430, 0.1429],
        [0.1429, 0.1427, 0.1429, 0.1427, 0.1430, 0.1430, 0.1429],
        [0.1429, 0.1426, 0.1429, 0.1427, 0.1430, 0.1430, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.1002, 0.1002, 0.1002, 0.0995, 0.1000, 0.1002, 0.1001, 0.1001,
         0.0993],
        [0.1002, 0.1002, 0.1002, 0.1002, 0.0995, 0.1000, 0.1002, 0.1001, 0.1001,
         0.0993],
        [0.1002, 0.1002, 0.1002, 0.1002, 0.0996, 0.1000, 0.1002, 0.1001, 0.1001,
         0.0993],
        [0.1002, 0.1002, 0.1002, 0.1002, 0.0996, 0.1000, 0.1002, 0.1001, 0.1001,
         0.0993],
        [0.1002, 0.1002, 0.1002, 0.1002, 0.0996, 0.1000, 0.1001, 0.1000, 0.1001,
         0.0994],
        [0.1002, 0.1002, 0.1002, 0.1002, 0.0995, 0.1000, 0.1002, 0.1001, 0.1001,
         0.0993],
        [0.1002, 0.1002, 0.1002, 0.1002, 0.0996, 0.1000, 0.1002, 0.1001, 0.1001,
         0.0993],
        [0.1002, 0.1002, 0.1002, 0.1002, 0.0995, 0.1000, 0.1002, 0.1001, 0.1001,
         0.0994],
        [0.1002, 0.1002, 0.1002, 0.1002, 0.0995, 0.1000, 0.1002, 0.1001, 0.1001,
         0.0993],
        [0.1001, 0.1001, 0.1002, 0.1002, 0.0996, 0.0999, 0.1001, 0.1000, 0.1001,
         0.0997]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2602369785308838s
iter time cost:10.016753673553467s
-------------Round number: 11-------------
Evaluate global model
Averaged Train Loss: 2.9765
Averaged Test Accurancy: 0.5858
Std Test Accurancy: 0.1782
evaluate time cost:4.734428405761719s
clients training time cost:4.8499133586883545s
attn_optimize time cost:0.4677309989929199s
weights:tensor([[0.1429, 0.1428, 0.1426, 0.1432, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1426, 0.1432, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1426, 0.1432, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1426, 0.1432, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1426, 0.1432, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1426, 0.1432, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1426, 0.1432, 0.1428, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0770, 0.0768, 0.0768, 0.0770, 0.0770, 0.0771, 0.0769, 0.0768, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1430, 0.1430, 0.1428, 0.1427, 0.1430, 0.1427],
        [0.1428, 0.1430, 0.1430, 0.1428, 0.1427, 0.1430, 0.1427],
        [0.1428, 0.1430, 0.1430, 0.1428, 0.1427, 0.1430, 0.1427],
        [0.1428, 0.1430, 0.1430, 0.1428, 0.1427, 0.1430, 0.1427],
        [0.1428, 0.1430, 0.1430, 0.1428, 0.1427, 0.1430, 0.1427],
        [0.1428, 0.1430, 0.1430, 0.1428, 0.1427, 0.1430, 0.1427],
        [0.1428, 0.1430, 0.1430, 0.1428, 0.1427, 0.1430, 0.1427]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1002, 0.1000, 0.1002, 0.1000, 0.0999, 0.1000, 0.0998, 0.0999,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1002, 0.1000, 0.0999, 0.1000, 0.0998, 0.0999,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1002, 0.1000, 0.0999, 0.1000, 0.0998, 0.0999,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1002, 0.1000, 0.0999, 0.1000, 0.0998, 0.0999,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1002, 0.1000, 0.0999, 0.1000, 0.0998, 0.0999,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1002, 0.1000, 0.0999, 0.1000, 0.0998, 0.0999,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1002, 0.1000, 0.0999, 0.1000, 0.0998, 0.0999,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1002, 0.1000, 0.0999, 0.1000, 0.0998, 0.0999,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1002, 0.1000, 0.0999, 0.1000, 0.0998, 0.0999,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1002, 0.1000, 0.0999, 0.1000, 0.0998, 0.0999,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.2006, 0.2001, 0.1996, 0.1996],
        [0.2001, 0.2005, 0.2001, 0.1996, 0.1996],
        [0.2001, 0.2006, 0.2001, 0.1996, 0.1996],
        [0.2002, 0.2006, 0.2001, 0.1996, 0.1996],
        [0.2002, 0.2006, 0.2001, 0.1996, 0.1996]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1430, 0.1428, 0.1429, 0.1427, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1428, 0.1429, 0.1427, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1428, 0.1429, 0.1427, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1428, 0.1429, 0.1427, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1428, 0.1429, 0.1427, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1428, 0.1429, 0.1427, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1428, 0.1429, 0.1427, 0.1429, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1002, 0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999,
         0.0996],
        [0.1001, 0.1002, 0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999,
         0.0996],
        [0.1001, 0.1002, 0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999,
         0.0996],
        [0.1001, 0.1002, 0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999,
         0.0996],
        [0.1001, 0.1002, 0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999,
         0.0997],
        [0.1001, 0.1002, 0.0999, 0.1001, 0.0998, 0.1000, 0.1001, 0.1002, 0.1000,
         0.0995],
        [0.1001, 0.1002, 0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1002, 0.1000,
         0.0995],
        [0.1001, 0.1002, 0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999,
         0.0996],
        [0.1001, 0.1002, 0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999,
         0.0995],
        [0.1000, 0.1001, 0.0998, 0.1000, 0.1000, 0.0999, 0.1000, 0.1002, 0.0999,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2707817554473877s
iter time cost:10.385916233062744s
-------------Round number: 12-------------
Evaluate global model
Averaged Train Loss: 3.0943
Averaged Test Accurancy: 0.5703
Std Test Accurancy: 0.1884
evaluate time cost:4.7970311641693115s
clients training time cost:4.79592227935791s
attn_optimize time cost:0.4549086093902588s
weights:tensor([[0.1429, 0.1426, 0.1430, 0.1430, 0.1431, 0.1427, 0.1429],
        [0.1429, 0.1426, 0.1430, 0.1430, 0.1431, 0.1426, 0.1428],
        [0.1429, 0.1426, 0.1430, 0.1430, 0.1431, 0.1427, 0.1428],
        [0.1429, 0.1426, 0.1430, 0.1430, 0.1431, 0.1426, 0.1428],
        [0.1429, 0.1426, 0.1430, 0.1430, 0.1431, 0.1427, 0.1428],
        [0.1429, 0.1426, 0.1430, 0.1430, 0.1431, 0.1426, 0.1428],
        [0.1429, 0.1426, 0.1430, 0.1430, 0.1431, 0.1427, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0767, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0767, 0.0770, 0.0771],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0768, 0.0767, 0.0768, 0.0772, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0767, 0.0771, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1430, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0999, 0.1000, 0.0998, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.0998,
         0.1001],
        [0.1000, 0.1000, 0.0998, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.0998,
         0.1001],
        [0.0999, 0.1000, 0.0998, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.0998,
         0.1001],
        [0.1000, 0.1000, 0.0998, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.0998, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.0998,
         0.1001],
        [0.1000, 0.1000, 0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.0998, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.0998,
         0.1001],
        [0.1000, 0.1000, 0.0998, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.0998,
         0.1001],
        [0.1000, 0.1000, 0.0998, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.0998,
         0.1001],
        [0.1000, 0.1000, 0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.0999,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.1996, 0.2000, 0.2001, 0.2004],
        [0.1999, 0.1996, 0.2000, 0.2001, 0.2004],
        [0.1999, 0.1996, 0.2000, 0.2001, 0.2004],
        [0.1999, 0.1996, 0.2000, 0.2001, 0.2004],
        [0.1999, 0.1996, 0.2000, 0.2001, 0.2004]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1425, 0.1426, 0.1432, 0.1430, 0.1430, 0.1427],
        [0.1429, 0.1424, 0.1426, 0.1433, 0.1430, 0.1430, 0.1427],
        [0.1429, 0.1424, 0.1426, 0.1433, 0.1430, 0.1430, 0.1427],
        [0.1429, 0.1424, 0.1426, 0.1433, 0.1430, 0.1430, 0.1427],
        [0.1429, 0.1424, 0.1426, 0.1433, 0.1430, 0.1430, 0.1427],
        [0.1429, 0.1424, 0.1426, 0.1433, 0.1430, 0.1430, 0.1427],
        [0.1429, 0.1424, 0.1426, 0.1433, 0.1430, 0.1430, 0.1427]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0502, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.1002, 0.1002, 0.1001, 0.0996, 0.1000, 0.0998, 0.1002, 0.1002,
         0.0995],
        [0.1002, 0.1002, 0.1002, 0.1001, 0.0996, 0.1000, 0.0999, 0.1002, 0.1002,
         0.0994],
        [0.1002, 0.1002, 0.1001, 0.1001, 0.0997, 0.1000, 0.0998, 0.1002, 0.1001,
         0.0995],
        [0.1002, 0.1002, 0.1001, 0.1001, 0.0996, 0.1000, 0.0999, 0.1002, 0.1002,
         0.0995],
        [0.1001, 0.1002, 0.1001, 0.1001, 0.0997, 0.1000, 0.0998, 0.1002, 0.1001,
         0.0996],
        [0.1002, 0.1002, 0.1002, 0.1001, 0.0996, 0.1000, 0.0999, 0.1002, 0.1002,
         0.0994],
        [0.1002, 0.1002, 0.1001, 0.1001, 0.0997, 0.1000, 0.0998, 0.1002, 0.1002,
         0.0995],
        [0.1002, 0.1002, 0.1001, 0.1001, 0.0997, 0.1000, 0.0998, 0.1002, 0.1001,
         0.0995],
        [0.1002, 0.1002, 0.1001, 0.1001, 0.0996, 0.1000, 0.0999, 0.1002, 0.1002,
         0.0994],
        [0.1001, 0.1002, 0.1001, 0.1001, 0.0998, 0.0999, 0.0997, 0.1001, 0.1001,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2740049362182617s
iter time cost:10.38850450515747s
-------------Round number: 13-------------
Evaluate global model
Averaged Train Loss: 2.6802
Averaged Test Accurancy: 0.6006
Std Test Accurancy: 0.1667
evaluate time cost:4.709893703460693s
clients training time cost:4.7690043449401855s
attn_optimize time cost:0.4443984031677246s
weights:tensor([[0.1427, 0.1428, 0.1430, 0.1427, 0.1426, 0.1429, 0.1433],
        [0.1427, 0.1428, 0.1430, 0.1427, 0.1426, 0.1429, 0.1433],
        [0.1427, 0.1428, 0.1430, 0.1427, 0.1426, 0.1429, 0.1433],
        [0.1427, 0.1428, 0.1430, 0.1427, 0.1426, 0.1429, 0.1433],
        [0.1427, 0.1428, 0.1430, 0.1427, 0.1426, 0.1429, 0.1433],
        [0.1427, 0.1428, 0.1430, 0.1427, 0.1426, 0.1429, 0.1433],
        [0.1427, 0.1428, 0.1430, 0.1427, 0.1426, 0.1429, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0767, 0.0769, 0.0770, 0.0770, 0.0772, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0771, 0.0770, 0.0772, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0771, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0770, 0.0770, 0.0772, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0771, 0.0770, 0.0772, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0771, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0770, 0.0770, 0.0772, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0771, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0771, 0.0770, 0.0772, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0771, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0771, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0770, 0.0770, 0.0772, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0770, 0.0770, 0.0772, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0772]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1430, 0.1431, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1427, 0.1430, 0.1431, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1427, 0.1430, 0.1431, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1427, 0.1430, 0.1431, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1427, 0.1430, 0.1431, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1427, 0.1430, 0.1431, 0.1427, 0.1427, 0.1430, 0.1429],
        [0.1427, 0.1430, 0.1431, 0.1427, 0.1427, 0.1430, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.0998, 0.1002, 0.1000, 0.1000, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1001],
        [0.1003, 0.0997, 0.1002, 0.1000, 0.1000, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1001],
        [0.1002, 0.0998, 0.1002, 0.1000, 0.1000, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1001],
        [0.1002, 0.0997, 0.1002, 0.1000, 0.1000, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1001],
        [0.1002, 0.0997, 0.1002, 0.1000, 0.1000, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1001],
        [0.1002, 0.0997, 0.1002, 0.1000, 0.1000, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1001],
        [0.1002, 0.0997, 0.1002, 0.1000, 0.1000, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1001],
        [0.1002, 0.0997, 0.1002, 0.1000, 0.1000, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1001],
        [0.1002, 0.0998, 0.1002, 0.1000, 0.1000, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1001],
        [0.1002, 0.0998, 0.1002, 0.1000, 0.1000, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1998, 0.2002, 0.2005, 0.2002, 0.1994],
        [0.1998, 0.2002, 0.2005, 0.2002, 0.1994],
        [0.1998, 0.2002, 0.2005, 0.2002, 0.1994],
        [0.1998, 0.2002, 0.2005, 0.2002, 0.1994],
        [0.1998, 0.2002, 0.2005, 0.2002, 0.1994]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1430, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1000, 0.1002, 0.1000, 0.0997, 0.1001, 0.1001, 0.1002, 0.1001,
         0.0995],
        [0.1001, 0.1001, 0.1001, 0.1000, 0.0997, 0.1001, 0.1001, 0.1002, 0.1001,
         0.0994],
        [0.1001, 0.1001, 0.1001, 0.1000, 0.0997, 0.1001, 0.1001, 0.1002, 0.1001,
         0.0995],
        [0.1001, 0.1000, 0.1002, 0.1000, 0.0997, 0.1001, 0.1001, 0.1002, 0.1001,
         0.0995],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.0998, 0.1001, 0.1001, 0.1002, 0.1001,
         0.0996],
        [0.1001, 0.1001, 0.1001, 0.1000, 0.0997, 0.1001, 0.1001, 0.1002, 0.1001,
         0.0994],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.0997, 0.1001, 0.1001, 0.1002, 0.1001,
         0.0995],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.0997, 0.1001, 0.1001, 0.1002, 0.1001,
         0.0995],
        [0.1001, 0.1001, 0.1001, 0.1000, 0.0997, 0.1001, 0.1001, 0.1002, 0.1001,
         0.0994],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000, 0.1002, 0.1000,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2678673267364502s
iter time cost:10.255221128463745s
-------------Round number: 14-------------
Evaluate global model
Averaged Train Loss: 2.9130
Averaged Test Accurancy: 0.5760
Std Test Accurancy: 0.1815
evaluate time cost:4.65756368637085s
clients training time cost:4.883706331253052s
attn_optimize time cost:0.44599270820617676s
weights:tensor([[0.1427, 0.1429, 0.1427, 0.1431, 0.1429, 0.1429, 0.1428],
        [0.1427, 0.1429, 0.1427, 0.1431, 0.1429, 0.1429, 0.1428],
        [0.1427, 0.1429, 0.1427, 0.1431, 0.1429, 0.1429, 0.1428],
        [0.1427, 0.1429, 0.1427, 0.1431, 0.1429, 0.1429, 0.1428],
        [0.1427, 0.1429, 0.1427, 0.1431, 0.1429, 0.1429, 0.1428],
        [0.1427, 0.1429, 0.1427, 0.1431, 0.1429, 0.1429, 0.1428],
        [0.1427, 0.1429, 0.1427, 0.1431, 0.1429, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0771, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0771, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0767, 0.0772, 0.0771, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1429, 0.1430, 0.1428, 0.1427, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1427],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1427],
        [0.1428, 0.1429, 0.1430, 0.1428, 0.1427, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1428, 0.1427, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1001, 0.0999, 0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000,
         0.0999],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000,
         0.0999],
        [0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000,
         0.0999],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000,
         0.0999],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000,
         0.0999],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000,
         0.0999],
        [0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000,
         0.0999],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000,
         0.0999],
        [0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000,
         0.0999],
        [0.0999, 0.1001, 0.0999, 0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2002, 0.2002, 0.1998, 0.1996, 0.2001],
        [0.2002, 0.2002, 0.1998, 0.1997, 0.2001],
        [0.2002, 0.2002, 0.1998, 0.1996, 0.2001],
        [0.2002, 0.2002, 0.1998, 0.1996, 0.2001],
        [0.2002, 0.2002, 0.1998, 0.1997, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1429, 0.1428, 0.1427, 0.1428, 0.1430, 0.1430],
        [0.1427, 0.1429, 0.1428, 0.1427, 0.1428, 0.1430, 0.1430],
        [0.1427, 0.1429, 0.1428, 0.1427, 0.1428, 0.1430, 0.1430],
        [0.1427, 0.1429, 0.1428, 0.1427, 0.1428, 0.1430, 0.1430],
        [0.1427, 0.1429, 0.1428, 0.1427, 0.1428, 0.1430, 0.1430],
        [0.1427, 0.1429, 0.1428, 0.1427, 0.1428, 0.1430, 0.1430],
        [0.1426, 0.1429, 0.1428, 0.1427, 0.1428, 0.1430, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.1001, 0.0999, 0.1003, 0.0996, 0.1000, 0.1002, 0.1002, 0.0999,
         0.0996],
        [0.1002, 0.1001, 0.0999, 0.1003, 0.0996, 0.1000, 0.1002, 0.1002, 0.0999,
         0.0996],
        [0.1002, 0.1001, 0.0998, 0.1003, 0.0996, 0.1000, 0.1002, 0.1002, 0.0998,
         0.0997],
        [0.1002, 0.1001, 0.0999, 0.1003, 0.0996, 0.1000, 0.1002, 0.1002, 0.0999,
         0.0996],
        [0.1002, 0.1001, 0.0998, 0.1003, 0.0997, 0.1000, 0.1002, 0.1001, 0.0998,
         0.0998],
        [0.1002, 0.1001, 0.0999, 0.1003, 0.0996, 0.1001, 0.1002, 0.1002, 0.0999,
         0.0995],
        [0.1002, 0.1001, 0.0999, 0.1003, 0.0996, 0.1000, 0.1002, 0.1002, 0.0999,
         0.0996],
        [0.1002, 0.1001, 0.0999, 0.1003, 0.0996, 0.1000, 0.1002, 0.1002, 0.0999,
         0.0997],
        [0.1002, 0.1001, 0.0998, 0.1003, 0.0996, 0.1001, 0.1002, 0.1002, 0.0999,
         0.0996],
        [0.1002, 0.1000, 0.0998, 0.1003, 0.0998, 0.1000, 0.1001, 0.1001, 0.0998,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2638101577758789s
iter time cost:10.313129901885986s
-------------Round number: 15-------------
Evaluate global model
Averaged Train Loss: 2.9970
Averaged Test Accurancy: 0.6234
Std Test Accurancy: 0.1823
evaluate time cost:4.711798906326294s
clients training time cost:4.888948917388916s
attn_optimize time cost:0.44797229766845703s
weights:tensor([[0.1428, 0.1427, 0.1428, 0.1432, 0.1428, 0.1429, 0.1428],
        [0.1429, 0.1427, 0.1428, 0.1432, 0.1428, 0.1429, 0.1428],
        [0.1429, 0.1427, 0.1428, 0.1432, 0.1428, 0.1429, 0.1428],
        [0.1429, 0.1427, 0.1428, 0.1432, 0.1428, 0.1429, 0.1428],
        [0.1429, 0.1427, 0.1428, 0.1432, 0.1428, 0.1429, 0.1428],
        [0.1429, 0.1427, 0.1428, 0.1432, 0.1428, 0.1429, 0.1427],
        [0.1429, 0.1427, 0.1428, 0.1432, 0.1428, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0768, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0767, 0.0770, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1429, 0.1431, 0.1428, 0.1427, 0.1429, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1427, 0.1427, 0.1429, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1427, 0.1427, 0.1429, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1428, 0.1427, 0.1429, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1428, 0.1427, 0.1429, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1428, 0.1427, 0.1429, 0.1427],
        [0.1428, 0.1429, 0.1431, 0.1428, 0.1427, 0.1429, 0.1427]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.0998, 0.0998,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.0998, 0.0998,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.0998, 0.0998,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.0998, 0.0998,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.0998, 0.0998,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.0998, 0.0998,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.0998, 0.0997,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.0998, 0.0997,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.0998, 0.0997,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.0998, 0.0998,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2002, 0.1996, 0.1998, 0.2001, 0.2002],
        [0.2002, 0.1996, 0.1998, 0.2001, 0.2002],
        [0.2002, 0.1996, 0.1998, 0.2001, 0.2002],
        [0.2002, 0.1996, 0.1998, 0.2001, 0.2002],
        [0.2002, 0.1997, 0.1998, 0.2001, 0.2002]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1430, 0.1426, 0.1429, 0.1428, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1426, 0.1429, 0.1428, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1426, 0.1429, 0.1428, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1426, 0.1429, 0.1428, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1426, 0.1429, 0.1428, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1426, 0.1429, 0.1428, 0.1429, 0.1430],
        [0.1427, 0.1430, 0.1426, 0.1430, 0.1428, 0.1429, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.1001, 0.1002, 0.1000, 0.0997, 0.0999, 0.1000, 0.1001, 0.1001,
         0.0996],
        [0.1002, 0.1001, 0.1002, 0.1000, 0.0997, 0.0999, 0.1000, 0.1001, 0.1001,
         0.0996],
        [0.1002, 0.1001, 0.1002, 0.1000, 0.0998, 0.0999, 0.1000, 0.1001, 0.1001,
         0.0997],
        [0.1002, 0.1001, 0.1002, 0.1000, 0.0997, 0.0998, 0.1000, 0.1001, 0.1001,
         0.0997],
        [0.1002, 0.1001, 0.1002, 0.1000, 0.0998, 0.0998, 0.1000, 0.1001, 0.1001,
         0.0999],
        [0.1002, 0.1001, 0.1002, 0.1000, 0.0997, 0.0998, 0.1000, 0.1001, 0.1001,
         0.0996],
        [0.1002, 0.1001, 0.1002, 0.1000, 0.0998, 0.0999, 0.1000, 0.1001, 0.1001,
         0.0997],
        [0.1002, 0.1001, 0.1002, 0.1000, 0.0998, 0.0998, 0.1000, 0.1001, 0.1001,
         0.0997],
        [0.1002, 0.1001, 0.1002, 0.1000, 0.0997, 0.0999, 0.1000, 0.1001, 0.1001,
         0.0997],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.0999, 0.0997, 0.1000, 0.1001, 0.1000,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26474618911743164s
iter time cost:10.377104997634888s
-------------Round number: 16-------------
Evaluate global model
Averaged Train Loss: 2.6934
Averaged Test Accurancy: 0.6148
Std Test Accurancy: 0.1878
evaluate time cost:4.795857667922974s
clients training time cost:5.017562627792358s
attn_optimize time cost:0.458524227142334s
weights:tensor([[0.1428, 0.1426, 0.1427, 0.1430, 0.1429, 0.1429, 0.1430],
        [0.1428, 0.1426, 0.1427, 0.1430, 0.1429, 0.1429, 0.1430],
        [0.1428, 0.1425, 0.1428, 0.1430, 0.1429, 0.1429, 0.1430],
        [0.1428, 0.1425, 0.1427, 0.1430, 0.1429, 0.1429, 0.1430],
        [0.1428, 0.1426, 0.1427, 0.1430, 0.1429, 0.1429, 0.1430],
        [0.1428, 0.1425, 0.1427, 0.1430, 0.1429, 0.1429, 0.1430],
        [0.1428, 0.1426, 0.1427, 0.1430, 0.1429, 0.1429, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0771, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0771, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0771, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0771, 0.0771, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0770, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1430, 0.1429, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1429, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1429, 0.1430, 0.1429, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1429, 0.1430, 0.1429, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1429, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1429, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1429, 0.1428, 0.1427, 0.1430, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1001,
         0.1000],
        [0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.0999, 0.1000,
         0.1000],
        [0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.0999, 0.1000,
         0.1000],
        [0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.0999, 0.1000,
         0.1000],
        [0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.0999, 0.1000,
         0.1000],
        [0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.0999, 0.1000,
         0.1000],
        [0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.0999, 0.1000,
         0.1000],
        [0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.0999, 0.1001,
         0.1000],
        [0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.0999, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.1998, 0.2004, 0.1999, 0.1999],
        [0.2000, 0.1998, 0.2004, 0.1999, 0.1999],
        [0.2000, 0.1998, 0.2004, 0.1999, 0.1999],
        [0.2000, 0.1998, 0.2004, 0.1999, 0.1999],
        [0.2000, 0.1998, 0.2004, 0.1999, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1426, 0.1430, 0.1430, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1426, 0.1430, 0.1430, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1426, 0.1430, 0.1430, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1425, 0.1430, 0.1430, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1426, 0.1430, 0.1430, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1426, 0.1430, 0.1431, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1425, 0.1430, 0.1431, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0502, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0999, 0.1000, 0.1001, 0.1002, 0.0998, 0.1001, 0.1001, 0.1000, 0.1002,
         0.0995],
        [0.1000, 0.1000, 0.1001, 0.1002, 0.0998, 0.1002, 0.1001, 0.1000, 0.1002,
         0.0995],
        [0.1000, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001, 0.1001, 0.1000, 0.1002,
         0.0995],
        [0.1000, 0.1000, 0.1001, 0.1001, 0.0998, 0.1001, 0.1001, 0.1000, 0.1002,
         0.0995],
        [0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0997],
        [0.1000, 0.1000, 0.1001, 0.1002, 0.0998, 0.1002, 0.1001, 0.1000, 0.1002,
         0.0994],
        [0.1000, 0.1000, 0.1001, 0.1002, 0.0998, 0.1001, 0.1001, 0.1000, 0.1002,
         0.0995],
        [0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1001, 0.1001, 0.1000, 0.1002,
         0.0995],
        [0.1000, 0.1000, 0.1001, 0.1002, 0.0998, 0.1001, 0.1001, 0.1000, 0.1002,
         0.0995],
        [0.0999, 0.0999, 0.1000, 0.1001, 0.1000, 0.1001, 0.1000, 0.1000, 0.1001,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2820107936859131s
iter time cost:10.619015216827393s
-------------Round number: 17-------------
Evaluate global model
Averaged Train Loss: 2.5520
Averaged Test Accurancy: 0.6298
Std Test Accurancy: 0.1805
evaluate time cost:4.947471857070923s
clients training time cost:5.022219657897949s
attn_optimize time cost:0.44737744331359863s
weights:tensor([[0.1427, 0.1428, 0.1428, 0.1432, 0.1428, 0.1427, 0.1429],
        [0.1427, 0.1428, 0.1428, 0.1432, 0.1428, 0.1427, 0.1429],
        [0.1427, 0.1428, 0.1428, 0.1432, 0.1428, 0.1427, 0.1429],
        [0.1427, 0.1428, 0.1428, 0.1432, 0.1428, 0.1427, 0.1429],
        [0.1427, 0.1428, 0.1428, 0.1432, 0.1428, 0.1427, 0.1429],
        [0.1427, 0.1428, 0.1428, 0.1432, 0.1428, 0.1427, 0.1429],
        [0.1427, 0.1428, 0.1428, 0.1432, 0.1428, 0.1427, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0767, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1429, 0.1431, 0.1427, 0.1427, 0.1431, 0.1428],
        [0.1427, 0.1429, 0.1431, 0.1427, 0.1427, 0.1431, 0.1428],
        [0.1427, 0.1429, 0.1431, 0.1427, 0.1427, 0.1431, 0.1428],
        [0.1427, 0.1429, 0.1431, 0.1427, 0.1427, 0.1431, 0.1428],
        [0.1427, 0.1429, 0.1431, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1427, 0.1429, 0.1431, 0.1427, 0.1427, 0.1430, 0.1428],
        [0.1427, 0.1429, 0.1431, 0.1427, 0.1427, 0.1430, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1001, 0.1000, 0.0999, 0.1001, 0.1001, 0.1001, 0.0998, 0.0999,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.0999, 0.1001, 0.1001, 0.1001, 0.0998, 0.0999,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.0999, 0.1001, 0.1001, 0.1001, 0.0998, 0.0999,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.0999, 0.1001, 0.1001, 0.1001, 0.0998, 0.0999,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.0999, 0.1001, 0.1001, 0.1001, 0.0998, 0.0999,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.0999, 0.1001, 0.1001, 0.1001, 0.0998, 0.0999,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.0999, 0.1001, 0.1001, 0.1001, 0.0998, 0.0999,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.0999, 0.1001, 0.1001, 0.1001, 0.0998, 0.0999,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.0999, 0.1001, 0.1001, 0.1001, 0.0998, 0.0999,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.0999, 0.1001, 0.1001, 0.1001, 0.0998, 0.0999,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2004, 0.1999, 0.1999, 0.1998],
        [0.2000, 0.2004, 0.1999, 0.1999, 0.1998],
        [0.1999, 0.2005, 0.1999, 0.1999, 0.1998],
        [0.2000, 0.2005, 0.1999, 0.1999, 0.1998],
        [0.2000, 0.2004, 0.1999, 0.1999, 0.1998]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0499, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0499, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0499, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1428, 0.1426, 0.1429, 0.1428, 0.1429, 0.1431],
        [0.1428, 0.1428, 0.1426, 0.1429, 0.1428, 0.1429, 0.1431],
        [0.1428, 0.1428, 0.1426, 0.1429, 0.1428, 0.1429, 0.1431],
        [0.1428, 0.1428, 0.1426, 0.1429, 0.1428, 0.1429, 0.1431],
        [0.1428, 0.1428, 0.1426, 0.1429, 0.1428, 0.1429, 0.1431],
        [0.1428, 0.1428, 0.1426, 0.1429, 0.1428, 0.1429, 0.1431],
        [0.1428, 0.1428, 0.1426, 0.1429, 0.1428, 0.1429, 0.1432]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.1001, 0.1000, 0.1002, 0.0998, 0.1000, 0.1000, 0.1000, 0.1001,
         0.0997],
        [0.1002, 0.1001, 0.1000, 0.1002, 0.0998, 0.1000, 0.1000, 0.1000, 0.1001,
         0.0997],
        [0.1002, 0.1000, 0.1000, 0.1002, 0.0998, 0.1000, 0.1000, 0.1000, 0.1001,
         0.0998],
        [0.1002, 0.1001, 0.1000, 0.1002, 0.0998, 0.1000, 0.1000, 0.1000, 0.1001,
         0.0997],
        [0.1001, 0.1000, 0.0999, 0.1001, 0.0998, 0.1000, 0.1000, 0.1000, 0.1001,
         0.0999],
        [0.1002, 0.1001, 0.1000, 0.1002, 0.0998, 0.1000, 0.1000, 0.1000, 0.1001,
         0.0997],
        [0.1002, 0.1001, 0.1000, 0.1002, 0.0998, 0.1000, 0.1000, 0.1000, 0.1001,
         0.0997],
        [0.1002, 0.1000, 0.1000, 0.1001, 0.0998, 0.1000, 0.1000, 0.1000, 0.1001,
         0.0998],
        [0.1002, 0.1001, 0.1000, 0.1002, 0.0998, 0.1000, 0.1000, 0.1000, 0.1001,
         0.0997],
        [0.1001, 0.1000, 0.0999, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000,
         0.1002]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2692453861236572s
iter time cost:10.749460458755493s
-------------Round number: 18-------------
Evaluate global model
Averaged Train Loss: 2.8413
Averaged Test Accurancy: 0.5886
Std Test Accurancy: 0.2045
evaluate time cost:4.684330224990845s
clients training time cost:4.903144836425781s
attn_optimize time cost:0.446990966796875s
weights:tensor([[0.1427, 0.1428, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1427, 0.1428, 0.1428, 0.1428, 0.1429, 0.1430, 0.1429],
        [0.1427, 0.1428, 0.1428, 0.1429, 0.1429, 0.1430, 0.1429],
        [0.1427, 0.1429, 0.1428, 0.1428, 0.1429, 0.1430, 0.1429],
        [0.1427, 0.1428, 0.1428, 0.1428, 0.1429, 0.1430, 0.1429],
        [0.1427, 0.1429, 0.1428, 0.1428, 0.1429, 0.1430, 0.1428],
        [0.1427, 0.1429, 0.1428, 0.1428, 0.1429, 0.1430, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0767, 0.0767, 0.0772, 0.0770, 0.0771, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1430, 0.1427, 0.1427, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1002, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.0998, 0.1000,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.0998, 0.1000,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.0998, 0.1000,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.0998, 0.1000,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.0998, 0.1000,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1001, 0.1000, 0.0999, 0.1002, 0.0998, 0.1000,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.0998, 0.1000,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1001, 0.1000, 0.0999, 0.1002, 0.0998, 0.1000,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.0998, 0.1000,
         0.0999],
        [0.1001, 0.1002, 0.1000, 0.1001, 0.1000, 0.0999, 0.1002, 0.0997, 0.1000,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2004, 0.1999, 0.1998, 0.1999, 0.2000],
        [0.2004, 0.1999, 0.1998, 0.1999, 0.2000],
        [0.2005, 0.1999, 0.1998, 0.1998, 0.2000],
        [0.2005, 0.1999, 0.1998, 0.1999, 0.1999],
        [0.2004, 0.1999, 0.1998, 0.1999, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1427, 0.1427, 0.1428, 0.1429, 0.1431, 0.1428],
        [0.1430, 0.1427, 0.1427, 0.1428, 0.1429, 0.1431, 0.1428],
        [0.1430, 0.1427, 0.1427, 0.1428, 0.1429, 0.1431, 0.1428],
        [0.1430, 0.1427, 0.1427, 0.1428, 0.1429, 0.1431, 0.1428],
        [0.1430, 0.1427, 0.1427, 0.1428, 0.1429, 0.1431, 0.1428],
        [0.1430, 0.1427, 0.1427, 0.1428, 0.1429, 0.1431, 0.1428],
        [0.1430, 0.1427, 0.1427, 0.1428, 0.1429, 0.1431, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0502,
         0.0500, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1000, 0.1001, 0.1001, 0.0996, 0.1001, 0.0999, 0.1002, 0.1001,
         0.0998],
        [0.1001, 0.1000, 0.1001, 0.1001, 0.0996, 0.1001, 0.0999, 0.1002, 0.1001,
         0.0998],
        [0.1001, 0.1000, 0.1001, 0.1001, 0.0997, 0.1001, 0.0999, 0.1002, 0.1001,
         0.0999],
        [0.1001, 0.1000, 0.1001, 0.1001, 0.0996, 0.1001, 0.0999, 0.1002, 0.1001,
         0.0998],
        [0.1001, 0.1000, 0.1000, 0.1001, 0.0997, 0.1001, 0.0998, 0.1002, 0.1001,
         0.1000],
        [0.1001, 0.1000, 0.1001, 0.1001, 0.0996, 0.1001, 0.0999, 0.1002, 0.1001,
         0.0997],
        [0.1001, 0.1000, 0.1001, 0.1001, 0.0996, 0.1001, 0.0999, 0.1002, 0.1001,
         0.0998],
        [0.1001, 0.1000, 0.1001, 0.1001, 0.0997, 0.1001, 0.0999, 0.1002, 0.1001,
         0.0999],
        [0.1001, 0.1000, 0.1001, 0.1001, 0.0996, 0.1001, 0.0999, 0.1002, 0.1001,
         0.0998],
        [0.1000, 0.0999, 0.1000, 0.1000, 0.0998, 0.1000, 0.0998, 0.1001, 0.1001,
         0.1003]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2646358013153076s
iter time cost:10.362051963806152s
-------------Round number: 19-------------
Evaluate global model
Averaged Train Loss: 1.6702
Averaged Test Accurancy: 0.6568
Std Test Accurancy: 0.1782
evaluate time cost:4.769857168197632s
clients training time cost:4.851072311401367s
attn_optimize time cost:0.44850683212280273s
weights:tensor([[0.1429, 0.1427, 0.1426, 0.1430, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1426, 0.1426, 0.1430, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1426, 0.1426, 0.1430, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1426, 0.1426, 0.1430, 0.1428, 0.1428, 0.1432],
        [0.1429, 0.1426, 0.1426, 0.1430, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1426, 0.1426, 0.1430, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1426, 0.1426, 0.1430, 0.1428, 0.1428, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0772, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0772, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0767, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0771, 0.0768, 0.0768, 0.0769,
         0.0769, 0.0768, 0.0771, 0.0769],
        [0.0769, 0.0768, 0.0768, 0.0771, 0.0770, 0.0772, 0.0768, 0.0768, 0.0770,
         0.0769, 0.0767, 0.0771, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1430, 0.1431, 0.1427, 0.1426, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1431, 0.1427, 0.1426, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1431, 0.1427, 0.1426, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1431, 0.1427, 0.1426, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1431, 0.1428, 0.1426, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1431, 0.1427, 0.1426, 0.1430, 0.1428],
        [0.1428, 0.1430, 0.1431, 0.1427, 0.1426, 0.1430, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.1001, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.1001, 0.1000, 0.0999, 0.0998, 0.1001, 0.1001, 0.0999, 0.1000,
         0.0999],
        [0.1002, 0.1001, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001, 0.0999, 0.1000,
         0.0999],
        [0.1002, 0.1001, 0.1000, 0.0999, 0.0998, 0.1001, 0.1001, 0.0999, 0.1000,
         0.0999],
        [0.1002, 0.1001, 0.1000, 0.0999, 0.0998, 0.1001, 0.1001, 0.0999, 0.1000,
         0.0999],
        [0.1002, 0.1001, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.1001, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.1001, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001, 0.0999, 0.1000,
         0.0999],
        [0.1002, 0.1001, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001, 0.0999, 0.1000,
         0.1000],
        [0.1002, 0.1001, 0.1000, 0.0999, 0.0999, 0.1001, 0.1001, 0.0999, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1996, 0.2003, 0.2001, 0.2001, 0.1998],
        [0.1996, 0.2003, 0.2001, 0.2001, 0.1999],
        [0.1996, 0.2003, 0.2001, 0.2001, 0.1999],
        [0.1996, 0.2003, 0.2001, 0.2001, 0.1999],
        [0.1996, 0.2003, 0.2001, 0.2001, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0494],
        [0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1430, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1430, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1431, 0.1427, 0.1429, 0.1428, 0.1430, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501,
         0.0499, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1001, 0.1002, 0.1000, 0.0996, 0.1001, 0.1000, 0.1002, 0.1001,
         0.0997],
        [0.1001, 0.1001, 0.1002, 0.1000, 0.0995, 0.1001, 0.1000, 0.1002, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1002, 0.1000, 0.0996, 0.1001, 0.1000, 0.1002, 0.1001,
         0.0997],
        [0.1001, 0.1001, 0.1002, 0.1000, 0.0996, 0.1001, 0.1000, 0.1002, 0.1001,
         0.0997],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.0996, 0.1001, 0.0999, 0.1002, 0.1001,
         0.0998],
        [0.1001, 0.1001, 0.1002, 0.1001, 0.0995, 0.1001, 0.1000, 0.1002, 0.1001,
         0.0996],
        [0.1001, 0.1001, 0.1002, 0.1000, 0.0996, 0.1001, 0.1000, 0.1002, 0.1001,
         0.0997],
        [0.1001, 0.1000, 0.1002, 0.1000, 0.0996, 0.1001, 0.1000, 0.1002, 0.1001,
         0.0997],
        [0.1001, 0.1001, 0.1002, 0.1001, 0.0995, 0.1001, 0.1000, 0.1002, 0.1001,
         0.0996],
        [0.1000, 0.1000, 0.1001, 0.1000, 0.0997, 0.1000, 0.0999, 0.1002, 0.1001,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2722470760345459s
iter time cost:10.406745672225952s
-------------Round number: 20-------------
Evaluate global model
Averaged Train Loss: 1.9191
Averaged Test Accurancy: 0.6218
Std Test Accurancy: 0.1910
evaluate time cost:4.780571699142456s
clients training time cost:4.8933656215667725s
attn_optimize time cost:0.45240306854248047s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
[running kmeans]: 7it [00:00, 333.03it/s, center_shift=0.000000, iteration=7, tol=0.000100]
weights:tensor([[0.1247, 0.1253, 0.1249, 0.1249, 0.1249, 0.1250, 0.1252, 0.1250],
        [0.1247, 0.1253, 0.1249, 0.1249, 0.1249, 0.1250, 0.1252, 0.1250],
        [0.1247, 0.1253, 0.1249, 0.1249, 0.1249, 0.1250, 0.1252, 0.1250],
        [0.1247, 0.1253, 0.1249, 0.1249, 0.1249, 0.1250, 0.1252, 0.1250],
        [0.1247, 0.1253, 0.1249, 0.1249, 0.1249, 0.1250, 0.1252, 0.1250],
        [0.1247, 0.1253, 0.1249, 0.1249, 0.1249, 0.1250, 0.1252, 0.1250],
        [0.1247, 0.1253, 0.1249, 0.1249, 0.1249, 0.1250, 0.1252, 0.1250],
        [0.1247, 0.1253, 0.1249, 0.1249, 0.1249, 0.1250, 0.1252, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0833, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0502, 0.0502,
         0.0499, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2498, 0.2499, 0.2498, 0.2504],
        [0.2498, 0.2499, 0.2498, 0.2504],
        [0.2498, 0.2499, 0.2499, 0.2504],
        [0.2498, 0.2499, 0.2498, 0.2504]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1434, 0.1426, 0.1429, 0.1429, 0.1425, 0.1429],
        [0.1428, 0.1434, 0.1426, 0.1429, 0.1429, 0.1425, 0.1429],
        [0.1427, 0.1434, 0.1426, 0.1429, 0.1429, 0.1425, 0.1430],
        [0.1427, 0.1434, 0.1426, 0.1429, 0.1429, 0.1425, 0.1429],
        [0.1427, 0.1434, 0.1426, 0.1429, 0.1429, 0.1425, 0.1429],
        [0.1427, 0.1434, 0.1426, 0.1429, 0.1429, 0.1425, 0.1430],
        [0.1427, 0.1434, 0.1426, 0.1429, 0.1429, 0.1425, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0501, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0497],
        [0.0499, 0.0501, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0498],
        [0.0499, 0.0501, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0497],
        [0.0499, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0498],
        [0.0499, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0498],
        [0.0499, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0498],
        [0.0499, 0.0501, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0497],
        [0.0499, 0.0501, 0.0499, 0.0503, 0.0499, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0498],
        [0.0499, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0501,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0498],
        [0.0499, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0497],
        [0.0499, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0498],
        [0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0497],
        [0.0499, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0502, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0498],
        [0.0499, 0.0501, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0498],
        [0.0499, 0.0501, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0498],
        [0.0499, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0501,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0498],
        [0.0499, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0497],
        [0.0499, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0497],
        [0.0499, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0502,
         0.0498, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0497],
        [0.0499, 0.0501, 0.0499, 0.0503, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0498, 0.0502, 0.0498, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1431, 0.1429, 0.1425, 0.1429, 0.1429, 0.1430],
        [0.1427, 0.1431, 0.1429, 0.1425, 0.1429, 0.1429, 0.1430],
        [0.1427, 0.1431, 0.1429, 0.1425, 0.1429, 0.1429, 0.1430],
        [0.1427, 0.1431, 0.1429, 0.1425, 0.1429, 0.1429, 0.1430],
        [0.1427, 0.1431, 0.1429, 0.1425, 0.1429, 0.1429, 0.1430],
        [0.1427, 0.1431, 0.1429, 0.1425, 0.1429, 0.1429, 0.1430],
        [0.1427, 0.1431, 0.1429, 0.1425, 0.1429, 0.1429, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2898263931274414s
iter time cost:10.51025390625s
-------------Round number: 21-------------
Evaluate global model
Averaged Train Loss: 1.1194
Averaged Test Accurancy: 0.6980
Std Test Accurancy: 0.1646
evaluate time cost:4.66753625869751s
clients training time cost:4.779449939727783s
attn_optimize time cost:0.494997501373291s
weights:tensor([[0.1247, 0.1253, 0.1249, 0.1250, 0.1249, 0.1250, 0.1253, 0.1249],
        [0.1247, 0.1253, 0.1249, 0.1250, 0.1249, 0.1250, 0.1253, 0.1249],
        [0.1247, 0.1253, 0.1249, 0.1250, 0.1249, 0.1250, 0.1253, 0.1249],
        [0.1247, 0.1253, 0.1249, 0.1250, 0.1249, 0.1250, 0.1253, 0.1249],
        [0.1247, 0.1253, 0.1249, 0.1250, 0.1249, 0.1250, 0.1253, 0.1249],
        [0.1247, 0.1253, 0.1249, 0.1250, 0.1249, 0.1250, 0.1253, 0.1249],
        [0.1247, 0.1253, 0.1249, 0.1250, 0.1249, 0.1250, 0.1253, 0.1249],
        [0.1247, 0.1253, 0.1249, 0.1250, 0.1249, 0.1250, 0.1253, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2497, 0.2501, 0.2500, 0.2502],
        [0.2497, 0.2502, 0.2500, 0.2502],
        [0.2497, 0.2501, 0.2500, 0.2502],
        [0.2497, 0.2502, 0.2500, 0.2501]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1431, 0.1426, 0.1429, 0.1429, 0.1425, 0.1430],
        [0.1428, 0.1432, 0.1426, 0.1429, 0.1429, 0.1426, 0.1430],
        [0.1428, 0.1431, 0.1426, 0.1430, 0.1429, 0.1426, 0.1430],
        [0.1428, 0.1431, 0.1426, 0.1430, 0.1429, 0.1425, 0.1430],
        [0.1428, 0.1431, 0.1426, 0.1429, 0.1429, 0.1426, 0.1430],
        [0.1428, 0.1431, 0.1426, 0.1429, 0.1429, 0.1426, 0.1430],
        [0.1428, 0.1431, 0.1426, 0.1429, 0.1429, 0.1426, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1430, 0.1427, 0.1426, 0.1429, 0.1427, 0.1430],
        [0.1430, 0.1430, 0.1428, 0.1426, 0.1429, 0.1427, 0.1430],
        [0.1430, 0.1431, 0.1428, 0.1426, 0.1429, 0.1427, 0.1430],
        [0.1430, 0.1430, 0.1428, 0.1426, 0.1429, 0.1427, 0.1430],
        [0.1430, 0.1430, 0.1428, 0.1426, 0.1429, 0.1427, 0.1430],
        [0.1430, 0.1430, 0.1427, 0.1426, 0.1429, 0.1427, 0.1430],
        [0.1430, 0.1430, 0.1427, 0.1426, 0.1429, 0.1427, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2898421287536621s
iter time cost:10.295638084411621s
-------------Round number: 22-------------
Evaluate global model
Averaged Train Loss: 1.3754
Averaged Test Accurancy: 0.6678
Std Test Accurancy: 0.1735
evaluate time cost:4.586519718170166s
clients training time cost:4.740005731582642s
attn_optimize time cost:0.484666109085083s
weights:tensor([[0.1247, 0.1252, 0.1248, 0.1250, 0.1251, 0.1251, 0.1252, 0.1250],
        [0.1247, 0.1252, 0.1248, 0.1249, 0.1251, 0.1251, 0.1252, 0.1250],
        [0.1247, 0.1252, 0.1248, 0.1250, 0.1251, 0.1251, 0.1252, 0.1250],
        [0.1247, 0.1252, 0.1248, 0.1250, 0.1250, 0.1251, 0.1252, 0.1250],
        [0.1247, 0.1252, 0.1248, 0.1250, 0.1250, 0.1250, 0.1252, 0.1250],
        [0.1247, 0.1252, 0.1249, 0.1250, 0.1250, 0.1250, 0.1252, 0.1250],
        [0.1247, 0.1252, 0.1248, 0.1250, 0.1251, 0.1251, 0.1252, 0.1250],
        [0.1247, 0.1252, 0.1248, 0.1250, 0.1251, 0.1251, 0.1252, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0833, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0498, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2499, 0.2500, 0.2497, 0.2504],
        [0.2499, 0.2500, 0.2497, 0.2504],
        [0.2499, 0.2500, 0.2498, 0.2503],
        [0.2499, 0.2500, 0.2497, 0.2504]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1433, 0.1426, 0.1429, 0.1430, 0.1426, 0.1429],
        [0.1427, 0.1433, 0.1426, 0.1429, 0.1430, 0.1426, 0.1429],
        [0.1427, 0.1432, 0.1426, 0.1429, 0.1430, 0.1426, 0.1430],
        [0.1427, 0.1433, 0.1426, 0.1429, 0.1430, 0.1426, 0.1429],
        [0.1427, 0.1432, 0.1426, 0.1429, 0.1430, 0.1426, 0.1429],
        [0.1427, 0.1432, 0.1426, 0.1429, 0.1430, 0.1426, 0.1430],
        [0.1427, 0.1432, 0.1426, 0.1429, 0.1430, 0.1426, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499,
         0.0501, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1430, 0.1429, 0.1424, 0.1429, 0.1428, 0.1430],
        [0.1429, 0.1431, 0.1429, 0.1424, 0.1429, 0.1428, 0.1430],
        [0.1429, 0.1431, 0.1429, 0.1424, 0.1429, 0.1428, 0.1430],
        [0.1429, 0.1431, 0.1429, 0.1424, 0.1429, 0.1428, 0.1430],
        [0.1429, 0.1431, 0.1429, 0.1424, 0.1429, 0.1428, 0.1430],
        [0.1429, 0.1430, 0.1429, 0.1424, 0.1429, 0.1428, 0.1430],
        [0.1429, 0.1431, 0.1429, 0.1424, 0.1429, 0.1428, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.29827213287353516s
iter time cost:10.174522399902344s
-------------Round number: 23-------------
Evaluate global model
Averaged Train Loss: 1.5571
Averaged Test Accurancy: 0.6738
Std Test Accurancy: 0.1453
evaluate time cost:4.667064428329468s
clients training time cost:5.0905442237854s
attn_optimize time cost:0.4840116500854492s
weights:tensor([[0.1246, 0.1253, 0.1248, 0.1250, 0.1249, 0.1249, 0.1254, 0.1251],
        [0.1246, 0.1253, 0.1248, 0.1249, 0.1249, 0.1249, 0.1254, 0.1250],
        [0.1246, 0.1253, 0.1248, 0.1250, 0.1249, 0.1249, 0.1254, 0.1251],
        [0.1246, 0.1253, 0.1248, 0.1250, 0.1249, 0.1249, 0.1254, 0.1251],
        [0.1246, 0.1253, 0.1248, 0.1250, 0.1249, 0.1249, 0.1254, 0.1250],
        [0.1246, 0.1253, 0.1248, 0.1250, 0.1249, 0.1249, 0.1254, 0.1250],
        [0.1246, 0.1253, 0.1248, 0.1250, 0.1249, 0.1249, 0.1254, 0.1251],
        [0.1246, 0.1253, 0.1248, 0.1250, 0.1249, 0.1249, 0.1254, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2497, 0.2502, 0.2499, 0.2502],
        [0.2497, 0.2502, 0.2499, 0.2502],
        [0.2497, 0.2502, 0.2499, 0.2502],
        [0.2497, 0.2502, 0.2499, 0.2502]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1433, 0.1426, 0.1429, 0.1429, 0.1426, 0.1429],
        [0.1427, 0.1433, 0.1426, 0.1429, 0.1429, 0.1426, 0.1429],
        [0.1427, 0.1433, 0.1426, 0.1429, 0.1429, 0.1426, 0.1429],
        [0.1427, 0.1433, 0.1426, 0.1429, 0.1429, 0.1426, 0.1429],
        [0.1427, 0.1433, 0.1426, 0.1429, 0.1429, 0.1426, 0.1429],
        [0.1427, 0.1433, 0.1426, 0.1429, 0.1429, 0.1426, 0.1429],
        [0.1427, 0.1433, 0.1426, 0.1429, 0.1429, 0.1426, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1431, 0.1428, 0.1425, 0.1429, 0.1427, 0.1432],
        [0.1428, 0.1431, 0.1428, 0.1425, 0.1429, 0.1427, 0.1432],
        [0.1428, 0.1431, 0.1428, 0.1425, 0.1429, 0.1427, 0.1432],
        [0.1428, 0.1431, 0.1428, 0.1425, 0.1429, 0.1427, 0.1432],
        [0.1428, 0.1431, 0.1428, 0.1425, 0.1428, 0.1427, 0.1432],
        [0.1428, 0.1431, 0.1428, 0.1425, 0.1429, 0.1427, 0.1432],
        [0.1428, 0.1431, 0.1428, 0.1425, 0.1428, 0.1427, 0.1432]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2948901653289795s
iter time cost:10.599269390106201s
-------------Round number: 24-------------
Evaluate global model
Averaged Train Loss: 1.6711
Averaged Test Accurancy: 0.6312
Std Test Accurancy: 0.1771
evaluate time cost:4.659151077270508s
clients training time cost:4.980928897857666s
attn_optimize time cost:0.5885090827941895s
weights:tensor([[0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1250, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0498, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2496, 0.2501, 0.2497, 0.2506],
        [0.2496, 0.2501, 0.2497, 0.2506],
        [0.2496, 0.2501, 0.2498, 0.2505],
        [0.2496, 0.2501, 0.2497, 0.2506]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1433, 0.1426, 0.1429, 0.1430, 0.1425, 0.1430],
        [0.1428, 0.1433, 0.1426, 0.1429, 0.1430, 0.1426, 0.1430],
        [0.1428, 0.1433, 0.1426, 0.1429, 0.1429, 0.1425, 0.1430],
        [0.1428, 0.1433, 0.1426, 0.1429, 0.1430, 0.1425, 0.1430],
        [0.1428, 0.1433, 0.1426, 0.1429, 0.1430, 0.1426, 0.1429],
        [0.1428, 0.1433, 0.1426, 0.1429, 0.1430, 0.1425, 0.1430],
        [0.1428, 0.1433, 0.1426, 0.1429, 0.1430, 0.1425, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0496, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0496, 0.0500,
         0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500],
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0496, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0496, 0.0500,
         0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0496, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0496, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0499,
         0.0500, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1431, 0.1428, 0.1424, 0.1429, 0.1429, 0.1430],
        [0.1429, 0.1431, 0.1428, 0.1424, 0.1429, 0.1429, 0.1430],
        [0.1429, 0.1431, 0.1428, 0.1424, 0.1429, 0.1429, 0.1430],
        [0.1429, 0.1431, 0.1428, 0.1424, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1431, 0.1428, 0.1424, 0.1429, 0.1429, 0.1430],
        [0.1429, 0.1431, 0.1428, 0.1424, 0.1429, 0.1429, 0.1430],
        [0.1429, 0.1431, 0.1428, 0.1424, 0.1429, 0.1429, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.44195556640625s
iter time cost:10.753621578216553s
-------------Round number: 25-------------
Evaluate global model
Averaged Train Loss: 1.3317
Averaged Test Accurancy: 0.6968
Std Test Accurancy: 0.1482
evaluate time cost:5.075409889221191s
clients training time cost:5.096725225448608s
attn_optimize time cost:0.5917129516601562s
weights:tensor([[0.1247, 0.1253, 0.1249, 0.1250, 0.1250, 0.1250, 0.1252, 0.1249],
        [0.1247, 0.1253, 0.1250, 0.1250, 0.1250, 0.1251, 0.1252, 0.1248],
        [0.1247, 0.1253, 0.1249, 0.1250, 0.1250, 0.1251, 0.1252, 0.1248],
        [0.1247, 0.1253, 0.1249, 0.1250, 0.1249, 0.1251, 0.1252, 0.1248],
        [0.1247, 0.1253, 0.1250, 0.1250, 0.1249, 0.1251, 0.1252, 0.1248],
        [0.1247, 0.1253, 0.1250, 0.1250, 0.1249, 0.1250, 0.1252, 0.1248],
        [0.1247, 0.1253, 0.1250, 0.1250, 0.1249, 0.1251, 0.1252, 0.1248],
        [0.1247, 0.1253, 0.1249, 0.1250, 0.1249, 0.1251, 0.1252, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0832, 0.0831, 0.0834,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0831, 0.0834,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0831, 0.0834,
         0.0833, 0.0835, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0499, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502, 0.0502,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2498, 0.2499, 0.2499, 0.2504],
        [0.2498, 0.2499, 0.2498, 0.2504],
        [0.2498, 0.2499, 0.2499, 0.2504],
        [0.2498, 0.2499, 0.2499, 0.2504]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1433, 0.1426, 0.1430, 0.1430, 0.1425, 0.1428],
        [0.1428, 0.1433, 0.1426, 0.1430, 0.1430, 0.1426, 0.1428],
        [0.1428, 0.1433, 0.1426, 0.1430, 0.1430, 0.1426, 0.1428],
        [0.1428, 0.1433, 0.1426, 0.1430, 0.1430, 0.1425, 0.1428],
        [0.1428, 0.1432, 0.1426, 0.1430, 0.1430, 0.1426, 0.1428],
        [0.1428, 0.1433, 0.1426, 0.1430, 0.1430, 0.1426, 0.1428],
        [0.1427, 0.1433, 0.1426, 0.1430, 0.1430, 0.1426, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1432, 0.1429, 0.1425, 0.1429, 0.1426, 0.1431],
        [0.1429, 0.1432, 0.1429, 0.1425, 0.1429, 0.1426, 0.1431],
        [0.1429, 0.1432, 0.1429, 0.1425, 0.1429, 0.1426, 0.1431],
        [0.1429, 0.1432, 0.1429, 0.1425, 0.1429, 0.1426, 0.1431],
        [0.1429, 0.1432, 0.1429, 0.1425, 0.1429, 0.1426, 0.1432],
        [0.1429, 0.1432, 0.1429, 0.1425, 0.1429, 0.1426, 0.1431],
        [0.1429, 0.1432, 0.1429, 0.1425, 0.1429, 0.1426, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3324015140533447s
iter time cost:11.178320407867432s
-------------Round number: 26-------------
Evaluate global model
Averaged Train Loss: 1.2852
Averaged Test Accurancy: 0.6657
Std Test Accurancy: 0.1492
evaluate time cost:5.251373052597046s
clients training time cost:4.969343900680542s
attn_optimize time cost:0.499453067779541s
weights:tensor([[0.1245, 0.1253, 0.1249, 0.1251, 0.1250, 0.1249, 0.1254, 0.1250],
        [0.1245, 0.1253, 0.1249, 0.1250, 0.1250, 0.1249, 0.1254, 0.1250],
        [0.1245, 0.1252, 0.1249, 0.1251, 0.1250, 0.1249, 0.1254, 0.1250],
        [0.1245, 0.1253, 0.1249, 0.1251, 0.1250, 0.1249, 0.1254, 0.1250],
        [0.1245, 0.1253, 0.1249, 0.1251, 0.1250, 0.1249, 0.1254, 0.1250],
        [0.1245, 0.1253, 0.1249, 0.1251, 0.1250, 0.1249, 0.1254, 0.1250],
        [0.1245, 0.1253, 0.1249, 0.1251, 0.1250, 0.1249, 0.1254, 0.1250],
        [0.1245, 0.1253, 0.1249, 0.1251, 0.1250, 0.1249, 0.1254, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0834, 0.0834, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2497, 0.2503, 0.2499, 0.2501],
        [0.2497, 0.2504, 0.2499, 0.2501],
        [0.2497, 0.2503, 0.2499, 0.2501],
        [0.2497, 0.2504, 0.2498, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1426, 0.1433, 0.1426, 0.1431, 0.1430, 0.1425, 0.1430],
        [0.1426, 0.1433, 0.1426, 0.1430, 0.1430, 0.1425, 0.1430],
        [0.1427, 0.1432, 0.1426, 0.1431, 0.1429, 0.1425, 0.1430],
        [0.1427, 0.1432, 0.1426, 0.1432, 0.1429, 0.1425, 0.1430],
        [0.1427, 0.1432, 0.1426, 0.1431, 0.1430, 0.1425, 0.1430],
        [0.1426, 0.1432, 0.1426, 0.1431, 0.1430, 0.1425, 0.1430],
        [0.1427, 0.1432, 0.1426, 0.1431, 0.1430, 0.1425, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0501, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1431, 0.1429, 0.1425, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1431, 0.1429, 0.1425, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1431, 0.1429, 0.1425, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1431, 0.1429, 0.1425, 0.1430, 0.1428, 0.1430],
        [0.1428, 0.1431, 0.1429, 0.1425, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1431, 0.1429, 0.1425, 0.1430, 0.1428, 0.1430],
        [0.1428, 0.1431, 0.1429, 0.1425, 0.1429, 0.1428, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3801562786102295s
iter time cost:11.16797161102295s
-------------Round number: 27-------------
Evaluate global model
Averaged Train Loss: 1.1885
Averaged Test Accurancy: 0.6861
Std Test Accurancy: 0.1444
evaluate time cost:5.075109481811523s
clients training time cost:4.848889589309692s
attn_optimize time cost:0.5029616355895996s
weights:tensor([[0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1251, 0.1251, 0.1249, 0.1253, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1249, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0835, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0835, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0835, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0835, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0835, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0835, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0835, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0835, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0835, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0835, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0498, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0498, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0498, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0499],
        [0.0500, 0.0498, 0.0500, 0.0499, 0.0502, 0.0501, 0.0502, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2496, 0.2498, 0.2499, 0.2507],
        [0.2496, 0.2498, 0.2499, 0.2506],
        [0.2497, 0.2498, 0.2499, 0.2506],
        [0.2496, 0.2498, 0.2499, 0.2507]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1426, 0.1434, 0.1426, 0.1430, 0.1430, 0.1425, 0.1429],
        [0.1426, 0.1433, 0.1426, 0.1430, 0.1430, 0.1425, 0.1429],
        [0.1426, 0.1433, 0.1426, 0.1430, 0.1430, 0.1425, 0.1429],
        [0.1426, 0.1433, 0.1426, 0.1430, 0.1430, 0.1425, 0.1429],
        [0.1426, 0.1433, 0.1427, 0.1430, 0.1430, 0.1425, 0.1429],
        [0.1426, 0.1433, 0.1426, 0.1430, 0.1430, 0.1425, 0.1429],
        [0.1426, 0.1433, 0.1426, 0.1430, 0.1430, 0.1425, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0499, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1431, 0.1430, 0.1424, 0.1428, 0.1427, 0.1431],
        [0.1430, 0.1431, 0.1430, 0.1424, 0.1428, 0.1427, 0.1431],
        [0.1430, 0.1431, 0.1430, 0.1424, 0.1428, 0.1427, 0.1431],
        [0.1430, 0.1431, 0.1430, 0.1424, 0.1428, 0.1427, 0.1431],
        [0.1430, 0.1431, 0.1430, 0.1424, 0.1428, 0.1427, 0.1431],
        [0.1430, 0.1431, 0.1430, 0.1424, 0.1428, 0.1427, 0.1431],
        [0.1430, 0.1431, 0.1430, 0.1424, 0.1428, 0.1427, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2943387031555176s
iter time cost:10.817387342453003s
-------------Round number: 28-------------
Evaluate global model
Averaged Train Loss: 1.1734
Averaged Test Accurancy: 0.6651
Std Test Accurancy: 0.1486
evaluate time cost:4.7902672290802s
clients training time cost:4.842873811721802s
attn_optimize time cost:0.5046586990356445s
weights:tensor([[0.1245, 0.1252, 0.1250, 0.1251, 0.1250, 0.1249, 0.1254, 0.1250],
        [0.1245, 0.1253, 0.1250, 0.1251, 0.1250, 0.1249, 0.1254, 0.1249],
        [0.1245, 0.1252, 0.1250, 0.1251, 0.1250, 0.1249, 0.1254, 0.1249],
        [0.1245, 0.1252, 0.1250, 0.1251, 0.1249, 0.1249, 0.1254, 0.1249],
        [0.1245, 0.1252, 0.1250, 0.1251, 0.1249, 0.1249, 0.1254, 0.1249],
        [0.1245, 0.1253, 0.1250, 0.1251, 0.1249, 0.1249, 0.1254, 0.1249],
        [0.1245, 0.1253, 0.1250, 0.1251, 0.1250, 0.1249, 0.1254, 0.1249],
        [0.1245, 0.1252, 0.1250, 0.1251, 0.1250, 0.1249, 0.1254, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0834, 0.0835, 0.0835, 0.0835, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0835, 0.0835, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0834, 0.0835, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0835, 0.0835, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0834, 0.0835, 0.0835, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0835, 0.0835, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0835, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0835, 0.0835, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0835, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0835, 0.0835, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0835, 0.0834, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0834, 0.0835, 0.0835, 0.0835, 0.0831, 0.0833, 0.0831, 0.0834,
         0.0833, 0.0834, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0502, 0.0502, 0.0499,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2495, 0.2500, 0.2500, 0.2505],
        [0.2495, 0.2501, 0.2500, 0.2505],
        [0.2495, 0.2500, 0.2500, 0.2504],
        [0.2495, 0.2501, 0.2500, 0.2505]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1435, 0.1426, 0.1429, 0.1430, 0.1424, 0.1429],
        [0.1427, 0.1434, 0.1426, 0.1429, 0.1429, 0.1425, 0.1429],
        [0.1427, 0.1434, 0.1426, 0.1429, 0.1429, 0.1424, 0.1429],
        [0.1427, 0.1435, 0.1426, 0.1429, 0.1429, 0.1424, 0.1429],
        [0.1427, 0.1434, 0.1427, 0.1429, 0.1429, 0.1425, 0.1429],
        [0.1427, 0.1434, 0.1426, 0.1429, 0.1430, 0.1424, 0.1429],
        [0.1427, 0.1434, 0.1426, 0.1429, 0.1430, 0.1425, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0498, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0501, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1432, 0.1429, 0.1424, 0.1429, 0.1429, 0.1430],
        [0.1427, 0.1432, 0.1429, 0.1424, 0.1429, 0.1429, 0.1431],
        [0.1427, 0.1432, 0.1429, 0.1424, 0.1429, 0.1429, 0.1431],
        [0.1427, 0.1432, 0.1429, 0.1424, 0.1429, 0.1429, 0.1430],
        [0.1427, 0.1432, 0.1429, 0.1424, 0.1429, 0.1429, 0.1431],
        [0.1427, 0.1432, 0.1429, 0.1424, 0.1429, 0.1429, 0.1431],
        [0.1427, 0.1432, 0.1429, 0.1424, 0.1429, 0.1429, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.332303524017334s
iter time cost:10.531158208847046s
-------------Round number: 29-------------
Evaluate global model
Averaged Train Loss: 1.0759
Averaged Test Accurancy: 0.6957
Std Test Accurancy: 0.1495
evaluate time cost:5.129344940185547s
clients training time cost:5.088169813156128s
attn_optimize time cost:0.6754233837127686s
weights:tensor([[0.1246, 0.1253, 0.1249, 0.1251, 0.1250, 0.1248, 0.1254, 0.1250],
        [0.1246, 0.1253, 0.1249, 0.1251, 0.1250, 0.1248, 0.1253, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1251, 0.1250, 0.1248, 0.1254, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1251, 0.1250, 0.1248, 0.1254, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1252, 0.1250, 0.1248, 0.1254, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1252, 0.1250, 0.1248, 0.1254, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1251, 0.1250, 0.1248, 0.1253, 0.1249],
        [0.1246, 0.1253, 0.1249, 0.1251, 0.1250, 0.1248, 0.1254, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0831, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0832, 0.0833, 0.0832, 0.0834,
         0.0834, 0.0834, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2495, 0.2499, 0.2500, 0.2506],
        [0.2495, 0.2500, 0.2500, 0.2506],
        [0.2495, 0.2499, 0.2501, 0.2505],
        [0.2495, 0.2499, 0.2500, 0.2506]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1433, 0.1426, 0.1429, 0.1431, 0.1425, 0.1429],
        [0.1427, 0.1433, 0.1426, 0.1429, 0.1430, 0.1426, 0.1429],
        [0.1428, 0.1433, 0.1426, 0.1429, 0.1431, 0.1425, 0.1429],
        [0.1427, 0.1434, 0.1426, 0.1429, 0.1431, 0.1425, 0.1429],
        [0.1428, 0.1433, 0.1426, 0.1429, 0.1431, 0.1426, 0.1429],
        [0.1427, 0.1433, 0.1426, 0.1429, 0.1431, 0.1425, 0.1429],
        [0.1427, 0.1433, 0.1426, 0.1429, 0.1431, 0.1426, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0500],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0500],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0500],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1432, 0.1428, 0.1424, 0.1429, 0.1427, 0.1432],
        [0.1428, 0.1432, 0.1428, 0.1424, 0.1429, 0.1427, 0.1432],
        [0.1428, 0.1432, 0.1428, 0.1424, 0.1429, 0.1427, 0.1432],
        [0.1428, 0.1431, 0.1428, 0.1424, 0.1429, 0.1427, 0.1432],
        [0.1429, 0.1432, 0.1428, 0.1424, 0.1429, 0.1427, 0.1432],
        [0.1429, 0.1432, 0.1428, 0.1424, 0.1429, 0.1427, 0.1432],
        [0.1429, 0.1432, 0.1428, 0.1424, 0.1429, 0.1427, 0.1432]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.30613040924072266s
iter time cost:11.271860837936401s
-------------Round number: 30-------------
Evaluate global model
Averaged Train Loss: 1.0852
Averaged Test Accurancy: 0.6917
Std Test Accurancy: 0.1405
evaluate time cost:5.090541124343872s
[running kmeans]: 5it [00:00, 356.82it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:5.014230012893677s
attn_optimize time cost:0.6050810813903809s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0668, 0.0666, 0.0668, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0665, 0.0667],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0665, 0.0667],
        [0.0668, 0.0666, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0665, 0.0667],
        [0.0668, 0.0666, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0665, 0.0666],
        [0.0668, 0.0666, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0665, 0.0666],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0665, 0.0666],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0665, 0.0667],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0665, 0.0666],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0666, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0665, 0.0667],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0665, 0.0667],
        [0.0668, 0.0666, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0665, 0.0666],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0665, 0.0667],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0665, 0.0667],
        [0.0668, 0.0666, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0665, 0.0666],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0665, 0.0666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0498, 0.0500, 0.0499, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0501,
         0.0499, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1244, 0.1253, 0.1249, 0.1252, 0.1250, 0.1250, 0.1253, 0.1249],
        [0.1244, 0.1253, 0.1249, 0.1251, 0.1251, 0.1250, 0.1253, 0.1248],
        [0.1244, 0.1253, 0.1249, 0.1252, 0.1251, 0.1250, 0.1253, 0.1249],
        [0.1244, 0.1253, 0.1249, 0.1252, 0.1250, 0.1250, 0.1253, 0.1249],
        [0.1244, 0.1254, 0.1249, 0.1252, 0.1250, 0.1250, 0.1253, 0.1248],
        [0.1244, 0.1254, 0.1249, 0.1252, 0.1250, 0.1250, 0.1253, 0.1248],
        [0.1245, 0.1254, 0.1249, 0.1252, 0.1250, 0.1250, 0.1252, 0.1248],
        [0.1244, 0.1253, 0.1249, 0.1252, 0.1250, 0.1250, 0.1253, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0623, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1662, 0.1669, 0.1667, 0.1663, 0.1667, 0.1672],
        [0.1662, 0.1669, 0.1667, 0.1663, 0.1667, 0.1672],
        [0.1662, 0.1669, 0.1667, 0.1663, 0.1667, 0.1672],
        [0.1662, 0.1669, 0.1667, 0.1664, 0.1667, 0.1672],
        [0.1662, 0.1669, 0.1667, 0.1663, 0.1667, 0.1672],
        [0.1662, 0.1668, 0.1668, 0.1663, 0.1667, 0.1672]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2005, 0.1991, 0.2002, 0.1999, 0.2004],
        [0.2005, 0.1990, 0.2002, 0.1999, 0.2004],
        [0.2005, 0.1991, 0.2002, 0.1999, 0.2004],
        [0.2005, 0.1991, 0.2002, 0.1999, 0.2004],
        [0.2005, 0.1990, 0.2000, 0.1995, 0.2010]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0502, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2504, 0.2506, 0.2511, 0.2478],
        [0.2504, 0.2505, 0.2511, 0.2480],
        [0.2504, 0.2506, 0.2511, 0.2480],
        [0.2503, 0.2506, 0.2510, 0.2482]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2004, 0.2002, 0.1994, 0.2000],
        [0.2000, 0.2004, 0.2002, 0.1994, 0.2000],
        [0.2000, 0.2004, 0.2002, 0.1994, 0.2000],
        [0.1999, 0.2004, 0.2002, 0.1994, 0.2000],
        [0.2000, 0.2004, 0.2002, 0.1994, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.25886058807373047s
iter time cost:11.059794902801514s
-------------Round number: 31-------------
Evaluate global model
Averaged Train Loss: 1.1500
Averaged Test Accurancy: 0.7213
Std Test Accurancy: 0.1427
evaluate time cost:5.2895989418029785s
clients training time cost:5.343029499053955s
attn_optimize time cost:0.7110254764556885s
weights:tensor([[0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0666, 0.0667, 0.0666, 0.0668, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0668, 0.0666, 0.0668, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0668, 0.0666, 0.0668, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0668],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1245, 0.1252, 0.1248, 0.1251, 0.1251, 0.1248, 0.1255, 0.1249],
        [0.1246, 0.1252, 0.1248, 0.1250, 0.1251, 0.1248, 0.1255, 0.1249],
        [0.1246, 0.1252, 0.1248, 0.1250, 0.1251, 0.1248, 0.1255, 0.1249],
        [0.1246, 0.1252, 0.1248, 0.1251, 0.1251, 0.1248, 0.1255, 0.1249],
        [0.1245, 0.1252, 0.1248, 0.1251, 0.1251, 0.1248, 0.1255, 0.1249],
        [0.1246, 0.1252, 0.1248, 0.1251, 0.1251, 0.1248, 0.1255, 0.1249],
        [0.1245, 0.1252, 0.1248, 0.1250, 0.1251, 0.1248, 0.1255, 0.1249],
        [0.1245, 0.1252, 0.1248, 0.1251, 0.1251, 0.1248, 0.1255, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0625, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0627, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0625, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1664, 0.1669, 0.1664, 0.1663, 0.1667, 0.1673],
        [0.1664, 0.1669, 0.1664, 0.1664, 0.1667, 0.1673],
        [0.1664, 0.1669, 0.1664, 0.1663, 0.1667, 0.1673],
        [0.1664, 0.1669, 0.1664, 0.1664, 0.1667, 0.1673],
        [0.1664, 0.1669, 0.1664, 0.1664, 0.1667, 0.1673],
        [0.1664, 0.1669, 0.1664, 0.1663, 0.1667, 0.1673]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.1992, 0.2004, 0.2000, 0.2003],
        [0.2002, 0.1992, 0.2004, 0.1999, 0.2003],
        [0.2002, 0.1992, 0.2004, 0.1999, 0.2003],
        [0.2001, 0.1993, 0.2003, 0.1999, 0.2004],
        [0.2000, 0.1992, 0.2002, 0.1997, 0.2009]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2505, 0.2505, 0.2512, 0.2477],
        [0.2505, 0.2505, 0.2512, 0.2478],
        [0.2505, 0.2504, 0.2512, 0.2479],
        [0.2504, 0.2504, 0.2512, 0.2480]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.2005, 0.2001, 0.1993, 0.2002],
        [0.1999, 0.2004, 0.2001, 0.1993, 0.2002],
        [0.1999, 0.2005, 0.2001, 0.1993, 0.2002],
        [0.1999, 0.2004, 0.2001, 0.1993, 0.2003],
        [0.2000, 0.2005, 0.2001, 0.1992, 0.2002]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27971577644348145s
iter time cost:11.693809509277344s
-------------Round number: 32-------------
Evaluate global model
Averaged Train Loss: 1.3433
Averaged Test Accurancy: 0.6635
Std Test Accurancy: 0.1590
evaluate time cost:5.107793569564819s
clients training time cost:5.015749216079712s
attn_optimize time cost:0.7244410514831543s
weights:tensor([[0.0666, 0.0665, 0.0667, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0665, 0.0667, 0.0668, 0.0666, 0.0666, 0.0666, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0664, 0.0668, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0666, 0.0667],
        [0.0666, 0.0665, 0.0667, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0665, 0.0668, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0666, 0.0667],
        [0.0666, 0.0665, 0.0668, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0665, 0.0668, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0665, 0.0667, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0665, 0.0668, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0665, 0.0667, 0.0667, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0665, 0.0668, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0665, 0.0668, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0665, 0.0667, 0.0668, 0.0666, 0.0666, 0.0666, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0666, 0.0667],
        [0.0666, 0.0665, 0.0667, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0665, 0.0667, 0.0668, 0.0666, 0.0666, 0.0666, 0.0666, 0.0668,
         0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0498, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1244, 0.1252, 0.1248, 0.1251, 0.1251, 0.1250, 0.1254, 0.1249],
        [0.1244, 0.1253, 0.1249, 0.1250, 0.1251, 0.1250, 0.1254, 0.1249],
        [0.1244, 0.1252, 0.1248, 0.1251, 0.1251, 0.1250, 0.1254, 0.1249],
        [0.1244, 0.1253, 0.1248, 0.1251, 0.1251, 0.1250, 0.1254, 0.1249],
        [0.1244, 0.1253, 0.1249, 0.1251, 0.1251, 0.1250, 0.1254, 0.1249],
        [0.1244, 0.1253, 0.1249, 0.1251, 0.1251, 0.1249, 0.1254, 0.1249],
        [0.1244, 0.1253, 0.1249, 0.1251, 0.1251, 0.1250, 0.1254, 0.1249],
        [0.1244, 0.1253, 0.1249, 0.1251, 0.1251, 0.1250, 0.1254, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0623, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0626, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0626, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1662, 0.1668, 0.1666, 0.1665, 0.1668, 0.1671],
        [0.1662, 0.1668, 0.1666, 0.1665, 0.1668, 0.1671],
        [0.1662, 0.1668, 0.1667, 0.1664, 0.1668, 0.1672],
        [0.1662, 0.1668, 0.1666, 0.1665, 0.1668, 0.1671],
        [0.1662, 0.1668, 0.1667, 0.1665, 0.1668, 0.1671],
        [0.1662, 0.1668, 0.1667, 0.1665, 0.1668, 0.1671]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2006, 0.1991, 0.1998, 0.1999, 0.2005],
        [0.2006, 0.1991, 0.1999, 0.1999, 0.2005],
        [0.2005, 0.1991, 0.1998, 0.1999, 0.2006],
        [0.2005, 0.1992, 0.1998, 0.1999, 0.2006],
        [0.2005, 0.1991, 0.1996, 0.1996, 0.2011]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0504, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2504, 0.2505, 0.2512, 0.2479],
        [0.2504, 0.2504, 0.2511, 0.2481],
        [0.2504, 0.2504, 0.2511, 0.2481],
        [0.2502, 0.2504, 0.2511, 0.2483]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2005, 0.2001, 0.1995, 0.1999],
        [0.2000, 0.2005, 0.2001, 0.1995, 0.1999],
        [0.2000, 0.2005, 0.2001, 0.1995, 0.1999],
        [0.2000, 0.2005, 0.2001, 0.1995, 0.1999],
        [0.2000, 0.2005, 0.2001, 0.1995, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.31120991706848145s
iter time cost:11.216980934143066s
-------------Round number: 33-------------
Evaluate global model
Averaged Train Loss: 1.2848
Averaged Test Accurancy: 0.6743
Std Test Accurancy: 0.1550
evaluate time cost:5.236469745635986s
clients training time cost:5.065735578536987s
attn_optimize time cost:0.4699714183807373s
weights:tensor([[0.0667, 0.0667, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0667, 0.0666, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0667, 0.0666, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0667, 0.0667, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0667, 0.0667, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0667, 0.0667, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0667, 0.0667, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0666],
        [0.0667, 0.0666, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0667, 0.0667, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0667, 0.0666, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0667, 0.0667, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0667, 0.0666, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0667, 0.0667, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0498, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1245, 0.1253, 0.1248, 0.1251, 0.1251, 0.1248, 0.1255, 0.1249],
        [0.1245, 0.1253, 0.1249, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249],
        [0.1245, 0.1253, 0.1248, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249],
        [0.1245, 0.1253, 0.1248, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249],
        [0.1245, 0.1254, 0.1249, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249],
        [0.1245, 0.1254, 0.1249, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249],
        [0.1245, 0.1254, 0.1249, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249],
        [0.1245, 0.1253, 0.1249, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0625, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1662, 0.1668, 0.1665, 0.1664, 0.1668, 0.1673],
        [0.1662, 0.1668, 0.1665, 0.1665, 0.1668, 0.1673],
        [0.1662, 0.1668, 0.1665, 0.1664, 0.1668, 0.1673],
        [0.1662, 0.1668, 0.1665, 0.1665, 0.1667, 0.1673],
        [0.1662, 0.1668, 0.1665, 0.1664, 0.1668, 0.1673],
        [0.1662, 0.1668, 0.1666, 0.1664, 0.1668, 0.1673]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2004, 0.1992, 0.2001, 0.1999, 0.2003],
        [0.2005, 0.1992, 0.2002, 0.1999, 0.2003],
        [0.2004, 0.1992, 0.2002, 0.1999, 0.2003],
        [0.2004, 0.1992, 0.2001, 0.1999, 0.2004],
        [0.2004, 0.1992, 0.2000, 0.1996, 0.2008]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0500, 0.0498,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0501, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2505, 0.2506, 0.2512, 0.2477],
        [0.2505, 0.2505, 0.2511, 0.2479],
        [0.2505, 0.2505, 0.2511, 0.2479],
        [0.2503, 0.2505, 0.2511, 0.2481]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2005, 0.2002, 0.1992, 0.2001],
        [0.2000, 0.2005, 0.2001, 0.1993, 0.2001],
        [0.2000, 0.2005, 0.2001, 0.1993, 0.2001],
        [0.2000, 0.2005, 0.2002, 0.1993, 0.2001],
        [0.2000, 0.2005, 0.2002, 0.1993, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27446889877319336s
iter time cost:11.110675573348999s
-------------Round number: 34-------------
Evaluate global model
Averaged Train Loss: 1.3367
Averaged Test Accurancy: 0.6666
Std Test Accurancy: 0.1623
evaluate time cost:4.846500873565674s
clients training time cost:5.0771164894104s
attn_optimize time cost:0.48194122314453125s
weights:tensor([[0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0668,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0668,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0668,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0668,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0668,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0666],
        [0.0668, 0.0665, 0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0668,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0668,
         0.0665, 0.0666, 0.0668, 0.0667, 0.0667, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0498, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1243, 0.1252, 0.1248, 0.1252, 0.1251, 0.1250, 0.1254, 0.1249],
        [0.1244, 0.1252, 0.1249, 0.1252, 0.1251, 0.1250, 0.1254, 0.1249],
        [0.1243, 0.1252, 0.1248, 0.1252, 0.1251, 0.1250, 0.1254, 0.1249],
        [0.1243, 0.1252, 0.1248, 0.1252, 0.1251, 0.1250, 0.1254, 0.1249],
        [0.1243, 0.1252, 0.1249, 0.1253, 0.1251, 0.1249, 0.1254, 0.1249],
        [0.1243, 0.1252, 0.1249, 0.1252, 0.1251, 0.1249, 0.1254, 0.1249],
        [0.1243, 0.1252, 0.1249, 0.1252, 0.1251, 0.1249, 0.1254, 0.1249],
        [0.1243, 0.1252, 0.1248, 0.1252, 0.1251, 0.1250, 0.1254, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0627, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0627, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0627, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0627, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0627, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0627, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0627, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0627, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0627, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0627, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0627, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0627, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1663, 0.1667, 0.1664, 0.1666, 0.1668, 0.1672],
        [0.1663, 0.1667, 0.1664, 0.1666, 0.1668, 0.1671],
        [0.1663, 0.1667, 0.1665, 0.1666, 0.1668, 0.1672],
        [0.1663, 0.1667, 0.1664, 0.1667, 0.1668, 0.1672],
        [0.1663, 0.1667, 0.1665, 0.1666, 0.1668, 0.1672],
        [0.1663, 0.1667, 0.1665, 0.1666, 0.1668, 0.1672]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2005, 0.1989, 0.2001, 0.1998, 0.2007],
        [0.2005, 0.1989, 0.2001, 0.1998, 0.2007],
        [0.2005, 0.1989, 0.2001, 0.1998, 0.2007],
        [0.2005, 0.1989, 0.2001, 0.1998, 0.2007],
        [0.2005, 0.1988, 0.1999, 0.1995, 0.2013]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2506, 0.2503, 0.2512, 0.2478],
        [0.2506, 0.2503, 0.2512, 0.2479],
        [0.2506, 0.2503, 0.2512, 0.2480],
        [0.2505, 0.2502, 0.2512, 0.2481]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1998, 0.2005, 0.2002, 0.1995, 0.2000],
        [0.1998, 0.2005, 0.2002, 0.1995, 0.2000],
        [0.1998, 0.2005, 0.2002, 0.1994, 0.2000],
        [0.1997, 0.2005, 0.2002, 0.1995, 0.2000],
        [0.1998, 0.2005, 0.2002, 0.1995, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27536773681640625s
iter time cost:10.742135286331177s
-------------Round number: 35-------------
Evaluate global model
Averaged Train Loss: 1.4313
Averaged Test Accurancy: 0.6845
Std Test Accurancy: 0.1633
evaluate time cost:5.214770793914795s
clients training time cost:5.055466413497925s
attn_optimize time cost:0.47241806983947754s
weights:tensor([[0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0665, 0.0667],
        [0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0667, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0667, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0667, 0.0666, 0.0667, 0.0665, 0.0668, 0.0666, 0.0668,
         0.0665, 0.0667, 0.0669, 0.0667, 0.0666, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0498, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1244, 0.1251, 0.1249, 0.1252, 0.1252, 0.1249, 0.1255, 0.1248],
        [0.1245, 0.1252, 0.1249, 0.1251, 0.1252, 0.1249, 0.1255, 0.1247],
        [0.1244, 0.1251, 0.1249, 0.1251, 0.1252, 0.1249, 0.1255, 0.1248],
        [0.1244, 0.1252, 0.1249, 0.1251, 0.1252, 0.1249, 0.1255, 0.1248],
        [0.1244, 0.1252, 0.1249, 0.1252, 0.1251, 0.1249, 0.1255, 0.1248],
        [0.1244, 0.1252, 0.1249, 0.1252, 0.1251, 0.1249, 0.1255, 0.1248],
        [0.1244, 0.1252, 0.1249, 0.1251, 0.1252, 0.1249, 0.1255, 0.1248],
        [0.1244, 0.1252, 0.1249, 0.1252, 0.1252, 0.1249, 0.1255, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1661, 0.1667, 0.1666, 0.1662, 0.1671, 0.1672],
        [0.1662, 0.1668, 0.1665, 0.1663, 0.1670, 0.1672],
        [0.1661, 0.1667, 0.1666, 0.1662, 0.1671, 0.1673],
        [0.1662, 0.1668, 0.1665, 0.1663, 0.1670, 0.1672],
        [0.1661, 0.1667, 0.1666, 0.1662, 0.1671, 0.1673],
        [0.1661, 0.1667, 0.1666, 0.1662, 0.1671, 0.1672]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2004, 0.1991, 0.2002, 0.1998, 0.2006],
        [0.2004, 0.1991, 0.2002, 0.1998, 0.2005],
        [0.2004, 0.1991, 0.2002, 0.1998, 0.2006],
        [0.2003, 0.1991, 0.2001, 0.1997, 0.2006],
        [0.2003, 0.1990, 0.2000, 0.1995, 0.2011]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2505, 0.2505, 0.2512, 0.2477],
        [0.2505, 0.2505, 0.2511, 0.2479],
        [0.2505, 0.2505, 0.2511, 0.2479],
        [0.2503, 0.2504, 0.2510, 0.2483]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2006, 0.2001, 0.1992, 0.2001],
        [0.2000, 0.2006, 0.2001, 0.1993, 0.2001],
        [0.2000, 0.2006, 0.2000, 0.1993, 0.2001],
        [0.1999, 0.2006, 0.2001, 0.1993, 0.2001],
        [0.2000, 0.2006, 0.2001, 0.1992, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2856473922729492s
iter time cost:11.09136414527893s
-------------Round number: 36-------------
Evaluate global model
Averaged Train Loss: 1.9331
Averaged Test Accurancy: 0.6325
Std Test Accurancy: 0.1515
evaluate time cost:4.785417079925537s
clients training time cost:4.9132773876190186s
attn_optimize time cost:0.4860055446624756s
weights:tensor([[0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0666, 0.0669, 0.0667, 0.0667, 0.0668],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0667, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0666, 0.0669, 0.0667, 0.0667, 0.0668],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0667, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0667, 0.0670, 0.0667, 0.0666, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0667, 0.0670, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0667, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0666, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0666, 0.0670, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0667, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0667, 0.0670, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0667, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0667, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0667, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0667, 0.0667, 0.0666, 0.0666,
         0.0664, 0.0666, 0.0669, 0.0667, 0.0666, 0.0668],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0667, 0.0666, 0.0667, 0.0665, 0.0666,
         0.0664, 0.0666, 0.0670, 0.0667, 0.0667, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1244, 0.1254, 0.1248, 0.1251, 0.1251, 0.1248, 0.1254, 0.1250],
        [0.1244, 0.1254, 0.1249, 0.1250, 0.1251, 0.1248, 0.1254, 0.1249],
        [0.1244, 0.1254, 0.1248, 0.1251, 0.1251, 0.1248, 0.1254, 0.1250],
        [0.1244, 0.1254, 0.1248, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249],
        [0.1244, 0.1255, 0.1249, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249],
        [0.1244, 0.1255, 0.1249, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249],
        [0.1244, 0.1254, 0.1249, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249],
        [0.1244, 0.1254, 0.1249, 0.1251, 0.1251, 0.1248, 0.1254, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0621, 0.0624, 0.0626, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1663, 0.1667, 0.1665, 0.1664, 0.1668, 0.1673],
        [0.1663, 0.1668, 0.1665, 0.1664, 0.1668, 0.1673],
        [0.1663, 0.1667, 0.1665, 0.1664, 0.1668, 0.1673],
        [0.1663, 0.1668, 0.1665, 0.1664, 0.1667, 0.1673],
        [0.1663, 0.1667, 0.1665, 0.1664, 0.1668, 0.1673],
        [0.1663, 0.1667, 0.1665, 0.1664, 0.1668, 0.1673]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2004, 0.1990, 0.2004, 0.1999, 0.2002],
        [0.2004, 0.1990, 0.2004, 0.1999, 0.2002],
        [0.2004, 0.1990, 0.2004, 0.1999, 0.2003],
        [0.2004, 0.1991, 0.2004, 0.1999, 0.2004],
        [0.2004, 0.1989, 0.2003, 0.1997, 0.2008]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2505, 0.2505, 0.2513, 0.2478],
        [0.2504, 0.2504, 0.2512, 0.2480],
        [0.2504, 0.2503, 0.2512, 0.2481],
        [0.2502, 0.2503, 0.2512, 0.2483]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.2004, 0.2000, 0.1993, 0.2001],
        [0.2001, 0.2004, 0.2000, 0.1994, 0.2001],
        [0.2001, 0.2005, 0.2000, 0.1994, 0.2001],
        [0.2001, 0.2004, 0.1999, 0.1994, 0.2001],
        [0.2001, 0.2005, 0.2000, 0.1994, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.29634785652160645s
iter time cost:10.546193361282349s
-------------Round number: 37-------------
Evaluate global model
Averaged Train Loss: 1.3077
Averaged Test Accurancy: 0.6778
Std Test Accurancy: 0.1661
evaluate time cost:4.987783908843994s
clients training time cost:5.263175010681152s
attn_optimize time cost:0.5981321334838867s
weights:tensor([[0.0666, 0.0666, 0.0668, 0.0666, 0.0666, 0.0665, 0.0668, 0.0665, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0668, 0.0666, 0.0666, 0.0666, 0.0668, 0.0665, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0668, 0.0666, 0.0666, 0.0666, 0.0668, 0.0665, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0668, 0.0666, 0.0666, 0.0665, 0.0668, 0.0665, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0668, 0.0666, 0.0666, 0.0665, 0.0668, 0.0665, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0668, 0.0666, 0.0666, 0.0665, 0.0668, 0.0665, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0668],
        [0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0498, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1244, 0.1253, 0.1249, 0.1250, 0.1251, 0.1249, 0.1254, 0.1249],
        [0.1244, 0.1254, 0.1250, 0.1249, 0.1252, 0.1249, 0.1254, 0.1248],
        [0.1244, 0.1253, 0.1249, 0.1250, 0.1252, 0.1249, 0.1254, 0.1249],
        [0.1245, 0.1254, 0.1249, 0.1249, 0.1251, 0.1250, 0.1254, 0.1248],
        [0.1244, 0.1254, 0.1250, 0.1250, 0.1251, 0.1249, 0.1254, 0.1248],
        [0.1244, 0.1254, 0.1250, 0.1250, 0.1251, 0.1249, 0.1254, 0.1248],
        [0.1245, 0.1254, 0.1250, 0.1250, 0.1251, 0.1249, 0.1254, 0.1248],
        [0.1244, 0.1254, 0.1249, 0.1250, 0.1251, 0.1249, 0.1254, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0627, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0627, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0627, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0627, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0627, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0627, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1662, 0.1668, 0.1664, 0.1664, 0.1668, 0.1673],
        [0.1662, 0.1668, 0.1664, 0.1665, 0.1668, 0.1673],
        [0.1661, 0.1668, 0.1665, 0.1664, 0.1668, 0.1674],
        [0.1662, 0.1668, 0.1664, 0.1665, 0.1667, 0.1673],
        [0.1662, 0.1668, 0.1665, 0.1664, 0.1668, 0.1673],
        [0.1662, 0.1668, 0.1665, 0.1664, 0.1668, 0.1674]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2006, 0.1990, 0.2001, 0.1996, 0.2007],
        [0.2006, 0.1990, 0.2001, 0.1996, 0.2007],
        [0.2006, 0.1990, 0.2001, 0.1996, 0.2007],
        [0.2005, 0.1991, 0.2000, 0.1996, 0.2008],
        [0.2006, 0.1989, 0.1999, 0.1993, 0.2013]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2505, 0.2506, 0.2512, 0.2477],
        [0.2504, 0.2505, 0.2510, 0.2480],
        [0.2504, 0.2505, 0.2511, 0.2480],
        [0.2502, 0.2505, 0.2509, 0.2484]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1998, 0.2006, 0.2003, 0.1993, 0.2001],
        [0.1998, 0.2005, 0.2003, 0.1993, 0.2001],
        [0.1998, 0.2006, 0.2003, 0.1993, 0.2001],
        [0.1997, 0.2005, 0.2003, 0.1993, 0.2001],
        [0.1998, 0.2006, 0.2003, 0.1993, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3023858070373535s
iter time cost:11.214799880981445s
-------------Round number: 38-------------
Evaluate global model
Averaged Train Loss: 1.1142
Averaged Test Accurancy: 0.6921
Std Test Accurancy: 0.1542
evaluate time cost:5.248185634613037s
clients training time cost:4.912790775299072s
attn_optimize time cost:0.4743938446044922s
weights:tensor([[0.0668, 0.0665, 0.0669, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0668, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0666, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0668, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0668, 0.0665, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0666, 0.0668],
        [0.0668, 0.0665, 0.0669, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667],
        [0.0668, 0.0665, 0.0668, 0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0667,
         0.0664, 0.0666, 0.0669, 0.0668, 0.0667, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0498, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1243, 0.1253, 0.1248, 0.1253, 0.1251, 0.1248, 0.1256, 0.1249],
        [0.1243, 0.1253, 0.1248, 0.1252, 0.1251, 0.1248, 0.1256, 0.1248],
        [0.1243, 0.1253, 0.1248, 0.1253, 0.1251, 0.1248, 0.1256, 0.1249],
        [0.1243, 0.1253, 0.1248, 0.1253, 0.1251, 0.1248, 0.1256, 0.1249],
        [0.1242, 0.1253, 0.1248, 0.1253, 0.1251, 0.1248, 0.1256, 0.1248],
        [0.1243, 0.1253, 0.1248, 0.1253, 0.1251, 0.1248, 0.1256, 0.1248],
        [0.1243, 0.1253, 0.1248, 0.1252, 0.1251, 0.1248, 0.1256, 0.1249],
        [0.1243, 0.1253, 0.1248, 0.1253, 0.1251, 0.1248, 0.1256, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0626, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1662, 0.1667, 0.1664, 0.1666, 0.1669, 0.1672],
        [0.1662, 0.1667, 0.1664, 0.1666, 0.1669, 0.1672],
        [0.1661, 0.1667, 0.1665, 0.1665, 0.1669, 0.1673],
        [0.1662, 0.1667, 0.1664, 0.1666, 0.1669, 0.1672],
        [0.1661, 0.1667, 0.1665, 0.1665, 0.1669, 0.1673],
        [0.1662, 0.1667, 0.1665, 0.1665, 0.1669, 0.1672]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2005, 0.1989, 0.2000, 0.1996, 0.2010],
        [0.2005, 0.1989, 0.2001, 0.1996, 0.2009],
        [0.2005, 0.1989, 0.2000, 0.1996, 0.2010],
        [0.2005, 0.1989, 0.2000, 0.1996, 0.2011],
        [0.2005, 0.1988, 0.1999, 0.1993, 0.2016]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0503, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2506, 0.2504, 0.2514, 0.2475],
        [0.2506, 0.2503, 0.2513, 0.2477],
        [0.2505, 0.2503, 0.2513, 0.2478],
        [0.2504, 0.2503, 0.2513, 0.2480]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1997, 0.2007, 0.2001, 0.1994, 0.2001],
        [0.1997, 0.2006, 0.2001, 0.1994, 0.2001],
        [0.1997, 0.2007, 0.2001, 0.1994, 0.2001],
        [0.1997, 0.2006, 0.2001, 0.1994, 0.2002],
        [0.1997, 0.2007, 0.2001, 0.1994, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.29318761825561523s
iter time cost:10.99361538887024s
-------------Round number: 39-------------
Evaluate global model
Averaged Train Loss: 0.7496
Averaged Test Accurancy: 0.7475
Std Test Accurancy: 0.1328
evaluate time cost:5.020028829574585s
clients training time cost:5.178534984588623s
attn_optimize time cost:0.5768072605133057s
weights:tensor([[0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0669, 0.0665, 0.0667, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0666, 0.0667, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0665, 0.0669, 0.0667, 0.0666, 0.0668],
        [0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667],
        [0.0667, 0.0665, 0.0668, 0.0665, 0.0667, 0.0666, 0.0668, 0.0666, 0.0667,
         0.0665, 0.0665, 0.0669, 0.0667, 0.0666, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1243, 0.1252, 0.1247, 0.1251, 0.1252, 0.1250, 0.1255, 0.1250],
        [0.1244, 0.1252, 0.1248, 0.1251, 0.1253, 0.1250, 0.1254, 0.1249],
        [0.1244, 0.1252, 0.1247, 0.1251, 0.1253, 0.1250, 0.1254, 0.1249],
        [0.1244, 0.1252, 0.1247, 0.1251, 0.1252, 0.1250, 0.1254, 0.1249],
        [0.1243, 0.1253, 0.1248, 0.1252, 0.1252, 0.1249, 0.1255, 0.1249],
        [0.1243, 0.1253, 0.1248, 0.1251, 0.1252, 0.1249, 0.1254, 0.1249],
        [0.1243, 0.1253, 0.1248, 0.1251, 0.1252, 0.1249, 0.1254, 0.1249],
        [0.1243, 0.1252, 0.1247, 0.1251, 0.1253, 0.1250, 0.1254, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0625, 0.0623],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0625, 0.0623],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0625, 0.0625, 0.0623],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0627, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0626, 0.0627, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0623,
         0.0626, 0.0625, 0.0624, 0.0622, 0.0624, 0.0626, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1662, 0.1667, 0.1665, 0.1664, 0.1669, 0.1673],
        [0.1662, 0.1667, 0.1665, 0.1664, 0.1668, 0.1673],
        [0.1661, 0.1667, 0.1666, 0.1664, 0.1668, 0.1674],
        [0.1662, 0.1668, 0.1665, 0.1664, 0.1668, 0.1673],
        [0.1662, 0.1667, 0.1666, 0.1664, 0.1669, 0.1673],
        [0.1662, 0.1667, 0.1666, 0.1664, 0.1668, 0.1673]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2005, 0.1990, 0.2001, 0.2000, 0.2005],
        [0.2005, 0.1990, 0.2001, 0.2000, 0.2005],
        [0.2004, 0.1990, 0.2001, 0.1999, 0.2006],
        [0.2004, 0.1990, 0.2001, 0.1999, 0.2006],
        [0.2004, 0.1988, 0.1999, 0.1997, 0.2011]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2507, 0.2505, 0.2512, 0.2476],
        [0.2507, 0.2504, 0.2511, 0.2478],
        [0.2506, 0.2505, 0.2511, 0.2478],
        [0.2505, 0.2504, 0.2510, 0.2481]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.2006, 0.2002, 0.1991, 0.2000],
        [0.2000, 0.2005, 0.2002, 0.1992, 0.2000],
        [0.2000, 0.2006, 0.2002, 0.1992, 0.2000],
        [0.2000, 0.2005, 0.2002, 0.1992, 0.2000],
        [0.2000, 0.2006, 0.2003, 0.1992, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3225564956665039s
iter time cost:11.160998582839966s
-------------Round number: 40-------------
Evaluate global model
Averaged Train Loss: 0.8524
Averaged Test Accurancy: 0.7359
Std Test Accurancy: 0.1383
evaluate time cost:5.524064540863037s
clients training time cost:5.1818177700042725s
attn_optimize time cost:0.514256477355957s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.4981, 0.5019],
        [0.4972, 0.5028]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2005, 0.2002, 0.1996, 0.2001, 0.1996],
        [0.2005, 0.2003, 0.1996, 0.2001, 0.1996],
        [0.2004, 0.2002, 0.1997, 0.2001, 0.1995],
        [0.2004, 0.2002, 0.1996, 0.2001, 0.1996],
        [0.2004, 0.2002, 0.1997, 0.2001, 0.1995]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0498, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0496, 0.0498, 0.0500, 0.0499, 0.0502, 0.0500, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0492]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 6it [00:00, 272.89it/s, center_shift=0.000000, iteration=6, tol=0.000100]
weights:tensor([[0.1112, 0.1108, 0.1111, 0.1110, 0.1111, 0.1107, 0.1111, 0.1117, 0.1113],
        [0.1111, 0.1109, 0.1112, 0.1110, 0.1111, 0.1108, 0.1111, 0.1116, 0.1113],
        [0.1111, 0.1109, 0.1112, 0.1110, 0.1111, 0.1108, 0.1111, 0.1116, 0.1113],
        [0.1111, 0.1109, 0.1112, 0.1110, 0.1110, 0.1108, 0.1111, 0.1116, 0.1113],
        [0.1111, 0.1109, 0.1111, 0.1110, 0.1111, 0.1107, 0.1111, 0.1116, 0.1113],
        [0.1111, 0.1109, 0.1111, 0.1110, 0.1111, 0.1107, 0.1111, 0.1116, 0.1113],
        [0.1112, 0.1108, 0.1111, 0.1110, 0.1110, 0.1107, 0.1112, 0.1116, 0.1113],
        [0.1112, 0.1108, 0.1112, 0.1110, 0.1110, 0.1107, 0.1112, 0.1116, 0.1113],
        [0.1111, 0.1108, 0.1111, 0.1110, 0.1111, 0.1107, 0.1111, 0.1116, 0.1113]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0244],
        [0.0252, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0243],
        [0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0244],
        ...,
        [0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0246],
        [0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0245],
        [0.0251, 0.0250, 0.0250,  ..., 0.0251, 0.0250, 0.0247]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2501, 0.2503, 0.2499, 0.2497],
        [0.2501, 0.2503, 0.2499, 0.2497],
        [0.2501, 0.2503, 0.2499, 0.2496],
        [0.2502, 0.2503, 0.2499, 0.2496]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1248, 0.1249, 0.1248, 0.1254, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1248, 0.1249, 0.1248, 0.1253, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1248, 0.1249, 0.1248, 0.1254, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1248, 0.1249, 0.1248, 0.1254, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1248, 0.1249, 0.1248, 0.1254, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1248, 0.1249, 0.1248, 0.1253, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1248, 0.1249, 0.1248, 0.1254, 0.1251, 0.1251, 0.1249],
        [0.1251, 0.1248, 0.1249, 0.1248, 0.1254, 0.1251, 0.1251, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.0999, 0.0998, 0.1001, 0.0997, 0.1001, 0.1000, 0.1001, 0.1001,
         0.1000],
        [0.1001, 0.0999, 0.0998, 0.1001, 0.0997, 0.1001, 0.1000, 0.1001, 0.1002,
         0.1000],
        [0.1000, 0.0999, 0.0998, 0.1001, 0.0996, 0.1001, 0.1000, 0.1001, 0.1002,
         0.1000],
        [0.1000, 0.1000, 0.0998, 0.1001, 0.0997, 0.1001, 0.1000, 0.1001, 0.1002,
         0.1000],
        [0.1000, 0.0999, 0.0998, 0.1001, 0.0997, 0.1001, 0.1000, 0.1001, 0.1002,
         0.1001],
        [0.1001, 0.0999, 0.0998, 0.1001, 0.0996, 0.1001, 0.1000, 0.1001, 0.1002,
         0.1001],
        [0.1000, 0.0999, 0.0998, 0.1001, 0.0997, 0.1001, 0.1000, 0.1001, 0.1002,
         0.1000],
        [0.1000, 0.1000, 0.0998, 0.1001, 0.0996, 0.1001, 0.1000, 0.1001, 0.1001,
         0.1000],
        [0.1000, 0.0999, 0.0998, 0.1001, 0.0997, 0.1001, 0.1000, 0.1001, 0.1001,
         0.1000],
        [0.1001, 0.0999, 0.0998, 0.1001, 0.0996, 0.1001, 0.1000, 0.1001, 0.1002,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.41305041313171387s
iter time cost:11.733104467391968s
-------------Round number: 41-------------
Evaluate global model
Averaged Train Loss: 0.7833
Averaged Test Accurancy: 0.7390
Std Test Accurancy: 0.1369
evaluate time cost:4.877444744110107s
clients training time cost:4.913886547088623s
attn_optimize time cost:0.6778848171234131s
weights:tensor([[0.4979, 0.5021],
        [0.4969, 0.5031]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2006, 0.2003, 0.1993, 0.2000, 0.1997],
        [0.2006, 0.2004, 0.1993, 0.2000, 0.1997],
        [0.2005, 0.2003, 0.1993, 0.2000, 0.1997],
        [0.2006, 0.2003, 0.1993, 0.2000, 0.1997],
        [0.2005, 0.2003, 0.1994, 0.2000, 0.1997]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0502, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0499, 0.0494],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0502, 0.0503, 0.0496, 0.0499, 0.0500, 0.0498, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0501, 0.0502, 0.0502, 0.0502,
         0.0500, 0.0492]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1110, 0.1112, 0.1110, 0.1109, 0.1109, 0.1110, 0.1117, 0.1112],
        [0.1111, 0.1110, 0.1112, 0.1111, 0.1110, 0.1109, 0.1109, 0.1117, 0.1112],
        [0.1111, 0.1110, 0.1112, 0.1111, 0.1110, 0.1109, 0.1109, 0.1117, 0.1112],
        [0.1111, 0.1110, 0.1112, 0.1110, 0.1110, 0.1109, 0.1110, 0.1117, 0.1112],
        [0.1111, 0.1110, 0.1112, 0.1110, 0.1110, 0.1109, 0.1110, 0.1117, 0.1112],
        [0.1111, 0.1110, 0.1112, 0.1111, 0.1110, 0.1109, 0.1110, 0.1117, 0.1112],
        [0.1111, 0.1110, 0.1112, 0.1110, 0.1109, 0.1109, 0.1110, 0.1117, 0.1112],
        [0.1111, 0.1110, 0.1112, 0.1110, 0.1109, 0.1109, 0.1110, 0.1117, 0.1112],
        [0.1111, 0.1110, 0.1112, 0.1111, 0.1110, 0.1109, 0.1109, 0.1117, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0244],
        [0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0243],
        [0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0244],
        ...,
        [0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0246],
        [0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0245],
        [0.0251, 0.0250, 0.0250,  ..., 0.0251, 0.0250, 0.0247]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2499, 0.2501, 0.2501],
        [0.2500, 0.2499, 0.2501, 0.2501],
        [0.2499, 0.2499, 0.2501, 0.2501],
        [0.2500, 0.2499, 0.2500, 0.2501]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1248, 0.1250, 0.1246, 0.1252, 0.1253, 0.1251, 0.1251, 0.1250],
        [0.1248, 0.1251, 0.1246, 0.1252, 0.1252, 0.1251, 0.1251, 0.1250],
        [0.1248, 0.1251, 0.1246, 0.1252, 0.1253, 0.1251, 0.1251, 0.1250],
        [0.1248, 0.1250, 0.1246, 0.1252, 0.1253, 0.1251, 0.1251, 0.1250],
        [0.1248, 0.1251, 0.1246, 0.1252, 0.1252, 0.1251, 0.1251, 0.1250],
        [0.1248, 0.1251, 0.1246, 0.1252, 0.1252, 0.1251, 0.1251, 0.1250],
        [0.1248, 0.1251, 0.1245, 0.1252, 0.1253, 0.1251, 0.1251, 0.1250],
        [0.1248, 0.1251, 0.1246, 0.1252, 0.1253, 0.1251, 0.1251, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.0998, 0.1002, 0.1001, 0.0998, 0.1000, 0.0999, 0.0999, 0.1001,
         0.1001],
        [0.1001, 0.0999, 0.1002, 0.1001, 0.0998, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1001],
        [0.1001, 0.0998, 0.1002, 0.1001, 0.0998, 0.1000, 0.0999, 0.0999, 0.1001,
         0.1001],
        [0.1001, 0.0999, 0.1002, 0.1001, 0.0998, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1001],
        [0.1001, 0.0999, 0.1002, 0.1001, 0.0998, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1001],
        [0.1001, 0.0998, 0.1002, 0.1001, 0.0998, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1001],
        [0.1001, 0.0998, 0.1002, 0.1001, 0.0998, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1001],
        [0.1001, 0.0999, 0.1002, 0.1001, 0.0998, 0.1000, 0.0999, 0.0999, 0.1001,
         0.1001],
        [0.1000, 0.0998, 0.1002, 0.1001, 0.0998, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1001],
        [0.1001, 0.0998, 0.1002, 0.1001, 0.0998, 0.1000, 0.0999, 0.0998, 0.1001,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3598906993865967s
iter time cost:10.897839307785034s
-------------Round number: 42-------------
Evaluate global model
Averaged Train Loss: 0.7555
Averaged Test Accurancy: 0.7513
Std Test Accurancy: 0.1331
evaluate time cost:4.733259677886963s
clients training time cost:4.975484609603882s
attn_optimize time cost:0.6637370586395264s
weights:tensor([[0.4977, 0.5023],
        [0.4966, 0.5034]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2003, 0.2001, 0.1998, 0.2001, 0.1997],
        [0.2003, 0.2002, 0.1998, 0.2001, 0.1997],
        [0.2002, 0.2001, 0.1998, 0.2001, 0.1996],
        [0.2003, 0.2002, 0.1998, 0.2001, 0.1996],
        [0.2003, 0.2002, 0.1998, 0.2001, 0.1996]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0500, 0.0493],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0494],
        [0.0501, 0.0504, 0.0496, 0.0499, 0.0500, 0.0498, 0.0503, 0.0500, 0.0502,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0500, 0.0492]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1114, 0.1108, 0.1111, 0.1110, 0.1111, 0.1107, 0.1111, 0.1115, 0.1114],
        [0.1113, 0.1109, 0.1111, 0.1110, 0.1111, 0.1107, 0.1110, 0.1115, 0.1114],
        [0.1113, 0.1108, 0.1111, 0.1110, 0.1111, 0.1107, 0.1110, 0.1115, 0.1114],
        [0.1113, 0.1109, 0.1111, 0.1110, 0.1111, 0.1107, 0.1110, 0.1115, 0.1114],
        [0.1113, 0.1109, 0.1111, 0.1110, 0.1111, 0.1107, 0.1111, 0.1115, 0.1113],
        [0.1113, 0.1109, 0.1111, 0.1110, 0.1111, 0.1107, 0.1110, 0.1115, 0.1113],
        [0.1114, 0.1108, 0.1111, 0.1110, 0.1110, 0.1107, 0.1111, 0.1115, 0.1114],
        [0.1114, 0.1108, 0.1111, 0.1110, 0.1111, 0.1107, 0.1111, 0.1115, 0.1114],
        [0.1113, 0.1108, 0.1111, 0.1110, 0.1111, 0.1107, 0.1110, 0.1115, 0.1114]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0244],
        [0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0243],
        [0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0243],
        ...,
        [0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0245],
        [0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0245],
        [0.0251, 0.0250, 0.0250,  ..., 0.0251, 0.0250, 0.0247]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2502, 0.2496, 0.2500],
        [0.2503, 0.2502, 0.2496, 0.2499],
        [0.2503, 0.2502, 0.2496, 0.2499],
        [0.2503, 0.2502, 0.2496, 0.2499]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1252, 0.1250, 0.1249, 0.1246, 0.1253, 0.1250, 0.1250, 0.1249],
        [0.1252, 0.1250, 0.1249, 0.1246, 0.1253, 0.1250, 0.1250, 0.1249],
        [0.1252, 0.1250, 0.1248, 0.1246, 0.1254, 0.1250, 0.1250, 0.1249],
        [0.1252, 0.1250, 0.1249, 0.1246, 0.1254, 0.1250, 0.1250, 0.1249],
        [0.1253, 0.1250, 0.1249, 0.1246, 0.1253, 0.1250, 0.1250, 0.1250],
        [0.1253, 0.1250, 0.1249, 0.1246, 0.1253, 0.1250, 0.1250, 0.1250],
        [0.1252, 0.1250, 0.1248, 0.1246, 0.1253, 0.1250, 0.1250, 0.1249],
        [0.1252, 0.1250, 0.1248, 0.1246, 0.1253, 0.1251, 0.1250, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1000, 0.0998, 0.1002, 0.0998, 0.1000, 0.0999, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.1000, 0.0998, 0.1001, 0.0997, 0.1000, 0.0999, 0.1000, 0.1003,
         0.1001],
        [0.1001, 0.1000, 0.0997, 0.1002, 0.0997, 0.1000, 0.0999, 0.1000, 0.1003,
         0.1001],
        [0.1001, 0.1000, 0.0997, 0.1002, 0.0998, 0.1000, 0.0999, 0.1000, 0.1003,
         0.1001],
        [0.1001, 0.1000, 0.0998, 0.1002, 0.0998, 0.1000, 0.0999, 0.1000, 0.1003,
         0.1001],
        [0.1001, 0.1000, 0.0998, 0.1002, 0.0997, 0.1000, 0.0999, 0.1000, 0.1003,
         0.1001],
        [0.1001, 0.1000, 0.0997, 0.1002, 0.0998, 0.1000, 0.0999, 0.1000, 0.1003,
         0.1001],
        [0.1001, 0.1000, 0.0997, 0.1002, 0.0997, 0.1000, 0.0999, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.1000, 0.0998, 0.1002, 0.0998, 0.1000, 0.0999, 0.1000, 0.1003,
         0.1001],
        [0.1001, 0.1000, 0.0997, 0.1002, 0.0997, 0.1000, 0.0999, 0.1000, 0.1003,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3732175827026367s
iter time cost:10.811352491378784s
-------------Round number: 43-------------
Evaluate global model
Averaged Train Loss: 0.7123
Averaged Test Accurancy: 0.7552
Std Test Accurancy: 0.1572
evaluate time cost:4.7325544357299805s
clients training time cost:4.911276817321777s
attn_optimize time cost:0.6783807277679443s
weights:tensor([[0.4974, 0.5026],
        [0.4964, 0.5036]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2006, 0.2004, 0.1994, 0.2001, 0.1995],
        [0.2006, 0.2004, 0.1994, 0.2001, 0.1995],
        [0.2005, 0.2004, 0.1994, 0.2001, 0.1995],
        [0.2005, 0.2004, 0.1994, 0.2002, 0.1995],
        [0.2005, 0.2004, 0.1995, 0.2001, 0.1995]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0501, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0501, 0.0501, 0.0501, 0.0502,
         0.0498, 0.0494],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0496],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0501, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0495],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0501, 0.0501, 0.0501, 0.0502,
         0.0498, 0.0495],
        [0.0502, 0.0504, 0.0496, 0.0499, 0.0500, 0.0498, 0.0501, 0.0500, 0.0502,
         0.0502, 0.0500, 0.0500, 0.0500, 0.0497, 0.0501, 0.0502, 0.0502, 0.0503,
         0.0499, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1112, 0.1109, 0.1111, 0.1109, 0.1110, 0.1108, 0.1111, 0.1115, 0.1114],
        [0.1112, 0.1110, 0.1111, 0.1109, 0.1110, 0.1108, 0.1111, 0.1115, 0.1114],
        [0.1112, 0.1110, 0.1112, 0.1109, 0.1110, 0.1108, 0.1111, 0.1115, 0.1114],
        [0.1112, 0.1110, 0.1112, 0.1109, 0.1110, 0.1108, 0.1111, 0.1115, 0.1113],
        [0.1112, 0.1110, 0.1111, 0.1109, 0.1110, 0.1108, 0.1111, 0.1115, 0.1113],
        [0.1112, 0.1110, 0.1111, 0.1109, 0.1110, 0.1108, 0.1111, 0.1115, 0.1113],
        [0.1112, 0.1109, 0.1111, 0.1109, 0.1110, 0.1108, 0.1112, 0.1115, 0.1114],
        [0.1112, 0.1110, 0.1111, 0.1109, 0.1110, 0.1108, 0.1111, 0.1115, 0.1114],
        [0.1112, 0.1110, 0.1111, 0.1109, 0.1111, 0.1108, 0.1111, 0.1115, 0.1114]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0244],
        [0.0252, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0243],
        [0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0243],
        ...,
        [0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0246],
        [0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0245],
        [0.0250, 0.0250, 0.0250,  ..., 0.0251, 0.0250, 0.0247]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2499, 0.2500, 0.2499, 0.2501],
        [0.2499, 0.2500, 0.2499, 0.2501],
        [0.2499, 0.2500, 0.2499, 0.2502],
        [0.2499, 0.2501, 0.2499, 0.2502]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1248, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248],
        [0.1250, 0.1250, 0.1249, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248],
        [0.1250, 0.1250, 0.1248, 0.1251, 0.1254, 0.1249, 0.1250, 0.1248],
        [0.1250, 0.1250, 0.1249, 0.1252, 0.1254, 0.1249, 0.1249, 0.1248],
        [0.1250, 0.1250, 0.1249, 0.1251, 0.1253, 0.1249, 0.1249, 0.1248],
        [0.1250, 0.1250, 0.1248, 0.1251, 0.1253, 0.1249, 0.1250, 0.1248],
        [0.1250, 0.1250, 0.1248, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248],
        [0.1250, 0.1250, 0.1248, 0.1251, 0.1253, 0.1250, 0.1250, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.0999, 0.0999, 0.1000, 0.0998, 0.1001, 0.1002, 0.1000, 0.1000,
         0.1000],
        [0.1001, 0.0999, 0.0999, 0.1000, 0.0998, 0.1001, 0.1002, 0.1000, 0.1000,
         0.1000],
        [0.1001, 0.0999, 0.0999, 0.1000, 0.0998, 0.1001, 0.1002, 0.1000, 0.1000,
         0.1000],
        [0.1001, 0.0999, 0.0999, 0.1000, 0.0998, 0.1001, 0.1002, 0.1000, 0.1000,
         0.1000],
        [0.1001, 0.0999, 0.0999, 0.1000, 0.0998, 0.1001, 0.1002, 0.1000, 0.1000,
         0.1000],
        [0.1001, 0.0999, 0.0999, 0.1000, 0.0998, 0.1001, 0.1002, 0.1000, 0.1000,
         0.1000],
        [0.1001, 0.0999, 0.0999, 0.1000, 0.0998, 0.1001, 0.1002, 0.1000, 0.1000,
         0.1000],
        [0.1001, 0.0999, 0.0999, 0.1000, 0.0998, 0.1001, 0.1002, 0.1000, 0.1000,
         0.1000],
        [0.1001, 0.0999, 0.0999, 0.1000, 0.0998, 0.1001, 0.1002, 0.1000, 0.1000,
         0.1000],
        [0.1001, 0.0999, 0.0999, 0.1000, 0.0998, 0.1001, 0.1002, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3625497817993164s
iter time cost:10.746819019317627s
-------------Round number: 44-------------
