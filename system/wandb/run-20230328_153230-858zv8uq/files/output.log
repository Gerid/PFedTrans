============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(1, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
-------------Round number: 0-------------
Evaluate global model
Averaged Train Loss: 2.3127
Averaged Test Accurancy: 0.0607
Averaged Test AUC: 0.4337
Std Test Accurancy: 0.0671
Std Test AUC: 0.1842
evaluate time cost:8.33997654914856s
clients training time cost:11.415594577789307s
running k-means on cuda..
device is :cuda
device is :cuda
form_cluster time cost:0.031027793884277344s
weights:tensor([[0.5000, 0.5000],
        [0.5000, 0.5000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3334, 0.3337, 0.3329],
        [0.3334, 0.3337, 0.3329],
        [0.3334, 0.3337, 0.3329]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2502, 0.2500, 0.2499, 0.2499],
        [0.2502, 0.2500, 0.2499, 0.2499],
        [0.2502, 0.2500, 0.2499, 0.2499],
        [0.2502, 0.2500, 0.2499, 0.2499]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5000, 0.5000],
        [0.5000, 0.5000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2502, 0.2500, 0.2499, 0.2499],
        [0.2502, 0.2500, 0.2499, 0.2499],
        [0.2502, 0.2500, 0.2499, 0.2499],
        [0.2502, 0.2500, 0.2499, 0.2499]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.031027555465698242s
iter time cost:19.854660034179688s
-------------Round number: 1-------------
Evaluate global model
