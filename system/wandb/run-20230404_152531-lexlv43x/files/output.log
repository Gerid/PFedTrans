============= Running time: 0th =============
Creating server and clients ...
DNN(
  (fc1): Linear(in_features=3072, out_features=100, bias=True)
  (fc): Linear(in_features=100, out_features=100, bias=True)
)
Join ratio / total clients: 1.0 / 100
Finished creating server and clients.
-------------Round number: 0-------------
Evaluate global model
Averaged Train Loss: 7.4868
Averaged Test Accurancy: 0.0000
Std Test Accurancy: 0.0000
evaluate time cost:5.8789732456207275s
[running kmeans]: 4it [00:00, 222.01it/s, center_shift=0.000010, iteration=4, tol=0.000100]
clients training time cost:4.43549656867981s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
form_cluster time cost:0.028387069702148438s
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2500, 0.2500, 0.2500],
        [0.2500, 0.2500, 0.2500, 0.2500],
        [0.2500, 0.2500, 0.2500, 0.2500],
        [0.2500, 0.2500, 0.2500, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.4559454917907715s
iter time cost:10.868865489959717s
-------------Round number: 1-------------
Evaluate global model
Averaged Train Loss: 2.7434
Averaged Test Accurancy: 0.5438
Std Test Accurancy: 0.1738
evaluate time cost:4.415838956832886s
clients training time cost:4.373543739318848s
attn_optimize time cost:0.47803664207458496s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1428, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1428, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1428, 0.1429],
        [0.1428, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1428, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1428, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2000, 0.2000, 0.1999, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.1999, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.1999, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.1999, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.1999, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5000, 0.5000],
        [0.5000, 0.5000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.22720623016357422s
iter time cost:9.568692207336426s
-------------Round number: 2-------------
Evaluate global model
[running kmeans]: 4it [00:00, 363.32it/s, center_shift=0.000000, iteration=4, tol=0.000100]
Averaged Train Loss: 3.3669
Averaged Test Accurancy: 0.5125
Std Test Accurancy: 0.1840
evaluate time cost:4.671180725097656s
[running kmeans]: 2it [00:00, 333.04it/s, center_shift=0.000055, iteration=2, tol=0.000100]
clients training time cost:4.490918397903442s
attn_optimize time cost:0.4559457302093506s
running k-means on cuda..
device is :cuda
device is :cuda
weights:tensor([[0.5000, 0.5000],
        [0.5000, 0.5000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5001, 0.4999],
        [0.5001, 0.4999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.30382299423217773s
iter time cost:10.007945775985718s
-------------Round number: 3-------------
Evaluate global model
Averaged Train Loss: 2.1787
Averaged Test Accurancy: 0.5498
Std Test Accurancy: 0.1778
evaluate time cost:4.565725326538086s
[running kmeans]: 6it [00:00, 374.66it/s, center_shift=0.000000, iteration=6, tol=0.000100]
clients training time cost:4.370959520339966s
attn_optimize time cost:0.551173210144043s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1111, 0.1109],
        [0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1111, 0.1109],
        [0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1111, 0.1109],
        [0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1111, 0.1109],
        [0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1111, 0.1109],
        [0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1111, 0.1109],
        [0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1111, 0.1109],
        [0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1111, 0.1109],
        [0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1111, 0.1108]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2500, 0.2501, 0.2499],
        [0.2500, 0.2500, 0.2501, 0.2499],
        [0.2500, 0.2500, 0.2501, 0.2499],
        [0.2500, 0.2500, 0.2501, 0.2499]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2928187847137451s
iter time cost:9.874762773513794s
-------------Round number: 4-------------
Evaluate global model
Averaged Train Loss: 3.5843
Averaged Test Accurancy: 0.5242
Std Test Accurancy: 0.1728
evaluate time cost:4.673657655715942s
[running kmeans]: 7it [00:00, 368.09it/s, center_shift=0.000000, iteration=7, tol=0.000100]
clients training time cost:4.830338716506958s
attn_optimize time cost:0.47196292877197266s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1249, 0.1249, 0.1250, 0.1250, 0.1250, 0.1251, 0.1251, 0.1251],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1250, 0.1251, 0.1251, 0.1251],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1250, 0.1251, 0.1251, 0.1251],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1250, 0.1251, 0.1251, 0.1251],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1250, 0.1251, 0.1251, 0.1251],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1250, 0.1251, 0.1251, 0.1251],
        [0.1249, 0.1249, 0.1250, 0.1250, 0.1250, 0.1251, 0.1251, 0.1251],
        [0.1249, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1251, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1666, 0.1667, 0.1666, 0.1666, 0.1668],
        [0.1666, 0.1666, 0.1667, 0.1666, 0.1666, 0.1668],
        [0.1666, 0.1666, 0.1667, 0.1666, 0.1666, 0.1668],
        [0.1666, 0.1666, 0.1667, 0.1666, 0.1666, 0.1668],
        [0.1666, 0.1666, 0.1667, 0.1666, 0.1666, 0.1668],
        [0.1666, 0.1666, 0.1667, 0.1666, 0.1666, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.1999, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.1999, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.2000, 0.2000, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430, 0.1427],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430, 0.1427],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430, 0.1427],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430, 0.1427],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430, 0.1427],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430, 0.1427],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430, 0.1427]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.31149840354919434s
iter time cost:10.382543802261353s
-------------Round number: 5-------------
Evaluate global model
Averaged Train Loss: 2.9186
Averaged Test Accurancy: 0.6157
Std Test Accurancy: 0.1748
evaluate time cost:4.573975086212158s
clients training time cost:5.00836968421936s
[running kmeans]: 4it [00:00, 307.42it/s, center_shift=0.000000, iteration=4, tol=0.000100]
attn_optimize time cost:0.48183131217956543s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.3333, 0.3333, 0.3334],
        [0.3333, 0.3333, 0.3334],
        [0.3333, 0.3333, 0.3334]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0768]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1110, 0.1110, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1110, 0.1110, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1110, 0.1110, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1110, 0.1110, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1110, 0.1110, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1110, 0.1110, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1110, 0.1110, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1110, 0.1110, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1110, 0.1110, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.24422168731689453s
iter time cost:10.39347505569458s
-------------Round number: 6-------------
Evaluate global model
Averaged Train Loss: 2.7509
Averaged Test Accurancy: 0.5493
Std Test Accurancy: 0.1739
evaluate time cost:4.6305413246154785s
clients training time cost:4.817389965057373s
[running kmeans]: 2it [00:00, 333.03it/s, center_shift=0.000050, iteration=2, tol=0.000100]
attn_optimize time cost:0.4258904457092285s
running k-means on cuda..
device is :cuda
device is :cuda
weights:tensor([[0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2000, 0.2000, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1249],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1667, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.2000, 0.2001, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2001, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2001, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2001, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2001, 0.2000, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2608165740966797s
iter time cost:10.231724977493286s
-------------Round number: 7-------------
Evaluate global model
Averaged Train Loss: 2.8594
Averaged Test Accurancy: 0.5780
Std Test Accurancy: 0.1825
evaluate time cost:4.621719121932983s
clients training time cost:4.95809268951416s
[running kmeans]: 9it [00:00, 333.03it/s, center_shift=0.000000, iteration=9, tol=0.000100]
attn_optimize time cost:0.5410330295562744s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3334, 0.3333, 0.3333],
        [0.3334, 0.3333, 0.3333],
        [0.3334, 0.3333, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3488895893096924s
iter time cost:10.565823078155518s
-------------Round number: 8-------------
Evaluate global model
Averaged Train Loss: 1.4029
Averaged Test Accurancy: 0.6707
Std Test Accurancy: 0.1623
evaluate time cost:4.328386545181274s
[running kmeans]: 4it [00:00, 307.40it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:4.924712896347046s
attn_optimize time cost:0.5234696865081787s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0906],
        [0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0906],
        [0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0906],
        [0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0906],
        [0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0906],
        [0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0906],
        [0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0906],
        [0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0906],
        [0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0906],
        [0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0906],
        [0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0906]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5000, 0.5000],
        [0.5000, 0.5000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.5070152282714844s
iter time cost:10.399231433868408s
-------------Round number: 9-------------
Evaluate global model
Averaged Train Loss: 1.3263
Averaged Test Accurancy: 0.6444
Std Test Accurancy: 0.1699
evaluate time cost:4.699218511581421s
[running kmeans]: 6it [00:00, 428.17it/s, center_shift=0.000028, iteration=6, tol=0.000100]
clients training time cost:4.637148141860962s
attn_optimize time cost:0.45888566970825195s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.30327439308166504s
iter time cost:10.242197275161743s
-------------Round number: 10-------------
Evaluate global model
Averaged Train Loss: 1.5914
Averaged Test Accurancy: 0.6234
Std Test Accurancy: 0.1671
evaluate time cost:4.418112516403198s
[running kmeans]: 4it [00:00, 249.78it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:4.703227281570435s
attn_optimize time cost:0.42494630813598633s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1667, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1666, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3332, 0.3334, 0.3333],
        [0.3332, 0.3334, 0.3333],
        [0.3332, 0.3334, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1667],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1667],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1667],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1667],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1667],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0714]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1250, 0.1246],
        [0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1250, 0.1246],
        [0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1250, 0.1246],
        [0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1250, 0.1246],
        [0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1250, 0.1246],
        [0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1250, 0.1246],
        [0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1250, 0.1246],
        [0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1250, 0.1246]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.37209486961364746s
iter time cost:10.050063133239746s
-------------Round number: 11-------------
Evaluate global model
Averaged Train Loss: 1.8135
Averaged Test Accurancy: 0.6344
Std Test Accurancy: 0.1806
evaluate time cost:4.541641473770142s
[running kmeans]: 5it [00:00, 356.83it/s, center_shift=0.000031, iteration=5, tol=0.000100]
clients training time cost:4.499478340148926s
attn_optimize time cost:0.4239537715911865s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667],
        [0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2000, 0.2000, 0.1999, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.1999, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.1999, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.1999, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.1999, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1666, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1667, 0.1666, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1667, 0.1666, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1667, 0.1666, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1667, 0.1666, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1667, 0.1666, 0.1667, 0.1666, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0769, 0.0770, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2908499240875244s
iter time cost:9.846058130264282s
-------------Round number: 12-------------
Evaluate global model
Averaged Train Loss: 1.3856
Averaged Test Accurancy: 0.6554
Std Test Accurancy: 0.1607
evaluate time cost:4.363701820373535s
clients training time cost:4.63271164894104s
[running kmeans]: 2it [00:00, 399.63it/s, center_shift=0.000000, iteration=2, tol=0.000100]
attn_optimize time cost:0.6489236354827881s
running k-means on cuda..
device is :cuda
device is :cuda
weights:tensor([[0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0256, 0.0256, 0.0256,  ..., 0.0257, 0.0257, 0.0256],
        [0.0256, 0.0256, 0.0256,  ..., 0.0257, 0.0257, 0.0256],
        [0.0256, 0.0256, 0.0256,  ..., 0.0257, 0.0257, 0.0256],
        ...,
        [0.0256, 0.0256, 0.0256,  ..., 0.0257, 0.0257, 0.0256],
        [0.0256, 0.0256, 0.0256,  ..., 0.0257, 0.0257, 0.0256],
        [0.0256, 0.0256, 0.0256,  ..., 0.0257, 0.0257, 0.0256]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1666, 0.1667, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2499, 0.2499, 0.2501],
        [0.2500, 0.2500, 0.2499, 0.2501],
        [0.2500, 0.2499, 0.2499, 0.2501],
        [0.2500, 0.2500, 0.2499, 0.2501]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1666, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2948124408721924s
iter time cost:10.014216899871826s
-------------Round number: 13-------------
Evaluate global model
Averaged Train Loss: 1.7385
Averaged Test Accurancy: 0.5984
Std Test Accurancy: 0.1773
evaluate time cost:4.658841371536255s
clients training time cost:4.954076290130615s
attn_optimize time cost:0.8248589038848877s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909,
         0.0909, 0.0910]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 6it [00:00, 333.04it/s, center_shift=0.000000, iteration=6, tol=0.000100]
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3208887577056885s
iter time cost:10.853752136230469s
-------------Round number: 14-------------
Evaluate global model
Averaged Train Loss: 1.1660
Averaged Test Accurancy: 0.6835
Std Test Accurancy: 0.1582
evaluate time cost:4.709834098815918s
clients training time cost:4.517292499542236s
attn_optimize time cost:0.4971737861633301s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.4999, 0.5001],
        [0.4999, 0.5001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 3it [00:00, 374.66it/s, center_shift=0.000000, iteration=3, tol=0.000100]
intra_cluster_agg time cost:0.28681421279907227s
iter time cost:10.108202457427979s
-------------Round number: 15-------------
Evaluate global model
Averaged Train Loss: 0.8898
Averaged Test Accurancy: 0.6955
Std Test Accurancy: 0.1494
evaluate time cost:4.53281044960022s
clients training time cost:4.582427501678467s
attn_optimize time cost:0.48398756980895996s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1668],
        [0.1667, 0.1666, 0.1666, 0.1666, 0.1667, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2501, 0.2499, 0.2500, 0.2500],
        [0.2501, 0.2499, 0.2500, 0.2500],
        [0.2501, 0.2499, 0.2500, 0.2500],
        [0.2501, 0.2499, 0.2500, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666],
        [0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1110, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1110, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1110, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2862842082977295s
iter time cost:9.995609045028687s
-------------Round number: 16-------------
Evaluate global model
[running kmeans]: 5it [00:00, 356.82it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 1.4175
Averaged Test Accurancy: 0.6371
Std Test Accurancy: 0.1570
evaluate time cost:4.673231363296509s
clients training time cost:4.612950325012207s
attn_optimize time cost:0.4339752197265625s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2000, 0.2000, 0.2000, 0.1999],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.1999],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.1999],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.1999],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28198885917663574s
iter time cost:10.100778341293335s
-------------Round number: 17-------------
Evaluate global model
[running kmeans]: 5it [00:00, 384.26it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 1.0816
Averaged Test Accurancy: 0.6951
Std Test Accurancy: 0.1553
evaluate time cost:4.526246070861816s
clients training time cost:4.454020261764526s
attn_optimize time cost:0.4511692523956299s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0666, 0.0666, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2499, 0.2500, 0.2499, 0.2501],
        [0.2499, 0.2500, 0.2499, 0.2501],
        [0.2499, 0.2500, 0.2499, 0.2501],
        [0.2499, 0.2500, 0.2499, 0.2501]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2000, 0.2000, 0.1999, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.1999, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.1999, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.1999, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.286820650100708s
iter time cost:9.804335832595825s
-------------Round number: 18-------------
Evaluate global model
[running kmeans]: 4it [00:00, 363.28it/s, center_shift=0.000055, iteration=4, tol=0.000100]
Averaged Train Loss: 1.0478
Averaged Test Accurancy: 0.7137
Std Test Accurancy: 0.1444
evaluate time cost:4.542543888092041s
clients training time cost:4.522503852844238s
attn_optimize time cost:0.4648780822753906s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2001, 0.2000, 0.1999, 0.1999],
        [0.2000, 0.2001, 0.2001, 0.1999, 0.1999],
        [0.2000, 0.2001, 0.2001, 0.1999, 0.1999],
        [0.2000, 0.2001, 0.2001, 0.1999, 0.1999],
        [0.2000, 0.2001, 0.2000, 0.2000, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250],
        [0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28185415267944336s
iter time cost:9.91087031364441s
-------------Round number: 19-------------
Evaluate global model
[running kmeans]: 5it [00:00, 384.25it/s, center_shift=0.000026, iteration=5, tol=0.000100]
Averaged Train Loss: 0.8221
Averaged Test Accurancy: 0.7251
Std Test Accurancy: 0.1441
evaluate time cost:4.59712553024292s
[running kmeans]: 6it [00:00, 374.66it/s, center_shift=0.000000, iteration=6, tol=0.000100]
clients training time cost:4.463451623916626s
attn_optimize time cost:0.4480326175689697s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3092803955078125s
iter time cost:9.919133424758911s
-------------Round number: 20-------------
Evaluate global model
Averaged Train Loss: 0.9686
Averaged Test Accurancy: 0.6856
Std Test Accurancy: 0.1357
evaluate time cost:4.598968744277954s
[running kmeans]: 3it [00:00, 374.66it/s, center_shift=0.000094, iteration=3, tol=0.000100]
clients training time cost:4.446784734725952s
attn_optimize time cost:0.500788688659668s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2500, 0.2500, 0.2500, 0.2500],
        [0.2500, 0.2500, 0.2500, 0.2500],
        [0.2500, 0.2500, 0.2500, 0.2500],
        [0.2500, 0.2500, 0.2500, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2001, 0.1999, 0.2000, 0.2000],
        [0.2000, 0.2001, 0.1999, 0.2000, 0.2000],
        [0.2000, 0.2001, 0.1999, 0.2000, 0.2000],
        [0.2000, 0.2001, 0.1999, 0.2000, 0.2000],
        [0.2000, 0.2001, 0.1999, 0.2000, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        ...,
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.1999, 0.2000, 0.2001, 0.2000],
        [0.1999, 0.1999, 0.2000, 0.2001, 0.2000],
        [0.1999, 0.1999, 0.2000, 0.2001, 0.2000],
        [0.1999, 0.1999, 0.2000, 0.2001, 0.2000],
        [0.1999, 0.1999, 0.2000, 0.2001, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3334, 0.3333, 0.3333],
        [0.3334, 0.3333, 0.3333],
        [0.3334, 0.3333, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5001, 0.4999],
        [0.5001, 0.4999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.392932653427124s
iter time cost:10.031099557876587s
-------------Round number: 21-------------
Evaluate global model
Averaged Train Loss: 0.8213
Averaged Test Accurancy: 0.7310
Std Test Accurancy: 0.1571
evaluate time cost:4.496966123580933s
[running kmeans]: 6it [00:00, 399.64it/s, center_shift=0.000029, iteration=6, tol=0.000100]
clients training time cost:4.5137903690338135s
attn_optimize time cost:0.7217459678649902s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2000, 0.2000, 0.2000, 0.1999],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.1999],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.1999],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.1999],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1430],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1430],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1430],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1430],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1430],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1430],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1249, 0.1251, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1251, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1251, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1251, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1251, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1251, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1251, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1251, 0.1250, 0.1250, 0.1250, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.30587315559387207s
iter time cost:10.14347219467163s
-------------Round number: 22-------------
Evaluate global model
Averaged Train Loss: 0.9475
Averaged Test Accurancy: 0.7075
Std Test Accurancy: 0.1445
evaluate time cost:4.713377952575684s
clients training time cost:4.557601451873779s
attn_optimize time cost:0.46962666511535645s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.2000, 0.1999, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.1999, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.1999, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.1999, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.1999, 0.2000, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0770, 0.0770, 0.0769, 0.0768,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1667, 0.1667, 0.1666, 0.1667, 0.1666],
        [0.1666, 0.1667, 0.1667, 0.1666, 0.1667, 0.1666],
        [0.1666, 0.1667, 0.1667, 0.1666, 0.1667, 0.1666],
        [0.1666, 0.1667, 0.1667, 0.1666, 0.1667, 0.1666],
        [0.1666, 0.1667, 0.1667, 0.1666, 0.1667, 0.1666],
        [0.1666, 0.1667, 0.1667, 0.1666, 0.1667, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1665, 0.1667, 0.1668, 0.1667, 0.1667, 0.1665],
        [0.1665, 0.1667, 0.1668, 0.1667, 0.1667, 0.1665],
        [0.1665, 0.1667, 0.1668, 0.1667, 0.1667, 0.1665],
        [0.1665, 0.1668, 0.1668, 0.1667, 0.1667, 0.1665],
        [0.1665, 0.1667, 0.1668, 0.1667, 0.1667, 0.1665],
        [0.1665, 0.1667, 0.1668, 0.1667, 0.1667, 0.1665]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3002743721008301s
iter time cost:10.140554428100586s
-------------Round number: 23-------------
Evaluate global model
[running kmeans]: 3it [00:00, 333.02it/s, center_shift=0.000000, iteration=3, tol=0.000100]
Averaged Train Loss: 0.8491
Averaged Test Accurancy: 0.7245
Std Test Accurancy: 0.1499
evaluate time cost:4.752134799957275s
clients training time cost:4.630866527557373s
attn_optimize time cost:0.5030426979064941s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1999, 0.2001, 0.2000, 0.1999, 0.2001],
        [0.1999, 0.2001, 0.2000, 0.1999, 0.2001],
        [0.1999, 0.2001, 0.2000, 0.1999, 0.2001],
        [0.1999, 0.2001, 0.2000, 0.1999, 0.2001],
        [0.1999, 0.2001, 0.2000, 0.1999, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1668, 0.1667, 0.1666, 0.1666, 0.1667],
        [0.1667, 0.1668, 0.1667, 0.1666, 0.1666, 0.1667],
        [0.1667, 0.1668, 0.1667, 0.1666, 0.1666, 0.1667],
        [0.1667, 0.1668, 0.1667, 0.1666, 0.1666, 0.1666],
        [0.1667, 0.1668, 0.1667, 0.1666, 0.1666, 0.1667],
        [0.1667, 0.1668, 0.1667, 0.1666, 0.1666, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1429, 0.1428, 0.1429, 0.1427, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1427, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1427, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1427, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1427, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1427, 0.1428, 0.1430],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1427, 0.1428, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5000, 0.5000],
        [0.5000, 0.5000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26546812057495117s
iter time cost:10.251604318618774s
-------------Round number: 24-------------
Evaluate global model
[running kmeans]: 4it [00:00, 363.29it/s, center_shift=0.000041, iteration=4, tol=0.000100]
Averaged Train Loss: 0.7854
Averaged Test Accurancy: 0.7399
Std Test Accurancy: 0.1346
evaluate time cost:4.688020467758179s
clients training time cost:4.50626540184021s
attn_optimize time cost:0.41292738914489746s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3334, 0.3332, 0.3334],
        [0.3334, 0.3332, 0.3334],
        [0.3334, 0.3332, 0.3334]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.2000, 0.1999, 0.1999, 0.2001],
        [0.2001, 0.2000, 0.1999, 0.1999, 0.2001],
        [0.2001, 0.2000, 0.1999, 0.1999, 0.2001],
        [0.2001, 0.2000, 0.1999, 0.1999, 0.2001],
        [0.2001, 0.2000, 0.1999, 0.1999, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2000, 0.2000, 0.2000, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2001],
        [0.2000, 0.2000, 0.2000, 0.2000, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.264240026473999s
iter time cost:10.027595520019531s
-------------Round number: 25-------------
Evaluate global model
[running kmeans]: 5it [00:00, 384.26it/s, center_shift=0.000071, iteration=5, tol=0.000100]
Averaged Train Loss: 0.6609
Averaged Test Accurancy: 0.7479
Std Test Accurancy: 0.1544
evaluate time cost:4.610333681106567s
[running kmeans]: 9it [00:00, 390.95it/s, center_shift=0.000000, iteration=9, tol=0.000100]
clients training time cost:4.528047800064087s
attn_optimize time cost:0.43395566940307617s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28826212882995605s
iter time cost:9.958291053771973s
-------------Round number: 26-------------
Evaluate global model
Averaged Train Loss: 0.7694
Averaged Test Accurancy: 0.7389
Std Test Accurancy: 0.1261
evaluate time cost:4.727926015853882s
[running kmeans]: 8it [00:00, 380.60it/s, center_shift=0.000000, iteration=8, tol=0.000100]
clients training time cost:4.411480903625488s
attn_optimize time cost:0.456998348236084s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.2000, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.2000, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.2000, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.2000, 0.1999, 0.2000, 0.2000, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0770, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2902638912200928s
iter time cost:9.992764711380005s
-------------Round number: 27-------------
Evaluate global model
Averaged Train Loss: 0.6936
Averaged Test Accurancy: 0.7522
Std Test Accurancy: 0.1380
evaluate time cost:4.8972790241241455s
clients training time cost:4.84359073638916s
attn_optimize time cost:0.6514565944671631s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
[running kmeans]: 7it [00:00, 333.05it/s, center_shift=0.000084, iteration=7, tol=0.000100]
weights:tensor([[0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1428, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3002736568450928s
iter time cost:10.782270908355713s
-------------Round number: 28-------------
Evaluate global model
Averaged Train Loss: 0.7354
Averaged Test Accurancy: 0.7359
Std Test Accurancy: 0.1165
evaluate time cost:4.8442299365997314s
clients training time cost:4.481198310852051s
attn_optimize time cost:0.425961971282959s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2500, 0.2502, 0.2499, 0.2500],
        [0.2500, 0.2502, 0.2499, 0.2500],
        [0.2500, 0.2502, 0.2499, 0.2500],
        [0.2500, 0.2502, 0.2499, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 3it [00:00, 374.67it/s, center_shift=0.000000, iteration=3, tol=0.000100]
weights:tensor([[0.1427, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1427, 0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429],
        [0.1427, 0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429],
        [0.1427, 0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429],
        [0.1427, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1427, 0.1429, 0.1429, 0.1430, 0.1428, 0.1428, 0.1429],
        [0.1427, 0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3335, 0.3333, 0.3332],
        [0.3335, 0.3333, 0.3332],
        [0.3335, 0.3333, 0.3332]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2783925533294678s
iter time cost:10.12186598777771s
-------------Round number: 29-------------
Evaluate global model
Averaged Train Loss: 0.7911
Averaged Test Accurancy: 0.7320
Std Test Accurancy: 0.1258
evaluate time cost:4.672478914260864s
clients training time cost:4.574292898178101s
attn_optimize time cost:0.49553537368774414s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2502, 0.2500, 0.2501, 0.2497],
        [0.2502, 0.2500, 0.2501, 0.2497],
        [0.2502, 0.2500, 0.2501, 0.2497],
        [0.2502, 0.2500, 0.2501, 0.2496]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3333, 0.3335, 0.3332],
        [0.3333, 0.3335, 0.3332],
        [0.3333, 0.3335, 0.3332]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 5it [00:00, 356.83it/s, center_shift=0.000000, iteration=5, tol=0.000100]
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27825260162353516s
iter time cost:10.127655982971191s
-------------Round number: 30-------------
Evaluate global model
Averaged Train Loss: 0.7080
Averaged Test Accurancy: 0.7461
Std Test Accurancy: 0.1274
evaluate time cost:4.695964813232422s
clients training time cost:4.530944585800171s
attn_optimize time cost:0.4840505123138428s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1999, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.1999, 0.2000, 0.2000, 0.2000, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2501, 0.2499, 0.2500, 0.2501],
        [0.2501, 0.2499, 0.2500, 0.2501],
        [0.2501, 0.2499, 0.2500, 0.2501],
        [0.2501, 0.2499, 0.2500, 0.2501]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3331, 0.3332, 0.3337],
        [0.3331, 0.3333, 0.3337],
        [0.3331, 0.3332, 0.3337]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1667, 0.1667, 0.1667, 0.1667, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
[running kmeans]: 3it [00:00, 333.02it/s, center_shift=0.000073, iteration=3, tol=0.000100]
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0768, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0768, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0768, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0768, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0768, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0768, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0768, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0768, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0768, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0768, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0768, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28682661056518555s
iter time cost:10.099879026412964s
-------------Round number: 31-------------
Evaluate global model
Averaged Train Loss: 0.6012
Averaged Test Accurancy: 0.7689
Std Test Accurancy: 0.1265
evaluate time cost:4.747379779815674s
clients training time cost:4.498559951782227s
[running kmeans]: 3it [00:00, 374.67it/s, center_shift=0.000000, iteration=3, tol=0.000100]
attn_optimize time cost:0.4522879123687744s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2500, 0.2500, 0.2500, 0.2500],
        [0.2500, 0.2500, 0.2500, 0.2500],
        [0.2500, 0.2500, 0.2500, 0.2500],
        [0.2500, 0.2500, 0.2500, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1245]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1112, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1113],
        [0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1113],
        [0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1113],
        [0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1113],
        [0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1667, 0.1666, 0.1668, 0.1666, 0.1666],
        [0.1666, 0.1667, 0.1666, 0.1668, 0.1666, 0.1666],
        [0.1666, 0.1667, 0.1666, 0.1668, 0.1666, 0.1666],
        [0.1666, 0.1667, 0.1666, 0.1668, 0.1666, 0.1666],
        [0.1666, 0.1667, 0.1666, 0.1668, 0.1666, 0.1666],
        [0.1666, 0.1667, 0.1666, 0.1668, 0.1666, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2567882537841797s
iter time cost:10.052104711532593s
-------------Round number: 32-------------
Evaluate global model
Averaged Train Loss: 0.6580
Averaged Test Accurancy: 0.7598
Std Test Accurancy: 0.1256
evaluate time cost:4.526949882507324s
clients training time cost:4.357966899871826s
attn_optimize time cost:0.41878747940063477s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2499, 0.2501, 0.2497],
        [0.2502, 0.2499, 0.2501, 0.2497],
        [0.2503, 0.2500, 0.2501, 0.2497],
        [0.2503, 0.2500, 0.2501, 0.2496]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1246],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1245]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.1999, 0.2000, 0.1999, 0.2000],
        [0.2001, 0.1999, 0.2000, 0.1999, 0.2000],
        [0.2001, 0.1999, 0.2000, 0.1999, 0.2000],
        [0.2001, 0.1999, 0.2000, 0.1999, 0.2000],
        [0.2001, 0.1999, 0.2000, 0.1999, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3332, 0.3334, 0.3334],
        [0.3332, 0.3334, 0.3334],
        [0.3332, 0.3334, 0.3334]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2742493152618408s
iter time cost:9.66603398323059s
-------------Round number: 33-------------
Evaluate global model
[running kmeans]: 5it [00:00, 416.29it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 0.5940
Averaged Test Accurancy: 0.7699
Std Test Accurancy: 0.0964
evaluate time cost:4.577287435531616s
clients training time cost:4.432720899581909s
attn_optimize time cost:0.44698572158813477s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1427, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1667, 0.1666, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27184128761291504s
iter time cost:9.834932804107666s
-------------Round number: 34-------------
Evaluate global model
[running kmeans]: 7it [00:00, 368.09it/s, center_shift=0.000077, iteration=7, tol=0.000100]
Averaged Train Loss: 0.8084
Averaged Test Accurancy: 0.7504
Std Test Accurancy: 0.1175
evaluate time cost:4.484899044036865s
clients training time cost:4.4885029792785645s
attn_optimize time cost:0.4450399875640869s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2000, 0.2000, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1245],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1245],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1245],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1245],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1245],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1245],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1245],
        [0.1251, 0.1250, 0.1251, 0.1250, 0.1251, 0.1251, 0.1251, 0.1245]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1665, 0.1666, 0.1668, 0.1667],
        [0.1667, 0.1667, 0.1665, 0.1666, 0.1668, 0.1667],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1667],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1667],
        [0.1667, 0.1667, 0.1665, 0.1666, 0.1668, 0.1667],
        [0.1667, 0.1667, 0.1665, 0.1666, 0.1668, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431],
        [0.1429, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.25881266593933105s
iter time cost:9.77934741973877s
-------------Round number: 35-------------
Evaluate global model
[running kmeans]: 9it [00:00, 390.96it/s, center_shift=0.000077, iteration=9, tol=0.000100]
Averaged Train Loss: 0.8016
Averaged Test Accurancy: 0.7395
Std Test Accurancy: 0.1244
evaluate time cost:4.588246822357178s
[running kmeans]: 8it [00:00, 399.66it/s, center_shift=0.000000, iteration=8, tol=0.000100]
clients training time cost:4.35351824760437s
attn_optimize time cost:0.416928768157959s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1667, 0.1666, 0.1668, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1666, 0.1668, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1666, 0.1668, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1666, 0.1668, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1666, 0.1668, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1666, 0.1668, 0.1666, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3333, 0.3334, 0.3333],
        [0.3333, 0.3334, 0.3333],
        [0.3333, 0.3334, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.30786561965942383s
iter time cost:9.771653890609741s
-------------Round number: 36-------------
Evaluate global model
Averaged Train Loss: 0.6439
Averaged Test Accurancy: 0.7505
Std Test Accurancy: 0.1230
evaluate time cost:4.5270774364471436s
[running kmeans]: 4it [00:00, 363.30it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:4.411052942276001s
attn_optimize time cost:0.4918334484100342s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0909, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1428, 0.1430, 0.1430, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1428, 0.1430, 0.1430, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1428, 0.1430, 0.1430, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1428, 0.1430, 0.1430, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1428, 0.1430, 0.1430, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1428, 0.1430, 0.1430, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1428, 0.1430, 0.1430, 0.1429, 0.1430, 0.1423]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26624131202697754s
iter time cost:9.79629635810852s
-------------Round number: 37-------------
Evaluate global model
Averaged Train Loss: 0.7000
Averaged Test Accurancy: 0.7422
Std Test Accurancy: 0.1229
evaluate time cost:4.5405189990997314s
clients training time cost:4.415518283843994s
[running kmeans]: 3it [00:00, 374.67it/s, center_shift=0.000073, iteration=3, tol=0.000100]
attn_optimize time cost:0.42794132232666016s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3336, 0.3331, 0.3333],
        [0.3336, 0.3331, 0.3333],
        [0.3336, 0.3331, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1427, 0.1428, 0.1428, 0.1428, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1428, 0.1428, 0.1428, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1428, 0.1428, 0.1428, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1428, 0.1428, 0.1428, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1428, 0.1428, 0.1428, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1428, 0.1428, 0.1428, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1428, 0.1428, 0.1428, 0.1432]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3332, 0.3334, 0.3334],
        [0.3332, 0.3334, 0.3334],
        [0.3332, 0.3334, 0.3334]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2692434787750244s
iter time cost:9.741860628128052s
-------------Round number: 38-------------
Evaluate global model
Averaged Train Loss: 0.6414
Averaged Test Accurancy: 0.7548
Std Test Accurancy: 0.1318
evaluate time cost:4.476154327392578s
clients training time cost:4.410149574279785s
attn_optimize time cost:0.4269402027130127s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2498, 0.2501, 0.2500, 0.2502],
        [0.2498, 0.2501, 0.2500, 0.2502],
        [0.2498, 0.2501, 0.2500, 0.2502],
        [0.2498, 0.2501, 0.2500, 0.2502]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4999, 0.5001],
        [0.4999, 0.5001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4999, 0.5001],
        [0.5000, 0.5000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5001, 0.4999],
        [0.5001, 0.4999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0250],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0250],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0250],
        ...,
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0250],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0250],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 3it [00:00, 374.65it/s, center_shift=0.000000, iteration=3, tol=0.000100]
intra_cluster_agg time cost:0.3399202823638916s
iter time cost:9.74324655532837s
-------------Round number: 39-------------
Evaluate global model
Averaged Train Loss: 0.7147
Averaged Test Accurancy: 0.7582
Std Test Accurancy: 0.1185
evaluate time cost:4.52588152885437s
clients training time cost:4.413618087768555s
attn_optimize time cost:0.6338174343109131s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2000, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.2000, 0.1999, 0.2001, 0.2000, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0713,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1667, 0.1667, 0.1666, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1666, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1666, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1666, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1666, 0.1666, 0.1668],
        [0.1666, 0.1667, 0.1667, 0.1666, 0.1666, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1428, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1428, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1428, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1428, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1428, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1428, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1428, 0.1427, 0.1428, 0.1429, 0.1432]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1000, 0.1001, 0.0999, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.23321151733398438s
iter time cost:9.904619216918945s
-------------Round number: 40-------------
Evaluate global model
[running kmeans]: 3it [00:00, 374.67it/s, center_shift=0.000000, iteration=3, tol=0.000100]
Averaged Train Loss: 0.5975
Averaged Test Accurancy: 0.7556
Std Test Accurancy: 0.1039
evaluate time cost:4.477596282958984s
clients training time cost:4.407843351364136s
attn_optimize time cost:0.37793898582458496s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2001, 0.2000, 0.2000, 0.1998, 0.2002],
        [0.2001, 0.2000, 0.2000, 0.1998, 0.2001],
        [0.2001, 0.2000, 0.2000, 0.1998, 0.2001],
        [0.2001, 0.2000, 0.2000, 0.1998, 0.2002],
        [0.2001, 0.2000, 0.2000, 0.1998, 0.2002]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2498, 0.2500, 0.2502, 0.2500],
        [0.2498, 0.2500, 0.2502, 0.2500],
        [0.2498, 0.2500, 0.2502, 0.2500],
        [0.2498, 0.2500, 0.2502, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.30486202239990234s
iter time cost:9.660324096679688s
-------------Round number: 41-------------
Evaluate global model
[running kmeans]: 6it [00:00, 374.66it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 0.5656
Averaged Test Accurancy: 0.7707
Std Test Accurancy: 0.1101
evaluate time cost:4.528254985809326s
clients training time cost:4.3994855880737305s
attn_optimize time cost:0.5011019706726074s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.2000, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.2000, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.2000, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.2000, 0.1999, 0.2001, 0.2000, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1428, 0.1429, 0.1430, 0.1428, 0.1427, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1430, 0.1428, 0.1427, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1430, 0.1428, 0.1427, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1430, 0.1428, 0.1427, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1430, 0.1428, 0.1427, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1430, 0.1428, 0.1427, 0.1430],
        [0.1428, 0.1428, 0.1429, 0.1430, 0.1428, 0.1427, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1429, 0.1430, 0.1429, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1429, 0.1430, 0.1429, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1429, 0.1430, 0.1429, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1429, 0.1430, 0.1429, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1429, 0.1430, 0.1429, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1429, 0.1430, 0.1429, 0.1429, 0.1430, 0.1423],
        [0.1430, 0.1429, 0.1430, 0.1429, 0.1430, 0.1430, 0.1423]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.25823450088500977s
iter time cost:9.78116226196289s
-------------Round number: 42-------------
Evaluate global model
[running kmeans]: 3it [00:00, 374.59it/s, center_shift=0.000093, iteration=3, tol=0.000100]
Averaged Train Loss: 0.6006
Averaged Test Accurancy: 0.7705
Std Test Accurancy: 0.1096
evaluate time cost:4.493928909301758s
[running kmeans]: 3it [00:00, 333.02it/s, center_shift=0.000032, iteration=3, tol=0.000100]
clients training time cost:4.395209789276123s
attn_optimize time cost:0.42104363441467285s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2501, 0.2499, 0.2500],
        [0.2500, 0.2501, 0.2499, 0.2500],
        [0.2500, 0.2501, 0.2499, 0.2500],
        [0.2500, 0.2501, 0.2499, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2497, 0.2501, 0.2500, 0.2502],
        [0.2497, 0.2501, 0.2500, 0.2502],
        [0.2497, 0.2501, 0.2500, 0.2502],
        [0.2497, 0.2501, 0.2499, 0.2502]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.2000, 0.1998, 0.1999, 0.2001],
        [0.2001, 0.2000, 0.1998, 0.1999, 0.2001],
        [0.2001, 0.2000, 0.1998, 0.1999, 0.2001],
        [0.2001, 0.2000, 0.1998, 0.1999, 0.2001],
        [0.2001, 0.2000, 0.1998, 0.1999, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2938404083251953s
iter time cost:9.686096668243408s
-------------Round number: 43-------------
Evaluate global model
Averaged Train Loss: 0.6325
Averaged Test Accurancy: 0.7681
Std Test Accurancy: 0.1074
evaluate time cost:4.632361888885498s
clients training time cost:4.531907081604004s
[running kmeans]: 7it [00:00, 368.09it/s, center_shift=0.000000, iteration=7, tol=0.000100]
attn_optimize time cost:0.6251451969146729s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1666, 0.1666, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1666, 0.1666, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1666, 0.1666, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1666, 0.1666, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1666, 0.1666, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1666, 0.1666, 0.1667, 0.1667, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0715, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0715, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0715, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0715, 0.0714, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0714]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1666, 0.1668, 0.1668, 0.1665, 0.1666],
        [0.1667, 0.1666, 0.1668, 0.1668, 0.1665, 0.1666],
        [0.1667, 0.1666, 0.1668, 0.1668, 0.1665, 0.1666],
        [0.1667, 0.1666, 0.1668, 0.1668, 0.1665, 0.1666],
        [0.1667, 0.1666, 0.1668, 0.1668, 0.1665, 0.1666],
        [0.1667, 0.1666, 0.1668, 0.1668, 0.1665, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1669, 0.1666, 0.1668, 0.1668, 0.1669, 0.1660],
        [0.1669, 0.1666, 0.1668, 0.1668, 0.1669, 0.1660],
        [0.1669, 0.1666, 0.1668, 0.1668, 0.1669, 0.1660],
        [0.1669, 0.1666, 0.1668, 0.1668, 0.1669, 0.1660],
        [0.1669, 0.1666, 0.1668, 0.1668, 0.1669, 0.1660],
        [0.1669, 0.1666, 0.1669, 0.1668, 0.1669, 0.1660]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1429, 0.1428, 0.1430, 0.1428, 0.1430, 0.1428],
        [0.1427, 0.1429, 0.1428, 0.1430, 0.1428, 0.1430, 0.1428],
        [0.1427, 0.1429, 0.1428, 0.1430, 0.1428, 0.1430, 0.1428],
        [0.1427, 0.1429, 0.1428, 0.1430, 0.1428, 0.1430, 0.1428],
        [0.1427, 0.1429, 0.1428, 0.1430, 0.1428, 0.1430, 0.1428],
        [0.1427, 0.1429, 0.1428, 0.1430, 0.1428, 0.1430, 0.1428],
        [0.1427, 0.1429, 0.1428, 0.1430, 0.1428, 0.1430, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1428, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26183629035949707s
iter time cost:10.153342247009277s
-------------Round number: 44-------------
Evaluate global model
Averaged Train Loss: 0.5400
Averaged Test Accurancy: 0.7758
Std Test Accurancy: 0.1093
evaluate time cost:4.452145576477051s
clients training time cost:4.95747709274292s
attn_optimize time cost:0.5640602111816406s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.23721599578857422s
iter time cost:10.301981687545776s
-------------Round number: 45-------------
Evaluate global model
[running kmeans]: 7it [00:00, 388.54it/s, center_shift=0.000075, iteration=7, tol=0.000100]
Averaged Train Loss: 0.5509
Averaged Test Accurancy: 0.7718
Std Test Accurancy: 0.1200
evaluate time cost:4.596544981002808s
clients training time cost:5.041795492172241s
attn_optimize time cost:0.6371476650238037s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0250, 0.0249, 0.0250,  ..., 0.0251, 0.0250, 0.0251],
        [0.0250, 0.0249, 0.0250,  ..., 0.0251, 0.0250, 0.0251],
        [0.0250, 0.0249, 0.0250,  ..., 0.0251, 0.0250, 0.0251],
        ...,
        [0.0250, 0.0249, 0.0250,  ..., 0.0251, 0.0250, 0.0251],
        [0.0250, 0.0249, 0.0250,  ..., 0.0251, 0.0250, 0.0251],
        [0.0250, 0.0249, 0.0250,  ..., 0.0251, 0.0250, 0.0251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4998, 0.5002],
        [0.4998, 0.5002]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2499, 0.2501, 0.2498],
        [0.2503, 0.2499, 0.2501, 0.2498],
        [0.2503, 0.2499, 0.2501, 0.2498],
        [0.2503, 0.2500, 0.2501, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4997, 0.5003],
        [0.4997, 0.5003]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1251, 0.1245],
        [0.1251, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1251, 0.1245],
        [0.1251, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1251, 0.1245],
        [0.1251, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1251, 0.1245],
        [0.1251, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1251, 0.1245],
        [0.1251, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1251, 0.1245],
        [0.1251, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1251, 0.1245],
        [0.1251, 0.1251, 0.1250, 0.1251, 0.1251, 0.1250, 0.1251, 0.1244]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2748095989227295s
iter time cost:10.632372379302979s
-------------Round number: 46-------------
Evaluate global model
[running kmeans]: 6it [00:00, 352.62it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 0.5377
Averaged Test Accurancy: 0.7798
Std Test Accurancy: 0.1364
evaluate time cost:4.520898342132568s
clients training time cost:4.550185680389404s
attn_optimize time cost:0.7008030414581299s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432],
        [0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1432]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.0999, 0.1000, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2000, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2000, 0.2000, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2452223300933838s
iter time cost:10.120759010314941s
-------------Round number: 47-------------
Evaluate global model
[running kmeans]: 6it [00:00, 362.09it/s, center_shift=0.000081, iteration=6, tol=0.000100]
Averaged Train Loss: 0.6248
Averaged Test Accurancy: 0.7741
Std Test Accurancy: 0.1152
evaluate time cost:4.431067705154419s
clients training time cost:4.8523712158203125s
attn_optimize time cost:0.4795870780944824s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1666, 0.1668, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1666, 0.1668, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1666, 0.1668, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1666, 0.1668, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1666, 0.1668, 0.1667, 0.1666, 0.1666],
        [0.1667, 0.1666, 0.1668, 0.1667, 0.1666, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1665, 0.1666, 0.1669, 0.1666, 0.1666, 0.1668],
        [0.1665, 0.1666, 0.1669, 0.1666, 0.1665, 0.1668],
        [0.1665, 0.1666, 0.1669, 0.1666, 0.1665, 0.1668],
        [0.1665, 0.1666, 0.1669, 0.1666, 0.1666, 0.1668],
        [0.1665, 0.1666, 0.1669, 0.1666, 0.1666, 0.1668],
        [0.1665, 0.1666, 0.1669, 0.1666, 0.1665, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1666, 0.1668, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0715, 0.0714, 0.0714, 0.0714, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0715]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.34231066703796387s
iter time cost:10.237456560134888s
-------------Round number: 48-------------
Evaluate global model
[running kmeans]: 4it [00:00, 285.45it/s, center_shift=0.000000, iteration=4, tol=0.000100]
Averaged Train Loss: 0.4899
Averaged Test Accurancy: 0.7888
Std Test Accurancy: 0.1114
evaluate time cost:4.616822719573975s
clients training time cost:4.662047624588013s
attn_optimize time cost:0.4659719467163086s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
[running kmeans]: 4it [00:00, 285.45it/s, center_shift=0.000000, iteration=4, tol=0.000100]
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2499, 0.2501, 0.2498],
        [0.2503, 0.2499, 0.2500, 0.2498],
        [0.2503, 0.2499, 0.2501, 0.2498],
        [0.2503, 0.2500, 0.2501, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1668, 0.1666, 0.1666, 0.1666, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2868208885192871s
iter time cost:10.114738941192627s
-------------Round number: 49-------------
Evaluate global model
Averaged Train Loss: 0.4794
Averaged Test Accurancy: 0.7903
Std Test Accurancy: 0.1007
evaluate time cost:4.6302125453948975s
clients training time cost:4.8380913734436035s
[running kmeans]: 4it [00:00, 363.28it/s, center_shift=0.000000, iteration=4, tol=0.000100]
attn_optimize time cost:0.4740872383117676s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909, 0.0910,
         0.0908, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1428, 0.1428, 0.1431, 0.1428, 0.1428, 0.1429],
        [0.1428, 0.1428, 0.1428, 0.1431, 0.1429, 0.1428, 0.1429],
        [0.1428, 0.1428, 0.1428, 0.1431, 0.1429, 0.1428, 0.1429],
        [0.1428, 0.1428, 0.1428, 0.1431, 0.1429, 0.1428, 0.1429],
        [0.1428, 0.1428, 0.1428, 0.1431, 0.1429, 0.1428, 0.1429],
        [0.1428, 0.1428, 0.1428, 0.1431, 0.1429, 0.1428, 0.1429],
        [0.1428, 0.1428, 0.1428, 0.1431, 0.1428, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27124691009521484s
iter time cost:10.317732810974121s
-------------Round number: 50-------------
Evaluate global model
Averaged Train Loss: 0.6544
Averaged Test Accurancy: 0.7699
Std Test Accurancy: 0.1067
evaluate time cost:4.594928741455078s
clients training time cost:4.777575731277466s
[running kmeans]: 6it [00:00, 285.46it/s, center_shift=0.000000, iteration=6, tol=0.000100]
attn_optimize time cost:0.60514235496521s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1428],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1428],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2499, 0.2501, 0.2498],
        [0.2502, 0.2499, 0.2500, 0.2498],
        [0.2503, 0.2499, 0.2500, 0.2498],
        [0.2503, 0.2500, 0.2501, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1112, 0.1111, 0.1112, 0.1111, 0.1112, 0.1112, 0.1112, 0.1112, 0.1106],
        [0.1112, 0.1111, 0.1112, 0.1111, 0.1112, 0.1112, 0.1112, 0.1112, 0.1106],
        [0.1112, 0.1111, 0.1112, 0.1111, 0.1112, 0.1112, 0.1112, 0.1112, 0.1106],
        [0.1112, 0.1111, 0.1112, 0.1111, 0.1112, 0.1112, 0.1112, 0.1112, 0.1106],
        [0.1112, 0.1111, 0.1112, 0.1111, 0.1112, 0.1112, 0.1112, 0.1112, 0.1106],
        [0.1112, 0.1111, 0.1112, 0.1111, 0.1112, 0.1112, 0.1112, 0.1112, 0.1106],
        [0.1112, 0.1111, 0.1112, 0.1111, 0.1112, 0.1112, 0.1112, 0.1112, 0.1106],
        [0.1112, 0.1111, 0.1112, 0.1111, 0.1112, 0.1112, 0.1112, 0.1112, 0.1106],
        [0.1112, 0.1111, 0.1112, 0.1111, 0.1112, 0.1112, 0.1112, 0.1112, 0.1106]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.34231066703796387s
iter time cost:10.407587766647339s
-------------Round number: 51-------------
Evaluate global model
Averaged Train Loss: 0.5363
Averaged Test Accurancy: 0.7863
Std Test Accurancy: 0.1013
evaluate time cost:4.370195627212524s
clients training time cost:4.814467906951904s
[running kmeans]: 6it [00:00, 399.65it/s, center_shift=0.000095, iteration=6, tol=0.000100]
attn_optimize time cost:0.4445464611053467s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1000],
        [0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000, 0.0999, 0.1001,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2499, 0.2501, 0.2498],
        [0.2502, 0.2499, 0.2501, 0.2498],
        [0.2503, 0.2499, 0.2501, 0.2498],
        [0.2503, 0.2500, 0.2501, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5001, 0.4999],
        [0.5001, 0.4999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1426, 0.1429, 0.1429, 0.1430, 0.1428, 0.1428, 0.1430],
        [0.1426, 0.1429, 0.1429, 0.1430, 0.1428, 0.1428, 0.1431],
        [0.1426, 0.1429, 0.1429, 0.1430, 0.1428, 0.1428, 0.1430],
        [0.1427, 0.1429, 0.1429, 0.1430, 0.1428, 0.1428, 0.1431],
        [0.1426, 0.1429, 0.1429, 0.1430, 0.1428, 0.1428, 0.1430],
        [0.1426, 0.1429, 0.1429, 0.1430, 0.1428, 0.1428, 0.1430],
        [0.1427, 0.1429, 0.1429, 0.1430, 0.1428, 0.1428, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429],
        [0.1429, 0.1427, 0.1428, 0.1429, 0.1429, 0.1429, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1111, 0.1110, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1111, 0.1110, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1111, 0.1110, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1111, 0.1110, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1111, 0.1110, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1111, 0.1110, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1111, 0.1110, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1111, 0.1110, 0.1112],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1111, 0.1110, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.272247314453125s
iter time cost:9.996384859085083s
-------------Round number: 52-------------
Evaluate global model
Averaged Train Loss: 0.5398
Averaged Test Accurancy: 0.7796
Std Test Accurancy: 0.1117
evaluate time cost:4.634624242782593s
clients training time cost:4.587081670761108s
[running kmeans]: 6it [00:00, 352.62it/s, center_shift=0.000000, iteration=6, tol=0.000100]
attn_optimize time cost:0.5630972385406494s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1666, 0.1666, 0.1669, 0.1667, 0.1666],
        [0.1666, 0.1666, 0.1666, 0.1669, 0.1667, 0.1666],
        [0.1666, 0.1666, 0.1666, 0.1669, 0.1667, 0.1666],
        [0.1666, 0.1666, 0.1666, 0.1669, 0.1667, 0.1666],
        [0.1666, 0.1666, 0.1666, 0.1669, 0.1667, 0.1666],
        [0.1666, 0.1666, 0.1666, 0.1669, 0.1667, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2499, 0.2500, 0.2498],
        [0.2503, 0.2499, 0.2500, 0.2498],
        [0.2503, 0.2499, 0.2500, 0.2498],
        [0.2503, 0.2499, 0.2501, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1250, 0.1249, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3142855167388916s
iter time cost:10.220796585083008s
-------------Round number: 53-------------
Evaluate global model
Averaged Train Loss: 0.5841
Averaged Test Accurancy: 0.7721
Std Test Accurancy: 0.1085
evaluate time cost:4.461129188537598s
clients training time cost:4.59727931022644s
[running kmeans]: 4it [00:00, 399.64it/s, center_shift=0.000000, iteration=4, tol=0.000100]
attn_optimize time cost:0.43823862075805664s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1668, 0.1666, 0.1667, 0.1668, 0.1666],
        [0.1666, 0.1668, 0.1666, 0.1667, 0.1668, 0.1666],
        [0.1666, 0.1668, 0.1666, 0.1667, 0.1668, 0.1666],
        [0.1666, 0.1668, 0.1666, 0.1666, 0.1668, 0.1666],
        [0.1666, 0.1668, 0.1666, 0.1667, 0.1668, 0.1666],
        [0.1666, 0.1668, 0.1666, 0.1667, 0.1668, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2001, 0.2002, 0.1998, 0.1999],
        [0.2000, 0.2001, 0.2002, 0.1998, 0.1999],
        [0.2000, 0.2001, 0.2002, 0.1998, 0.1999],
        [0.2000, 0.2001, 0.2002, 0.1998, 0.1999],
        [0.2000, 0.2001, 0.2002, 0.1998, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2502269744873047s
iter time cost:9.842961549758911s
-------------Round number: 54-------------
Evaluate global model
Averaged Train Loss: 0.4486
Averaged Test Accurancy: 0.7953
Std Test Accurancy: 0.1040
evaluate time cost:4.659709692001343s
clients training time cost:4.752086162567139s
[running kmeans]: 3it [00:00, 333.02it/s, center_shift=0.000000, iteration=3, tol=0.000100]
attn_optimize time cost:0.4500916004180908s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3333, 0.3337, 0.3330],
        [0.3333, 0.3337, 0.3330],
        [0.3333, 0.3337, 0.3330]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1251, 0.1249, 0.1250, 0.1251, 0.1250, 0.1251, 0.1249],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1251, 0.1250, 0.1251, 0.1250],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1251, 0.1250, 0.1251, 0.1250],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1251, 0.1250, 0.1251, 0.1250],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1251, 0.1250, 0.1251, 0.1250],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1251, 0.1250, 0.1251, 0.1249],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1251, 0.1250, 0.1251, 0.1249],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1251, 0.1250, 0.1251, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2499, 0.2501, 0.2498],
        [0.2502, 0.2499, 0.2500, 0.2498],
        [0.2503, 0.2499, 0.2501, 0.2498],
        [0.2503, 0.2500, 0.2501, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3158423900604248s
iter time cost:10.285827875137329s
-------------Round number: 55-------------
Evaluate global model
Averaged Train Loss: 0.4667
Averaged Test Accurancy: 0.7911
Std Test Accurancy: 0.0978
evaluate time cost:4.40983510017395s
clients training time cost:4.536725282669067s
attn_optimize time cost:0.46788477897644043s
running k-means on cuda..
[running kmeans]: 5it [00:00, 384.27it/s, center_shift=0.000000, iteration=5, tol=0.000100]
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1251, 0.1249, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1249, 0.1251, 0.1249, 0.1250, 0.1250, 0.1250, 0.1250, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3331, 0.3333, 0.3336],
        [0.3331, 0.3333, 0.3336],
        [0.3331, 0.3333, 0.3336]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1431],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1431],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1431],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1431],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1430],
        [0.1427, 0.1428, 0.1428, 0.1430, 0.1429, 0.1428, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1428, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2000, 0.2000, 0.2001, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2001, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2001, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2001, 0.2000],
        [0.2000, 0.2000, 0.2000, 0.2001, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.23421287536621094s
iter time cost:9.73573637008667s
-------------Round number: 56-------------
Evaluate global model
Averaged Train Loss: 0.4532
Averaged Test Accurancy: 0.7935
Std Test Accurancy: 0.0935
evaluate time cost:4.70903754234314s
clients training time cost:4.837713718414307s
[running kmeans]: 3it [00:00, 333.03it/s, center_shift=0.000000, iteration=3, tol=0.000100]
attn_optimize time cost:0.3877677917480469s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2499, 0.2500, 0.2500, 0.2501],
        [0.2499, 0.2500, 0.2500, 0.2501],
        [0.2499, 0.2500, 0.2500, 0.2501],
        [0.2499, 0.2500, 0.2500, 0.2501]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4999, 0.5001],
        [0.4999, 0.5001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2499, 0.2501, 0.2499, 0.2501],
        [0.2499, 0.2501, 0.2499, 0.2501],
        [0.2499, 0.2501, 0.2499, 0.2501],
        [0.2499, 0.2501, 0.2499, 0.2501]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5001, 0.4999],
        [0.5001, 0.4999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.33286499977111816s
iter time cost:10.361470699310303s
-------------Round number: 57-------------
Evaluate global model
Averaged Train Loss: 0.5235
Averaged Test Accurancy: 0.7747
Std Test Accurancy: 0.0933
evaluate time cost:4.5976972579956055s
clients training time cost:4.608880519866943s
attn_optimize time cost:0.7162396907806396s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0834],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0834, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5000, 0.5000],
        [0.5000, 0.5000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2502, 0.2498, 0.2499, 0.2501],
        [0.2502, 0.2498, 0.2499, 0.2501],
        [0.2502, 0.2498, 0.2499, 0.2501],
        [0.2502, 0.2498, 0.2499, 0.2501]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2657942771911621s
iter time cost:10.268685102462769s
-------------Round number: 58-------------
Evaluate global model
[running kmeans]: 3it [00:00, 299.73it/s, center_shift=0.000000, iteration=3, tol=0.000100]
Averaged Train Loss: 0.4986
Averaged Test Accurancy: 0.7828
Std Test Accurancy: 0.0944
evaluate time cost:4.703911542892456s
clients training time cost:5.01017427444458s
attn_optimize time cost:0.5950863361358643s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.4998, 0.5002],
        [0.4998, 0.5002]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1428],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1428],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1430, 0.1430, 0.1427, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3268589973449707s
iter time cost:10.742127895355225s
-------------Round number: 59-------------
Evaluate global model
[running kmeans]: 3it [00:00, 374.66it/s, center_shift=0.000000, iteration=3, tol=0.000100]
Averaged Train Loss: 0.4088
Averaged Test Accurancy: 0.8012
Std Test Accurancy: 0.0865
evaluate time cost:4.475163459777832s
clients training time cost:4.931185722351074s
attn_optimize time cost:0.6862080097198486s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1667, 0.1665, 0.1664, 0.1665, 0.1667, 0.1672],
        [0.1667, 0.1665, 0.1664, 0.1665, 0.1667, 0.1672],
        [0.1667, 0.1665, 0.1664, 0.1665, 0.1666, 0.1672],
        [0.1667, 0.1665, 0.1664, 0.1665, 0.1667, 0.1672],
        [0.1667, 0.1665, 0.1664, 0.1665, 0.1667, 0.1672],
        [0.1667, 0.1665, 0.1664, 0.1665, 0.1666, 0.1672]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1429, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1428, 0.1428, 0.1430, 0.1428, 0.1427, 0.1431],
        [0.1428, 0.1428, 0.1428, 0.1430, 0.1428, 0.1427, 0.1431],
        [0.1428, 0.1428, 0.1428, 0.1430, 0.1428, 0.1427, 0.1431],
        [0.1428, 0.1428, 0.1428, 0.1430, 0.1428, 0.1427, 0.1431],
        [0.1428, 0.1428, 0.1428, 0.1430, 0.1428, 0.1427, 0.1431],
        [0.1428, 0.1428, 0.1428, 0.1430, 0.1428, 0.1427, 0.1430],
        [0.1428, 0.1428, 0.1428, 0.1430, 0.1428, 0.1427, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4997, 0.5003],
        [0.4997, 0.5003]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.2000, 0.2001, 0.1999, 0.2001],
        [0.1999, 0.2000, 0.2001, 0.1999, 0.2001],
        [0.1999, 0.2000, 0.2001, 0.1999, 0.2001],
        [0.1999, 0.2000, 0.2001, 0.1999, 0.2001],
        [0.1999, 0.2000, 0.2001, 0.1999, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3463141918182373s
iter time cost:10.528501749038696s
-------------Round number: 60-------------
Evaluate global model
[running kmeans]: 3it [00:00, 428.19it/s, center_shift=0.000006, iteration=3, tol=0.000100]
Averaged Train Loss: 0.4679
Averaged Test Accurancy: 0.7908
Std Test Accurancy: 0.1035
evaluate time cost:4.3930230140686035s
clients training time cost:5.030289649963379s
[running kmeans]: 4it [00:00, 363.32it/s, center_shift=0.000000, iteration=4, tol=0.000100]
attn_optimize time cost:0.6341331005096436s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2499, 0.2500, 0.2501, 0.2500],
        [0.2499, 0.2500, 0.2501, 0.2500],
        [0.2499, 0.2501, 0.2501, 0.2500],
        [0.2499, 0.2500, 0.2501, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1249, 0.1249, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1249, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1249, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1249, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1249, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1249, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1249, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1249, 0.1249, 0.1250, 0.1250, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1667, 0.1668, 0.1664, 0.1665, 0.1669],
        [0.1666, 0.1667, 0.1669, 0.1664, 0.1665, 0.1669],
        [0.1666, 0.1667, 0.1669, 0.1664, 0.1665, 0.1669],
        [0.1666, 0.1667, 0.1669, 0.1664, 0.1665, 0.1669],
        [0.1666, 0.1667, 0.1668, 0.1664, 0.1665, 0.1669],
        [0.1666, 0.1667, 0.1668, 0.1664, 0.1665, 0.1669]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2499, 0.2501, 0.2498],
        [0.2503, 0.2498, 0.2500, 0.2498],
        [0.2503, 0.2499, 0.2500, 0.2498],
        [0.2503, 0.2499, 0.2501, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.25979089736938477s
iter time cost:10.436344385147095s
-------------Round number: 61-------------
Evaluate global model
Averaged Train Loss: 0.4308
Averaged Test Accurancy: 0.8001
Std Test Accurancy: 0.0904
evaluate time cost:4.579247236251831s
clients training time cost:4.710919380187988s
[running kmeans]: 4it [00:00, 333.04it/s, center_shift=0.000000, iteration=4, tol=0.000100]
attn_optimize time cost:0.45641422271728516s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2503, 0.2498, 0.2501, 0.2498],
        [0.2503, 0.2498, 0.2500, 0.2498],
        [0.2503, 0.2499, 0.2501, 0.2498],
        [0.2503, 0.2499, 0.2501, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.0999,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1665, 0.1666, 0.1668, 0.1667, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3398911952972412s
iter time cost:10.206132173538208s
-------------Round number: 62-------------
Evaluate global model
Averaged Train Loss: 0.4515
Averaged Test Accurancy: 0.7836
Std Test Accurancy: 0.0948
evaluate time cost:4.475498676300049s
clients training time cost:4.473076820373535s
attn_optimize time cost:0.4389643669128418s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1999, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2001, 0.2000, 0.2001],
        [0.1999, 0.1999, 0.2001, 0.2000, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1666, 0.1664, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1664, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1664, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1664, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1664, 0.1666, 0.1668, 0.1668],
        [0.1667, 0.1666, 0.1664, 0.1666, 0.1668, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0909, 0.0910, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0908, 0.0910],
        [0.0908, 0.0909, 0.0910, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0908, 0.0909, 0.0910, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0908, 0.0909, 0.0910, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0908, 0.0909, 0.0910, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0908, 0.0910],
        [0.0908, 0.0909, 0.0910, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0908, 0.0910],
        [0.0908, 0.0909, 0.0910, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0908, 0.0910],
        [0.0908, 0.0909, 0.0910, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0908, 0.0910],
        [0.0908, 0.0909, 0.0910, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0908, 0.0910],
        [0.0908, 0.0909, 0.0910, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0910],
        [0.0908, 0.0909, 0.0910, 0.0910, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909,
         0.0908, 0.0910]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1110, 0.1112, 0.1110, 0.1111, 0.1112, 0.1113, 0.1111, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1110, 0.1111, 0.1112, 0.1113, 0.1111, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1110, 0.1111, 0.1112, 0.1113, 0.1111, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1110, 0.1111, 0.1112, 0.1113, 0.1111, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1110, 0.1111, 0.1112, 0.1113, 0.1111, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1110, 0.1111, 0.1112, 0.1113, 0.1111, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1110, 0.1111, 0.1112, 0.1113, 0.1111, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1110, 0.1111, 0.1112, 0.1113, 0.1111, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1110, 0.1111, 0.1112, 0.1113, 0.1111, 0.1110, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 5it [00:00, 312.22it/s, center_shift=0.000000, iteration=5, tol=0.000100]
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2552213668823242s
iter time cost:9.762868881225586s
-------------Round number: 63-------------
Evaluate global model
Averaged Train Loss: 0.4476
Averaged Test Accurancy: 0.7954
Std Test Accurancy: 0.0882
evaluate time cost:4.661482095718384s
clients training time cost:4.646196603775024s
attn_optimize time cost:0.43939924240112305s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1665, 0.1666, 0.1669, 0.1666, 0.1665, 0.1669],
        [0.1665, 0.1666, 0.1669, 0.1666, 0.1665, 0.1669],
        [0.1665, 0.1666, 0.1669, 0.1666, 0.1665, 0.1669],
        [0.1665, 0.1666, 0.1669, 0.1666, 0.1666, 0.1669],
        [0.1665, 0.1666, 0.1669, 0.1666, 0.1665, 0.1669],
        [0.1665, 0.1666, 0.1669, 0.1666, 0.1665, 0.1669]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.1999, 0.1999, 0.1999, 0.2001],
        [0.2001, 0.1999, 0.1999, 0.1999, 0.2001],
        [0.2001, 0.1999, 0.1999, 0.1999, 0.2001],
        [0.2001, 0.1999, 0.1999, 0.1999, 0.2001],
        [0.2001, 0.1999, 0.1999, 0.1999, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0908, 0.0909,
         0.0910, 0.0908]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428],
        [0.1429, 0.1430, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        ...,
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0251,  ..., 0.0249, 0.0250, 0.0249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 5it [00:00, 333.03it/s, center_shift=0.000000, iteration=5, tol=0.000100]
weights:tensor([[0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995],
        [0.1001, 0.0999, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1001,
         0.0995]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1110, 0.1112, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3218529224395752s
iter time cost:10.169020652770996s
-------------Round number: 64-------------
Evaluate global model
Averaged Train Loss: 0.4545
Averaged Test Accurancy: 0.7991
Std Test Accurancy: 0.0936
evaluate time cost:4.361076831817627s
clients training time cost:4.429682970046997s
attn_optimize time cost:0.6474604606628418s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1251, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251],
        [0.1249, 0.1251, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2500, 0.2501, 0.2499],
        [0.2500, 0.2500, 0.2501, 0.2500],
        [0.2500, 0.2500, 0.2501, 0.2499],
        [0.2500, 0.2500, 0.2501, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0526, 0.0526, 0.0527, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2497859001159668s
iter time cost:9.785094261169434s
-------------Round number: 65-------------
Evaluate global model
[running kmeans]: 4it [00:00, 399.65it/s, center_shift=0.000000, iteration=4, tol=0.000100]
Averaged Train Loss: 0.4486
Averaged Test Accurancy: 0.7857
Std Test Accurancy: 0.0949
evaluate time cost:4.679173707962036s
clients training time cost:4.595331907272339s
attn_optimize time cost:0.5050866603851318s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
[running kmeans]: 7it [00:00, 411.40it/s, center_shift=0.000088, iteration=7, tol=0.000100]
weights:tensor([[0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.1000, 0.1000, 0.0999,
         0.1002],
        [0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.1000, 0.1000, 0.0999,
         0.1002],
        [0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.1000, 0.1000, 0.0999,
         0.1002],
        [0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.1000, 0.1000, 0.0999,
         0.1002],
        [0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.1000, 0.1000, 0.0999,
         0.1002],
        [0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.1000, 0.1000, 0.0999,
         0.1002],
        [0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.1000, 0.1000, 0.0999,
         0.1002],
        [0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.1000, 0.1000, 0.0999,
         0.1002],
        [0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.1000, 0.1000, 0.0999,
         0.1002],
        [0.0999, 0.1000, 0.1001, 0.1002, 0.1000, 0.0999, 0.1000, 0.1000, 0.0999,
         0.1002]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2498, 0.2501, 0.2498],
        [0.2503, 0.2498, 0.2500, 0.2498],
        [0.2503, 0.2498, 0.2500, 0.2498],
        [0.2503, 0.2499, 0.2501, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1434],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1434],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1434],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1434],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1434]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770],
        [0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999, 0.1000, 0.0999,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999, 0.1000, 0.0999,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999, 0.1000, 0.0999,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999, 0.1000, 0.0999,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.0999,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999, 0.1000, 0.0999,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999, 0.1000, 0.0999,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001, 0.0999, 0.1000, 0.0999,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999, 0.1000, 0.0999,
         0.1000],
        [0.0999, 0.1000, 0.0999, 0.1000, 0.1001, 0.1002, 0.0999, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1428, 0.1428, 0.1431, 0.1428, 0.1427, 0.1431],
        [0.1427, 0.1428, 0.1428, 0.1431, 0.1428, 0.1427, 0.1431],
        [0.1427, 0.1428, 0.1428, 0.1431, 0.1428, 0.1428, 0.1431],
        [0.1427, 0.1428, 0.1428, 0.1431, 0.1428, 0.1427, 0.1431],
        [0.1427, 0.1428, 0.1428, 0.1431, 0.1428, 0.1428, 0.1431],
        [0.1427, 0.1428, 0.1428, 0.1431, 0.1428, 0.1427, 0.1431],
        [0.1427, 0.1428, 0.1428, 0.1431, 0.1428, 0.1427, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1430, 0.1429, 0.1427, 0.1428, 0.1427, 0.1430],
        [0.1429, 0.1430, 0.1429, 0.1427, 0.1428, 0.1427, 0.1429],
        [0.1429, 0.1430, 0.1429, 0.1427, 0.1428, 0.1427, 0.1430],
        [0.1429, 0.1430, 0.1429, 0.1427, 0.1428, 0.1427, 0.1430],
        [0.1429, 0.1430, 0.1429, 0.1427, 0.1428, 0.1427, 0.1430],
        [0.1429, 0.1430, 0.1429, 0.1427, 0.1428, 0.1427, 0.1430],
        [0.1429, 0.1430, 0.1429, 0.1427, 0.1428, 0.1427, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1110, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.25978922843933105s
iter time cost:10.140473365783691s
-------------Round number: 66-------------
Evaluate global model
Averaged Train Loss: 0.3988
Averaged Test Accurancy: 0.8013
Std Test Accurancy: 0.0804
evaluate time cost:4.529138088226318s
clients training time cost:4.799079656600952s
attn_optimize time cost:0.42694759368896484s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 3it [00:00, 374.67it/s, center_shift=0.000000, iteration=3, tol=0.000100]
weights:tensor([[0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428],
        [0.1428, 0.1429, 0.1429, 0.1429, 0.1428, 0.1429, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2500, 0.2499, 0.2500],
        [0.2500, 0.2500, 0.2499, 0.2500],
        [0.2500, 0.2500, 0.2499, 0.2500],
        [0.2500, 0.2500, 0.2499, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3336, 0.3331, 0.3333],
        [0.3336, 0.3331, 0.3333],
        [0.3336, 0.3331, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2499, 0.2498, 0.2503],
        [0.2500, 0.2499, 0.2498, 0.2503],
        [0.2500, 0.2499, 0.2498, 0.2503],
        [0.2500, 0.2499, 0.2498, 0.2503]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27625083923339844s
iter time cost:10.112096786499023s
-------------Round number: 67-------------
Evaluate global model
Averaged Train Loss: 0.4259
Averaged Test Accurancy: 0.8010
Std Test Accurancy: 0.0865
evaluate time cost:4.692462682723999s
clients training time cost:4.801636457443237s
attn_optimize time cost:0.6087305545806885s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2498, 0.2500, 0.2498],
        [0.2503, 0.2498, 0.2500, 0.2498],
        [0.2503, 0.2498, 0.2500, 0.2498],
        [0.2503, 0.2499, 0.2501, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668],
        [0.0666, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668,
         0.0666, 0.0666, 0.0667, 0.0667, 0.0666, 0.0668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769],
        [0.0769, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2497, 0.2500, 0.2499, 0.2504],
        [0.2497, 0.2500, 0.2499, 0.2504],
        [0.2497, 0.2500, 0.2499, 0.2504],
        [0.2497, 0.2500, 0.2499, 0.2504]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1434],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1434],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433],
        [0.1429, 0.1427, 0.1427, 0.1427, 0.1428, 0.1429, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.23921751976013184s
iter time cost:10.431127786636353s
-------------Round number: 68-------------
Evaluate global model
[running kmeans]: 6it [00:00, 428.19it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 0.4054
Averaged Test Accurancy: 0.8092
Std Test Accurancy: 0.0882
