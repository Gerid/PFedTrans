============= Running time: 0th =============
Creating server and clients ...
DNN(
  (fc1): Linear(in_features=3072, out_features=100, bias=True)
  (fc): Linear(in_features=100, out_features=10, bias=True)
)
Join ratio / total clients: 1.0 / 100
Finished creating server and clients.
-------------Round number: 0-------------
Evaluate global model
Averaged Train Loss: 4.1251
Averaged Test Accurancy: 0.0995
Std Test Accurancy: 0.2408
evaluate time cost:5.995303630828857s
clients training time cost:5.085556268692017s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
form_cluster time cost:0.027023792266845703s
weights:tensor([[0.1428, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429],
        [0.1428, 0.1429, 0.1429, 0.1428, 0.1428, 0.1429, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0833, 0.0835]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250],
        [0.1250, 0.1250, 0.1250, 0.1250, 0.1250, 0.1249, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110],
        [0.1111, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0765]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.40192532539367676s
iter time cost:11.605896711349487s
-------------Round number: 1-------------
Evaluate global model
[running kmeans]: 3it [00:00, 199.82it/s, center_shift=0.000032, iteration=3, tol=0.000100]
Averaged Train Loss: 2.9455
Averaged Test Accurancy: 0.5291
Std Test Accurancy: 0.1768
evaluate time cost:5.001585960388184s
clients training time cost:5.119906425476074s
attn_optimize time cost:0.4378976821899414s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1428, 0.1428, 0.1429],
        [0.1429, 0.1428, 0.1429, 0.1428, 0.1429, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.2000, 0.2000, 0.2000, 0.1999],
        [0.2001, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.2000, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.2000, 0.2000, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        ...,
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1248, 0.1251, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1248, 0.1251, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1248, 0.1251, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1248, 0.1251, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1248, 0.1251, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1248, 0.1252, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1249, 0.1251, 0.1251],
        [0.1251, 0.1250, 0.1249, 0.1250, 0.1250, 0.1248, 0.1251, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.1999, 0.2000, 0.2001, 0.1999],
        [0.2000, 0.1999, 0.2000, 0.2001, 0.1999],
        [0.2000, 0.1999, 0.2000, 0.2001, 0.1999],
        [0.2000, 0.1999, 0.2000, 0.2001, 0.1999],
        [0.2000, 0.1999, 0.2000, 0.2001, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2000, 0.2001, 0.2000, 0.1999],
        [0.1999, 0.2000, 0.2001, 0.2000, 0.1999],
        [0.2000, 0.2000, 0.2001, 0.2000, 0.1999],
        [0.1999, 0.2000, 0.2001, 0.2000, 0.1999],
        [0.2000, 0.2000, 0.2001, 0.2000, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2499, 0.2503, 0.2497, 0.2501],
        [0.2499, 0.2503, 0.2497, 0.2501],
        [0.2499, 0.2503, 0.2497, 0.2501],
        [0.2499, 0.2503, 0.2497, 0.2501]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2002, 0.2003, 0.2002, 0.2003, 0.1990],
        [0.2002, 0.2003, 0.2002, 0.2003, 0.1990],
        [0.2002, 0.2003, 0.2002, 0.2003, 0.1990],
        [0.2002, 0.2003, 0.2002, 0.2003, 0.1990],
        [0.2002, 0.2003, 0.2002, 0.2003, 0.1991]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3886067867279053s
iter time cost:11.077114582061768s
-------------Round number: 2-------------
Evaluate global model
[running kmeans]: 5it [00:00, 416.30it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 2.4887
Averaged Test Accurancy: 0.5626
Std Test Accurancy: 0.1774
evaluate time cost:4.972089529037476s
clients training time cost:4.983180999755859s
attn_optimize time cost:0.6671657562255859s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1667, 0.1667, 0.1666, 0.1666, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1111],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0999, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001,
         0.1000],
        [0.0999, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001,
         0.1000],
        [0.0999, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001,
         0.1000],
        [0.0999, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001,
         0.1000],
        [0.0999, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001,
         0.1000],
        [0.0999, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001,
         0.1000],
        [0.0999, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001,
         0.1000],
        [0.0999, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001,
         0.1000],
        [0.0999, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001,
         0.1000],
        [0.0999, 0.1000, 0.1001, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2502, 0.2499, 0.2500, 0.2500],
        [0.2502, 0.2499, 0.2500, 0.2500],
        [0.2502, 0.2499, 0.2500, 0.2500],
        [0.2502, 0.2499, 0.2500, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2501, 0.2499, 0.2500],
        [0.2500, 0.2501, 0.2499, 0.2500],
        [0.2500, 0.2501, 0.2499, 0.2500],
        [0.2500, 0.2501, 0.2499, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1668, 0.1667, 0.1667, 0.1667, 0.1664],
        [0.1667, 0.1668, 0.1667, 0.1667, 0.1667, 0.1665],
        [0.1667, 0.1668, 0.1667, 0.1667, 0.1667, 0.1665],
        [0.1667, 0.1668, 0.1667, 0.1667, 0.1667, 0.1664],
        [0.1667, 0.1668, 0.1667, 0.1667, 0.1667, 0.1664],
        [0.1667, 0.1668, 0.1667, 0.1667, 0.1667, 0.1664]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0496],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0496],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0496],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0496],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0495],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0496],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0496],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0496],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0496],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0496],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.32488179206848145s
iter time cost:11.025388717651367s
-------------Round number: 3-------------
Evaluate global model
[running kmeans]: 6it [00:00, 399.63it/s, center_shift=0.000082, iteration=6, tol=0.000100]
Averaged Train Loss: 2.8076
Averaged Test Accurancy: 0.5550
Std Test Accurancy: 0.1773
evaluate time cost:5.777891159057617s
clients training time cost:4.955265522003174s
attn_optimize time cost:0.47764086723327637s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.3328, 0.3329, 0.3343],
        [0.3328, 0.3329, 0.3343],
        [0.3328, 0.3329, 0.3343]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0587, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0588, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0588, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0588, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0587, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0587, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0588, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0588, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0588, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0587, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0587, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0588, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0587, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0588, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0587, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0588, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589],
        [0.0588, 0.0588, 0.0588, 0.0589, 0.0589, 0.0588, 0.0589, 0.0588, 0.0588,
         0.0588, 0.0588, 0.0588, 0.0589, 0.0588, 0.0589, 0.0588, 0.0589]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769],
        [0.0770, 0.0769, 0.0769, 0.0770, 0.0770, 0.0770, 0.0769, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428, 0.1432],
        [0.1427, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428, 0.1432],
        [0.1427, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428, 0.1432],
        [0.1427, 0.1428, 0.1427, 0.1429, 0.1428, 0.1428, 0.1432],
        [0.1427, 0.1428, 0.1428, 0.1429, 0.1428, 0.1428, 0.1432],
        [0.1427, 0.1428, 0.1428, 0.1429, 0.1429, 0.1428, 0.1432],
        [0.1427, 0.1427, 0.1427, 0.1429, 0.1428, 0.1428, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1000, 0.1001, 0.0999,
         0.1002],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1001, 0.0999,
         0.1002],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1001, 0.0999,
         0.1002],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1001, 0.0999,
         0.1002],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1001, 0.0999,
         0.1001],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1000, 0.1001, 0.0999,
         0.1002],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1001, 0.0999,
         0.1002],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1001, 0.0999,
         0.1002],
        [0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1000, 0.1001, 0.0999,
         0.1002],
        [0.1000, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1000, 0.1001, 0.0999,
         0.1002]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.0999, 0.1001, 0.0999, 0.0999, 0.0999, 0.1001, 0.1000, 0.1001,
         0.1001],
        [0.1000, 0.0999, 0.1001, 0.0999, 0.0999, 0.0999, 0.1001, 0.1000, 0.1001,
         0.1001],
        [0.1000, 0.0999, 0.1001, 0.0999, 0.0999, 0.0999, 0.1001, 0.1000, 0.1001,
         0.1001],
        [0.1000, 0.0999, 0.1001, 0.0999, 0.0999, 0.0999, 0.1001, 0.1000, 0.1001,
         0.1000],
        [0.1000, 0.0999, 0.1001, 0.0999, 0.0999, 0.0999, 0.1001, 0.1000, 0.1001,
         0.1000],
        [0.1000, 0.0999, 0.1001, 0.0999, 0.0999, 0.0999, 0.1001, 0.1000, 0.1001,
         0.1000],
        [0.1000, 0.0999, 0.1001, 0.0999, 0.0999, 0.0999, 0.1001, 0.1000, 0.1001,
         0.1001],
        [0.1000, 0.0999, 0.1001, 0.0999, 0.0999, 0.0999, 0.1001, 0.1000, 0.1001,
         0.1001],
        [0.1000, 0.0999, 0.1001, 0.0999, 0.0999, 0.0999, 0.1001, 0.1000, 0.1001,
         0.1001],
        [0.1000, 0.0999, 0.1001, 0.0999, 0.0999, 0.0999, 0.1001, 0.1000, 0.1001,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1252, 0.1252, 0.1248, 0.1248, 0.1250, 0.1251, 0.1247],
        [0.1251, 0.1252, 0.1252, 0.1248, 0.1248, 0.1250, 0.1251, 0.1247],
        [0.1251, 0.1252, 0.1252, 0.1248, 0.1248, 0.1250, 0.1251, 0.1247],
        [0.1251, 0.1252, 0.1252, 0.1248, 0.1248, 0.1250, 0.1251, 0.1247],
        [0.1251, 0.1252, 0.1252, 0.1248, 0.1248, 0.1250, 0.1251, 0.1247],
        [0.1251, 0.1252, 0.1252, 0.1248, 0.1248, 0.1250, 0.1251, 0.1247],
        [0.1251, 0.1252, 0.1252, 0.1248, 0.1248, 0.1250, 0.1251, 0.1247],
        [0.1251, 0.1252, 0.1252, 0.1248, 0.1248, 0.1250, 0.1251, 0.1247]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2692446708679199s
iter time cost:11.565119504928589s
-------------Round number: 4-------------
Evaluate global model
[running kmeans]: 6it [00:00, 315.50it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 3.4684
Averaged Test Accurancy: 0.5209
Std Test Accurancy: 0.1729
evaluate time cost:5.434908390045166s
clients training time cost:5.07393479347229s
attn_optimize time cost:0.6028273105621338s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0998, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0998, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0998, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0998, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0998, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0998, 0.0999, 0.1000,
         0.1000],
        [0.1001, 0.1001, 0.1000, 0.1000, 0.1002, 0.1000, 0.0998, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0998, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0998, 0.0999, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1000, 0.1000, 0.1001, 0.1000, 0.0998, 0.0999, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1002, 0.1000, 0.0998, 0.1002, 0.1000, 0.0999, 0.1001, 0.1001,
         0.0996],
        [0.1000, 0.1002, 0.1000, 0.0998, 0.1002, 0.1000, 0.0999, 0.1001, 0.1001,
         0.0997],
        [0.1000, 0.1002, 0.1000, 0.0998, 0.1002, 0.1000, 0.0999, 0.1001, 0.1001,
         0.0996],
        [0.1000, 0.1002, 0.1000, 0.0998, 0.1002, 0.1000, 0.0999, 0.1001, 0.1001,
         0.0996],
        [0.1000, 0.1002, 0.1000, 0.0998, 0.1002, 0.1000, 0.0999, 0.1001, 0.1001,
         0.0997],
        [0.1000, 0.1002, 0.1000, 0.0998, 0.1002, 0.1000, 0.0999, 0.1001, 0.1001,
         0.0997],
        [0.1000, 0.1002, 0.1000, 0.0998, 0.1002, 0.1000, 0.0999, 0.1001, 0.1001,
         0.0996],
        [0.1000, 0.1002, 0.1000, 0.0998, 0.1002, 0.1000, 0.0999, 0.1001, 0.1001,
         0.0997],
        [0.1000, 0.1002, 0.1000, 0.0998, 0.1002, 0.1000, 0.0999, 0.1001, 0.1001,
         0.0997],
        [0.1000, 0.1002, 0.1000, 0.0998, 0.1002, 0.1000, 0.0999, 0.1001, 0.1001,
         0.0997]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1114],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1113],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1113],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1114],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1114],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1114],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1114],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1114],
        [0.1110, 0.1109, 0.1112, 0.1111, 0.1111, 0.1112, 0.1110, 0.1111, 0.1114]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000],
        [0.0999, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0908, 0.0910, 0.0911, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0910, 0.0911, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0910, 0.0911, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0910, 0.0910, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0910, 0.0910, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0910, 0.0910, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0910, 0.0910, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0910, 0.0910, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0910, 0.0910, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0910, 0.0910, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0908, 0.0910, 0.0910, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1110, 0.1111],
        [0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1110, 0.1111],
        [0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1110, 0.1111],
        [0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1110, 0.1111],
        [0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1110, 0.1111],
        [0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1111, 0.1112, 0.1110, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0587, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0588, 0.0588, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0587, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0587, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0588, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0588, 0.0588, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0588, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0587, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0587, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0587, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590],
        [0.0588, 0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0587, 0.0589, 0.0589,
         0.0588, 0.0589, 0.0588, 0.0587, 0.0588, 0.0588, 0.0589, 0.0590]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3330, 0.3332, 0.3338],
        [0.3330, 0.3332, 0.3338],
        [0.3331, 0.3332, 0.3337]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.35651063919067383s
iter time cost:11.608309030532837s
-------------Round number: 5-------------
Evaluate global model
[running kmeans]: 11it [00:00, 366.33it/s, center_shift=0.000000, iteration=11, tol=0.000100]
Averaged Train Loss: 3.3967
Averaged Test Accurancy: 0.5528
Std Test Accurancy: 0.1790
evaluate time cost:5.035404920578003s
clients training time cost:4.8651134967803955s
attn_optimize time cost:0.5151665210723877s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1249, 0.1252, 0.1251, 0.1248, 0.1248, 0.1251, 0.1249, 0.1251],
        [0.1249, 0.1252, 0.1251, 0.1248, 0.1248, 0.1251, 0.1249, 0.1251],
        [0.1249, 0.1252, 0.1251, 0.1248, 0.1248, 0.1251, 0.1249, 0.1251],
        [0.1249, 0.1252, 0.1251, 0.1248, 0.1248, 0.1251, 0.1249, 0.1251],
        [0.1249, 0.1252, 0.1251, 0.1248, 0.1248, 0.1251, 0.1249, 0.1251],
        [0.1249, 0.1252, 0.1251, 0.1248, 0.1248, 0.1251, 0.1249, 0.1251],
        [0.1249, 0.1252, 0.1251, 0.1248, 0.1248, 0.1251, 0.1249, 0.1251],
        [0.1249, 0.1252, 0.1251, 0.1248, 0.1248, 0.1251, 0.1249, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0832, 0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0831, 0.0831, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0831, 0.0831, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0832, 0.0831, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0832, 0.0831, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0831, 0.0831, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0832, 0.0832, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0831, 0.0831, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0831, 0.0831, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0832, 0.0831, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0832, 0.0831, 0.0833],
        [0.0832, 0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0832, 0.0831, 0.0833],
        [0.0833, 0.0833, 0.0834, 0.0835, 0.0834, 0.0834, 0.0834, 0.0834, 0.0834,
         0.0832, 0.0831, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0910, 0.0908],
        [0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909, 0.0909, 0.0910, 0.0910,
         0.0910, 0.0908],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0910, 0.0908],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0910, 0.0908],
        [0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909, 0.0909, 0.0910, 0.0910,
         0.0910, 0.0908],
        [0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909, 0.0909, 0.0910, 0.0910,
         0.0910, 0.0908],
        [0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909, 0.0909, 0.0910, 0.0910,
         0.0910, 0.0908],
        [0.0909, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909, 0.0909, 0.0910, 0.0910,
         0.0910, 0.0908],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0910, 0.0908]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0910, 0.0908, 0.0908, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0908, 0.0908, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0908, 0.0908, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0908, 0.0908, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0908, 0.0908, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0908, 0.0908, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0908, 0.0908, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0908, 0.0908, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0908, 0.0908, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0908, 0.0908, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0909],
        [0.0908, 0.0910, 0.0908, 0.0908, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1251, 0.1250, 0.1250, 0.1251, 0.1248, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1251, 0.1248, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1251, 0.1248, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1251, 0.1248, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1251, 0.1248, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250],
        [0.1251, 0.1251, 0.1250, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1253, 0.1251, 0.1247],
        [0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1253, 0.1251, 0.1247],
        [0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1252, 0.1251, 0.1247],
        [0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1253, 0.1251, 0.1247],
        [0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1253, 0.1251, 0.1247],
        [0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1252, 0.1251, 0.1247],
        [0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1252, 0.1251, 0.1247],
        [0.1250, 0.1250, 0.1252, 0.1249, 0.1249, 0.1252, 0.1251, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.37187719345092773s
iter time cost:10.925687074661255s
-------------Round number: 6-------------
Evaluate global model
[running kmeans]: 4it [00:00, 266.43it/s, center_shift=0.000000, iteration=4, tol=0.000100]
Averaged Train Loss: 2.9998
Averaged Test Accurancy: 0.5650
Std Test Accurancy: 0.1700
evaluate time cost:5.284368991851807s
clients training time cost:4.8833537101745605s
attn_optimize time cost:0.7242250442504883s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1249, 0.1250, 0.1250, 0.1251, 0.1249, 0.1249, 0.1251, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1249, 0.1249, 0.1251, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1249, 0.1249, 0.1251, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250],
        [0.1249, 0.1250, 0.1250, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1669, 0.1666, 0.1666, 0.1668, 0.1666, 0.1666],
        [0.1669, 0.1666, 0.1666, 0.1668, 0.1666, 0.1666],
        [0.1669, 0.1667, 0.1666, 0.1668, 0.1666, 0.1666],
        [0.1669, 0.1666, 0.1666, 0.1668, 0.1666, 0.1666],
        [0.1669, 0.1667, 0.1666, 0.1668, 0.1666, 0.1666],
        [0.1669, 0.1667, 0.1666, 0.1668, 0.1666, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1668, 0.1667, 0.1666, 0.1667, 0.1667, 0.1665],
        [0.1668, 0.1667, 0.1667, 0.1667, 0.1667, 0.1665],
        [0.1668, 0.1667, 0.1667, 0.1667, 0.1667, 0.1665],
        [0.1668, 0.1667, 0.1666, 0.1667, 0.1667, 0.1665],
        [0.1668, 0.1667, 0.1666, 0.1667, 0.1667, 0.1665],
        [0.1668, 0.1666, 0.1666, 0.1667, 0.1667, 0.1665]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0910, 0.0909, 0.0910, 0.0910, 0.0910, 0.0909, 0.0911, 0.0907, 0.0906,
         0.0909, 0.0910],
        [0.0910, 0.0909, 0.0910, 0.0910, 0.0910, 0.0909, 0.0911, 0.0907, 0.0907,
         0.0909, 0.0910],
        [0.0910, 0.0909, 0.0910, 0.0910, 0.0910, 0.0909, 0.0911, 0.0907, 0.0906,
         0.0909, 0.0910],
        [0.0910, 0.0909, 0.0910, 0.0910, 0.0910, 0.0909, 0.0911, 0.0907, 0.0906,
         0.0909, 0.0910],
        [0.0910, 0.0909, 0.0910, 0.0910, 0.0910, 0.0909, 0.0911, 0.0907, 0.0907,
         0.0909, 0.0910],
        [0.0910, 0.0909, 0.0910, 0.0910, 0.0910, 0.0909, 0.0911, 0.0907, 0.0907,
         0.0909, 0.0910],
        [0.0910, 0.0909, 0.0910, 0.0910, 0.0910, 0.0909, 0.0911, 0.0907, 0.0906,
         0.0909, 0.0910],
        [0.0910, 0.0909, 0.0910, 0.0910, 0.0910, 0.0909, 0.0911, 0.0907, 0.0906,
         0.0909, 0.0910],
        [0.0910, 0.0909, 0.0910, 0.0910, 0.0910, 0.0909, 0.0911, 0.0907, 0.0906,
         0.0909, 0.0910],
        [0.0910, 0.0909, 0.0910, 0.0910, 0.0910, 0.0909, 0.0911, 0.0907, 0.0906,
         0.0909, 0.0910],
        [0.0910, 0.0909, 0.0910, 0.0910, 0.0910, 0.0909, 0.0911, 0.0907, 0.0906,
         0.0909, 0.0910]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 6it [00:00, 299.74it/s, center_shift=0.000000, iteration=6, tol=0.000100]
weights:tensor([[0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0250],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0250],
        ...,
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0250, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0250, 0.0249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0772, 0.0770, 0.0769, 0.0768, 0.0771, 0.0767, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0767, 0.0769],
        [0.0769, 0.0772, 0.0770, 0.0769, 0.0768, 0.0770, 0.0767, 0.0770, 0.0770,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0769, 0.0771, 0.0770, 0.0769, 0.0768, 0.0771, 0.0768, 0.0770, 0.0770,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0769, 0.0771, 0.0770, 0.0769, 0.0768, 0.0771, 0.0767, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0767, 0.0769],
        [0.0769, 0.0772, 0.0770, 0.0769, 0.0768, 0.0771, 0.0767, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0767, 0.0769],
        [0.0769, 0.0771, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0770,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0769, 0.0771, 0.0770, 0.0769, 0.0768, 0.0771, 0.0767, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0767, 0.0769],
        [0.0769, 0.0771, 0.0770, 0.0769, 0.0768, 0.0771, 0.0767, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0767, 0.0769],
        [0.0769, 0.0772, 0.0770, 0.0769, 0.0768, 0.0771, 0.0767, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0767, 0.0769],
        [0.0769, 0.0771, 0.0770, 0.0769, 0.0768, 0.0771, 0.0768, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0769, 0.0771, 0.0770, 0.0769, 0.0768, 0.0771, 0.0768, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0767, 0.0769],
        [0.0769, 0.0772, 0.0770, 0.0769, 0.0768, 0.0771, 0.0767, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0767, 0.0769],
        [0.0769, 0.0772, 0.0770, 0.0769, 0.0768, 0.0771, 0.0767, 0.0770, 0.0769,
         0.0770, 0.0769, 0.0767, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.2001, 0.2000, 0.1999, 0.1999],
        [0.2001, 0.2001, 0.2000, 0.1999, 0.1999],
        [0.2001, 0.2001, 0.2000, 0.1999, 0.1999],
        [0.2001, 0.2001, 0.2000, 0.1999, 0.1999],
        [0.2001, 0.2001, 0.2000, 0.1999, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1110, 0.1112, 0.1109, 0.1113, 0.1111, 0.1111, 0.1110, 0.1112, 0.1112],
        [0.1110, 0.1112, 0.1109, 0.1113, 0.1111, 0.1112, 0.1110, 0.1112, 0.1111],
        [0.1110, 0.1112, 0.1109, 0.1113, 0.1111, 0.1111, 0.1110, 0.1112, 0.1112],
        [0.1110, 0.1112, 0.1109, 0.1113, 0.1111, 0.1112, 0.1110, 0.1112, 0.1111],
        [0.1110, 0.1112, 0.1109, 0.1113, 0.1111, 0.1112, 0.1110, 0.1112, 0.1111],
        [0.1110, 0.1112, 0.1109, 0.1113, 0.1111, 0.1111, 0.1110, 0.1112, 0.1112],
        [0.1110, 0.1112, 0.1109, 0.1113, 0.1111, 0.1111, 0.1110, 0.1112, 0.1112],
        [0.1110, 0.1112, 0.1109, 0.1113, 0.1111, 0.1112, 0.1110, 0.1112, 0.1111],
        [0.1110, 0.1112, 0.1109, 0.1113, 0.1111, 0.1112, 0.1110, 0.1112, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.6371476650238037s
iter time cost:11.679231405258179s
-------------Round number: 7-------------
Evaluate global model
Averaged Train Loss: 3.2363
Averaged Test Accurancy: 0.5903
Std Test Accurancy: 0.1881
evaluate time cost:5.04893684387207s
clients training time cost:4.9596638679504395s
attn_optimize time cost:0.6330316066741943s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0908, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0908, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0908, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0908, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0908, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0908, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0910, 0.0908, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0910, 0.0908, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0908, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0910, 0.0908, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0910, 0.0908, 0.0908, 0.0909,
         0.0909, 0.0911]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0908, 0.0908],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0908, 0.0908],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0908, 0.0908],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1670, 0.1664, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1670, 0.1664, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1670, 0.1664, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1670, 0.1664, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1670, 0.1664, 0.1666, 0.1666, 0.1667, 0.1667],
        [0.1670, 0.1664, 0.1666, 0.1666, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1112, 0.1108, 0.1110, 0.1110, 0.1113, 0.1109, 0.1112, 0.1112, 0.1114],
        [0.1112, 0.1108, 0.1110, 0.1110, 0.1113, 0.1109, 0.1112, 0.1112, 0.1114],
        [0.1112, 0.1108, 0.1110, 0.1110, 0.1113, 0.1109, 0.1112, 0.1112, 0.1114],
        [0.1112, 0.1108, 0.1110, 0.1110, 0.1113, 0.1109, 0.1112, 0.1113, 0.1114],
        [0.1112, 0.1108, 0.1110, 0.1110, 0.1113, 0.1109, 0.1112, 0.1113, 0.1114],
        [0.1112, 0.1108, 0.1110, 0.1110, 0.1113, 0.1109, 0.1112, 0.1112, 0.1114],
        [0.1112, 0.1108, 0.1110, 0.1110, 0.1113, 0.1109, 0.1112, 0.1112, 0.1114],
        [0.1112, 0.1108, 0.1110, 0.1110, 0.1113, 0.1109, 0.1112, 0.1113, 0.1114],
        [0.1112, 0.1107, 0.1110, 0.1110, 0.1113, 0.1109, 0.1113, 0.1113, 0.1113]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1250, 0.1251, 0.1251, 0.1249, 0.1250, 0.1249, 0.1250, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0716,
         0.0714, 0.0713, 0.0714, 0.0715, 0.0711],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715,
         0.0714, 0.0713, 0.0714, 0.0715, 0.0711],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0716,
         0.0714, 0.0713, 0.0714, 0.0715, 0.0710],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0716,
         0.0714, 0.0713, 0.0714, 0.0715, 0.0710],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0716,
         0.0714, 0.0713, 0.0714, 0.0715, 0.0710],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0716,
         0.0714, 0.0713, 0.0714, 0.0715, 0.0710],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715,
         0.0714, 0.0713, 0.0715, 0.0715, 0.0710],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0716,
         0.0714, 0.0713, 0.0715, 0.0715, 0.0710],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715,
         0.0714, 0.0713, 0.0715, 0.0715, 0.0711],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0716,
         0.0714, 0.0713, 0.0714, 0.0715, 0.0710],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0716,
         0.0714, 0.0713, 0.0714, 0.0715, 0.0710],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0716,
         0.0714, 0.0713, 0.0714, 0.0715, 0.0710],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0714, 0.0715, 0.0715, 0.0715,
         0.0714, 0.0713, 0.0715, 0.0715, 0.0710],
        [0.0715, 0.0716, 0.0714, 0.0715, 0.0714, 0.0713, 0.0715, 0.0715, 0.0716,
         0.0713, 0.0713, 0.0714, 0.0715, 0.0712]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.34289121627807617s
iter time cost:11.070603370666504s
-------------Round number: 8-------------
Evaluate global model
[running kmeans]: 5it [00:00, 293.85it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 3.0472
Averaged Test Accurancy: 0.6206
Std Test Accurancy: 0.1690
evaluate time cost:5.916748762130737s
clients training time cost:4.919619083404541s
attn_optimize time cost:0.4520735740661621s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714],
        [0.0713, 0.0714, 0.0714, 0.0716, 0.0715, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0714]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1668, 0.1665, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1667, 0.1665, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1668, 0.1665, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1668, 0.1665, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1668, 0.1665, 0.1667, 0.1667, 0.1667, 0.1666],
        [0.1668, 0.1665, 0.1667, 0.1667, 0.1667, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.2002, 0.2001, 0.2000, 0.1998],
        [0.1999, 0.2002, 0.2001, 0.2000, 0.1998],
        [0.1999, 0.2002, 0.2001, 0.2000, 0.1998],
        [0.1999, 0.2002, 0.2001, 0.2000, 0.1998],
        [0.1999, 0.2002, 0.2001, 0.2000, 0.1998]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0769, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0770, 0.0769, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769,
         0.0768, 0.0770, 0.0770, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1667, 0.1666, 0.1667, 0.1666, 0.1669],
        [0.1666, 0.1667, 0.1666, 0.1667, 0.1666, 0.1669],
        [0.1666, 0.1667, 0.1666, 0.1667, 0.1666, 0.1669],
        [0.1666, 0.1667, 0.1666, 0.1667, 0.1666, 0.1669],
        [0.1666, 0.1667, 0.1666, 0.1667, 0.1666, 0.1669],
        [0.1666, 0.1667, 0.1666, 0.1667, 0.1666, 0.1669]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0494],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0500, 0.0500, 0.0502, 0.0502, 0.0499, 0.0502, 0.0501, 0.0499,
         0.0499, 0.0502, 0.0500, 0.0502, 0.0502, 0.0499, 0.0499, 0.0499, 0.0499,
         0.0499, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0716, 0.0715, 0.0715, 0.0714, 0.0714, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0713, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0714, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0713, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0714, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0714, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0714, 0.0715, 0.0714, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0713, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0714, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0714, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0714, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0714, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0715, 0.0714, 0.0714, 0.0715, 0.0714, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0712],
        [0.0715, 0.0714, 0.0715, 0.0714, 0.0713, 0.0715, 0.0713, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0715, 0.0714, 0.0714]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0502],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503],
        [0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0498, 0.0501, 0.0498, 0.0499,
         0.0499, 0.0502, 0.0498, 0.0502, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0503]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26055359840393066s
iter time cost:11.631145238876343s
-------------Round number: 9-------------
Evaluate global model
[running kmeans]: 4it [00:00, 305.62it/s, center_shift=0.000000, iteration=4, tol=0.000100]
Averaged Train Loss: 2.7113
Averaged Test Accurancy: 0.5790
Std Test Accurancy: 0.1866
evaluate time cost:5.296130657196045s
clients training time cost:5.004704713821411s
attn_optimize time cost:0.47778868675231934s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834],
        [0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834],
        [0.0834, 0.0835, 0.0834, 0.0833, 0.0831, 0.0831, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834],
        [0.0834, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834],
        [0.0833, 0.0835, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0835, 0.0835,
         0.0832, 0.0833, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 4it [00:00, 363.34it/s, center_shift=0.000000, iteration=4, tol=0.000100]
weights:tensor([[0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1426, 0.1431, 0.1428, 0.1428, 0.1430],
        [0.1429, 0.1428, 0.1426, 0.1431, 0.1428, 0.1428, 0.1430],
        [0.1429, 0.1428, 0.1426, 0.1431, 0.1428, 0.1428, 0.1430],
        [0.1429, 0.1428, 0.1426, 0.1431, 0.1428, 0.1428, 0.1430],
        [0.1429, 0.1428, 0.1426, 0.1431, 0.1428, 0.1428, 0.1430],
        [0.1429, 0.1428, 0.1426, 0.1431, 0.1428, 0.1428, 0.1430],
        [0.1429, 0.1428, 0.1426, 0.1431, 0.1428, 0.1428, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0525, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0525, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0526,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0527, 0.0525, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0527, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0527, 0.0525, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527],
        [0.0527, 0.0528, 0.0524, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3042900562286377s
iter time cost:11.165989875793457s
-------------Round number: 10-------------
Evaluate global model
Averaged Train Loss: 1.3926
Averaged Test Accurancy: 0.6617
Std Test Accurancy: 0.1743
evaluate time cost:4.933332443237305s
clients training time cost:4.8957130908966064s
attn_optimize time cost:0.5360894203186035s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1250, 0.1250, 0.1251, 0.1249, 0.1250, 0.1251, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1249, 0.1250, 0.1251, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1249, 0.1250, 0.1251, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1249, 0.1250, 0.1251, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1249, 0.1250, 0.1251, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1249, 0.1250, 0.1251, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1249, 0.1250, 0.1251, 0.1249, 0.1250],
        [0.1249, 0.1250, 0.1251, 0.1249, 0.1250, 0.1251, 0.1249, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3330, 0.3334, 0.3335],
        [0.3330, 0.3334, 0.3336],
        [0.3330, 0.3334, 0.3336]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4997, 0.5003],
        [0.4997, 0.5003]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4997, 0.5003],
        [0.4997, 0.5003]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0498, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2501, 0.2500, 0.2500],
        [0.2500, 0.2501, 0.2500, 0.2500],
        [0.2500, 0.2501, 0.2500, 0.2500],
        [0.2500, 0.2501, 0.2500, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3190269470214844s
iter time cost:10.766235589981079s
-------------Round number: 11-------------
Evaluate global model
[running kmeans]: 3it [00:00, 333.01it/s, center_shift=0.000000, iteration=3, tol=0.000100]
Averaged Train Loss: 2.0651
Averaged Test Accurancy: 0.5884
Std Test Accurancy: 0.1836
evaluate time cost:4.989774227142334s
clients training time cost:4.945514440536499s
attn_optimize time cost:0.5470690727233887s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0834, 0.0830],
        [0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0834, 0.0830],
        [0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0834, 0.0830],
        [0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0834, 0.0830],
        [0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0834, 0.0830],
        [0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0834, 0.0829],
        [0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0834, 0.0829],
        [0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0834, 0.0830],
        [0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0834, 0.0830],
        [0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0834, 0.0830],
        [0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0834, 0.0829],
        [0.0834, 0.0834, 0.0835, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1254, 0.1252, 0.1250, 0.1254, 0.1252, 0.1251, 0.1253, 0.1234],
        [0.1254, 0.1253, 0.1250, 0.1254, 0.1252, 0.1252, 0.1253, 0.1233],
        [0.1254, 0.1253, 0.1250, 0.1253, 0.1252, 0.1251, 0.1253, 0.1233],
        [0.1254, 0.1253, 0.1250, 0.1254, 0.1252, 0.1251, 0.1253, 0.1233],
        [0.1254, 0.1253, 0.1250, 0.1254, 0.1252, 0.1252, 0.1253, 0.1233],
        [0.1254, 0.1253, 0.1250, 0.1253, 0.1252, 0.1251, 0.1253, 0.1233],
        [0.1254, 0.1253, 0.1250, 0.1254, 0.1252, 0.1251, 0.1253, 0.1233],
        [0.1255, 0.1253, 0.1250, 0.1254, 0.1252, 0.1251, 0.1253, 0.1232]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1248, 0.1250, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1252, 0.1250, 0.1249, 0.1249, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1252, 0.1250, 0.1249, 0.1249, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1252, 0.1250, 0.1250, 0.1249, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1252, 0.1250, 0.1249, 0.1249, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1252, 0.1250, 0.1249, 0.1250, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1252, 0.1250, 0.1249, 0.1249, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0833, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0999, 0.1001, 0.1001, 0.1001, 0.0999, 0.0999, 0.1001, 0.1002, 0.0999,
         0.0997],
        [0.0999, 0.1001, 0.1001, 0.1001, 0.0999, 0.0999, 0.1001, 0.1002, 0.0999,
         0.0998],
        [0.0999, 0.1001, 0.1001, 0.1001, 0.0999, 0.0999, 0.1001, 0.1002, 0.0999,
         0.0998],
        [0.0999, 0.1001, 0.1001, 0.1001, 0.0999, 0.0999, 0.1001, 0.1002, 0.0999,
         0.0997],
        [0.0999, 0.1001, 0.1001, 0.1001, 0.0999, 0.0999, 0.1001, 0.1002, 0.0999,
         0.0998],
        [0.0999, 0.1001, 0.1001, 0.1001, 0.0999, 0.0999, 0.1001, 0.1002, 0.0999,
         0.0997],
        [0.0999, 0.1001, 0.1001, 0.1001, 0.0999, 0.0999, 0.1001, 0.1002, 0.0999,
         0.0998],
        [0.0999, 0.1001, 0.1001, 0.1001, 0.0999, 0.0999, 0.1001, 0.1002, 0.0999,
         0.0998],
        [0.0999, 0.1001, 0.1001, 0.1001, 0.0999, 0.0999, 0.1001, 0.1002, 0.0999,
         0.0997],
        [0.0999, 0.1001, 0.1001, 0.1001, 0.0999, 0.0999, 0.1001, 0.1002, 0.0999,
         0.0997]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1431, 0.1429, 0.1429, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1431, 0.1429, 0.1429, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1431, 0.1429, 0.1429, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1431, 0.1429, 0.1429, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1431, 0.1429, 0.1429, 0.1428, 0.1427, 0.1428, 0.1428],
        [0.1431, 0.1429, 0.1429, 0.1428, 0.1428, 0.1428, 0.1428],
        [0.1431, 0.1429, 0.1429, 0.1428, 0.1427, 0.1428, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0832, 0.0833, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0833],
        [0.0832, 0.0834, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0834,
         0.0832, 0.0833, 0.0833],
        [0.0832, 0.0833, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0833],
        [0.0832, 0.0833, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0833],
        [0.0832, 0.0833, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0833],
        [0.0832, 0.0833, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0833],
        [0.0832, 0.0833, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0833],
        [0.0832, 0.0833, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0833],
        [0.0832, 0.0833, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0833],
        [0.0832, 0.0833, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0833],
        [0.0832, 0.0833, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0833],
        [0.0832, 0.0833, 0.0834, 0.0835, 0.0833, 0.0833, 0.0834, 0.0834, 0.0833,
         0.0832, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.0999, 0.1001, 0.0999, 0.0999, 0.1001, 0.1000, 0.0999, 0.1000,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.0999, 0.0999, 0.1001, 0.1000, 0.0999, 0.1000,
         0.1002],
        [0.1002, 0.0999, 0.1001, 0.0999, 0.0999, 0.1001, 0.1000, 0.0999, 0.1000,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.0998, 0.0999, 0.1001, 0.1000, 0.0999, 0.1000,
         0.1002],
        [0.1002, 0.0999, 0.1001, 0.0998, 0.0999, 0.1001, 0.1000, 0.0999, 0.1000,
         0.1002],
        [0.1002, 0.0999, 0.1001, 0.0998, 0.0999, 0.1001, 0.1000, 0.0999, 0.1000,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.0999, 0.0999, 0.1001, 0.1000, 0.0999, 0.1000,
         0.1002],
        [0.1002, 0.0999, 0.1001, 0.0998, 0.0999, 0.1001, 0.1000, 0.0999, 0.1000,
         0.1002],
        [0.1002, 0.0999, 0.1001, 0.0999, 0.0999, 0.1001, 0.1000, 0.0999, 0.1000,
         0.1002],
        [0.1002, 0.0999, 0.1001, 0.0998, 0.0999, 0.1001, 0.1000, 0.0998, 0.1001,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0501, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.24880552291870117s
iter time cost:10.83025574684143s
-------------Round number: 12-------------
Evaluate global model
[running kmeans]: 8it [00:00, 307.42it/s, center_shift=0.000000, iteration=8, tol=0.000100]
Averaged Train Loss: 2.6506
Averaged Test Accurancy: 0.6082
Std Test Accurancy: 0.1806
evaluate time cost:5.057571887969971s
clients training time cost:4.9987616539001465s
attn_optimize time cost:0.4163787364959717s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0908, 0.0909, 0.0909, 0.0909, 0.0912, 0.0909, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0908, 0.0909, 0.0909, 0.0909, 0.0912, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0908, 0.0909, 0.0909, 0.0909, 0.0912, 0.0910, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0908, 0.0908, 0.0909, 0.0909, 0.0909, 0.0912, 0.0910, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0908, 0.0908, 0.0909, 0.0909, 0.0909, 0.0912, 0.0910, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0908, 0.0908, 0.0909, 0.0909, 0.0909, 0.0912, 0.0910, 0.0909, 0.0910,
         0.0909, 0.0908],
        [0.0908, 0.0908, 0.0909, 0.0909, 0.0909, 0.0912, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0908, 0.0909, 0.0909, 0.0909, 0.0912, 0.0910, 0.0909, 0.0910,
         0.0909, 0.0909],
        [0.0908, 0.0908, 0.0909, 0.0909, 0.0909, 0.0912, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0908, 0.0909, 0.0909, 0.0909, 0.0912, 0.0910, 0.0909, 0.0909,
         0.0909, 0.0909],
        [0.0908, 0.0908, 0.0909, 0.0909, 0.0909, 0.0912, 0.0910, 0.0908, 0.0910,
         0.0909, 0.0908]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1430, 0.1430, 0.1427, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1430, 0.1430, 0.1427, 0.1427, 0.1428, 0.1429],
        [0.1429, 0.1430, 0.1430, 0.1427, 0.1427, 0.1428, 0.1429],
        [0.1430, 0.1430, 0.1430, 0.1427, 0.1427, 0.1428, 0.1428],
        [0.1430, 0.1430, 0.1430, 0.1427, 0.1427, 0.1428, 0.1428],
        [0.1430, 0.1430, 0.1430, 0.1427, 0.1427, 0.1428, 0.1428],
        [0.1430, 0.1430, 0.1430, 0.1427, 0.1427, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1251, 0.1252, 0.1251, 0.1251, 0.1252, 0.1251, 0.1243],
        [0.1249, 0.1251, 0.1252, 0.1251, 0.1251, 0.1252, 0.1251, 0.1243],
        [0.1249, 0.1251, 0.1252, 0.1251, 0.1251, 0.1252, 0.1251, 0.1244],
        [0.1249, 0.1251, 0.1252, 0.1251, 0.1251, 0.1252, 0.1251, 0.1243],
        [0.1249, 0.1251, 0.1252, 0.1251, 0.1251, 0.1252, 0.1251, 0.1243],
        [0.1249, 0.1251, 0.1252, 0.1251, 0.1251, 0.1252, 0.1251, 0.1244],
        [0.1249, 0.1251, 0.1252, 0.1251, 0.1251, 0.1252, 0.1251, 0.1243],
        [0.1249, 0.1251, 0.1253, 0.1251, 0.1252, 0.1252, 0.1252, 0.1240]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0834,
         0.0833, 0.0835, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0833, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0833, 0.0834, 0.0833, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1112, 0.1112, 0.1111, 0.1111, 0.1112, 0.1110, 0.1108, 0.1112],
        [0.1112, 0.1112, 0.1112, 0.1111, 0.1111, 0.1112, 0.1110, 0.1108, 0.1112],
        [0.1111, 0.1112, 0.1112, 0.1111, 0.1111, 0.1112, 0.1110, 0.1108, 0.1112],
        [0.1112, 0.1112, 0.1112, 0.1111, 0.1111, 0.1112, 0.1110, 0.1108, 0.1112],
        [0.1112, 0.1112, 0.1112, 0.1111, 0.1111, 0.1112, 0.1110, 0.1108, 0.1112],
        [0.1112, 0.1112, 0.1112, 0.1111, 0.1111, 0.1112, 0.1110, 0.1108, 0.1112],
        [0.1111, 0.1112, 0.1112, 0.1111, 0.1111, 0.1112, 0.1110, 0.1108, 0.1112],
        [0.1112, 0.1112, 0.1112, 0.1111, 0.1111, 0.1112, 0.1110, 0.1108, 0.1112],
        [0.1112, 0.1112, 0.1112, 0.1111, 0.1111, 0.1112, 0.1110, 0.1108, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26282167434692383s
iter time cost:10.82438349723816s
-------------Round number: 13-------------
Evaluate global model
[running kmeans]: 6it [00:00, 333.02it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 1.7018
Averaged Test Accurancy: 0.6542
Std Test Accurancy: 0.1892
evaluate time cost:4.909497261047363s
clients training time cost:4.895475625991821s
attn_optimize time cost:0.4409828186035156s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0626, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0626, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0626, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0625],
        [0.0625, 0.0626, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0626, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0626, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0626, 0.0625],
        [0.0625, 0.0625, 0.0625, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625,
         0.0626, 0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0502, 0.0498, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501,
         0.0501, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0911,
         0.0910, 0.0906],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0911,
         0.0910, 0.0907],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0911,
         0.0910, 0.0907],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0911,
         0.0910, 0.0907],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0911,
         0.0910, 0.0906],
        [0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0911,
         0.0910, 0.0906],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0911,
         0.0910, 0.0906],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0911,
         0.0910, 0.0907],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0911,
         0.0910, 0.0906],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910, 0.0911,
         0.0910, 0.0906],
        [0.0908, 0.0909, 0.0908, 0.0909, 0.0908, 0.0909, 0.0909, 0.0910, 0.0911,
         0.0909, 0.0910]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833],
        [0.0833, 0.0834, 0.0833, 0.0833, 0.0834, 0.0832, 0.0833, 0.0834, 0.0834,
         0.0834, 0.0832, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1429, 0.1426, 0.1428, 0.1427, 0.1429, 0.1430],
        [0.1430, 0.1429, 0.1426, 0.1428, 0.1427, 0.1429, 0.1430],
        [0.1430, 0.1429, 0.1426, 0.1428, 0.1427, 0.1429, 0.1430],
        [0.1430, 0.1429, 0.1426, 0.1428, 0.1427, 0.1429, 0.1430],
        [0.1430, 0.1429, 0.1426, 0.1428, 0.1427, 0.1429, 0.1430],
        [0.1430, 0.1429, 0.1426, 0.1428, 0.1427, 0.1429, 0.1430],
        [0.1430, 0.1429, 0.1426, 0.1428, 0.1427, 0.1429, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3335, 0.3329, 0.3336],
        [0.3335, 0.3329, 0.3336],
        [0.3334, 0.3329, 0.3336]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111],
        [0.1111, 0.1111, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2672441005706787s
iter time cost:10.591269731521606s
-------------Round number: 14-------------
Evaluate global model
[running kmeans]: 4it [00:00, 363.31it/s, center_shift=0.000000, iteration=4, tol=0.000100]
Averaged Train Loss: 1.6158
Averaged Test Accurancy: 0.6681
Std Test Accurancy: 0.1636
evaluate time cost:4.983089208602905s
clients training time cost:5.19796895980835s
attn_optimize time cost:0.6545858383178711s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0528, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0528, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0528, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0528, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0528, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0528, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0770, 0.0771, 0.0768, 0.0771,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0769, 0.0769, 0.0771, 0.0768, 0.0770,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0770, 0.0771, 0.0768, 0.0771,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0770, 0.0771, 0.0768, 0.0771,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0770, 0.0771, 0.0768, 0.0771,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0769, 0.0769, 0.0771, 0.0768, 0.0770,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0769, 0.0769, 0.0771, 0.0768, 0.0770,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0771, 0.0768, 0.0770,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0771, 0.0768, 0.0771,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0770, 0.0771, 0.0768, 0.0771,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0771, 0.0768, 0.0771,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0770, 0.0771, 0.0768, 0.0771,
         0.0768, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0770, 0.0771, 0.0768, 0.0771,
         0.0768, 0.0770, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1427, 0.1430, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1427, 0.1430, 0.1429, 0.1429, 0.1429, 0.1429, 0.1427],
        [0.1427, 0.1430, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1427, 0.1430, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1426, 0.1430, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1427, 0.1430, 0.1429, 0.1429, 0.1429, 0.1429, 0.1428],
        [0.1427, 0.1430, 0.1428, 0.1430, 0.1429, 0.1428, 0.1427]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1110, 0.1109, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1113, 0.1111],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1113, 0.1111],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1113, 0.1111],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1113, 0.1111],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1113, 0.1111],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1113, 0.1111],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1113, 0.1111],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1113, 0.1111],
        [0.1110, 0.1110, 0.1112, 0.1111, 0.1111, 0.1112, 0.1111, 0.1113, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1001, 0.1001, 0.0998, 0.1000, 0.0998, 0.1000, 0.1002, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1001, 0.0998, 0.1000, 0.0998, 0.1000, 0.1002, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1001, 0.0998, 0.1000, 0.0998, 0.1000, 0.1002, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1001, 0.0998, 0.1000, 0.0998, 0.1000, 0.1002, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1001, 0.0998, 0.1000, 0.0998, 0.1000, 0.1002, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1001, 0.0998, 0.1000, 0.0998, 0.1000, 0.1002, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1001, 0.0998, 0.1000, 0.0998, 0.1000, 0.1002, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1001, 0.0998, 0.1000, 0.0998, 0.1000, 0.1002, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1001, 0.0998, 0.1000, 0.0998, 0.1000, 0.1002, 0.1000,
         0.1000],
        [0.1000, 0.1001, 0.1001, 0.0998, 0.1000, 0.0998, 0.1000, 0.1002, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0492],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0492],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0492],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0492],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
[running kmeans]: 6it [00:00, 299.73it/s, center_shift=0.000000, iteration=6, tol=0.000100]
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526],
        [0.0526, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3198678493499756s
iter time cost:11.271617412567139s
-------------Round number: 15-------------
Evaluate global model
Averaged Train Loss: 1.5030
Averaged Test Accurancy: 0.7060
Std Test Accurancy: 0.1674
evaluate time cost:5.206014633178711s
clients training time cost:5.104357719421387s
attn_optimize time cost:0.5074601173400879s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1252, 0.1250, 0.1250, 0.1249, 0.1250, 0.1248, 0.1249, 0.1250],
        [0.1252, 0.1250, 0.1250, 0.1249, 0.1250, 0.1248, 0.1249, 0.1250],
        [0.1252, 0.1250, 0.1250, 0.1249, 0.1250, 0.1248, 0.1249, 0.1250],
        [0.1252, 0.1250, 0.1250, 0.1249, 0.1250, 0.1248, 0.1249, 0.1250],
        [0.1252, 0.1250, 0.1250, 0.1249, 0.1250, 0.1248, 0.1249, 0.1250],
        [0.1252, 0.1250, 0.1250, 0.1249, 0.1250, 0.1248, 0.1249, 0.1250],
        [0.1252, 0.1250, 0.1250, 0.1249, 0.1250, 0.1248, 0.1249, 0.1250],
        [0.1252, 0.1250, 0.1250, 0.1249, 0.1250, 0.1248, 0.1249, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0911,
         0.0908, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0911,
         0.0908, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0911,
         0.0908, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0911,
         0.0908, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0911,
         0.0908, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0910,
         0.0908, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0911,
         0.0908, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0909, 0.0910, 0.0909, 0.0909, 0.0909, 0.0911,
         0.0908, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1666, 0.1665, 0.1668, 0.1666, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1668, 0.1666, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1668, 0.1666, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1668, 0.1666, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1668, 0.1666, 0.1668],
        [0.1667, 0.1666, 0.1665, 0.1668, 0.1666, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0250, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0245],
        [0.0250, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0245],
        [0.0250, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0245],
        ...,
        [0.0250, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0246],
        [0.0250, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0246],
        [0.0250, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0246]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4998, 0.5002],
        [0.4998, 0.5002]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0910, 0.0909, 0.0908, 0.0908, 0.0908, 0.0909, 0.0911, 0.0911,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0909, 0.0909, 0.0908, 0.0909, 0.0911, 0.0911,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0908, 0.0908, 0.0909, 0.0911, 0.0911,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0908, 0.0908, 0.0909, 0.0911, 0.0911,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0908, 0.0908, 0.0909, 0.0911, 0.0911,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0908, 0.0908, 0.0909, 0.0911, 0.0911,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0908, 0.0908, 0.0909, 0.0912, 0.0911,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0908, 0.0908, 0.0909, 0.0911, 0.0911,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0908, 0.0908, 0.0909, 0.0912, 0.0911,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0908, 0.0908, 0.0909, 0.0911, 0.0911,
         0.0908, 0.0909],
        [0.0908, 0.0910, 0.0909, 0.0908, 0.0908, 0.0908, 0.0909, 0.0911, 0.0911,
         0.0908, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0908, 0.0910, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910,
         0.0909, 0.0906],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910, 0.0910, 0.0910,
         0.0909, 0.0906],
        [0.0909, 0.0909, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910, 0.0910, 0.0910,
         0.0909, 0.0905],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910, 0.0910, 0.0910,
         0.0909, 0.0906],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910, 0.0910, 0.0910,
         0.0909, 0.0905],
        [0.0909, 0.0910, 0.0910, 0.0908, 0.0910, 0.0909, 0.0910, 0.0910, 0.0910,
         0.0909, 0.0905],
        [0.0908, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910,
         0.0909, 0.0906],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0909, 0.0910, 0.0910,
         0.0909, 0.0905],
        [0.0909, 0.0909, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910, 0.0910, 0.0910,
         0.0909, 0.0905],
        [0.0909, 0.0910, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910, 0.0910, 0.0910,
         0.0909, 0.0905],
        [0.0908, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0909, 0.0910, 0.0910,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1112, 0.1112, 0.1111, 0.1110, 0.1111, 0.1112, 0.1112, 0.1110, 0.1110],
        [0.1112, 0.1112, 0.1111, 0.1111, 0.1111, 0.1112, 0.1112, 0.1110, 0.1110],
        [0.1112, 0.1112, 0.1111, 0.1110, 0.1111, 0.1112, 0.1112, 0.1110, 0.1110],
        [0.1112, 0.1112, 0.1111, 0.1110, 0.1111, 0.1112, 0.1112, 0.1110, 0.1110],
        [0.1112, 0.1112, 0.1111, 0.1110, 0.1111, 0.1112, 0.1112, 0.1110, 0.1110],
        [0.1112, 0.1112, 0.1111, 0.1110, 0.1111, 0.1112, 0.1112, 0.1110, 0.1110],
        [0.1112, 0.1112, 0.1111, 0.1110, 0.1111, 0.1112, 0.1112, 0.1110, 0.1110],
        [0.1112, 0.1112, 0.1111, 0.1110, 0.1111, 0.1112, 0.1112, 0.1110, 0.1110],
        [0.1112, 0.1112, 0.1111, 0.1110, 0.1111, 0.1112, 0.1112, 0.1110, 0.1110]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3511059284210205s
iter time cost:11.276620626449585s
-------------Round number: 16-------------
Evaluate global model
[running kmeans]: 5it [00:00, 312.22it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 1.6801
Averaged Test Accurancy: 0.6649
Std Test Accurancy: 0.1604
evaluate time cost:5.134327411651611s
clients training time cost:5.237466335296631s
attn_optimize time cost:0.6206653118133545s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.3332, 0.3336, 0.3332],
        [0.3332, 0.3336, 0.3332],
        [0.3332, 0.3336, 0.3332]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.0999, 0.1000, 0.0997, 0.1000, 0.0999, 0.1001, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.0997, 0.1000, 0.0999, 0.1001, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.0997, 0.1000, 0.0999, 0.1001, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.0998, 0.1000, 0.0999, 0.1001, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.0997, 0.1000, 0.0999, 0.1001, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.0997, 0.1000, 0.0999, 0.1001, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.0998, 0.1000, 0.0999, 0.1001, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.0997, 0.1000, 0.0999, 0.1001, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.0997, 0.1000, 0.0999, 0.1001, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.0997, 0.1000, 0.0999, 0.1001, 0.1000, 0.1002,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3335, 0.3332, 0.3333],
        [0.3335, 0.3332, 0.3333],
        [0.3335, 0.3332, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0251, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0245],
        [0.0251, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0245],
        [0.0251, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0246],
        ...,
        [0.0251, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0246],
        [0.0251, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0246],
        [0.0251, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0246]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3336, 0.3334, 0.3330],
        [0.3336, 0.3335, 0.3330],
        [0.3336, 0.3334, 0.3330]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0910, 0.0909, 0.0907, 0.0909, 0.0910, 0.0909, 0.0911, 0.0908, 0.0908,
         0.0910, 0.0909],
        [0.0910, 0.0909, 0.0907, 0.0909, 0.0910, 0.0909, 0.0911, 0.0908, 0.0908,
         0.0910, 0.0909],
        [0.0911, 0.0909, 0.0907, 0.0909, 0.0910, 0.0909, 0.0911, 0.0908, 0.0908,
         0.0910, 0.0909],
        [0.0911, 0.0909, 0.0907, 0.0909, 0.0910, 0.0909, 0.0911, 0.0908, 0.0908,
         0.0910, 0.0909],
        [0.0911, 0.0909, 0.0907, 0.0909, 0.0910, 0.0909, 0.0911, 0.0908, 0.0908,
         0.0911, 0.0909],
        [0.0911, 0.0909, 0.0907, 0.0909, 0.0910, 0.0909, 0.0911, 0.0908, 0.0908,
         0.0910, 0.0909],
        [0.0911, 0.0909, 0.0907, 0.0909, 0.0910, 0.0909, 0.0911, 0.0908, 0.0908,
         0.0910, 0.0909],
        [0.0911, 0.0909, 0.0907, 0.0909, 0.0910, 0.0909, 0.0911, 0.0908, 0.0908,
         0.0910, 0.0909],
        [0.0911, 0.0909, 0.0907, 0.0909, 0.0910, 0.0909, 0.0911, 0.0908, 0.0908,
         0.0910, 0.0909],
        [0.0910, 0.0909, 0.0907, 0.0909, 0.0910, 0.0909, 0.0911, 0.0908, 0.0908,
         0.0910, 0.0909],
        [0.0911, 0.0909, 0.0907, 0.0909, 0.0910, 0.0909, 0.0911, 0.0908, 0.0908,
         0.0910, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1250, 0.1247, 0.1249, 0.1251, 0.1252, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1247, 0.1249, 0.1251, 0.1252, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1247, 0.1249, 0.1251, 0.1252, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1247, 0.1249, 0.1251, 0.1252, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1247, 0.1249, 0.1251, 0.1252, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1247, 0.1249, 0.1251, 0.1252, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1247, 0.1249, 0.1251, 0.1252, 0.1250],
        [0.1251, 0.1250, 0.1250, 0.1247, 0.1249, 0.1251, 0.1252, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3393080234527588s
iter time cost:11.457882642745972s
-------------Round number: 17-------------
Evaluate global model
[running kmeans]: 4it [00:00, 307.44it/s, center_shift=0.000000, iteration=4, tol=0.000100]
Averaged Train Loss: 1.6052
Averaged Test Accurancy: 0.6831
Std Test Accurancy: 0.1652
evaluate time cost:4.998949289321899s
clients training time cost:5.122602462768555s
attn_optimize time cost:0.7072818279266357s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1429, 0.1429, 0.1427, 0.1428, 0.1429, 0.1430, 0.1427],
        [0.1429, 0.1429, 0.1427, 0.1428, 0.1429, 0.1430, 0.1427],
        [0.1429, 0.1430, 0.1427, 0.1428, 0.1429, 0.1430, 0.1427],
        [0.1429, 0.1430, 0.1427, 0.1428, 0.1429, 0.1430, 0.1427],
        [0.1429, 0.1429, 0.1427, 0.1428, 0.1429, 0.1430, 0.1427],
        [0.1429, 0.1429, 0.1427, 0.1428, 0.1429, 0.1430, 0.1427],
        [0.1429, 0.1429, 0.1427, 0.1428, 0.1429, 0.1430, 0.1427]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.1998, 0.2002, 0.2001, 0.2000],
        [0.2000, 0.1998, 0.2002, 0.2000, 0.2000],
        [0.2000, 0.1998, 0.2002, 0.2001, 0.2000],
        [0.2000, 0.1998, 0.2002, 0.2001, 0.2000],
        [0.2000, 0.1998, 0.2003, 0.2001, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2499, 0.2500, 0.2500],
        [0.2500, 0.2499, 0.2500, 0.2500],
        [0.2501, 0.2499, 0.2500, 0.2500],
        [0.2501, 0.2499, 0.2500, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1248, 0.1251, 0.1251, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1251, 0.1248, 0.1251, 0.1250, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1251, 0.1248, 0.1251, 0.1250, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1251, 0.1248, 0.1251, 0.1251, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1251, 0.1248, 0.1251, 0.1250, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1251, 0.1248, 0.1251, 0.1251, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1251, 0.1248, 0.1251, 0.1250, 0.1247, 0.1250, 0.1252, 0.1250],
        [0.1251, 0.1248, 0.1251, 0.1250, 0.1247, 0.1250, 0.1252, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526],
        [0.0525, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0664, 0.0667, 0.0668, 0.0668,
         0.0666, 0.0669, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0665, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0668, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0664, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0668, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0666, 0.0668, 0.0664, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0669, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0664, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0669, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0664, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0669, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0665, 0.0666, 0.0668, 0.0667,
         0.0666, 0.0668, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0664, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0668, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0665, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0668, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0666, 0.0668, 0.0664, 0.0667, 0.0668, 0.0668,
         0.0666, 0.0669, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0664, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0668, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0664, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0669, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0666, 0.0668, 0.0664, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0668, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0664, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0669, 0.0667, 0.0668, 0.0665, 0.0666],
        [0.0665, 0.0667, 0.0667, 0.0666, 0.0668, 0.0664, 0.0666, 0.0668, 0.0668,
         0.0666, 0.0669, 0.0667, 0.0668, 0.0665, 0.0666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0498, 0.0499,
         0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.30384206771850586s
iter time cost:11.254788160324097s
-------------Round number: 18-------------
Evaluate global model
[running kmeans]: 7it [00:00, 279.75it/s, center_shift=0.000000, iteration=7, tol=0.000100]
Averaged Train Loss: 1.8829
Averaged Test Accurancy: 0.6451
Std Test Accurancy: 0.1825
evaluate time cost:4.967020273208618s
clients training time cost:5.240640640258789s
attn_optimize time cost:0.5246074199676514s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0501, 0.0499, 0.0502, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0499],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1253, 0.1251, 0.1251, 0.1249, 0.1249, 0.1250, 0.1248, 0.1249],
        [0.1253, 0.1251, 0.1251, 0.1249, 0.1249, 0.1250, 0.1248, 0.1249],
        [0.1253, 0.1251, 0.1251, 0.1249, 0.1249, 0.1250, 0.1248, 0.1249],
        [0.1253, 0.1251, 0.1251, 0.1249, 0.1249, 0.1250, 0.1248, 0.1249],
        [0.1253, 0.1251, 0.1251, 0.1250, 0.1249, 0.1250, 0.1248, 0.1249],
        [0.1253, 0.1251, 0.1251, 0.1249, 0.1249, 0.1250, 0.1248, 0.1249],
        [0.1253, 0.1251, 0.1251, 0.1250, 0.1249, 0.1250, 0.1248, 0.1249],
        [0.1253, 0.1251, 0.1251, 0.1250, 0.1249, 0.1250, 0.1248, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3335, 0.3331, 0.3334],
        [0.3335, 0.3331, 0.3334],
        [0.3335, 0.3331, 0.3334]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2002, 0.2001, 0.1999, 0.1999, 0.1999],
        [0.2002, 0.2001, 0.1999, 0.1999, 0.2000],
        [0.2002, 0.2001, 0.1999, 0.1999, 0.2000],
        [0.2002, 0.2001, 0.1999, 0.1999, 0.2000],
        [0.2002, 0.2001, 0.1999, 0.1999, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1666, 0.1666, 0.1666, 0.1665, 0.1670],
        [0.1666, 0.1666, 0.1666, 0.1666, 0.1665, 0.1670],
        [0.1666, 0.1666, 0.1666, 0.1666, 0.1665, 0.1670],
        [0.1666, 0.1666, 0.1666, 0.1666, 0.1665, 0.1670],
        [0.1666, 0.1666, 0.1666, 0.1666, 0.1665, 0.1670],
        [0.1666, 0.1666, 0.1666, 0.1666, 0.1665, 0.1670]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0624, 0.0625, 0.0626, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0625, 0.0626, 0.0626, 0.0626, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0626, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0625, 0.0626, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0624, 0.0625, 0.0626, 0.0626, 0.0625, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28383922576904297s
iter time cost:11.11019253730774s
-------------Round number: 19-------------
Evaluate global model
[running kmeans]: 5it [00:00, 277.53it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 1.6926
Averaged Test Accurancy: 0.6681
Std Test Accurancy: 0.1781
evaluate time cost:5.004631996154785s
clients training time cost:5.179874420166016s
attn_optimize time cost:0.6621465682983398s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0527, 0.0527, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0527, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1668, 0.1666, 0.1665, 0.1667, 0.1669, 0.1664],
        [0.1668, 0.1666, 0.1665, 0.1667, 0.1669, 0.1664],
        [0.1668, 0.1666, 0.1665, 0.1667, 0.1669, 0.1664],
        [0.1668, 0.1666, 0.1665, 0.1667, 0.1670, 0.1664],
        [0.1668, 0.1666, 0.1665, 0.1668, 0.1669, 0.1664],
        [0.1668, 0.1666, 0.1665, 0.1667, 0.1669, 0.1664]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1248, 0.1250, 0.1248, 0.1250, 0.1249, 0.1251, 0.1253, 0.1250],
        [0.1248, 0.1250, 0.1248, 0.1250, 0.1249, 0.1251, 0.1253, 0.1250],
        [0.1248, 0.1250, 0.1248, 0.1250, 0.1249, 0.1251, 0.1253, 0.1250],
        [0.1248, 0.1250, 0.1248, 0.1250, 0.1249, 0.1251, 0.1253, 0.1250],
        [0.1248, 0.1250, 0.1249, 0.1250, 0.1249, 0.1251, 0.1253, 0.1250],
        [0.1248, 0.1250, 0.1248, 0.1250, 0.1249, 0.1251, 0.1253, 0.1250],
        [0.1248, 0.1250, 0.1248, 0.1250, 0.1249, 0.1251, 0.1253, 0.1250],
        [0.1248, 0.1250, 0.1248, 0.1250, 0.1249, 0.1251, 0.1253, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1669, 0.1666, 0.1668, 0.1665, 0.1665, 0.1666],
        [0.1669, 0.1666, 0.1668, 0.1665, 0.1665, 0.1666],
        [0.1669, 0.1666, 0.1668, 0.1665, 0.1665, 0.1666],
        [0.1669, 0.1666, 0.1668, 0.1665, 0.1665, 0.1666],
        [0.1669, 0.1666, 0.1668, 0.1665, 0.1665, 0.1666],
        [0.1669, 0.1666, 0.1669, 0.1665, 0.1664, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0492],
        [0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 5it [00:00, 312.22it/s, center_shift=0.000000, iteration=5, tol=0.000100]
weights:tensor([[0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527],
        [0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.35691404342651367s
iter time cost:11.322495937347412s
-------------Round number: 20-------------
Evaluate global model
Averaged Train Loss: 1.1274
Averaged Test Accurancy: 0.7103
Std Test Accurancy: 0.1672
evaluate time cost:5.495249271392822s
clients training time cost:5.262887477874756s
attn_optimize time cost:0.5530543327331543s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0526, 0.0525, 0.0528, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0527, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526],
        [0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0770],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0770],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0769],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0770],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0770],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0770],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0770],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0770],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0770],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0770],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0770],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0770],
        [0.0768, 0.0768, 0.0770, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.1998, 0.2000, 0.2001, 0.2000],
        [0.2000, 0.1998, 0.2000, 0.2002, 0.2000],
        [0.2000, 0.1999, 0.2000, 0.2002, 0.2000],
        [0.2000, 0.1998, 0.2000, 0.2002, 0.2000],
        [0.2000, 0.1998, 0.2000, 0.2001, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1434, 0.1429, 0.1428, 0.1425, 0.1428, 0.1428, 0.1428],
        [0.1435, 0.1429, 0.1427, 0.1425, 0.1428, 0.1428, 0.1428],
        [0.1434, 0.1429, 0.1428, 0.1425, 0.1428, 0.1428, 0.1428],
        [0.1434, 0.1429, 0.1428, 0.1425, 0.1428, 0.1428, 0.1428],
        [0.1434, 0.1429, 0.1427, 0.1425, 0.1428, 0.1428, 0.1428],
        [0.1435, 0.1429, 0.1428, 0.1425, 0.1428, 0.1428, 0.1428],
        [0.1434, 0.1429, 0.1428, 0.1425, 0.1428, 0.1428, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1427, 0.1428, 0.1430, 0.1428, 0.1428, 0.1427],
        [0.1430, 0.1427, 0.1429, 0.1431, 0.1428, 0.1428, 0.1427],
        [0.1430, 0.1427, 0.1428, 0.1431, 0.1428, 0.1428, 0.1427],
        [0.1430, 0.1427, 0.1428, 0.1431, 0.1428, 0.1428, 0.1427],
        [0.1430, 0.1427, 0.1428, 0.1431, 0.1428, 0.1428, 0.1427],
        [0.1430, 0.1427, 0.1428, 0.1430, 0.1428, 0.1428, 0.1427],
        [0.1430, 0.1427, 0.1428, 0.1431, 0.1428, 0.1428, 0.1427]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 7it [00:00, 317.91it/s, center_shift=0.000000, iteration=7, tol=0.000100]
weights:tensor([[0.1424, 0.1427, 0.1430, 0.1427, 0.1431, 0.1431, 0.1428],
        [0.1425, 0.1427, 0.1430, 0.1427, 0.1431, 0.1431, 0.1428],
        [0.1425, 0.1427, 0.1430, 0.1427, 0.1432, 0.1432, 0.1427],
        [0.1424, 0.1427, 0.1430, 0.1427, 0.1431, 0.1431, 0.1428],
        [0.1424, 0.1427, 0.1430, 0.1427, 0.1432, 0.1431, 0.1428],
        [0.1425, 0.1427, 0.1430, 0.1427, 0.1432, 0.1432, 0.1427],
        [0.1424, 0.1427, 0.1430, 0.1427, 0.1432, 0.1432, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2527885437011719s
iter time cost:11.65205979347229s
-------------Round number: 21-------------
Evaluate global model
Averaged Train Loss: 1.2221
Averaged Test Accurancy: 0.7087
Std Test Accurancy: 0.1431
evaluate time cost:5.0912206172943115s
[running kmeans]: 7it [00:00, 388.55it/s, center_shift=0.000000, iteration=7, tol=0.000100]
clients training time cost:5.23103404045105s
attn_optimize time cost:0.4383983612060547s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2000, 0.2000, 0.2000, 0.1997, 0.2004],
        [0.2000, 0.2000, 0.2000, 0.1997, 0.2004],
        [0.2000, 0.2000, 0.2000, 0.1997, 0.2004],
        [0.2000, 0.2000, 0.2000, 0.1997, 0.2004],
        [0.2000, 0.2000, 0.2000, 0.1997, 0.2004]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0492],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0492],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0492],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0769, 0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0770, 0.0768,
         0.0769, 0.0770, 0.0770, 0.0768],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0770, 0.0770, 0.0766, 0.0770, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0770, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0768],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0770, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0768],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0770, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0768],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0770, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0770, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0768],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0770, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0770, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0768],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0770, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0768],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0770, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0768],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0770, 0.0769,
         0.0769, 0.0770, 0.0770, 0.0768],
        [0.0770, 0.0768, 0.0771, 0.0769, 0.0769, 0.0770, 0.0766, 0.0770, 0.0768,
         0.0769, 0.0770, 0.0770, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1431, 0.1427, 0.1428, 0.1429, 0.1426, 0.1429],
        [0.1429, 0.1431, 0.1427, 0.1428, 0.1429, 0.1426, 0.1429],
        [0.1429, 0.1431, 0.1427, 0.1428, 0.1429, 0.1426, 0.1429],
        [0.1429, 0.1432, 0.1427, 0.1428, 0.1429, 0.1426, 0.1429],
        [0.1429, 0.1431, 0.1427, 0.1428, 0.1429, 0.1426, 0.1429],
        [0.1429, 0.1431, 0.1427, 0.1428, 0.1429, 0.1426, 0.1429],
        [0.1429, 0.1431, 0.1427, 0.1428, 0.1429, 0.1426, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0833, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0833, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0833, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0832, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0832, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0832, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0832, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0832, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0832, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0832, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0833, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0832, 0.0832, 0.0833, 0.0835, 0.0832, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0833, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3719956874847412s
iter time cost:11.215294361114502s
-------------Round number: 22-------------
Evaluate global model
Averaged Train Loss: 1.3319
Averaged Test Accurancy: 0.6861
Std Test Accurancy: 0.1729
evaluate time cost:5.17524528503418s
clients training time cost:5.042511940002441s
attn_optimize time cost:0.4894874095916748s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1252, 0.1248, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1252, 0.1249, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1252, 0.1249, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1252, 0.1249, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1252, 0.1249, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1252, 0.1249, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1252, 0.1249, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250, 0.1249],
        [0.1252, 0.1249, 0.1251, 0.1249, 0.1249, 0.1250, 0.1250, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1671, 0.1667, 0.1672, 0.1668, 0.1657],
        [0.1666, 0.1671, 0.1667, 0.1672, 0.1667, 0.1658],
        [0.1666, 0.1671, 0.1667, 0.1672, 0.1667, 0.1657],
        [0.1666, 0.1671, 0.1667, 0.1672, 0.1667, 0.1658],
        [0.1666, 0.1671, 0.1667, 0.1672, 0.1667, 0.1657],
        [0.1666, 0.1672, 0.1666, 0.1673, 0.1668, 0.1654]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0768, 0.0770, 0.0770, 0.0770, 0.0770, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0715, 0.0713,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0714, 0.0715, 0.0713,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0714, 0.0715, 0.0714,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0714, 0.0715, 0.0713,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0714, 0.0715, 0.0714,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0715, 0.0713,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0715, 0.0713,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0714, 0.0715, 0.0714,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715],
        [0.0714, 0.0715, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0715, 0.0714, 0.0714, 0.0715, 0.0715]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1671, 0.1664, 0.1667, 0.1663, 0.1668],
        [0.1666, 0.1671, 0.1664, 0.1667, 0.1664, 0.1668],
        [0.1667, 0.1671, 0.1664, 0.1667, 0.1664, 0.1668],
        [0.1667, 0.1671, 0.1664, 0.1667, 0.1663, 0.1668],
        [0.1666, 0.1671, 0.1664, 0.1667, 0.1664, 0.1668],
        [0.1666, 0.1671, 0.1664, 0.1667, 0.1664, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0910],
        [0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0910],
        [0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0910],
        [0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0909, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0910],
        [0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0910],
        [0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0910],
        [0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0910],
        [0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0910, 0.0909, 0.0909, 0.0909,
         0.0910, 0.0910],
        [0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0910],
        [0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0910, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0910],
        [0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0910]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.22886919975280762s
iter time cost:11.038206815719604s
-------------Round number: 23-------------
Evaluate global model
[running kmeans]: 9it [00:00, 290.06it/s, center_shift=0.000000, iteration=9, tol=0.000100]
Averaged Train Loss: 0.9196
Averaged Test Accurancy: 0.7151
Std Test Accurancy: 0.1456
evaluate time cost:4.7804274559021s
clients training time cost:4.975506544113159s
[running kmeans]: 5it [00:00, 312.20it/s, center_shift=0.000000, iteration=5, tol=0.000100]
attn_optimize time cost:0.43195176124572754s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1662, 0.1671, 0.1668, 0.1674, 0.1667, 0.1658],
        [0.1662, 0.1671, 0.1668, 0.1674, 0.1667, 0.1659],
        [0.1662, 0.1671, 0.1668, 0.1674, 0.1667, 0.1658],
        [0.1662, 0.1671, 0.1668, 0.1674, 0.1667, 0.1658],
        [0.1662, 0.1671, 0.1668, 0.1674, 0.1667, 0.1658],
        [0.1661, 0.1672, 0.1668, 0.1676, 0.1668, 0.1655]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1673, 0.1662, 0.1667, 0.1663, 0.1669],
        [0.1666, 0.1672, 0.1662, 0.1667, 0.1663, 0.1669],
        [0.1666, 0.1672, 0.1662, 0.1667, 0.1663, 0.1669],
        [0.1666, 0.1673, 0.1662, 0.1667, 0.1663, 0.1669],
        [0.1666, 0.1672, 0.1662, 0.1667, 0.1663, 0.1669],
        [0.1666, 0.1672, 0.1662, 0.1667, 0.1663, 0.1669]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0502, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1252, 0.1250, 0.1250, 0.1248, 0.1252, 0.1249],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1250, 0.1248, 0.1252, 0.1249],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1250, 0.1248, 0.1252, 0.1249],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1250, 0.1248, 0.1252, 0.1249],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1250, 0.1248, 0.1252, 0.1249],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1250, 0.1248, 0.1252, 0.1249],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1250, 0.1248, 0.1252, 0.1249],
        [0.1249, 0.1250, 0.1252, 0.1250, 0.1250, 0.1248, 0.1252, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0714, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0714, 0.0715, 0.0715, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0715]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1432, 0.1429, 0.1424, 0.1430, 0.1428, 0.1426],
        [0.1432, 0.1432, 0.1429, 0.1424, 0.1430, 0.1428, 0.1426],
        [0.1432, 0.1432, 0.1429, 0.1424, 0.1430, 0.1428, 0.1426],
        [0.1432, 0.1432, 0.1429, 0.1424, 0.1430, 0.1428, 0.1425],
        [0.1432, 0.1432, 0.1429, 0.1424, 0.1430, 0.1428, 0.1426],
        [0.1432, 0.1432, 0.1429, 0.1424, 0.1430, 0.1428, 0.1427],
        [0.1432, 0.1432, 0.1428, 0.1423, 0.1429, 0.1427, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1998, 0.2000, 0.2002, 0.2002, 0.1999],
        [0.1998, 0.2000, 0.2002, 0.2002, 0.1999],
        [0.1997, 0.2000, 0.2002, 0.2002, 0.1999],
        [0.1997, 0.2000, 0.2002, 0.2002, 0.1998],
        [0.1997, 0.2000, 0.2002, 0.2002, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0771, 0.0770, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27625107765197754s
iter time cost:10.543778896331787s
-------------Round number: 24-------------
Evaluate global model
Averaged Train Loss: 0.9316
Averaged Test Accurancy: 0.7071
Std Test Accurancy: 0.1729
evaluate time cost:5.460222959518433s
clients training time cost:4.860872745513916s
attn_optimize time cost:0.44940805435180664s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1669, 0.1670, 0.1660, 0.1669, 0.1664, 0.1668],
        [0.1669, 0.1670, 0.1660, 0.1669, 0.1664, 0.1668],
        [0.1669, 0.1670, 0.1660, 0.1669, 0.1665, 0.1667],
        [0.1669, 0.1670, 0.1660, 0.1669, 0.1665, 0.1668],
        [0.1669, 0.1670, 0.1660, 0.1669, 0.1664, 0.1669],
        [0.1669, 0.1669, 0.1659, 0.1669, 0.1663, 0.1672]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1249, 0.1252, 0.1248, 0.1250, 0.1253, 0.1248, 0.1251],
        [0.1249, 0.1249, 0.1252, 0.1248, 0.1250, 0.1253, 0.1248, 0.1251],
        [0.1249, 0.1249, 0.1252, 0.1248, 0.1250, 0.1253, 0.1248, 0.1251],
        [0.1249, 0.1249, 0.1252, 0.1248, 0.1250, 0.1253, 0.1248, 0.1251],
        [0.1249, 0.1249, 0.1252, 0.1248, 0.1250, 0.1253, 0.1248, 0.1251],
        [0.1249, 0.1249, 0.1252, 0.1248, 0.1250, 0.1253, 0.1248, 0.1251],
        [0.1249, 0.1249, 0.1252, 0.1248, 0.1250, 0.1253, 0.1248, 0.1251],
        [0.1249, 0.1249, 0.1252, 0.1248, 0.1250, 0.1253, 0.1248, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0527, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0524, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1666, 0.1666, 0.1665, 0.1670, 0.1666],
        [0.1667, 0.1666, 0.1666, 0.1665, 0.1669, 0.1666],
        [0.1667, 0.1666, 0.1666, 0.1665, 0.1670, 0.1666],
        [0.1667, 0.1666, 0.1665, 0.1665, 0.1670, 0.1666],
        [0.1667, 0.1666, 0.1666, 0.1665, 0.1669, 0.1666],
        [0.1667, 0.1666, 0.1665, 0.1665, 0.1670, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1672, 0.1663, 0.1667, 0.1662, 0.1670],
        [0.1666, 0.1672, 0.1664, 0.1667, 0.1662, 0.1670],
        [0.1666, 0.1671, 0.1664, 0.1667, 0.1662, 0.1670],
        [0.1666, 0.1671, 0.1663, 0.1667, 0.1662, 0.1670],
        [0.1665, 0.1672, 0.1664, 0.1667, 0.1662, 0.1670],
        [0.1666, 0.1671, 0.1664, 0.1667, 0.1662, 0.1670]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0770, 0.0768, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0770, 0.0768, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0770, 0.0768, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0770, 0.0768, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0770, 0.0768, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0769, 0.0768, 0.0768, 0.0768, 0.0770,
         0.0770, 0.0768, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0770, 0.0768, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0768, 0.0770,
         0.0770, 0.0768, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0770, 0.0768, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0768, 0.0770,
         0.0770, 0.0769, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0770, 0.0768, 0.0769, 0.0768],
        [0.0769, 0.0770, 0.0771, 0.0770, 0.0770, 0.0768, 0.0768, 0.0768, 0.0770,
         0.0770, 0.0768, 0.0769, 0.0768]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.31189846992492676s
iter time cost:11.159472465515137s
-------------Round number: 25-------------
Evaluate global model
[running kmeans]: 4it [00:00, 363.28it/s, center_shift=0.000000, iteration=4, tol=0.000100]
Averaged Train Loss: 1.1306
Averaged Test Accurancy: 0.6901
Std Test Accurancy: 0.1659
evaluate time cost:4.968653678894043s
[running kmeans]: 5it [00:00, 237.88it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:4.853299379348755s
attn_optimize time cost:0.5057260990142822s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1432, 0.1432, 0.1424, 0.1423, 0.1429, 0.1430, 0.1430],
        [0.1432, 0.1433, 0.1424, 0.1424, 0.1429, 0.1430, 0.1429],
        [0.1432, 0.1433, 0.1424, 0.1424, 0.1429, 0.1430, 0.1429],
        [0.1432, 0.1433, 0.1425, 0.1424, 0.1429, 0.1430, 0.1428],
        [0.1432, 0.1432, 0.1424, 0.1424, 0.1429, 0.1430, 0.1429],
        [0.1432, 0.1432, 0.1425, 0.1424, 0.1429, 0.1429, 0.1430],
        [0.1432, 0.1432, 0.1423, 0.1423, 0.1429, 0.1429, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0770, 0.0769, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2509, 0.2505, 0.2511, 0.2474],
        [0.2509, 0.2505, 0.2511, 0.2475],
        [0.2509, 0.2505, 0.2511, 0.2475],
        [0.2509, 0.2506, 0.2511, 0.2474]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1107, 0.1113, 0.1110, 0.1111, 0.1111, 0.1111, 0.1114, 0.1114, 0.1109],
        [0.1107, 0.1113, 0.1110, 0.1111, 0.1111, 0.1111, 0.1114, 0.1114, 0.1109],
        [0.1106, 0.1113, 0.1110, 0.1112, 0.1111, 0.1111, 0.1114, 0.1114, 0.1109],
        [0.1107, 0.1113, 0.1110, 0.1111, 0.1111, 0.1111, 0.1114, 0.1114, 0.1109],
        [0.1107, 0.1113, 0.1110, 0.1111, 0.1111, 0.1111, 0.1114, 0.1114, 0.1109],
        [0.1107, 0.1113, 0.1110, 0.1111, 0.1111, 0.1111, 0.1114, 0.1114, 0.1109],
        [0.1107, 0.1113, 0.1110, 0.1111, 0.1111, 0.1111, 0.1114, 0.1114, 0.1109],
        [0.1107, 0.1113, 0.1110, 0.1111, 0.1111, 0.1111, 0.1114, 0.1114, 0.1109],
        [0.1107, 0.1113, 0.1110, 0.1111, 0.1111, 0.1111, 0.1114, 0.1114, 0.1109]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0623, 0.0624, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0624, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0624, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0625, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0624, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0624, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0626, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0498, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500,
         0.0499, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1431, 0.1427, 0.1428, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1431, 0.1427, 0.1429, 0.1428, 0.1429, 0.1429, 0.1428],
        [0.1431, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1427],
        [0.1431, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1427],
        [0.1432, 0.1428, 0.1428, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1431, 0.1428, 0.1429, 0.1428, 0.1428, 0.1429, 0.1428],
        [0.1431, 0.1427, 0.1429, 0.1427, 0.1429, 0.1428, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0768, 0.0767, 0.0767, 0.0769, 0.0767, 0.0770, 0.0770, 0.0770, 0.0771,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0768, 0.0767, 0.0767, 0.0769, 0.0767, 0.0770, 0.0770, 0.0770, 0.0771,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0768, 0.0767, 0.0768, 0.0769, 0.0768, 0.0770, 0.0770, 0.0770, 0.0771,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0768, 0.0769, 0.0768, 0.0770, 0.0770, 0.0770, 0.0770,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0767, 0.0769, 0.0768, 0.0770, 0.0770, 0.0770, 0.0771,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0768, 0.0769, 0.0768, 0.0770, 0.0770, 0.0769, 0.0770,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0767, 0.0769, 0.0768, 0.0770, 0.0770, 0.0770, 0.0771,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0768, 0.0769, 0.0768, 0.0770, 0.0770, 0.0770, 0.0770,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0768, 0.0769, 0.0768, 0.0770, 0.0770, 0.0770, 0.0770,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0768, 0.0769, 0.0768, 0.0770, 0.0770, 0.0770, 0.0771,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0767, 0.0769, 0.0768, 0.0770, 0.0770, 0.0770, 0.0771,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0769, 0.0767, 0.0767, 0.0769, 0.0768, 0.0770, 0.0770, 0.0770, 0.0770,
         0.0772, 0.0769, 0.0770, 0.0770],
        [0.0768, 0.0767, 0.0767, 0.0769, 0.0768, 0.0770, 0.0770, 0.0769, 0.0771,
         0.0772, 0.0769, 0.0770, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1002, 0.0999, 0.1001, 0.0998, 0.1000, 0.1001, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1002, 0.0998, 0.1001, 0.0998, 0.1000, 0.1001, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1002, 0.0998, 0.1001, 0.0998, 0.1000, 0.1000, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1002, 0.0999, 0.1001, 0.0998, 0.1000, 0.1000, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1002, 0.0999, 0.1001, 0.0998, 0.1000, 0.1000, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1002, 0.0998, 0.1001, 0.0998, 0.1000, 0.1000, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1002, 0.0999, 0.1001, 0.0998, 0.1000, 0.1001, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1002, 0.0998, 0.1001, 0.0998, 0.1000, 0.1001, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1002, 0.0999, 0.1001, 0.0998, 0.1000, 0.1000, 0.1000, 0.0999,
         0.1001],
        [0.1000, 0.1002, 0.0998, 0.1001, 0.0998, 0.1000, 0.1000, 0.1000, 0.0999,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.31328511238098145s
iter time cost:10.787824630737305s
-------------Round number: 26-------------
Evaluate global model
Averaged Train Loss: 0.8607
Averaged Test Accurancy: 0.7003
Std Test Accurancy: 0.1553
evaluate time cost:5.436861753463745s
clients training time cost:4.955370187759399s
attn_optimize time cost:0.41938066482543945s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1252, 0.1247, 0.1249, 0.1249, 0.1250, 0.1251, 0.1250, 0.1252],
        [0.1252, 0.1248, 0.1249, 0.1248, 0.1250, 0.1251, 0.1250, 0.1252],
        [0.1252, 0.1247, 0.1249, 0.1248, 0.1250, 0.1251, 0.1250, 0.1252],
        [0.1252, 0.1248, 0.1249, 0.1248, 0.1250, 0.1251, 0.1250, 0.1252],
        [0.1252, 0.1247, 0.1249, 0.1248, 0.1250, 0.1251, 0.1250, 0.1252],
        [0.1252, 0.1248, 0.1249, 0.1248, 0.1250, 0.1251, 0.1250, 0.1252],
        [0.1252, 0.1247, 0.1249, 0.1248, 0.1250, 0.1251, 0.1250, 0.1252],
        [0.1252, 0.1247, 0.1249, 0.1248, 0.1250, 0.1251, 0.1250, 0.1252]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1426, 0.1432, 0.1429, 0.1432, 0.1432, 0.1430, 0.1419],
        [0.1426, 0.1432, 0.1428, 0.1432, 0.1432, 0.1430, 0.1420],
        [0.1426, 0.1432, 0.1429, 0.1432, 0.1432, 0.1430, 0.1419],
        [0.1426, 0.1432, 0.1429, 0.1432, 0.1432, 0.1430, 0.1419],
        [0.1426, 0.1432, 0.1428, 0.1432, 0.1432, 0.1430, 0.1420],
        [0.1426, 0.1432, 0.1429, 0.1432, 0.1432, 0.1430, 0.1420],
        [0.1426, 0.1433, 0.1428, 0.1433, 0.1433, 0.1431, 0.1417]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0625, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1115, 0.1112, 0.1112, 0.1111, 0.1109, 0.1110, 0.1110, 0.1109, 0.1112],
        [0.1115, 0.1112, 0.1112, 0.1111, 0.1109, 0.1110, 0.1110, 0.1109, 0.1112],
        [0.1115, 0.1112, 0.1112, 0.1111, 0.1109, 0.1110, 0.1110, 0.1109, 0.1112],
        [0.1115, 0.1112, 0.1112, 0.1111, 0.1109, 0.1110, 0.1110, 0.1109, 0.1112],
        [0.1115, 0.1112, 0.1112, 0.1111, 0.1109, 0.1110, 0.1110, 0.1109, 0.1112],
        [0.1115, 0.1112, 0.1112, 0.1111, 0.1109, 0.1110, 0.1110, 0.1109, 0.1112],
        [0.1115, 0.1112, 0.1112, 0.1111, 0.1109, 0.1110, 0.1110, 0.1109, 0.1112],
        [0.1115, 0.1112, 0.1112, 0.1111, 0.1109, 0.1110, 0.1110, 0.1109, 0.1112],
        [0.1115, 0.1112, 0.1112, 0.1111, 0.1109, 0.1110, 0.1110, 0.1109, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2510, 0.2505, 0.2510, 0.2475],
        [0.2510, 0.2504, 0.2510, 0.2477],
        [0.2510, 0.2504, 0.2510, 0.2476],
        [0.2509, 0.2504, 0.2510, 0.2476]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0835, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0831, 0.0834, 0.0833, 0.0833, 0.0834, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0835, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0834, 0.0831, 0.0834, 0.0833, 0.0833, 0.0835, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0835, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0835, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0835, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0831, 0.0834, 0.0833, 0.0833, 0.0835, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0835, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0835, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0835, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0832],
        [0.0834, 0.0834, 0.0831, 0.0833, 0.0832, 0.0833, 0.0835, 0.0835, 0.0834,
         0.0835, 0.0832, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0499, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0770, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771],
        [0.0770, 0.0770, 0.0767, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771],
        [0.0770, 0.0770, 0.0767, 0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771],
        [0.0770, 0.0770, 0.0767, 0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771],
        [0.0769, 0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0770, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771],
        [0.0770, 0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771],
        [0.0770, 0.0770, 0.0767, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771],
        [0.0770, 0.0771, 0.0768, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768, 0.0769,
         0.0769, 0.0769, 0.0770, 0.0770],
        [0.0770, 0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0770, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771],
        [0.0770, 0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0770, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771],
        [0.0770, 0.0770, 0.0767, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771],
        [0.0770, 0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771],
        [0.0770, 0.0770, 0.0767, 0.0769, 0.0769, 0.0770, 0.0769, 0.0768, 0.0769,
         0.0770, 0.0769, 0.0770, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1000, 0.1001, 0.1000, 0.0999, 0.0999, 0.1000, 0.1002, 0.0998,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.0999, 0.1002, 0.0998,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000, 0.1002, 0.0998,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.0999, 0.1002, 0.0998,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000, 0.1002, 0.0998,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000, 0.1002, 0.0998,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.0999, 0.1002, 0.0998,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.0999, 0.1002, 0.0998,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000, 0.1002, 0.0998,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.0999, 0.1000, 0.1000, 0.1002, 0.0998,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.21688485145568848s
iter time cost:11.113577365875244s
-------------Round number: 27-------------
Evaluate global model
[running kmeans]: 5it [00:00, 333.03it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 1.2983
Averaged Test Accurancy: 0.7192
Std Test Accurancy: 0.1296
evaluate time cost:5.031761407852173s
clients training time cost:4.874030351638794s
attn_optimize time cost:0.4547293186187744s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0499, 0.0499,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0769, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1431, 0.1428, 0.1428, 0.1429, 0.1427, 0.1429, 0.1428],
        [0.1432, 0.1427, 0.1428, 0.1429, 0.1427, 0.1429, 0.1428],
        [0.1431, 0.1428, 0.1428, 0.1429, 0.1427, 0.1429, 0.1428],
        [0.1432, 0.1428, 0.1428, 0.1428, 0.1427, 0.1429, 0.1428],
        [0.1432, 0.1427, 0.1428, 0.1428, 0.1427, 0.1429, 0.1429],
        [0.1432, 0.1427, 0.1428, 0.1428, 0.1427, 0.1429, 0.1429],
        [0.1431, 0.1427, 0.1428, 0.1429, 0.1427, 0.1429, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0911, 0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0908, 0.0908, 0.0911,
         0.0909, 0.0909],
        [0.0910, 0.0908, 0.0909, 0.0908, 0.0909, 0.0910, 0.0909, 0.0908, 0.0911,
         0.0909, 0.0909],
        [0.0910, 0.0908, 0.0909, 0.0908, 0.0909, 0.0910, 0.0909, 0.0908, 0.0911,
         0.0909, 0.0909],
        [0.0910, 0.0908, 0.0909, 0.0908, 0.0909, 0.0911, 0.0908, 0.0908, 0.0911,
         0.0909, 0.0909],
        [0.0910, 0.0908, 0.0909, 0.0908, 0.0909, 0.0910, 0.0909, 0.0908, 0.0911,
         0.0909, 0.0909],
        [0.0910, 0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0909, 0.0908, 0.0911,
         0.0909, 0.0909],
        [0.0910, 0.0908, 0.0909, 0.0908, 0.0909, 0.0910, 0.0908, 0.0908, 0.0911,
         0.0909, 0.0909],
        [0.0911, 0.0907, 0.0909, 0.0908, 0.0909, 0.0910, 0.0909, 0.0908, 0.0911,
         0.0909, 0.0909],
        [0.0910, 0.0908, 0.0909, 0.0908, 0.0909, 0.0910, 0.0909, 0.0907, 0.0910,
         0.0909, 0.0909],
        [0.0910, 0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0908, 0.0908, 0.0911,
         0.0909, 0.0909],
        [0.0910, 0.0908, 0.0909, 0.0908, 0.0909, 0.0911, 0.0908, 0.0908, 0.0911,
         0.0909, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0501, 0.0502, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0497, 0.0500, 0.0501,
         0.0500, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1670, 0.1669, 0.1664, 0.1662, 0.1668, 0.1667],
        [0.1670, 0.1669, 0.1664, 0.1662, 0.1668, 0.1667],
        [0.1670, 0.1669, 0.1665, 0.1662, 0.1668, 0.1666],
        [0.1670, 0.1669, 0.1665, 0.1662, 0.1668, 0.1666],
        [0.1670, 0.1669, 0.1664, 0.1662, 0.1668, 0.1666],
        [0.1670, 0.1669, 0.1665, 0.1662, 0.1668, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1424, 0.1434, 0.1428, 0.1431, 0.1436, 0.1430, 0.1417],
        [0.1424, 0.1434, 0.1428, 0.1431, 0.1435, 0.1429, 0.1418],
        [0.1424, 0.1434, 0.1428, 0.1431, 0.1436, 0.1429, 0.1417],
        [0.1424, 0.1434, 0.1429, 0.1431, 0.1436, 0.1429, 0.1418],
        [0.1424, 0.1434, 0.1428, 0.1431, 0.1435, 0.1429, 0.1418],
        [0.1424, 0.1434, 0.1428, 0.1431, 0.1436, 0.1429, 0.1418],
        [0.1423, 0.1434, 0.1428, 0.1432, 0.1437, 0.1431, 0.1415]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769, 0.0769, 0.0769, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769, 0.0769, 0.0769, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769, 0.0769, 0.0770, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769, 0.0769, 0.0769, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769, 0.0769, 0.0769, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769, 0.0769, 0.0770, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0769, 0.0769, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769, 0.0769, 0.0769, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769, 0.0769, 0.0769, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769, 0.0769, 0.0770, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0768, 0.0769, 0.0768, 0.0769, 0.0769, 0.0769, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769, 0.0769, 0.0769, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771],
        [0.0769, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769, 0.0769, 0.0769, 0.0768,
         0.0769, 0.0768, 0.0770, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4996, 0.5004],
        [0.4995, 0.5005]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3563237190246582s
iter time cost:10.827152729034424s
-------------Round number: 28-------------
Evaluate global model
[running kmeans]: 4it [00:00, 333.03it/s, center_shift=0.000000, iteration=4, tol=0.000100]
Averaged Train Loss: 0.8001
Averaged Test Accurancy: 0.7129
Std Test Accurancy: 0.1532
evaluate time cost:5.527395009994507s
[running kmeans]: 9it [00:00, 374.66it/s, center_shift=0.000000, iteration=9, tol=0.000100]
clients training time cost:4.942046880722046s
attn_optimize time cost:0.4650888442993164s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0770, 0.0768, 0.0769, 0.0768, 0.0771, 0.0769, 0.0770, 0.0767, 0.0771,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0770, 0.0769, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0771, 0.0769, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0770, 0.0769, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0770, 0.0769, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0770, 0.0769, 0.0771, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0770, 0.0769, 0.0770, 0.0768, 0.0771,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0771, 0.0769, 0.0770, 0.0767, 0.0770,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0770, 0.0769, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0770, 0.0769, 0.0770, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0771, 0.0769, 0.0770, 0.0767, 0.0770,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0771, 0.0769, 0.0770, 0.0767, 0.0771,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0770, 0.0769, 0.0771, 0.0768, 0.0770,
         0.0771, 0.0769, 0.0767, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1432, 0.1427, 0.1422, 0.1429, 0.1425, 0.1431],
        [0.1433, 0.1432, 0.1427, 0.1422, 0.1429, 0.1425, 0.1431],
        [0.1433, 0.1432, 0.1427, 0.1422, 0.1429, 0.1426, 0.1431],
        [0.1433, 0.1432, 0.1427, 0.1422, 0.1429, 0.1426, 0.1430],
        [0.1433, 0.1432, 0.1427, 0.1422, 0.1429, 0.1425, 0.1431],
        [0.1433, 0.1432, 0.1427, 0.1422, 0.1429, 0.1425, 0.1432],
        [0.1434, 0.1432, 0.1426, 0.1421, 0.1429, 0.1424, 0.1435]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0716, 0.0712, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0712, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0712, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0712, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0712, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0712, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0712, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0712, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0712, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0712, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0716],
        [0.0714, 0.0716, 0.0712, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1250, 0.1248, 0.1250, 0.1249, 0.1249, 0.1253],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250, 0.1249, 0.1253],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1250, 0.1249, 0.1249, 0.1253],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250, 0.1249, 0.1253],
        [0.1250, 0.1250, 0.1250, 0.1247, 0.1250, 0.1250, 0.1249, 0.1253],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250, 0.1249, 0.1253],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1250, 0.1249, 0.1250, 0.1253],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1250, 0.1249, 0.1249, 0.1253]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0835, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0834, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0835, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0835, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0836, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0834, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0836, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0834, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0836, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0834, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0836, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0834, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0835, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0836, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0834, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0835, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0832],
        [0.0834, 0.0832, 0.0831, 0.0834, 0.0833, 0.0834, 0.0835, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0831],
        [0.0834, 0.0832, 0.0831, 0.0833, 0.0832, 0.0834, 0.0836, 0.0834, 0.0834,
         0.0835, 0.0834, 0.0831]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0910, 0.0911, 0.0910, 0.0907, 0.0908, 0.0907, 0.0911, 0.0910,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0911, 0.0910, 0.0907, 0.0908, 0.0907, 0.0911, 0.0910,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0911, 0.0910, 0.0907, 0.0908, 0.0907, 0.0911, 0.0910,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0911, 0.0910, 0.0907, 0.0908, 0.0907, 0.0911, 0.0910,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0911, 0.0910, 0.0907, 0.0908, 0.0907, 0.0911, 0.0910,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0911, 0.0910, 0.0907, 0.0908, 0.0907, 0.0911, 0.0910,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0911, 0.0910, 0.0907, 0.0908, 0.0907, 0.0911, 0.0910,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0911, 0.0910, 0.0907, 0.0908, 0.0907, 0.0911, 0.0910,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0911, 0.0910, 0.0907, 0.0908, 0.0907, 0.0911, 0.0910,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0911, 0.0910, 0.0907, 0.0908, 0.0907, 0.0911, 0.0910,
         0.0909, 0.0908],
        [0.0909, 0.0910, 0.0911, 0.0910, 0.0907, 0.0908, 0.0907, 0.0911, 0.0910,
         0.0909, 0.0908]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1664, 0.1673, 0.1668, 0.1671, 0.1669, 0.1656],
        [0.1663, 0.1672, 0.1668, 0.1671, 0.1668, 0.1657],
        [0.1664, 0.1673, 0.1668, 0.1671, 0.1669, 0.1656],
        [0.1664, 0.1672, 0.1668, 0.1671, 0.1668, 0.1657],
        [0.1663, 0.1673, 0.1668, 0.1671, 0.1668, 0.1657],
        [0.1663, 0.1673, 0.1667, 0.1672, 0.1670, 0.1654]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1254, 0.1251, 0.1245, 0.1250, 0.1252, 0.1246, 0.1251],
        [0.1250, 0.1254, 0.1252, 0.1246, 0.1249, 0.1252, 0.1246, 0.1251],
        [0.1249, 0.1254, 0.1252, 0.1245, 0.1249, 0.1253, 0.1246, 0.1251],
        [0.1250, 0.1254, 0.1251, 0.1245, 0.1250, 0.1252, 0.1246, 0.1251],
        [0.1250, 0.1254, 0.1251, 0.1245, 0.1250, 0.1252, 0.1246, 0.1251],
        [0.1249, 0.1254, 0.1252, 0.1246, 0.1250, 0.1252, 0.1246, 0.1251],
        [0.1250, 0.1254, 0.1252, 0.1245, 0.1249, 0.1252, 0.1246, 0.1251],
        [0.1250, 0.1254, 0.1252, 0.1246, 0.1249, 0.1252, 0.1246, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3328862190246582s
iter time cost:11.354496240615845s
-------------Round number: 29-------------
Evaluate global model
Averaged Train Loss: 0.7106
Averaged Test Accurancy: 0.7580
Std Test Accurancy: 0.1238
evaluate time cost:5.1402928829193115s
[running kmeans]: 6it [00:00, 374.66it/s, center_shift=0.000000, iteration=6, tol=0.000100]
clients training time cost:4.886998414993286s
attn_optimize time cost:0.5480530261993408s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.3328, 0.3330, 0.3342],
        [0.3328, 0.3330, 0.3342],
        [0.3328, 0.3330, 0.3342]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.0998, 0.0999, 0.1001, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.0999, 0.1001, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.0999, 0.1001, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.0999, 0.1001, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1002, 0.0998, 0.0999, 0.1001, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1002, 0.0999, 0.0999, 0.1000, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1002, 0.0998, 0.0999, 0.1001, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1002, 0.0998, 0.0999, 0.1001, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1002, 0.0998, 0.0999, 0.1001, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000,
         0.1000],
        [0.1002, 0.0998, 0.0999, 0.1001, 0.1001, 0.1000, 0.0999, 0.1000, 0.1000,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0831, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0835, 0.0833, 0.0835,
         0.0833, 0.0834, 0.0833],
        [0.0831, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0834, 0.0833, 0.0835,
         0.0834, 0.0834, 0.0832],
        [0.0831, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0835, 0.0833, 0.0835,
         0.0834, 0.0834, 0.0833],
        [0.0831, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0835, 0.0833, 0.0835,
         0.0834, 0.0834, 0.0832],
        [0.0831, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0835, 0.0833, 0.0835,
         0.0834, 0.0834, 0.0832],
        [0.0831, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0835, 0.0833, 0.0835,
         0.0834, 0.0834, 0.0832],
        [0.0831, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0835, 0.0833, 0.0835,
         0.0834, 0.0834, 0.0833],
        [0.0831, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0835, 0.0833, 0.0835,
         0.0834, 0.0834, 0.0833],
        [0.0831, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0835, 0.0833, 0.0835,
         0.0834, 0.0834, 0.0832],
        [0.0831, 0.0834, 0.0832, 0.0834, 0.0833, 0.0833, 0.0835, 0.0833, 0.0835,
         0.0834, 0.0834, 0.0833],
        [0.0831, 0.0835, 0.0832, 0.0834, 0.0833, 0.0833, 0.0835, 0.0833, 0.0835,
         0.0834, 0.0834, 0.0832],
        [0.0830, 0.0835, 0.0832, 0.0834, 0.0832, 0.0833, 0.0835, 0.0833, 0.0835,
         0.0834, 0.0833, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1670, 0.1669, 0.1665, 0.1661, 0.1668, 0.1667],
        [0.1670, 0.1669, 0.1665, 0.1662, 0.1667, 0.1667],
        [0.1670, 0.1669, 0.1665, 0.1661, 0.1668, 0.1667],
        [0.1670, 0.1669, 0.1665, 0.1661, 0.1668, 0.1667],
        [0.1670, 0.1669, 0.1665, 0.1661, 0.1668, 0.1667],
        [0.1670, 0.1669, 0.1665, 0.1662, 0.1668, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1253, 0.1244, 0.1254, 0.1250, 0.1247, 0.1251],
        [0.1251, 0.1250, 0.1252, 0.1245, 0.1254, 0.1250, 0.1248, 0.1251],
        [0.1251, 0.1250, 0.1253, 0.1245, 0.1254, 0.1250, 0.1248, 0.1251],
        [0.1250, 0.1250, 0.1252, 0.1245, 0.1254, 0.1250, 0.1248, 0.1251],
        [0.1251, 0.1250, 0.1253, 0.1245, 0.1254, 0.1250, 0.1248, 0.1251],
        [0.1250, 0.1250, 0.1252, 0.1245, 0.1254, 0.1250, 0.1247, 0.1251],
        [0.1251, 0.1250, 0.1253, 0.1244, 0.1254, 0.1250, 0.1247, 0.1251],
        [0.1251, 0.1250, 0.1253, 0.1244, 0.1254, 0.1250, 0.1247, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0626, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0626, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0625, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2508, 0.2506, 0.2511, 0.2474],
        [0.2508, 0.2505, 0.2510, 0.2477],
        [0.2508, 0.2505, 0.2510, 0.2476],
        [0.2507, 0.2507, 0.2510, 0.2476]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.34589171409606934s
iter time cost:11.022327899932861s
-------------Round number: 30-------------
Evaluate global model
Averaged Train Loss: 0.8642
Averaged Test Accurancy: 0.7129
Std Test Accurancy: 0.1645
evaluate time cost:5.656046390533447s
[running kmeans]: 6it [00:00, 352.62it/s, center_shift=0.000000, iteration=6, tol=0.000100]
clients training time cost:4.923772096633911s
attn_optimize time cost:0.4768502712249756s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2496, 0.2504, 0.2502, 0.2498],
        [0.2496, 0.2504, 0.2502, 0.2498],
        [0.2496, 0.2504, 0.2502, 0.2498],
        [0.2496, 0.2504, 0.2502, 0.2498]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500, 0.0498,
         0.0500, 0.0502]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1002, 0.1001, 0.0998, 0.1000, 0.0998, 0.1001, 0.1001, 0.1000,
         0.0998],
        [0.1001, 0.1002, 0.1001, 0.0998, 0.1000, 0.0998, 0.1001, 0.1001, 0.1000,
         0.0998],
        [0.1001, 0.1002, 0.1001, 0.0998, 0.1000, 0.0998, 0.1001, 0.1001, 0.1000,
         0.0998],
        [0.1001, 0.1002, 0.1001, 0.0998, 0.1000, 0.0998, 0.1001, 0.1001, 0.1000,
         0.0998],
        [0.1001, 0.1002, 0.1001, 0.0998, 0.1000, 0.0998, 0.1001, 0.1001, 0.1000,
         0.0998],
        [0.1001, 0.1002, 0.1001, 0.0998, 0.1000, 0.0998, 0.1001, 0.1001, 0.1000,
         0.0998],
        [0.1001, 0.1002, 0.1001, 0.0998, 0.1000, 0.0998, 0.1001, 0.1001, 0.1000,
         0.0998],
        [0.1001, 0.1002, 0.1001, 0.0998, 0.1000, 0.0998, 0.1001, 0.1001, 0.1000,
         0.0998],
        [0.1001, 0.1002, 0.1001, 0.0998, 0.1000, 0.0998, 0.1001, 0.1001, 0.1000,
         0.0998],
        [0.1001, 0.1002, 0.1001, 0.0998, 0.1000, 0.0998, 0.1001, 0.1000, 0.1000,
         0.0998]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1428, 0.1426, 0.1427, 0.1429, 0.1429, 0.1433],
        [0.1428, 0.1428, 0.1426, 0.1427, 0.1429, 0.1429, 0.1433],
        [0.1428, 0.1428, 0.1426, 0.1427, 0.1429, 0.1429, 0.1433],
        [0.1428, 0.1428, 0.1426, 0.1427, 0.1429, 0.1429, 0.1433],
        [0.1428, 0.1428, 0.1426, 0.1427, 0.1429, 0.1429, 0.1433],
        [0.1428, 0.1428, 0.1426, 0.1427, 0.1429, 0.1429, 0.1433],
        [0.1428, 0.1428, 0.1426, 0.1427, 0.1429, 0.1429, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0496],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0496],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0497],
        [0.0500, 0.0502, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0496],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0496],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0496],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0496],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0496],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0496],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0497],
        [0.0500, 0.0501, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1252, 0.1250, 0.1252, 0.1251, 0.1248, 0.1249, 0.1250, 0.1249],
        [0.1252, 0.1250, 0.1252, 0.1251, 0.1248, 0.1249, 0.1250, 0.1249],
        [0.1253, 0.1250, 0.1251, 0.1251, 0.1248, 0.1249, 0.1250, 0.1249],
        [0.1253, 0.1250, 0.1252, 0.1251, 0.1247, 0.1249, 0.1250, 0.1248],
        [0.1253, 0.1250, 0.1252, 0.1251, 0.1247, 0.1249, 0.1250, 0.1248],
        [0.1253, 0.1250, 0.1251, 0.1251, 0.1248, 0.1249, 0.1250, 0.1248],
        [0.1252, 0.1250, 0.1251, 0.1251, 0.1248, 0.1249, 0.1250, 0.1249],
        [0.1252, 0.1250, 0.1252, 0.1251, 0.1248, 0.1249, 0.1250, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1670, 0.1668, 0.1668, 0.1660, 0.1667],
        [0.1667, 0.1671, 0.1668, 0.1668, 0.1660, 0.1667],
        [0.1667, 0.1670, 0.1668, 0.1668, 0.1660, 0.1667],
        [0.1667, 0.1670, 0.1668, 0.1668, 0.1660, 0.1667],
        [0.1667, 0.1670, 0.1668, 0.1668, 0.1660, 0.1667],
        [0.1667, 0.1670, 0.1668, 0.1668, 0.1660, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2511, 0.2503, 0.2511, 0.2475],
        [0.2511, 0.2503, 0.2511, 0.2475],
        [0.2510, 0.2503, 0.2511, 0.2475],
        [0.2511, 0.2504, 0.2511, 0.2475]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3313014507293701s
iter time cost:11.474047899246216s
-------------Round number: 31-------------
Evaluate global model
Averaged Train Loss: 0.7415
Averaged Test Accurancy: 0.7490
Std Test Accurancy: 0.1270
evaluate time cost:5.288634300231934s
clients training time cost:4.815819025039673s
attn_optimize time cost:0.4698760509490967s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2510, 0.2504, 0.2513, 0.2474],
        [0.2509, 0.2503, 0.2512, 0.2476],
        [0.2509, 0.2503, 0.2512, 0.2476],
        [0.2509, 0.2504, 0.2513, 0.2474]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
[running kmeans]: 4it [00:00, 307.42it/s, center_shift=0.000000, iteration=4, tol=0.000100]
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0502, 0.0498, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0499, 0.0502, 0.0499, 0.0502, 0.0498, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0503]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2003, 0.1998, 0.1998, 0.1999, 0.2003],
        [0.2003, 0.1998, 0.1998, 0.1999, 0.2003],
        [0.2003, 0.1998, 0.1998, 0.1999, 0.2003],
        [0.2003, 0.1998, 0.1998, 0.1999, 0.2003],
        [0.2003, 0.1998, 0.1998, 0.1999, 0.2003]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1664, 0.1673, 0.1668, 0.1673, 0.1668, 0.1655],
        [0.1663, 0.1673, 0.1667, 0.1672, 0.1667, 0.1657],
        [0.1664, 0.1673, 0.1668, 0.1673, 0.1668, 0.1655],
        [0.1663, 0.1673, 0.1668, 0.1673, 0.1667, 0.1656],
        [0.1664, 0.1673, 0.1667, 0.1672, 0.1667, 0.1656],
        [0.1663, 0.1674, 0.1667, 0.1674, 0.1669, 0.1653]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1002, 0.0997, 0.1000, 0.1000, 0.0999, 0.0999, 0.0999, 0.1001,
         0.1002],
        [0.1000, 0.1003, 0.0997, 0.1000, 0.1000, 0.0999, 0.0999, 0.0999, 0.1001,
         0.1002],
        [0.1000, 0.1003, 0.0997, 0.1000, 0.1000, 0.0999, 0.0999, 0.0999, 0.1001,
         0.1002],
        [0.1000, 0.1003, 0.0997, 0.1000, 0.1000, 0.0999, 0.0999, 0.0999, 0.1001,
         0.1002],
        [0.1000, 0.1003, 0.0997, 0.1000, 0.1000, 0.0999, 0.0999, 0.0999, 0.1001,
         0.1002],
        [0.1000, 0.1003, 0.0997, 0.1000, 0.1000, 0.0999, 0.0999, 0.0999, 0.1001,
         0.1002],
        [0.1000, 0.1003, 0.0997, 0.1000, 0.1000, 0.0999, 0.0999, 0.0999, 0.1001,
         0.1002],
        [0.1000, 0.1003, 0.0997, 0.1000, 0.1000, 0.0999, 0.0999, 0.0999, 0.1001,
         0.1002],
        [0.1000, 0.1003, 0.0997, 0.1000, 0.1000, 0.0999, 0.0999, 0.0999, 0.1001,
         0.1002],
        [0.1000, 0.1003, 0.0997, 0.1000, 0.1000, 0.0999, 0.0999, 0.0999, 0.1001,
         0.1002]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2498, 0.2504, 0.2497, 0.2501],
        [0.2498, 0.2504, 0.2497, 0.2501],
        [0.2499, 0.2504, 0.2496, 0.2501],
        [0.2499, 0.2504, 0.2497, 0.2501]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3335, 0.3334, 0.3331],
        [0.3335, 0.3334, 0.3331],
        [0.3335, 0.3334, 0.3331]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0625, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0625, 0.0624, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0832, 0.0832],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0833, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0832, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0835, 0.0833, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0832, 0.0832],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0832, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0832, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0832, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0832, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0832, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0832, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0832, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0832, 0.0834, 0.0833, 0.0833, 0.0835,
         0.0834, 0.0831, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.34064793586730957s
iter time cost:11.037086963653564s
-------------Round number: 32-------------
Evaluate global model
Averaged Train Loss: 0.6829
Averaged Test Accurancy: 0.7490
Std Test Accurancy: 0.1215
evaluate time cost:5.72320032119751s
[running kmeans]: 6it [00:00, 399.65it/s, center_shift=0.000000, iteration=6, tol=0.000100]
clients training time cost:4.806633472442627s
attn_optimize time cost:0.44106149673461914s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0768, 0.0770, 0.0768, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0768, 0.0770, 0.0768, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0768, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0769, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0769, 0.0770, 0.0769, 0.0769, 0.0769, 0.0770, 0.0770, 0.0768,
         0.0770, 0.0770, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1662, 0.1674, 0.1667, 0.1674, 0.1667, 0.1656],
        [0.1661, 0.1674, 0.1666, 0.1674, 0.1667, 0.1658],
        [0.1662, 0.1674, 0.1666, 0.1674, 0.1667, 0.1657],
        [0.1661, 0.1674, 0.1667, 0.1674, 0.1667, 0.1658],
        [0.1661, 0.1674, 0.1666, 0.1674, 0.1666, 0.1658],
        [0.1660, 0.1675, 0.1665, 0.1676, 0.1668, 0.1656]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0715, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0715, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0714, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0714, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0715, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0715, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0713, 0.0715, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0714, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0714, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0714, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0714, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0715, 0.0713, 0.0715, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0715, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0714, 0.0713, 0.0715, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0716],
        [0.0714, 0.0716, 0.0713, 0.0714, 0.0713, 0.0715, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0714, 0.0714, 0.0716]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1431, 0.1428, 0.1428, 0.1427, 0.1427, 0.1430, 0.1429],
        [0.1431, 0.1428, 0.1428, 0.1427, 0.1427, 0.1430, 0.1429],
        [0.1431, 0.1428, 0.1428, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1431, 0.1428, 0.1428, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1431, 0.1428, 0.1428, 0.1428, 0.1427, 0.1430, 0.1429],
        [0.1431, 0.1428, 0.1428, 0.1427, 0.1427, 0.1430, 0.1429],
        [0.1431, 0.1428, 0.1428, 0.1427, 0.1427, 0.1430, 0.1430]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1248, 0.1248, 0.1251, 0.1249, 0.1254, 0.1252, 0.1252, 0.1246],
        [0.1248, 0.1248, 0.1251, 0.1248, 0.1254, 0.1252, 0.1252, 0.1246],
        [0.1248, 0.1248, 0.1251, 0.1249, 0.1254, 0.1252, 0.1252, 0.1246],
        [0.1248, 0.1248, 0.1251, 0.1249, 0.1254, 0.1252, 0.1252, 0.1247],
        [0.1248, 0.1248, 0.1251, 0.1249, 0.1254, 0.1252, 0.1252, 0.1246],
        [0.1248, 0.1248, 0.1251, 0.1249, 0.1254, 0.1252, 0.1252, 0.1246],
        [0.1248, 0.1248, 0.1251, 0.1249, 0.1254, 0.1252, 0.1252, 0.1246],
        [0.1248, 0.1247, 0.1249, 0.1248, 0.1255, 0.1253, 0.1253, 0.1246]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1248, 0.1250, 0.1250, 0.1249, 0.1249, 0.1253, 0.1250, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1249, 0.1249, 0.1253, 0.1250, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1249, 0.1249, 0.1253, 0.1250, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1249, 0.1249, 0.1253, 0.1250, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1249, 0.1249, 0.1253, 0.1250, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1249, 0.1249, 0.1253, 0.1250, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1249, 0.1249, 0.1253, 0.1250, 0.1251],
        [0.1248, 0.1250, 0.1250, 0.1249, 0.1249, 0.1254, 0.1250, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1430, 0.1427, 0.1422, 0.1430, 0.1427, 0.1433],
        [0.1432, 0.1431, 0.1426, 0.1422, 0.1430, 0.1427, 0.1432],
        [0.1432, 0.1430, 0.1427, 0.1422, 0.1431, 0.1427, 0.1432],
        [0.1432, 0.1431, 0.1427, 0.1422, 0.1431, 0.1427, 0.1431],
        [0.1432, 0.1430, 0.1426, 0.1422, 0.1431, 0.1427, 0.1433],
        [0.1432, 0.1430, 0.1426, 0.1422, 0.1430, 0.1426, 0.1433],
        [0.1432, 0.1430, 0.1426, 0.1420, 0.1430, 0.1425, 0.1436]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0501, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0493],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0503, 0.0502, 0.0502, 0.0502, 0.0498, 0.0499,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0497, 0.0500, 0.0500,
         0.0499, 0.0492]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0831, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0834],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0833, 0.0831, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0831, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0831, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0834],
        [0.0834, 0.0834, 0.0834, 0.0833, 0.0832, 0.0831, 0.0833, 0.0833, 0.0834,
         0.0835, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0831, 0.0833, 0.0833, 0.0833,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0833, 0.0834, 0.0833, 0.0833, 0.0831, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0831, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0831, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0834],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0831, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0834],
        [0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0831, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0835, 0.0834],
        [0.0833, 0.0834, 0.0834, 0.0833, 0.0833, 0.0831, 0.0833, 0.0833, 0.0834,
         0.0834, 0.0834, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2003, 0.2001, 0.2001, 0.1997, 0.1998],
        [0.2003, 0.2001, 0.2001, 0.1997, 0.1998],
        [0.2003, 0.2001, 0.2001, 0.1997, 0.1998],
        [0.2003, 0.2001, 0.2001, 0.1997, 0.1998],
        [0.2003, 0.2001, 0.2001, 0.1997, 0.1998]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.20974230766296387s
iter time cost:11.264714241027832s
-------------Round number: 33-------------
Evaluate global model
Averaged Train Loss: 0.9414
Averaged Test Accurancy: 0.7008
Std Test Accurancy: 0.1681
evaluate time cost:5.020549774169922s
clients training time cost:4.781941890716553s
attn_optimize time cost:0.4261138439178467s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1421, 0.1431, 0.1427, 0.1431, 0.1428, 0.1432, 0.1430],
        [0.1421, 0.1431, 0.1427, 0.1431, 0.1428, 0.1432, 0.1429],
        [0.1421, 0.1431, 0.1427, 0.1431, 0.1428, 0.1432, 0.1429],
        [0.1421, 0.1431, 0.1427, 0.1431, 0.1428, 0.1432, 0.1429],
        [0.1421, 0.1431, 0.1427, 0.1431, 0.1428, 0.1432, 0.1429],
        [0.1421, 0.1431, 0.1427, 0.1431, 0.1428, 0.1432, 0.1429],
        [0.1421, 0.1431, 0.1427, 0.1431, 0.1428, 0.1432, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0492]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1431, 0.1425, 0.1430, 0.1427, 0.1428, 0.1431],
        [0.1428, 0.1432, 0.1425, 0.1430, 0.1427, 0.1428, 0.1431],
        [0.1428, 0.1431, 0.1425, 0.1430, 0.1427, 0.1428, 0.1431],
        [0.1428, 0.1432, 0.1425, 0.1430, 0.1427, 0.1428, 0.1431],
        [0.1428, 0.1431, 0.1425, 0.1430, 0.1427, 0.1428, 0.1431],
        [0.1428, 0.1432, 0.1425, 0.1430, 0.1427, 0.1428, 0.1431],
        [0.1428, 0.1432, 0.1425, 0.1430, 0.1427, 0.1428, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1664, 0.1667, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1664, 0.1667, 0.1668, 0.1668, 0.1667, 0.1667],
        [0.1664, 0.1667, 0.1668, 0.1668, 0.1667, 0.1667],
        [0.1664, 0.1667, 0.1668, 0.1667, 0.1667, 0.1666],
        [0.1664, 0.1667, 0.1668, 0.1667, 0.1667, 0.1667],
        [0.1664, 0.1667, 0.1668, 0.1668, 0.1667, 0.1667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1998, 0.1997, 0.2004, 0.2001, 0.1999],
        [0.1998, 0.1997, 0.2005, 0.2001, 0.1999],
        [0.1999, 0.1997, 0.2004, 0.2001, 0.1999],
        [0.1999, 0.1996, 0.2005, 0.2002, 0.1999],
        [0.1999, 0.1997, 0.2004, 0.2001, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0835, 0.0831, 0.0833, 0.0832, 0.0834, 0.0834, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0835, 0.0831, 0.0833, 0.0832, 0.0834, 0.0834, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0831, 0.0833, 0.0832, 0.0834, 0.0833, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0835, 0.0831, 0.0833, 0.0832, 0.0834, 0.0834, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0835, 0.0831, 0.0833, 0.0832, 0.0834, 0.0834, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0835, 0.0831, 0.0833, 0.0832, 0.0834, 0.0834, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0835, 0.0831, 0.0833, 0.0832, 0.0834, 0.0834, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0835, 0.0831, 0.0833, 0.0832, 0.0834, 0.0834, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0831, 0.0833, 0.0832, 0.0834, 0.0834, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0835, 0.0831, 0.0833, 0.0832, 0.0834, 0.0834, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0831, 0.0833, 0.0832, 0.0834, 0.0834, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0835, 0.0831, 0.0833, 0.0832, 0.0834, 0.0834, 0.0834, 0.0832,
         0.0833, 0.0834, 0.0836]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 5it [00:00, 293.85it/s, center_shift=0.000000, iteration=5, tol=0.000100]
weights:tensor([[0.0251, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0251, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0251, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        ...,
        [0.0251, 0.0250, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        [0.0251, 0.0250, 0.0250,  ..., 0.0249, 0.0250, 0.0249],
        [0.0251, 0.0250, 0.0250,  ..., 0.0249, 0.0250, 0.0251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3713369369506836s
iter time cost:10.681592464447021s
-------------Round number: 34-------------
Evaluate global model
Averaged Train Loss: 0.7392
Averaged Test Accurancy: 0.7434
Std Test Accurancy: 0.1571
evaluate time cost:5.729400634765625s
[running kmeans]: 4it [00:00, 333.05it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:4.83858323097229s
attn_optimize time cost:0.7478744983673096s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.3335, 0.3328, 0.3337],
        [0.3335, 0.3328, 0.3337],
        [0.3335, 0.3328, 0.3338]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0836, 0.0834, 0.0835,
         0.0833, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0832, 0.0836, 0.0834, 0.0835,
         0.0833, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0833, 0.0836, 0.0834, 0.0835,
         0.0833, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0832, 0.0836, 0.0834, 0.0835,
         0.0833, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0833, 0.0836, 0.0834, 0.0835,
         0.0833, 0.0833, 0.0831],
        [0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0833, 0.0836, 0.0834, 0.0835,
         0.0833, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0833, 0.0836, 0.0834, 0.0835,
         0.0833, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0832, 0.0836, 0.0834, 0.0835,
         0.0833, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0833, 0.0836, 0.0834, 0.0835,
         0.0833, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0832, 0.0836, 0.0834, 0.0835,
         0.0832, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0833, 0.0836, 0.0834, 0.0835,
         0.0833, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0833, 0.0832, 0.0831, 0.0832, 0.0837, 0.0834, 0.0836,
         0.0833, 0.0833, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1112, 0.1114, 0.1112, 0.1108, 0.1110, 0.1113, 0.1112, 0.1111, 0.1109],
        [0.1112, 0.1114, 0.1112, 0.1108, 0.1110, 0.1113, 0.1112, 0.1111, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1108, 0.1110, 0.1113, 0.1112, 0.1111, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1108, 0.1110, 0.1113, 0.1112, 0.1111, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1108, 0.1110, 0.1113, 0.1112, 0.1111, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1108, 0.1110, 0.1113, 0.1112, 0.1111, 0.1109],
        [0.1112, 0.1114, 0.1112, 0.1108, 0.1110, 0.1113, 0.1112, 0.1111, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1108, 0.1110, 0.1113, 0.1112, 0.1111, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1108, 0.1110, 0.1113, 0.1112, 0.1111, 0.1109]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0624, 0.0625, 0.0626, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0624, 0.0625, 0.0625, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0624, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0624, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0624, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0624, 0.0625, 0.0625, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0624, 0.0625, 0.0626, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0624, 0.0625, 0.0625, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0624, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0624, 0.0625, 0.0626, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0624, 0.0625, 0.0626, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0625, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0624, 0.0625, 0.0626, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0625, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0624, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0625, 0.0623, 0.0625, 0.0626, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0625, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0624, 0.0625, 0.0625, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0625, 0.0624, 0.0625, 0.0626, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0625, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0624, 0.0625, 0.0626, 0.0625,
         0.0624, 0.0624, 0.0625, 0.0625, 0.0625, 0.0626, 0.0627]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1250, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1250, 0.1247, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1250, 0.1247, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1250, 0.1248, 0.1250, 0.1250, 0.1250, 0.1253]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0501,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0498, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1432, 0.1430, 0.1427, 0.1430, 0.1422, 0.1429],
        [0.1430, 0.1433, 0.1430, 0.1427, 0.1430, 0.1422, 0.1429],
        [0.1430, 0.1432, 0.1430, 0.1427, 0.1430, 0.1422, 0.1429],
        [0.1430, 0.1432, 0.1430, 0.1427, 0.1430, 0.1422, 0.1429],
        [0.1430, 0.1432, 0.1430, 0.1427, 0.1430, 0.1422, 0.1428],
        [0.1430, 0.1433, 0.1430, 0.1427, 0.1430, 0.1421, 0.1429],
        [0.1430, 0.1433, 0.1430, 0.1427, 0.1430, 0.1422, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2498, 0.2506, 0.2507, 0.2488],
        [0.2498, 0.2506, 0.2507, 0.2489],
        [0.2498, 0.2505, 0.2506, 0.2491],
        [0.2497, 0.2505, 0.2510, 0.2488]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26381444931030273s
iter time cost:11.663749933242798s
-------------Round number: 35-------------
Evaluate global model
Averaged Train Loss: 0.5928
Averaged Test Accurancy: 0.7685
Std Test Accurancy: 0.1205
evaluate time cost:5.455399990081787s
[running kmeans]: 4it [00:00, 333.03it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:4.8461785316467285s
attn_optimize time cost:0.5311195850372314s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0625, 0.0626, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0625, 0.0626, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0625, 0.0626, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0625, 0.0625, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0625, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0625, 0.0625, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0625, 0.0625, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0625, 0.0626, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0625, 0.0626, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0625, 0.0626, 0.0622, 0.0625, 0.0625, 0.0624],
        [0.0626, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0625, 0.0625, 0.0622, 0.0624, 0.0625, 0.0624],
        [0.0626, 0.0625, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0625, 0.0625, 0.0622, 0.0624, 0.0625, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.2000, 0.2001, 0.1998, 0.2000],
        [0.2001, 0.2000, 0.2001, 0.1998, 0.2000],
        [0.2001, 0.2000, 0.2001, 0.1998, 0.1999],
        [0.2001, 0.2000, 0.2002, 0.1998, 0.1999],
        [0.2001, 0.2000, 0.2001, 0.1998, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499, 0.0501, 0.0502,
         0.0499, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.1999, 0.2004, 0.2001, 0.1997],
        [0.2000, 0.1998, 0.2004, 0.2001, 0.1997],
        [0.1999, 0.1998, 0.2004, 0.2001, 0.1998],
        [0.1999, 0.1999, 0.2004, 0.2001, 0.1997],
        [0.2000, 0.1998, 0.2003, 0.2001, 0.1997]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1431, 0.1428, 0.1428, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1431, 0.1428, 0.1428, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1431, 0.1428, 0.1429, 0.1428, 0.1427, 0.1430, 0.1427],
        [0.1431, 0.1428, 0.1428, 0.1428, 0.1427, 0.1430, 0.1427],
        [0.1431, 0.1428, 0.1429, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1431, 0.1428, 0.1428, 0.1428, 0.1427, 0.1430, 0.1428],
        [0.1431, 0.1427, 0.1429, 0.1428, 0.1427, 0.1430, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0500],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0503]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3333, 0.3329, 0.3338],
        [0.3334, 0.3328, 0.3338],
        [0.3333, 0.3328, 0.3338]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3333, 0.3333, 0.3334],
        [0.3333, 0.3333, 0.3333],
        [0.3333, 0.3333, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0498, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0502, 0.0498, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0495],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0502, 0.0498, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0502, 0.0498, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0502, 0.0498, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0502, 0.0498, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0502, 0.0498, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0498, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0500, 0.0498, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.291353702545166s
iter time cost:11.209128618240356s
-------------Round number: 36-------------
Evaluate global model
Averaged Train Loss: 0.7432
Averaged Test Accurancy: 0.7279
Std Test Accurancy: 0.1302
evaluate time cost:5.480936765670776s
clients training time cost:4.839656352996826s
attn_optimize time cost:0.7405099868774414s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
[running kmeans]: 4it [00:00, 285.41it/s, center_shift=0.000000, iteration=4, tol=0.000100]
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0502,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0502,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4987, 0.5013],
        [0.4987, 0.5013]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1110, 0.1112, 0.1111, 0.1110, 0.1112, 0.1112, 0.1113, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1111, 0.1110, 0.1112, 0.1112, 0.1112, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1111, 0.1109, 0.1112, 0.1112, 0.1113, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1111, 0.1109, 0.1112, 0.1112, 0.1113, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1111, 0.1110, 0.1112, 0.1112, 0.1112, 0.1110, 0.1111],
        [0.1111, 0.1112, 0.1111, 0.1109, 0.1112, 0.1112, 0.1113, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1111, 0.1109, 0.1112, 0.1112, 0.1113, 0.1110, 0.1111],
        [0.1110, 0.1111, 0.1111, 0.1110, 0.1112, 0.1112, 0.1112, 0.1110, 0.1111],
        [0.1110, 0.1112, 0.1111, 0.1109, 0.1112, 0.1112, 0.1112, 0.1110, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0497, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502, 0.0501,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3333, 0.3333, 0.3333],
        [0.3334, 0.3333, 0.3333],
        [0.3333, 0.3333, 0.3334]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.0998, 0.1000, 0.1001, 0.0998, 0.0998, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.1001, 0.0998, 0.0998, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.1001, 0.0998, 0.1000, 0.1001, 0.0998, 0.0998, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.1001, 0.0998, 0.1000, 0.1001, 0.0998, 0.0998, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.1001, 0.0998, 0.0998, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.1002, 0.0998, 0.1000, 0.1001, 0.0998, 0.0998, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.1001, 0.0998, 0.0998, 0.1002, 0.1002, 0.0999,
         0.1001],
        [0.1001, 0.0998, 0.1000, 0.1001, 0.0997, 0.0998, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.1001, 0.0998, 0.1000, 0.1001, 0.0998, 0.0998, 0.1002, 0.1001, 0.0999,
         0.1001],
        [0.1001, 0.0998, 0.1000, 0.1001, 0.0998, 0.0998, 0.1002, 0.1001, 0.0999,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1432, 0.1424, 0.1423, 0.1430, 0.1426, 0.1434],
        [0.1432, 0.1433, 0.1424, 0.1423, 0.1430, 0.1426, 0.1433],
        [0.1432, 0.1432, 0.1425, 0.1423, 0.1430, 0.1426, 0.1433],
        [0.1432, 0.1432, 0.1425, 0.1423, 0.1430, 0.1426, 0.1432],
        [0.1432, 0.1432, 0.1424, 0.1423, 0.1430, 0.1426, 0.1434],
        [0.1431, 0.1432, 0.1424, 0.1423, 0.1429, 0.1426, 0.1434],
        [0.1432, 0.1432, 0.1423, 0.1421, 0.1429, 0.1424, 0.1438]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1252, 0.1249, 0.1250, 0.1246, 0.1251, 0.1249, 0.1250, 0.1253],
        [0.1252, 0.1249, 0.1250, 0.1246, 0.1251, 0.1250, 0.1250, 0.1253],
        [0.1252, 0.1249, 0.1250, 0.1246, 0.1251, 0.1249, 0.1250, 0.1253],
        [0.1251, 0.1249, 0.1250, 0.1246, 0.1251, 0.1250, 0.1250, 0.1253],
        [0.1252, 0.1249, 0.1250, 0.1246, 0.1251, 0.1249, 0.1250, 0.1253],
        [0.1252, 0.1249, 0.1250, 0.1246, 0.1251, 0.1250, 0.1250, 0.1254],
        [0.1252, 0.1249, 0.1250, 0.1246, 0.1251, 0.1249, 0.1250, 0.1253],
        [0.1252, 0.1249, 0.1250, 0.1246, 0.1251, 0.1249, 0.1250, 0.1253]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0500, 0.0501, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0493],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0492]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2519190311431885s
iter time cost:11.403102397918701s
-------------Round number: 37-------------
Evaluate global model
Averaged Train Loss: 0.8468
Averaged Test Accurancy: 0.7387
Std Test Accurancy: 0.1427
evaluate time cost:5.433598041534424s
[running kmeans]: 6it [00:00, 315.52it/s, center_shift=0.000000, iteration=6, tol=0.000100]
clients training time cost:4.843674421310425s
attn_optimize time cost:0.576129674911499s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1249, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250, 0.1253],
        [0.1249, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1251, 0.1253],
        [0.1249, 0.1250, 0.1248, 0.1249, 0.1250, 0.1250, 0.1250, 0.1253]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0251, 0.0250, 0.0250,  ..., 0.0250, 0.0249, 0.0248],
        [0.0251, 0.0250, 0.0250,  ..., 0.0250, 0.0249, 0.0248],
        [0.0251, 0.0250, 0.0250,  ..., 0.0250, 0.0249, 0.0249],
        ...,
        [0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0247],
        [0.0251, 0.0250, 0.0251,  ..., 0.0250, 0.0249, 0.0247],
        [0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0247]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3340, 0.3331, 0.3330],
        [0.3340, 0.3330, 0.3329],
        [0.3340, 0.3330, 0.3330]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1673, 0.1673, 0.1663, 0.1659, 0.1669, 0.1663],
        [0.1673, 0.1673, 0.1663, 0.1659, 0.1669, 0.1663],
        [0.1674, 0.1672, 0.1663, 0.1659, 0.1669, 0.1663],
        [0.1673, 0.1673, 0.1663, 0.1659, 0.1669, 0.1663],
        [0.1673, 0.1673, 0.1663, 0.1659, 0.1669, 0.1663],
        [0.1674, 0.1673, 0.1663, 0.1659, 0.1669, 0.1663]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2510, 0.2504, 0.2513, 0.2473],
        [0.2510, 0.2503, 0.2512, 0.2475],
        [0.2509, 0.2503, 0.2512, 0.2475],
        [0.2510, 0.2505, 0.2513, 0.2472]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0907, 0.0910, 0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0909, 0.0909,
         0.0910, 0.0907],
        [0.0907, 0.0909, 0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0909, 0.0909,
         0.0910, 0.0908],
        [0.0907, 0.0909, 0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0910, 0.0909,
         0.0910, 0.0907],
        [0.0907, 0.0910, 0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0909, 0.0909,
         0.0910, 0.0907],
        [0.0907, 0.0909, 0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0909, 0.0909,
         0.0910, 0.0907],
        [0.0907, 0.0909, 0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0909, 0.0909,
         0.0910, 0.0907],
        [0.0907, 0.0909, 0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0909, 0.0909,
         0.0910, 0.0907],
        [0.0907, 0.0909, 0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0909, 0.0909,
         0.0910, 0.0907],
        [0.0907, 0.0909, 0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0909, 0.0909,
         0.0910, 0.0907],
        [0.0907, 0.0909, 0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0909, 0.0909,
         0.0910, 0.0908],
        [0.0907, 0.0910, 0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0909, 0.0909,
         0.0910, 0.0907]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0627, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0626, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0625, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624],
        [0.0625, 0.0626, 0.0627, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0624,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0624]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.0997, 0.1001, 0.1001, 0.0999, 0.0998, 0.1003, 0.1002, 0.0999,
         0.1000],
        [0.1001, 0.0997, 0.1001, 0.1001, 0.0999, 0.0998, 0.1003, 0.1002, 0.0999,
         0.1000],
        [0.1001, 0.0997, 0.1001, 0.1001, 0.0999, 0.0998, 0.1003, 0.1001, 0.0999,
         0.1000],
        [0.1001, 0.0997, 0.1001, 0.1001, 0.0999, 0.0998, 0.1003, 0.1001, 0.0999,
         0.1000],
        [0.1001, 0.0997, 0.1001, 0.1001, 0.0999, 0.0998, 0.1003, 0.1001, 0.0999,
         0.1000],
        [0.1001, 0.0997, 0.1001, 0.1001, 0.0999, 0.0998, 0.1003, 0.1001, 0.0999,
         0.1000],
        [0.1001, 0.0997, 0.1001, 0.1001, 0.0999, 0.0998, 0.1003, 0.1002, 0.0999,
         0.1000],
        [0.1001, 0.0997, 0.1001, 0.1001, 0.0998, 0.0998, 0.1003, 0.1002, 0.0999,
         0.1000],
        [0.1001, 0.0997, 0.1001, 0.1001, 0.0999, 0.0998, 0.1003, 0.1001, 0.0999,
         0.1000],
        [0.1001, 0.0997, 0.1001, 0.1001, 0.0999, 0.0998, 0.1003, 0.1001, 0.0999,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2959139347076416s
iter time cost:11.238396883010864s
-------------Round number: 38-------------
Evaluate global model
Averaged Train Loss: 0.6908
Averaged Test Accurancy: 0.7512
Std Test Accurancy: 0.1326
evaluate time cost:5.741676568984985s
[running kmeans]: 3it [00:00, 299.71it/s, center_shift=0.000000, iteration=3, tol=0.000100]
clients training time cost:4.782862186431885s
attn_optimize time cost:0.6007506847381592s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0497],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0497],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0497],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0501, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0833, 0.0832, 0.0834, 0.0831, 0.0835, 0.0832, 0.0832, 0.0837,
         0.0835, 0.0831, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0832, 0.0835, 0.0832, 0.0832, 0.0836,
         0.0835, 0.0831, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0832, 0.0835, 0.0832, 0.0832, 0.0837,
         0.0835, 0.0831, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0835, 0.0832, 0.0832, 0.0837,
         0.0835, 0.0831, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0832, 0.0835, 0.0832, 0.0832, 0.0837,
         0.0835, 0.0831, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0831, 0.0835, 0.0832, 0.0832, 0.0837,
         0.0835, 0.0831, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0832, 0.0835, 0.0832, 0.0832, 0.0837,
         0.0835, 0.0831, 0.0833],
        [0.0835, 0.0833, 0.0832, 0.0834, 0.0831, 0.0835, 0.0832, 0.0832, 0.0837,
         0.0835, 0.0831, 0.0833],
        [0.0835, 0.0833, 0.0832, 0.0834, 0.0831, 0.0835, 0.0832, 0.0832, 0.0836,
         0.0835, 0.0831, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0832, 0.0835, 0.0832, 0.0832, 0.0837,
         0.0835, 0.0831, 0.0834],
        [0.0835, 0.0833, 0.0832, 0.0834, 0.0831, 0.0835, 0.0832, 0.0832, 0.0837,
         0.0835, 0.0831, 0.0833],
        [0.0834, 0.0833, 0.0832, 0.0834, 0.0832, 0.0835, 0.0832, 0.0832, 0.0837,
         0.0835, 0.0831, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0526, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0524, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0524, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0524, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0524, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0524, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0526],
        [0.0527, 0.0525, 0.0527, 0.0525, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0524, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0526],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0526],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0524, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0528,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1112, 0.1114, 0.1112, 0.1107, 0.1110, 0.1113, 0.1112, 0.1112, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1107, 0.1110, 0.1113, 0.1112, 0.1112, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1107, 0.1110, 0.1113, 0.1112, 0.1112, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1107, 0.1110, 0.1113, 0.1112, 0.1112, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1107, 0.1110, 0.1113, 0.1112, 0.1112, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1107, 0.1110, 0.1113, 0.1112, 0.1112, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1107, 0.1110, 0.1113, 0.1112, 0.1112, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1107, 0.1110, 0.1113, 0.1112, 0.1113, 0.1108],
        [0.1112, 0.1114, 0.1112, 0.1107, 0.1110, 0.1113, 0.1112, 0.1112, 0.1108]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2508, 0.2506, 0.2514, 0.2473],
        [0.2507, 0.2504, 0.2512, 0.2476],
        [0.2507, 0.2504, 0.2513, 0.2476],
        [0.2507, 0.2506, 0.2513, 0.2475]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1430, 0.1426, 0.1421, 0.1432, 0.1426, 0.1435],
        [0.1430, 0.1430, 0.1426, 0.1421, 0.1432, 0.1426, 0.1434],
        [0.1430, 0.1430, 0.1426, 0.1421, 0.1432, 0.1426, 0.1434],
        [0.1430, 0.1431, 0.1426, 0.1421, 0.1432, 0.1426, 0.1433],
        [0.1430, 0.1430, 0.1426, 0.1421, 0.1432, 0.1426, 0.1435],
        [0.1430, 0.1430, 0.1426, 0.1421, 0.1432, 0.1426, 0.1435],
        [0.1430, 0.1430, 0.1425, 0.1419, 0.1432, 0.1424, 0.1439]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1432, 0.1431, 0.1426, 0.1430, 0.1423, 0.1428],
        [0.1431, 0.1432, 0.1431, 0.1426, 0.1430, 0.1423, 0.1428],
        [0.1431, 0.1432, 0.1431, 0.1426, 0.1430, 0.1423, 0.1428],
        [0.1431, 0.1432, 0.1431, 0.1426, 0.1430, 0.1423, 0.1428],
        [0.1431, 0.1432, 0.1431, 0.1426, 0.1430, 0.1423, 0.1428],
        [0.1431, 0.1432, 0.1431, 0.1426, 0.1430, 0.1423, 0.1428],
        [0.1431, 0.1432, 0.1431, 0.1426, 0.1430, 0.1423, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28125596046447754s
iter time cost:11.490623235702515s
-------------Round number: 39-------------
Evaluate global model
Averaged Train Loss: 0.9239
Averaged Test Accurancy: 0.7164
Std Test Accurancy: 0.1294
evaluate time cost:5.296224355697632s
[running kmeans]: 5it [00:00, 384.27it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:4.698616981506348s
attn_optimize time cost:0.4649984836578369s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1421, 0.1431, 0.1426, 0.1432, 0.1430, 0.1435, 0.1427],
        [0.1421, 0.1431, 0.1426, 0.1431, 0.1430, 0.1434, 0.1426],
        [0.1421, 0.1430, 0.1426, 0.1432, 0.1431, 0.1434, 0.1427],
        [0.1421, 0.1431, 0.1426, 0.1431, 0.1430, 0.1434, 0.1427],
        [0.1420, 0.1431, 0.1426, 0.1432, 0.1430, 0.1435, 0.1426],
        [0.1420, 0.1431, 0.1426, 0.1431, 0.1430, 0.1434, 0.1427],
        [0.1421, 0.1431, 0.1426, 0.1432, 0.1430, 0.1434, 0.1426]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1434, 0.1430, 0.1422, 0.1421, 0.1429, 0.1429, 0.1435],
        [0.1434, 0.1430, 0.1422, 0.1421, 0.1429, 0.1429, 0.1434],
        [0.1434, 0.1430, 0.1422, 0.1421, 0.1429, 0.1429, 0.1434],
        [0.1434, 0.1431, 0.1423, 0.1421, 0.1429, 0.1429, 0.1433],
        [0.1434, 0.1430, 0.1422, 0.1421, 0.1429, 0.1428, 0.1435],
        [0.1433, 0.1430, 0.1423, 0.1422, 0.1429, 0.1428, 0.1435],
        [0.1435, 0.1430, 0.1421, 0.1420, 0.1429, 0.1427, 0.1439]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1000, 0.1001, 0.1000, 0.0996, 0.1000, 0.0998, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.0996, 0.1000, 0.0998, 0.1000, 0.1002,
         0.1000],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.0996, 0.1000, 0.0998, 0.1000, 0.1002,
         0.1000],
        [0.1001, 0.1000, 0.1001, 0.0999, 0.0996, 0.1000, 0.0998, 0.1001, 0.1002,
         0.1000],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.0997, 0.1000, 0.0998, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.0996, 0.1000, 0.0998, 0.1000, 0.1002,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.0996, 0.1000, 0.0998, 0.1000, 0.1002,
         0.1000],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.0996, 0.1000, 0.0998, 0.1001, 0.1002,
         0.1001],
        [0.1001, 0.1000, 0.1001, 0.1000, 0.0996, 0.1000, 0.0998, 0.1000, 0.1002,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0996, 0.1000, 0.0998, 0.1001, 0.1002,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1110, 0.1110, 0.1114, 0.1110, 0.1110, 0.1114, 0.1110, 0.1113, 0.1110],
        [0.1111, 0.1110, 0.1114, 0.1110, 0.1109, 0.1114, 0.1110, 0.1113, 0.1110],
        [0.1111, 0.1110, 0.1114, 0.1110, 0.1109, 0.1114, 0.1110, 0.1113, 0.1110],
        [0.1111, 0.1110, 0.1114, 0.1109, 0.1109, 0.1114, 0.1110, 0.1113, 0.1109],
        [0.1111, 0.1110, 0.1114, 0.1110, 0.1110, 0.1114, 0.1110, 0.1113, 0.1110],
        [0.1111, 0.1110, 0.1114, 0.1110, 0.1109, 0.1114, 0.1110, 0.1113, 0.1110],
        [0.1111, 0.1110, 0.1114, 0.1110, 0.1109, 0.1113, 0.1110, 0.1113, 0.1110],
        [0.1111, 0.1110, 0.1114, 0.1110, 0.1109, 0.1114, 0.1110, 0.1113, 0.1110],
        [0.1111, 0.1110, 0.1114, 0.1110, 0.1109, 0.1113, 0.1110, 0.1113, 0.1110]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0835, 0.0831, 0.0834, 0.0831, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0834, 0.0835, 0.0831, 0.0834, 0.0831, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0834, 0.0835, 0.0831, 0.0834, 0.0831, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0834, 0.0835, 0.0831, 0.0834, 0.0831, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0833, 0.0835, 0.0831, 0.0835, 0.0831, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0834, 0.0835, 0.0831, 0.0835, 0.0831, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0834, 0.0835, 0.0831, 0.0834, 0.0831, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0834, 0.0835, 0.0831, 0.0835, 0.0831, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0834, 0.0836, 0.0831, 0.0835, 0.0831, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0834, 0.0835, 0.0831, 0.0834, 0.0831, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0834, 0.0835, 0.0831, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835],
        [0.0834, 0.0835, 0.0831, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0835]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0497, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0502, 0.0502, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0497, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0497, 0.0500, 0.0501,
         0.0500, 0.0493],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0500, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0768,
         0.0772, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0768,
         0.0772, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0768,
         0.0772, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0768,
         0.0772, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0772, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0768,
         0.0772, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0772, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0768,
         0.0772, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0772, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0768,
         0.0772, 0.0771, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0769, 0.0768,
         0.0772, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0768,
         0.0772, 0.0770, 0.0770, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0772, 0.0770, 0.0770, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2541327476501465s
iter time cost:10.79604983329773s
-------------Round number: 40-------------
Evaluate global model
Averaged Train Loss: 0.7062
Averaged Test Accurancy: 0.7672
Std Test Accurancy: 0.1280
evaluate time cost:5.6898887157440186s
clients training time cost:4.789368391036987s
[running kmeans]: 5it [00:00, 293.85it/s, center_shift=0.000000, iteration=5, tol=0.000100]
attn_optimize time cost:0.4179573059082031s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2001, 0.1998, 0.2001, 0.1997, 0.2003],
        [0.2001, 0.1998, 0.2001, 0.1997, 0.2003],
        [0.2001, 0.1998, 0.2001, 0.1997, 0.2003],
        [0.2001, 0.1998, 0.2001, 0.1997, 0.2003],
        [0.2001, 0.1998, 0.2001, 0.1997, 0.2003]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0907, 0.0911, 0.0907, 0.0908, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0911, 0.0908],
        [0.0907, 0.0910, 0.0907, 0.0908, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0911, 0.0908],
        [0.0907, 0.0910, 0.0907, 0.0908, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0911, 0.0908],
        [0.0907, 0.0911, 0.0907, 0.0908, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0911, 0.0908],
        [0.0907, 0.0911, 0.0907, 0.0908, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0911, 0.0908],
        [0.0907, 0.0910, 0.0907, 0.0908, 0.0910, 0.0910, 0.0910, 0.0909, 0.0910,
         0.0911, 0.0908],
        [0.0907, 0.0910, 0.0907, 0.0908, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0911, 0.0908],
        [0.0907, 0.0910, 0.0907, 0.0908, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0911, 0.0908],
        [0.0907, 0.0911, 0.0907, 0.0908, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0911, 0.0908],
        [0.0907, 0.0910, 0.0907, 0.0908, 0.0910, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0911, 0.0908],
        [0.0907, 0.0911, 0.0907, 0.0908, 0.0909, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0911, 0.0908]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1433, 0.1424, 0.1420, 0.1428, 0.1425, 0.1436],
        [0.1432, 0.1434, 0.1425, 0.1420, 0.1428, 0.1426, 0.1435],
        [0.1432, 0.1433, 0.1425, 0.1420, 0.1428, 0.1426, 0.1435],
        [0.1432, 0.1434, 0.1425, 0.1421, 0.1429, 0.1426, 0.1434],
        [0.1432, 0.1433, 0.1424, 0.1420, 0.1428, 0.1425, 0.1436],
        [0.1432, 0.1433, 0.1424, 0.1421, 0.1428, 0.1425, 0.1437],
        [0.1432, 0.1434, 0.1423, 0.1419, 0.1428, 0.1424, 0.1440]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0771, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0769, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0771, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0767, 0.0770],
        [0.0772, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0767, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5006, 0.4994],
        [0.5006, 0.4994]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0252, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0244],
        [0.0252, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0243],
        [0.0252, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0244],
        ...,
        [0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0245],
        [0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0249, 0.0245],
        [0.0251, 0.0251, 0.0250,  ..., 0.0251, 0.0250, 0.0246]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0833, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0834, 0.0833, 0.0832,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0834, 0.0833, 0.0833, 0.0833,
         0.0833, 0.0834, 0.0836]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1245, 0.1254, 0.1250, 0.1254, 0.1251, 0.1256, 0.1251, 0.1240],
        [0.1245, 0.1254, 0.1250, 0.1253, 0.1251, 0.1256, 0.1250, 0.1241],
        [0.1245, 0.1254, 0.1250, 0.1254, 0.1252, 0.1256, 0.1251, 0.1240],
        [0.1245, 0.1254, 0.1250, 0.1253, 0.1251, 0.1255, 0.1250, 0.1241],
        [0.1245, 0.1254, 0.1250, 0.1253, 0.1251, 0.1256, 0.1250, 0.1241],
        [0.1245, 0.1254, 0.1250, 0.1253, 0.1251, 0.1256, 0.1250, 0.1241],
        [0.1245, 0.1254, 0.1250, 0.1253, 0.1251, 0.1256, 0.1250, 0.1242],
        [0.1244, 0.1254, 0.1249, 0.1253, 0.1251, 0.1257, 0.1252, 0.1240]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.29946255683898926s
iter time cost:11.288760662078857s
-------------Round number: 41-------------
Evaluate global model
Averaged Train Loss: 0.5635
Averaged Test Accurancy: 0.7762
Std Test Accurancy: 0.1428
evaluate time cost:5.303999662399292s
clients training time cost:4.832740306854248s
attn_optimize time cost:0.818016767501831s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
[running kmeans]: 5it [00:00, 333.03it/s, center_shift=0.000000, iteration=5, tol=0.000100]
weights:tensor([[0.2509, 0.2505, 0.2513, 0.2473],
        [0.2508, 0.2503, 0.2512, 0.2476],
        [0.2508, 0.2504, 0.2512, 0.2476],
        [0.2508, 0.2505, 0.2512, 0.2474]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1252, 0.1249, 0.1252, 0.1246, 0.1251, 0.1250, 0.1248, 0.1251],
        [0.1252, 0.1250, 0.1252, 0.1246, 0.1251, 0.1250, 0.1248, 0.1252],
        [0.1252, 0.1250, 0.1252, 0.1246, 0.1251, 0.1250, 0.1248, 0.1252],
        [0.1252, 0.1250, 0.1252, 0.1246, 0.1251, 0.1250, 0.1248, 0.1252],
        [0.1252, 0.1250, 0.1252, 0.1246, 0.1251, 0.1250, 0.1248, 0.1252],
        [0.1252, 0.1250, 0.1252, 0.1246, 0.1251, 0.1250, 0.1248, 0.1252],
        [0.1252, 0.1250, 0.1252, 0.1246, 0.1251, 0.1250, 0.1248, 0.1251],
        [0.1252, 0.1250, 0.1252, 0.1246, 0.1251, 0.1250, 0.1248, 0.1252]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1666, 0.1668, 0.1668, 0.1667, 0.1665],
        [0.1667, 0.1665, 0.1668, 0.1668, 0.1667, 0.1665],
        [0.1666, 0.1665, 0.1668, 0.1668, 0.1667, 0.1665],
        [0.1666, 0.1666, 0.1668, 0.1668, 0.1667, 0.1665],
        [0.1666, 0.1666, 0.1668, 0.1668, 0.1667, 0.1665],
        [0.1666, 0.1665, 0.1668, 0.1668, 0.1667, 0.1665]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1427, 0.1429, 0.1428, 0.1431, 0.1427, 0.1429],
        [0.1430, 0.1427, 0.1429, 0.1427, 0.1431, 0.1427, 0.1429],
        [0.1430, 0.1427, 0.1429, 0.1427, 0.1431, 0.1427, 0.1429],
        [0.1430, 0.1427, 0.1428, 0.1427, 0.1431, 0.1427, 0.1429],
        [0.1430, 0.1426, 0.1429, 0.1427, 0.1431, 0.1427, 0.1429],
        [0.1430, 0.1426, 0.1429, 0.1427, 0.1431, 0.1427, 0.1429],
        [0.1430, 0.1427, 0.1428, 0.1427, 0.1431, 0.1427, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0625, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0625, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0625, 0.0626, 0.0628, 0.0626, 0.0626, 0.0626, 0.0623, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0501, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0505]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0498, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0832, 0.0834, 0.0832, 0.0835, 0.0833, 0.0833, 0.0836, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0831],
        [0.0833, 0.0834, 0.0832, 0.0836, 0.0833, 0.0833, 0.0835, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0831],
        [0.0833, 0.0834, 0.0832, 0.0835, 0.0833, 0.0833, 0.0836, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0831],
        [0.0833, 0.0834, 0.0832, 0.0836, 0.0832, 0.0833, 0.0836, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0830],
        [0.0833, 0.0834, 0.0832, 0.0835, 0.0832, 0.0833, 0.0836, 0.0834, 0.0834,
         0.0834, 0.0833, 0.0830],
        [0.0833, 0.0834, 0.0832, 0.0835, 0.0833, 0.0833, 0.0836, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0831],
        [0.0833, 0.0834, 0.0832, 0.0836, 0.0832, 0.0833, 0.0836, 0.0834, 0.0833,
         0.0833, 0.0833, 0.0830],
        [0.0833, 0.0834, 0.0832, 0.0836, 0.0832, 0.0833, 0.0836, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0831],
        [0.0833, 0.0834, 0.0832, 0.0836, 0.0832, 0.0833, 0.0836, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0831],
        [0.0833, 0.0834, 0.0832, 0.0835, 0.0833, 0.0833, 0.0836, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0831],
        [0.0833, 0.0834, 0.0832, 0.0835, 0.0832, 0.0833, 0.0836, 0.0834, 0.0834,
         0.0833, 0.0833, 0.0831],
        [0.0832, 0.0834, 0.0832, 0.0836, 0.0831, 0.0833, 0.0837, 0.0835, 0.0834,
         0.0834, 0.0832, 0.0831]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1668, 0.1666, 0.1666, 0.1665, 0.1664, 0.1670],
        [0.1669, 0.1666, 0.1666, 0.1665, 0.1665, 0.1670],
        [0.1668, 0.1666, 0.1667, 0.1665, 0.1664, 0.1670],
        [0.1669, 0.1666, 0.1667, 0.1665, 0.1664, 0.1670],
        [0.1669, 0.1666, 0.1667, 0.1665, 0.1664, 0.1669],
        [0.1669, 0.1666, 0.1666, 0.1665, 0.1665, 0.1669]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.29126787185668945s
iter time cost:11.327099084854126s
-------------Round number: 42-------------
Evaluate global model
Averaged Train Loss: 0.5793
Averaged Test Accurancy: 0.7650
Std Test Accurancy: 0.1088
evaluate time cost:5.516297101974487s
[running kmeans]: 10it [00:00, 356.82it/s, center_shift=0.000000, iteration=10, tol=0.000100]
clients training time cost:4.89194393157959s
attn_optimize time cost:0.5471382141113281s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0499, 0.0498, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0502, 0.0501,
         0.0499, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.2000, 0.1998, 0.1996, 0.2007],
        [0.1999, 0.2000, 0.1998, 0.1996, 0.2007],
        [0.1999, 0.2000, 0.1998, 0.1996, 0.2007],
        [0.1999, 0.2000, 0.1999, 0.1995, 0.2007],
        [0.1999, 0.2001, 0.1998, 0.1995, 0.2007]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3329, 0.3339, 0.3332],
        [0.3329, 0.3339, 0.3332],
        [0.3329, 0.3339, 0.3332]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1253, 0.1246, 0.1251, 0.1249, 0.1247, 0.1251, 0.1252],
        [0.1250, 0.1253, 0.1246, 0.1251, 0.1249, 0.1247, 0.1251, 0.1253],
        [0.1250, 0.1253, 0.1246, 0.1251, 0.1250, 0.1247, 0.1251, 0.1252],
        [0.1250, 0.1253, 0.1246, 0.1251, 0.1249, 0.1247, 0.1251, 0.1253],
        [0.1250, 0.1253, 0.1246, 0.1251, 0.1249, 0.1247, 0.1251, 0.1253],
        [0.1250, 0.1253, 0.1246, 0.1251, 0.1249, 0.1248, 0.1251, 0.1253],
        [0.1250, 0.1253, 0.1246, 0.1251, 0.1249, 0.1247, 0.1251, 0.1253],
        [0.1250, 0.1253, 0.1246, 0.1251, 0.1249, 0.1248, 0.1251, 0.1252]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1432, 0.1425, 0.1418, 0.1429, 0.1426, 0.1438],
        [0.1433, 0.1432, 0.1425, 0.1418, 0.1429, 0.1426, 0.1437],
        [0.1433, 0.1432, 0.1425, 0.1418, 0.1430, 0.1426, 0.1437],
        [0.1433, 0.1432, 0.1425, 0.1418, 0.1430, 0.1426, 0.1436],
        [0.1433, 0.1432, 0.1424, 0.1418, 0.1429, 0.1426, 0.1438],
        [0.1433, 0.1432, 0.1424, 0.1418, 0.1429, 0.1425, 0.1438],
        [0.1433, 0.1432, 0.1423, 0.1416, 0.1429, 0.1424, 0.1442]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0492],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0490],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0492],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0492],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1253, 0.1250, 0.1246, 0.1251, 0.1248, 0.1252, 0.1248, 0.1250],
        [0.1253, 0.1250, 0.1246, 0.1252, 0.1248, 0.1252, 0.1249, 0.1250],
        [0.1253, 0.1250, 0.1246, 0.1252, 0.1248, 0.1252, 0.1249, 0.1250],
        [0.1253, 0.1250, 0.1245, 0.1252, 0.1248, 0.1252, 0.1249, 0.1250],
        [0.1254, 0.1250, 0.1246, 0.1251, 0.1248, 0.1252, 0.1249, 0.1250],
        [0.1253, 0.1250, 0.1246, 0.1251, 0.1248, 0.1252, 0.1248, 0.1251],
        [0.1253, 0.1250, 0.1246, 0.1251, 0.1248, 0.1252, 0.1249, 0.1250],
        [0.1253, 0.1250, 0.1246, 0.1252, 0.1248, 0.1252, 0.1249, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1242, 0.1253, 0.1248, 0.1252, 0.1251, 0.1252, 0.1254, 0.1250],
        [0.1242, 0.1253, 0.1248, 0.1252, 0.1251, 0.1251, 0.1254, 0.1249],
        [0.1242, 0.1253, 0.1248, 0.1252, 0.1251, 0.1252, 0.1253, 0.1249],
        [0.1242, 0.1253, 0.1248, 0.1252, 0.1251, 0.1251, 0.1253, 0.1249],
        [0.1242, 0.1253, 0.1248, 0.1253, 0.1251, 0.1251, 0.1254, 0.1249],
        [0.1242, 0.1253, 0.1248, 0.1252, 0.1251, 0.1251, 0.1254, 0.1249],
        [0.1242, 0.1253, 0.1248, 0.1252, 0.1251, 0.1251, 0.1254, 0.1249],
        [0.1242, 0.1253, 0.1248, 0.1252, 0.1251, 0.1251, 0.1254, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0502],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0501,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2538177967071533s
iter time cost:11.303281784057617s
-------------Round number: 43-------------
Evaluate global model
Averaged Train Loss: 0.8308
Averaged Test Accurancy: 0.7241
Std Test Accurancy: 0.1372
evaluate time cost:5.638580560684204s
clients training time cost:4.858106374740601s
[running kmeans]: 3it [00:00, 299.74it/s, center_shift=0.000000, iteration=3, tol=0.000100]
attn_optimize time cost:0.5751433372497559s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2509, 0.2505, 0.2514, 0.2472],
        [0.2508, 0.2504, 0.2513, 0.2475],
        [0.2508, 0.2504, 0.2513, 0.2475],
        [0.2508, 0.2507, 0.2513, 0.2472]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.2002, 0.1999, 0.2001, 0.1999],
        [0.1999, 0.2002, 0.1999, 0.2001, 0.1999],
        [0.1999, 0.2002, 0.1999, 0.2001, 0.1999],
        [0.1999, 0.2002, 0.1999, 0.2001, 0.1999],
        [0.1999, 0.2002, 0.1999, 0.2001, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0498, 0.0498, 0.0503, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501,
         0.0498, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0502],
        [0.0501, 0.0501, 0.0498, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0503],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0501],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0496, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0501],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0503, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0505]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0499, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501,
         0.0499, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2493, 0.2503, 0.2507, 0.2497],
        [0.2493, 0.2504, 0.2507, 0.2497],
        [0.2493, 0.2504, 0.2507, 0.2497],
        [0.2493, 0.2503, 0.2507, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1420, 0.1430, 0.1427, 0.1431, 0.1430, 0.1434, 0.1427],
        [0.1421, 0.1431, 0.1427, 0.1431, 0.1430, 0.1434, 0.1427],
        [0.1421, 0.1430, 0.1427, 0.1431, 0.1431, 0.1434, 0.1427],
        [0.1421, 0.1430, 0.1427, 0.1431, 0.1430, 0.1434, 0.1427],
        [0.1420, 0.1430, 0.1427, 0.1431, 0.1430, 0.1434, 0.1427],
        [0.1420, 0.1430, 0.1427, 0.1431, 0.1430, 0.1434, 0.1427],
        [0.1421, 0.1430, 0.1427, 0.1431, 0.1430, 0.1434, 0.1427]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0836, 0.0832, 0.0833, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0832, 0.0834, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0832, 0.0834, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0832, 0.0833, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0832, 0.0834, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0832, 0.0834, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0834, 0.0836],
        [0.0833, 0.0836, 0.0832, 0.0834, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0831, 0.0834, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0834, 0.0836],
        [0.0834, 0.0836, 0.0831, 0.0834, 0.0831, 0.0833, 0.0834, 0.0832, 0.0832,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0832, 0.0834, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0832, 0.0833, 0.0830, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0834, 0.0835],
        [0.0833, 0.0836, 0.0832, 0.0833, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0834, 0.0835]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1431, 0.1433, 0.1430, 0.1426, 0.1431, 0.1421, 0.1428],
        [0.1431, 0.1434, 0.1430, 0.1425, 0.1431, 0.1421, 0.1428],
        [0.1431, 0.1433, 0.1430, 0.1425, 0.1430, 0.1421, 0.1428],
        [0.1431, 0.1433, 0.1430, 0.1426, 0.1430, 0.1421, 0.1428],
        [0.1431, 0.1433, 0.1431, 0.1425, 0.1430, 0.1421, 0.1428],
        [0.1431, 0.1433, 0.1431, 0.1425, 0.1430, 0.1420, 0.1429],
        [0.1431, 0.1434, 0.1430, 0.1425, 0.1430, 0.1421, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27124667167663574s
iter time cost:11.417707681655884s
-------------Round number: 44-------------
Evaluate global model
Averaged Train Loss: 0.6702
Averaged Test Accurancy: 0.7404
Std Test Accurancy: 0.1308
evaluate time cost:5.507958650588989s
[running kmeans]: 4it [00:00, 333.03it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:4.968553304672241s
attn_optimize time cost:0.5102295875549316s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0497, 0.0501, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497, 0.0501, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0497, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0496, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0499, 0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0501,
         0.0499, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1431, 0.1434, 0.1423, 0.1420, 0.1430, 0.1424, 0.1438],
        [0.1431, 0.1434, 0.1423, 0.1420, 0.1430, 0.1424, 0.1437],
        [0.1431, 0.1434, 0.1423, 0.1420, 0.1431, 0.1424, 0.1437],
        [0.1431, 0.1434, 0.1423, 0.1420, 0.1431, 0.1424, 0.1436],
        [0.1431, 0.1434, 0.1423, 0.1420, 0.1430, 0.1424, 0.1438],
        [0.1431, 0.1434, 0.1423, 0.1421, 0.1430, 0.1424, 0.1438],
        [0.1432, 0.1434, 0.1421, 0.1418, 0.1430, 0.1422, 0.1442]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1667, 0.1667, 0.1665, 0.1666, 0.1665, 0.1670],
        [0.1668, 0.1667, 0.1665, 0.1666, 0.1664, 0.1670],
        [0.1667, 0.1667, 0.1665, 0.1666, 0.1665, 0.1670],
        [0.1667, 0.1667, 0.1665, 0.1666, 0.1665, 0.1670],
        [0.1667, 0.1667, 0.1665, 0.1666, 0.1665, 0.1670],
        [0.1667, 0.1667, 0.1665, 0.1666, 0.1665, 0.1670]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1428, 0.1427, 0.1428, 0.1427, 0.1425, 0.1432],
        [0.1433, 0.1428, 0.1427, 0.1428, 0.1427, 0.1425, 0.1432],
        [0.1432, 0.1428, 0.1428, 0.1428, 0.1427, 0.1425, 0.1431],
        [0.1433, 0.1428, 0.1428, 0.1428, 0.1427, 0.1425, 0.1431],
        [0.1433, 0.1428, 0.1428, 0.1428, 0.1427, 0.1425, 0.1431],
        [0.1433, 0.1428, 0.1427, 0.1428, 0.1427, 0.1425, 0.1432],
        [0.1433, 0.1428, 0.1428, 0.1428, 0.1428, 0.1425, 0.1431]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0526, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0526, 0.0526, 0.0524, 0.0527, 0.0526, 0.0527,
         0.0527, 0.0526, 0.0525, 0.0527, 0.0526, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0526, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0526, 0.0526, 0.0524, 0.0527, 0.0526, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0528, 0.0527,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0526, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0526, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0526, 0.0527,
         0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0528, 0.0526, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0526, 0.0527, 0.0525, 0.0527, 0.0526, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0526, 0.0526, 0.0525, 0.0527, 0.0526, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0526, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0525]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1670, 0.1667, 0.1662, 0.1666, 0.1665, 0.1671],
        [0.1669, 0.1667, 0.1663, 0.1666, 0.1665, 0.1671],
        [0.1670, 0.1667, 0.1662, 0.1666, 0.1665, 0.1671],
        [0.1669, 0.1667, 0.1662, 0.1666, 0.1664, 0.1671],
        [0.1670, 0.1667, 0.1662, 0.1666, 0.1665, 0.1671],
        [0.1669, 0.1667, 0.1663, 0.1666, 0.1665, 0.1671]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0502, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0502, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0501, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0502, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0501, 0.0503, 0.0502, 0.0501, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0502, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0502, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0499, 0.0501, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0499, 0.0502, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0491]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0766, 0.0768, 0.0768, 0.0770, 0.0767, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28907108306884766s
iter time cost:11.355886220932007s
-------------Round number: 45-------------
Evaluate global model
Averaged Train Loss: 0.6615
Averaged Test Accurancy: 0.7666
Std Test Accurancy: 0.1231
evaluate time cost:5.30885910987854s
[running kmeans]: 9it [00:00, 350.45it/s, center_shift=0.000000, iteration=9, tol=0.000100]
clients training time cost:4.925002098083496s
attn_optimize time cost:0.5054590702056885s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0771, 0.0768, 0.0768,
         0.0772, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0769, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0770, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0907, 0.0911, 0.0909, 0.0910, 0.0907, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0907],
        [0.0908, 0.0911, 0.0909, 0.0911, 0.0907, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0908],
        [0.0908, 0.0911, 0.0909, 0.0910, 0.0907, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0907],
        [0.0907, 0.0911, 0.0909, 0.0911, 0.0907, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0907],
        [0.0907, 0.0911, 0.0909, 0.0910, 0.0907, 0.0909, 0.0911, 0.0909, 0.0910,
         0.0910, 0.0907],
        [0.0908, 0.0911, 0.0909, 0.0910, 0.0907, 0.0909, 0.0911, 0.0909, 0.0909,
         0.0910, 0.0907],
        [0.0908, 0.0911, 0.0909, 0.0911, 0.0907, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0907],
        [0.0908, 0.0911, 0.0909, 0.0911, 0.0907, 0.0908, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0907],
        [0.0908, 0.0911, 0.0909, 0.0910, 0.0907, 0.0909, 0.0910, 0.0909, 0.0910,
         0.0910, 0.0907],
        [0.0908, 0.0911, 0.0909, 0.0910, 0.0907, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0907],
        [0.0907, 0.0911, 0.0909, 0.0910, 0.0907, 0.0909, 0.0910, 0.0909, 0.0909,
         0.0910, 0.0907]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1431, 0.1424, 0.1418, 0.1428, 0.1426, 0.1439],
        [0.1433, 0.1432, 0.1424, 0.1419, 0.1428, 0.1427, 0.1438],
        [0.1433, 0.1431, 0.1425, 0.1419, 0.1428, 0.1427, 0.1438],
        [0.1433, 0.1432, 0.1425, 0.1419, 0.1428, 0.1426, 0.1437],
        [0.1433, 0.1431, 0.1424, 0.1418, 0.1428, 0.1426, 0.1439],
        [0.1433, 0.1431, 0.1424, 0.1419, 0.1428, 0.1426, 0.1439],
        [0.1433, 0.1431, 0.1423, 0.1416, 0.1428, 0.1424, 0.1444]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1428, 0.1429, 0.1429, 0.1426, 0.1432, 0.1427],
        [0.1430, 0.1427, 0.1429, 0.1429, 0.1426, 0.1432, 0.1428],
        [0.1430, 0.1428, 0.1430, 0.1429, 0.1426, 0.1431, 0.1427],
        [0.1430, 0.1428, 0.1429, 0.1429, 0.1426, 0.1431, 0.1427],
        [0.1430, 0.1428, 0.1429, 0.1429, 0.1426, 0.1431, 0.1427],
        [0.1430, 0.1428, 0.1429, 0.1429, 0.1426, 0.1431, 0.1428],
        [0.1429, 0.1427, 0.1430, 0.1429, 0.1425, 0.1432, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0528, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0528, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0525]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1250, 0.1250, 0.1248, 0.1250, 0.1251, 0.1247, 0.1253],
        [0.1251, 0.1250, 0.1250, 0.1248, 0.1250, 0.1252, 0.1247, 0.1253],
        [0.1251, 0.1250, 0.1250, 0.1248, 0.1250, 0.1252, 0.1247, 0.1253],
        [0.1251, 0.1250, 0.1250, 0.1248, 0.1250, 0.1252, 0.1247, 0.1253],
        [0.1251, 0.1250, 0.1250, 0.1247, 0.1250, 0.1252, 0.1247, 0.1253],
        [0.1251, 0.1250, 0.1249, 0.1248, 0.1250, 0.1252, 0.1247, 0.1253],
        [0.1251, 0.1250, 0.1249, 0.1248, 0.1250, 0.1252, 0.1247, 0.1253],
        [0.1251, 0.1250, 0.1250, 0.1248, 0.1250, 0.1252, 0.1247, 0.1253]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0502, 0.0501, 0.0503, 0.0502, 0.0502, 0.0502, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0492],
        [0.0498, 0.0501, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0500, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0498, 0.0502, 0.0501, 0.0503, 0.0501, 0.0502, 0.0502, 0.0499, 0.0497,
         0.0501, 0.0500, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0501, 0.0503, 0.0501, 0.0502, 0.0502, 0.0499, 0.0497,
         0.0500, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0498, 0.0501, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0490],
        [0.0498, 0.0501, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0501, 0.0503, 0.0501, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0498, 0.0502, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0498, 0.0501, 0.0501, 0.0503, 0.0502, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0501, 0.0503, 0.0501, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0501, 0.0503, 0.0501, 0.0502, 0.0502, 0.0499, 0.0497,
         0.0500, 0.0500, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0498, 0.0501, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0501, 0.0503, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0498, 0.0502, 0.0501, 0.0504, 0.0501, 0.0503, 0.0502, 0.0498, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0768, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2352123260498047s
iter time cost:11.081290006637573s
-------------Round number: 46-------------
Evaluate global model
Averaged Train Loss: 0.6119
Averaged Test Accurancy: 0.7637
Std Test Accurancy: 0.1321
evaluate time cost:5.2101781368255615s
[running kmeans]: 4it [00:00, 363.35it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:4.7388715744018555s
attn_optimize time cost:0.4801466464996338s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0835, 0.0833, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0831, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0831, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0831, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0832, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0832, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0831, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0832, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0832, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0831, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0831, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0832, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0833, 0.0832, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0836, 0.0832, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0529, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0529, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0527, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0526, 0.0529, 0.0526, 0.0527, 0.0525, 0.0525, 0.0525, 0.0526,
         0.0526, 0.0525, 0.0526, 0.0527, 0.0526, 0.0527, 0.0527, 0.0527, 0.0527,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0496, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0501, 0.0502,
         0.0499, 0.0492],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0501, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0490],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0492],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1428, 0.1429, 0.1427, 0.1427, 0.1425, 0.1432],
        [0.1432, 0.1427, 0.1429, 0.1426, 0.1427, 0.1425, 0.1432],
        [0.1432, 0.1428, 0.1430, 0.1427, 0.1427, 0.1425, 0.1432],
        [0.1432, 0.1428, 0.1429, 0.1427, 0.1427, 0.1425, 0.1432],
        [0.1432, 0.1428, 0.1429, 0.1427, 0.1427, 0.1425, 0.1432],
        [0.1433, 0.1428, 0.1428, 0.1427, 0.1427, 0.1425, 0.1432],
        [0.1432, 0.1428, 0.1429, 0.1427, 0.1427, 0.1425, 0.1432]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1674, 0.1673, 0.1664, 0.1656, 0.1670, 0.1664],
        [0.1674, 0.1673, 0.1664, 0.1656, 0.1669, 0.1664],
        [0.1674, 0.1673, 0.1664, 0.1656, 0.1670, 0.1664],
        [0.1674, 0.1673, 0.1664, 0.1656, 0.1669, 0.1664],
        [0.1674, 0.1673, 0.1664, 0.1656, 0.1670, 0.1664],
        [0.1674, 0.1673, 0.1664, 0.1657, 0.1669, 0.1664]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0767, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769, 0.0768, 0.0768,
         0.0773, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0768, 0.0768,
         0.0773, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0767, 0.0768,
         0.0773, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769, 0.0767, 0.0769,
         0.0773, 0.0771, 0.0769, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0767, 0.0768,
         0.0773, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0768, 0.0769,
         0.0773, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0767, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769, 0.0767, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0769, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0771, 0.0768, 0.0770, 0.0767, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.31423497200012207s
iter time cost:10.896079063415527s
-------------Round number: 47-------------
Evaluate global model
Averaged Train Loss: 0.7302
Averaged Test Accurancy: 0.7487
Std Test Accurancy: 0.1162
evaluate time cost:5.294684171676636s
[running kmeans]: 6it [00:00, 374.69it/s, center_shift=0.000000, iteration=6, tol=0.000100]
clients training time cost:5.028823614120483s
attn_optimize time cost:0.549116849899292s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0770, 0.0772, 0.0767, 0.0770, 0.0766, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0770, 0.0772, 0.0767, 0.0770, 0.0767, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0772],
        [0.0770, 0.0772, 0.0767, 0.0770, 0.0766, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0770, 0.0772, 0.0767, 0.0770, 0.0766, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0769, 0.0772, 0.0767, 0.0770, 0.0767, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0770, 0.0772, 0.0767, 0.0770, 0.0766, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0772],
        [0.0770, 0.0772, 0.0768, 0.0770, 0.0767, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0770, 0.0772, 0.0768, 0.0770, 0.0766, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0770, 0.0772, 0.0767, 0.0770, 0.0766, 0.0769, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0772],
        [0.0770, 0.0773, 0.0767, 0.0770, 0.0767, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0770, 0.0772, 0.0767, 0.0770, 0.0767, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0770, 0.0773, 0.0767, 0.0770, 0.0766, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771],
        [0.0770, 0.0772, 0.0767, 0.0770, 0.0766, 0.0770, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0769, 0.0769, 0.0771]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0498, 0.0499, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0499, 0.0500, 0.0498, 0.0499, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0501, 0.0498, 0.0501, 0.0499, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0501, 0.0498, 0.0500, 0.0498, 0.0499, 0.0500, 0.0497, 0.0501,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0498, 0.0500, 0.0498, 0.0499, 0.0500, 0.0497, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0499, 0.0500, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0502, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0506]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2496, 0.2502, 0.2496, 0.2506],
        [0.2497, 0.2502, 0.2496, 0.2506],
        [0.2496, 0.2502, 0.2496, 0.2505],
        [0.2497, 0.2502, 0.2496, 0.2506]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0910, 0.0907, 0.0909, 0.0908, 0.0909, 0.0912, 0.0908, 0.0911,
         0.0909, 0.0907],
        [0.0910, 0.0910, 0.0907, 0.0909, 0.0909, 0.0909, 0.0911, 0.0908, 0.0911,
         0.0909, 0.0908],
        [0.0910, 0.0910, 0.0907, 0.0909, 0.0909, 0.0909, 0.0912, 0.0909, 0.0911,
         0.0909, 0.0907],
        [0.0909, 0.0910, 0.0907, 0.0909, 0.0908, 0.0909, 0.0912, 0.0908, 0.0911,
         0.0909, 0.0907],
        [0.0910, 0.0910, 0.0907, 0.0909, 0.0908, 0.0909, 0.0912, 0.0908, 0.0911,
         0.0909, 0.0907],
        [0.0910, 0.0910, 0.0907, 0.0909, 0.0909, 0.0909, 0.0912, 0.0908, 0.0911,
         0.0909, 0.0907],
        [0.0910, 0.0910, 0.0907, 0.0909, 0.0908, 0.0909, 0.0912, 0.0908, 0.0911,
         0.0909, 0.0907],
        [0.0910, 0.0910, 0.0907, 0.0909, 0.0908, 0.0908, 0.0912, 0.0908, 0.0911,
         0.0909, 0.0907],
        [0.0910, 0.0910, 0.0907, 0.0909, 0.0908, 0.0909, 0.0912, 0.0908, 0.0911,
         0.0909, 0.0907],
        [0.0910, 0.0910, 0.0907, 0.0909, 0.0909, 0.0909, 0.0912, 0.0908, 0.0911,
         0.0909, 0.0907],
        [0.0909, 0.0910, 0.0907, 0.0909, 0.0908, 0.0909, 0.0911, 0.0909, 0.0911,
         0.0909, 0.0907]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2500, 0.2495, 0.2502],
        [0.2503, 0.2500, 0.2495, 0.2501],
        [0.2503, 0.2500, 0.2495, 0.2502],
        [0.2503, 0.2500, 0.2495, 0.2502]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0501, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0524, 0.0528, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0527, 0.0529, 0.0528, 0.0528, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0527, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0524,
         0.0526, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0524, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0524,
         0.0526, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0527, 0.0529, 0.0528, 0.0528, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0526, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0527, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0527, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0528, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0528, 0.0527, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0526, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0528, 0.0527, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0526, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0524,
         0.0526, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0527,
         0.0525]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1421, 0.1434, 0.1427, 0.1433, 0.1437, 0.1431, 0.1416],
        [0.1421, 0.1434, 0.1427, 0.1432, 0.1437, 0.1430, 0.1418],
        [0.1421, 0.1434, 0.1427, 0.1433, 0.1437, 0.1431, 0.1417],
        [0.1421, 0.1434, 0.1428, 0.1432, 0.1437, 0.1430, 0.1419],
        [0.1421, 0.1434, 0.1428, 0.1432, 0.1437, 0.1430, 0.1419],
        [0.1421, 0.1434, 0.1427, 0.1432, 0.1437, 0.1430, 0.1419],
        [0.1419, 0.1434, 0.1425, 0.1432, 0.1439, 0.1434, 0.1416]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2698347568511963s
iter time cost:11.232543706893921s
-------------Round number: 48-------------
Evaluate global model
Averaged Train Loss: 0.5779
Averaged Test Accurancy: 0.7669
Std Test Accurancy: 0.1137
evaluate time cost:5.520735502243042s
clients training time cost:4.875241279602051s
attn_optimize time cost:0.4945669174194336s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1242, 0.1252, 0.1248, 0.1253, 0.1251, 0.1250, 0.1255, 0.1250],
        [0.1242, 0.1252, 0.1248, 0.1252, 0.1252, 0.1250, 0.1255, 0.1249],
        [0.1242, 0.1252, 0.1248, 0.1253, 0.1252, 0.1250, 0.1255, 0.1250],
        [0.1242, 0.1252, 0.1248, 0.1253, 0.1252, 0.1250, 0.1255, 0.1250],
        [0.1242, 0.1252, 0.1249, 0.1253, 0.1251, 0.1249, 0.1255, 0.1249],
        [0.1242, 0.1252, 0.1248, 0.1253, 0.1251, 0.1250, 0.1255, 0.1249],
        [0.1242, 0.1252, 0.1248, 0.1252, 0.1251, 0.1249, 0.1255, 0.1249],
        [0.1242, 0.1252, 0.1248, 0.1253, 0.1251, 0.1250, 0.1255, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5010, 0.4990],
        [0.5010, 0.4990]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0770, 0.0773, 0.0770, 0.0770, 0.0765, 0.0769, 0.0766, 0.0771,
         0.0770, 0.0769, 0.0770, 0.0767],
        [0.0770, 0.0770, 0.0773, 0.0770, 0.0770, 0.0765, 0.0769, 0.0766, 0.0771,
         0.0770, 0.0769, 0.0770, 0.0767],
        [0.0770, 0.0770, 0.0773, 0.0770, 0.0770, 0.0765, 0.0769, 0.0767, 0.0771,
         0.0770, 0.0770, 0.0770, 0.0766],
        [0.0770, 0.0770, 0.0773, 0.0770, 0.0769, 0.0765, 0.0769, 0.0766, 0.0772,
         0.0770, 0.0769, 0.0770, 0.0767],
        [0.0770, 0.0770, 0.0773, 0.0770, 0.0770, 0.0765, 0.0769, 0.0766, 0.0772,
         0.0770, 0.0769, 0.0769, 0.0767],
        [0.0770, 0.0770, 0.0773, 0.0770, 0.0769, 0.0765, 0.0769, 0.0766, 0.0772,
         0.0770, 0.0769, 0.0770, 0.0767],
        [0.0770, 0.0770, 0.0772, 0.0770, 0.0769, 0.0766, 0.0769, 0.0767, 0.0771,
         0.0770, 0.0769, 0.0770, 0.0767],
        [0.0770, 0.0770, 0.0773, 0.0770, 0.0770, 0.0765, 0.0769, 0.0766, 0.0772,
         0.0770, 0.0769, 0.0770, 0.0766],
        [0.0770, 0.0770, 0.0773, 0.0770, 0.0769, 0.0765, 0.0769, 0.0766, 0.0771,
         0.0770, 0.0769, 0.0770, 0.0767],
        [0.0770, 0.0770, 0.0773, 0.0770, 0.0770, 0.0765, 0.0769, 0.0766, 0.0771,
         0.0770, 0.0769, 0.0770, 0.0767],
        [0.0770, 0.0770, 0.0773, 0.0770, 0.0770, 0.0765, 0.0769, 0.0766, 0.0772,
         0.0770, 0.0769, 0.0770, 0.0767],
        [0.0770, 0.0770, 0.0773, 0.0770, 0.0769, 0.0765, 0.0769, 0.0766, 0.0772,
         0.0770, 0.0769, 0.0770, 0.0767],
        [0.0770, 0.0770, 0.0773, 0.0770, 0.0770, 0.0765, 0.0769, 0.0766, 0.0771,
         0.0770, 0.0769, 0.0770, 0.0767]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
[running kmeans]: 8it [00:00, 307.41it/s, center_shift=0.000000, iteration=8, tol=0.000100]
weights:tensor([[0.0909, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0910, 0.0908, 0.0908,
         0.0910, 0.0911],
        [0.0909, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0910, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0909, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0911],
        [0.0909, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0909, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0910, 0.0908, 0.0908,
         0.0910, 0.0911],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0909, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0910, 0.0908, 0.0908,
         0.0910, 0.0911],
        [0.0909, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0910, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0909, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0910, 0.0908, 0.0908,
         0.0910, 0.0911],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0909, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0909, 0.0908,
         0.0910, 0.0911]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0500, 0.0499, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0500, 0.0499, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0500, 0.0499, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499,
         0.0501, 0.0502],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0501],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0500, 0.0499, 0.0501, 0.0499, 0.0503, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0506]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0498, 0.0501, 0.0499, 0.0503, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0499, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2501, 0.2497, 0.2507, 0.2495],
        [0.2502, 0.2497, 0.2507, 0.2495],
        [0.2501, 0.2497, 0.2507, 0.2495],
        [0.2501, 0.2497, 0.2506, 0.2496]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3222935199737549s
iter time cost:11.319932460784912s
-------------Round number: 49-------------
Evaluate global model
Averaged Train Loss: 0.6291
Averaged Test Accurancy: 0.7698
Std Test Accurancy: 0.1214
evaluate time cost:5.406112909317017s
[running kmeans]: 6it [00:00, 333.04it/s, center_shift=0.000000, iteration=6, tol=0.000100]
clients training time cost:4.942709684371948s
attn_optimize time cost:0.5861082077026367s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0910, 0.0912, 0.0907, 0.0910, 0.0906, 0.0909, 0.0909, 0.0907, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0907, 0.0910, 0.0906, 0.0909, 0.0909, 0.0907, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0907, 0.0910, 0.0906, 0.0909, 0.0909, 0.0907, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0907, 0.0910, 0.0906, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0907, 0.0910, 0.0906, 0.0909, 0.0909, 0.0907, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0907, 0.0910, 0.0906, 0.0909, 0.0909, 0.0907, 0.0908,
         0.0910, 0.0911],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0907, 0.0910, 0.0907, 0.0909, 0.0909, 0.0907, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0907, 0.0910, 0.0906, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3334, 0.3336, 0.3330],
        [0.3334, 0.3336, 0.3330],
        [0.3333, 0.3336, 0.3330]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1248, 0.1253, 0.1248, 0.1251, 0.1254, 0.1251, 0.1251, 0.1245],
        [0.1248, 0.1254, 0.1248, 0.1251, 0.1254, 0.1251, 0.1251, 0.1243],
        [0.1248, 0.1253, 0.1247, 0.1251, 0.1255, 0.1251, 0.1251, 0.1244],
        [0.1248, 0.1253, 0.1248, 0.1251, 0.1255, 0.1250, 0.1251, 0.1244],
        [0.1248, 0.1253, 0.1248, 0.1251, 0.1255, 0.1251, 0.1251, 0.1244],
        [0.1248, 0.1254, 0.1248, 0.1250, 0.1254, 0.1250, 0.1251, 0.1245],
        [0.1248, 0.1253, 0.1247, 0.1251, 0.1255, 0.1251, 0.1251, 0.1245],
        [0.1247, 0.1253, 0.1245, 0.1250, 0.1256, 0.1252, 0.1251, 0.1246]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1664, 0.1677, 0.1672, 0.1661, 0.1667, 0.1659],
        [0.1664, 0.1676, 0.1672, 0.1662, 0.1667, 0.1660],
        [0.1664, 0.1676, 0.1672, 0.1661, 0.1667, 0.1660],
        [0.1665, 0.1676, 0.1671, 0.1661, 0.1667, 0.1659],
        [0.1664, 0.1676, 0.1672, 0.1661, 0.1667, 0.1659],
        [0.1664, 0.1676, 0.1672, 0.1661, 0.1666, 0.1660]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0499, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0499, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0833, 0.0835, 0.0832, 0.0833, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0835, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0835, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0832, 0.0833, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0835, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0832, 0.0834, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0835, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0832, 0.0833, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0836, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0834, 0.0832, 0.0833, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0835, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0835, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0834, 0.0832, 0.0833, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0835, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0834, 0.0833, 0.0833, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0835, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0832, 0.0833, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0835, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0833, 0.0833, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0835, 0.0834, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0832, 0.0833, 0.0832, 0.0832, 0.0835, 0.0832,
         0.0835, 0.0834, 0.0831]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1105, 0.1114, 0.1110, 0.1113, 0.1114, 0.1113, 0.1117, 0.1113, 0.1101],
        [0.1105, 0.1114, 0.1110, 0.1112, 0.1113, 0.1113, 0.1117, 0.1112, 0.1103],
        [0.1105, 0.1114, 0.1110, 0.1113, 0.1114, 0.1114, 0.1117, 0.1113, 0.1102],
        [0.1105, 0.1114, 0.1110, 0.1112, 0.1113, 0.1113, 0.1117, 0.1113, 0.1103],
        [0.1104, 0.1114, 0.1110, 0.1113, 0.1113, 0.1113, 0.1117, 0.1112, 0.1103],
        [0.1105, 0.1114, 0.1110, 0.1113, 0.1113, 0.1113, 0.1117, 0.1113, 0.1103],
        [0.1105, 0.1114, 0.1110, 0.1112, 0.1113, 0.1112, 0.1117, 0.1113, 0.1104],
        [0.1104, 0.1114, 0.1110, 0.1112, 0.1113, 0.1113, 0.1117, 0.1113, 0.1104],
        [0.1103, 0.1114, 0.1108, 0.1112, 0.1113, 0.1113, 0.1119, 0.1116, 0.1102]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.1004, 0.1002, 0.0996, 0.1001, 0.0997, 0.1001, 0.0998, 0.1003,
         0.0997],
        [0.1002, 0.1004, 0.1002, 0.0996, 0.1000, 0.0997, 0.1001, 0.0999, 0.1003,
         0.0997],
        [0.1002, 0.1004, 0.1002, 0.0996, 0.1000, 0.0997, 0.1000, 0.0998, 0.1003,
         0.0997],
        [0.1002, 0.1004, 0.1002, 0.0996, 0.1000, 0.0997, 0.1000, 0.0999, 0.1003,
         0.0997],
        [0.1001, 0.1004, 0.1002, 0.0996, 0.1001, 0.0997, 0.1000, 0.0998, 0.1002,
         0.0997],
        [0.1002, 0.1004, 0.1002, 0.0996, 0.1000, 0.0997, 0.1000, 0.0999, 0.1003,
         0.0997],
        [0.1002, 0.1004, 0.1002, 0.0996, 0.1000, 0.0997, 0.1000, 0.0999, 0.1003,
         0.0997],
        [0.1002, 0.1004, 0.1002, 0.0995, 0.1000, 0.0997, 0.1000, 0.0999, 0.1003,
         0.0997],
        [0.1002, 0.1004, 0.1002, 0.0996, 0.1000, 0.0997, 0.1001, 0.0999, 0.1003,
         0.0997],
        [0.1002, 0.1004, 0.1002, 0.0996, 0.1000, 0.0997, 0.1000, 0.0999, 0.1003,
         0.0997]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0498, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0498, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0502, 0.0499, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0502, 0.0498, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0499, 0.0502, 0.0498, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0502, 0.0498, 0.0500, 0.0499, 0.0498, 0.0499,
         0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0498, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0502, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2561962604522705s
iter time cost:11.284211158752441s
-------------Round number: 50-------------
Evaluate global model
Averaged Train Loss: 0.5770
Averaged Test Accurancy: 0.7649
Std Test Accurancy: 0.1286
evaluate time cost:5.526127099990845s
[running kmeans]: 5it [00:00, 384.26it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:5.143488883972168s
attn_optimize time cost:0.48902106285095215s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0910, 0.0908, 0.0907,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0910, 0.0908, 0.0907,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0910, 0.0909, 0.0908, 0.0907,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0908, 0.0907,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0910, 0.0908, 0.0907,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0908, 0.0907,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0910, 0.0910, 0.0908, 0.0907,
         0.0910, 0.0911],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0910, 0.0909, 0.0907,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0907, 0.0909, 0.0910, 0.0908, 0.0907,
         0.0909, 0.0911],
        [0.0911, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0909, 0.0907,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0909, 0.0909, 0.0907,
         0.0910, 0.0912]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0831, 0.0832, 0.0832, 0.0834, 0.0831, 0.0835, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0834],
        [0.0835, 0.0831, 0.0832, 0.0832, 0.0833, 0.0832, 0.0835, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0834],
        [0.0835, 0.0831, 0.0832, 0.0832, 0.0834, 0.0831, 0.0835, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0833],
        [0.0835, 0.0831, 0.0833, 0.0832, 0.0833, 0.0831, 0.0835, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0833],
        [0.0835, 0.0831, 0.0832, 0.0832, 0.0834, 0.0831, 0.0835, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0833],
        [0.0835, 0.0831, 0.0832, 0.0832, 0.0833, 0.0832, 0.0836, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0833],
        [0.0835, 0.0831, 0.0832, 0.0832, 0.0834, 0.0831, 0.0835, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0834],
        [0.0835, 0.0831, 0.0832, 0.0832, 0.0833, 0.0832, 0.0835, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0834],
        [0.0835, 0.0831, 0.0832, 0.0832, 0.0833, 0.0831, 0.0835, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0833],
        [0.0835, 0.0831, 0.0832, 0.0832, 0.0834, 0.0832, 0.0835, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0834],
        [0.0835, 0.0831, 0.0832, 0.0832, 0.0834, 0.0831, 0.0835, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0834],
        [0.0835, 0.0831, 0.0832, 0.0832, 0.0834, 0.0832, 0.0836, 0.0832, 0.0837,
         0.0835, 0.0832, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1104, 0.1114, 0.1110, 0.1114, 0.1113, 0.1113, 0.1119, 0.1113, 0.1101],
        [0.1104, 0.1114, 0.1110, 0.1113, 0.1113, 0.1113, 0.1118, 0.1112, 0.1103],
        [0.1104, 0.1114, 0.1110, 0.1113, 0.1113, 0.1113, 0.1119, 0.1112, 0.1102],
        [0.1104, 0.1114, 0.1110, 0.1113, 0.1112, 0.1113, 0.1118, 0.1112, 0.1103],
        [0.1104, 0.1114, 0.1111, 0.1113, 0.1112, 0.1113, 0.1119, 0.1112, 0.1103],
        [0.1104, 0.1114, 0.1111, 0.1114, 0.1112, 0.1113, 0.1118, 0.1112, 0.1103],
        [0.1104, 0.1114, 0.1111, 0.1113, 0.1112, 0.1112, 0.1118, 0.1112, 0.1104],
        [0.1104, 0.1114, 0.1110, 0.1113, 0.1112, 0.1113, 0.1118, 0.1112, 0.1104],
        [0.1102, 0.1114, 0.1109, 0.1113, 0.1112, 0.1112, 0.1121, 0.1115, 0.1102]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0492],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0501,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0490],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0500, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0501,
         0.0499, 0.0492],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0490],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0499, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0500, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1432, 0.1425, 0.1421, 0.1431, 0.1428, 0.1428],
        [0.1435, 0.1433, 0.1425, 0.1421, 0.1430, 0.1427, 0.1429],
        [0.1435, 0.1432, 0.1426, 0.1421, 0.1431, 0.1427, 0.1428],
        [0.1435, 0.1433, 0.1425, 0.1421, 0.1431, 0.1428, 0.1428],
        [0.1435, 0.1433, 0.1425, 0.1421, 0.1431, 0.1428, 0.1428],
        [0.1435, 0.1432, 0.1426, 0.1421, 0.1431, 0.1427, 0.1428],
        [0.1435, 0.1432, 0.1425, 0.1421, 0.1430, 0.1428, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.0999, 0.1001, 0.1000, 0.0997, 0.0999, 0.0999, 0.1004, 0.0999,
         0.1001],
        [0.1002, 0.0999, 0.1000, 0.0999, 0.0997, 0.1000, 0.0999, 0.1004, 0.0999,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0997, 0.0999, 0.0999, 0.1004, 0.0999,
         0.1001],
        [0.1002, 0.0999, 0.1000, 0.1000, 0.0997, 0.1000, 0.0998, 0.1004, 0.0999,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.0999, 0.0997, 0.1000, 0.0999, 0.1004, 0.0999,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0997, 0.1000, 0.0999, 0.1004, 0.0999,
         0.1001],
        [0.1002, 0.0999, 0.1000, 0.0999, 0.0997, 0.1000, 0.0998, 0.1004, 0.0999,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0997, 0.0999, 0.0999, 0.1004, 0.0999,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0997, 0.0999, 0.0999, 0.1004, 0.0999,
         0.1001],
        [0.1002, 0.0999, 0.1000, 0.0999, 0.0997, 0.1000, 0.0999, 0.1004, 0.0999,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1431, 0.1427, 0.1427, 0.1427, 0.1427, 0.1431, 0.1429],
        [0.1431, 0.1427, 0.1428, 0.1426, 0.1427, 0.1432, 0.1429],
        [0.1430, 0.1427, 0.1428, 0.1427, 0.1427, 0.1431, 0.1428],
        [0.1431, 0.1427, 0.1428, 0.1427, 0.1427, 0.1431, 0.1428],
        [0.1431, 0.1427, 0.1428, 0.1427, 0.1427, 0.1431, 0.1429],
        [0.1431, 0.1427, 0.1428, 0.1427, 0.1427, 0.1431, 0.1429],
        [0.1431, 0.1427, 0.1428, 0.1426, 0.1428, 0.1431, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3333, 0.3338, 0.3330],
        [0.3334, 0.3337, 0.3329],
        [0.3333, 0.3337, 0.3329]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0501,
         0.0501, 0.0498],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0502, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0502, 0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0501, 0.0497],
        [0.0502, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0499,
         0.0498, 0.0501, 0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0501,
         0.0500, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2539076805114746s
iter time cost:11.501628637313843s
-------------Round number: 51-------------
Evaluate global model
Averaged Train Loss: 0.6793
Averaged Test Accurancy: 0.7631
Std Test Accurancy: 0.1035
evaluate time cost:5.16807222366333s
[running kmeans]: 2it [00:00, 399.67it/s, center_shift=0.000000, iteration=2, tol=0.000100]
clients training time cost:4.93027138710022s
attn_optimize time cost:0.5331294536590576s
running k-means on cuda..
device is :cuda
device is :cuda
weights:tensor([[0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0524, 0.0525, 0.0529, 0.0527, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0528, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0524,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0524, 0.0526, 0.0528,
         0.0525],
        [0.0525, 0.0527, 0.0528, 0.0529, 0.0527, 0.0528, 0.0527, 0.0524, 0.0524,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0524, 0.0526, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0529, 0.0528, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0524,
         0.0526, 0.0524, 0.0525, 0.0529, 0.0527, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0529, 0.0528, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0525, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0524,
         0.0526, 0.0524, 0.0525, 0.0529, 0.0527, 0.0527, 0.0523, 0.0527, 0.0527,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0525, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0528, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0529, 0.0528, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0524,
         0.0527, 0.0524, 0.0525, 0.0529, 0.0527, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0528, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0528, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0524,
         0.0527, 0.0525, 0.0525, 0.0529, 0.0528, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0525, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0524,
         0.0527, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527, 0.0524, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525],
        [0.0524, 0.0527, 0.0528, 0.0529, 0.0528, 0.0528, 0.0527, 0.0524, 0.0523,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0527, 0.0527, 0.0523, 0.0526, 0.0528,
         0.0525]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0494],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0496, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0502, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1430, 0.1424, 0.1419, 0.1428, 0.1425, 0.1440],
        [0.1433, 0.1431, 0.1424, 0.1420, 0.1428, 0.1426, 0.1438],
        [0.1433, 0.1430, 0.1425, 0.1420, 0.1429, 0.1425, 0.1439],
        [0.1433, 0.1431, 0.1424, 0.1420, 0.1429, 0.1425, 0.1438],
        [0.1433, 0.1430, 0.1424, 0.1420, 0.1428, 0.1425, 0.1440],
        [0.1433, 0.1430, 0.1424, 0.1420, 0.1428, 0.1424, 0.1441],
        [0.1434, 0.1430, 0.1423, 0.1418, 0.1428, 0.1423, 0.1445]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0502],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0501, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0497, 0.0502,
         0.0500, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0528, 0.0525, 0.0528, 0.0525, 0.0525, 0.0527, 0.0527,
         0.0528, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0528, 0.0525, 0.0528, 0.0525, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0528, 0.0525, 0.0528, 0.0526, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0528, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0528, 0.0525, 0.0528, 0.0525, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0528, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0528, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0528, 0.0525, 0.0528, 0.0525, 0.0525, 0.0527, 0.0527,
         0.0528, 0.0524, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0528, 0.0525, 0.0528, 0.0526, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0524, 0.0526, 0.0528, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0528, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0528, 0.0525, 0.0528, 0.0526, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0528, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0528, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0525, 0.0527, 0.0527,
         0.0528, 0.0524, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0528, 0.0525, 0.0528, 0.0525, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0524, 0.0526, 0.0528, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0528, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0528, 0.0525, 0.0528, 0.0526, 0.0525, 0.0527, 0.0527,
         0.0527, 0.0525, 0.0526, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527,
         0.0525]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5003, 0.4997],
        [0.5002, 0.4998]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.0996, 0.1000, 0.1000, 0.1002, 0.0998, 0.0999, 0.1003, 0.1002,
         0.0998],
        [0.1001, 0.0997, 0.1000, 0.1000, 0.1002, 0.0998, 0.0999, 0.1003, 0.1002,
         0.0998],
        [0.1001, 0.0997, 0.1000, 0.1000, 0.1002, 0.0998, 0.0999, 0.1003, 0.1002,
         0.0998],
        [0.1001, 0.0997, 0.1000, 0.1000, 0.1002, 0.0998, 0.0999, 0.1004, 0.1002,
         0.0998],
        [0.1001, 0.0996, 0.0999, 0.1000, 0.1002, 0.0998, 0.0999, 0.1004, 0.1002,
         0.0999],
        [0.1001, 0.0997, 0.1000, 0.1000, 0.1002, 0.0998, 0.0999, 0.1003, 0.1002,
         0.0998],
        [0.1001, 0.0996, 0.1000, 0.1000, 0.1002, 0.0998, 0.0999, 0.1004, 0.1002,
         0.0998],
        [0.1001, 0.0997, 0.1000, 0.1000, 0.1002, 0.0998, 0.0999, 0.1003, 0.1002,
         0.0998],
        [0.1001, 0.0996, 0.0999, 0.1001, 0.1002, 0.0998, 0.0999, 0.1003, 0.1002,
         0.0998],
        [0.1001, 0.0996, 0.0999, 0.1000, 0.1002, 0.0998, 0.0999, 0.1003, 0.1002,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.30530500411987305s
iter time cost:11.009846210479736s
-------------Round number: 52-------------
Evaluate global model
Averaged Train Loss: 0.6302
Averaged Test Accurancy: 0.7628
Std Test Accurancy: 0.1130
evaluate time cost:5.202084541320801s
[running kmeans]: 5it [00:00, 293.84it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:5.221967697143555s
attn_optimize time cost:0.5553264617919922s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1114, 0.1111, 0.1110, 0.1112, 0.1109, 0.1108, 0.1113, 0.1109, 0.1115],
        [0.1114, 0.1110, 0.1111, 0.1112, 0.1109, 0.1108, 0.1112, 0.1109, 0.1115],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1108, 0.1112, 0.1109, 0.1115],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1108, 0.1112, 0.1109, 0.1115],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1108, 0.1112, 0.1109, 0.1115],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1108, 0.1112, 0.1109, 0.1115],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1108, 0.1112, 0.1109, 0.1115],
        [0.1115, 0.1111, 0.1110, 0.1112, 0.1109, 0.1108, 0.1112, 0.1109, 0.1115],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1108, 0.1112, 0.1109, 0.1115]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0837, 0.0832, 0.0834, 0.0831, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0833, 0.0835],
        [0.0833, 0.0836, 0.0832, 0.0834, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0832, 0.0833, 0.0835],
        [0.0833, 0.0837, 0.0832, 0.0834, 0.0830, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0832, 0.0833, 0.0836],
        [0.0833, 0.0837, 0.0832, 0.0834, 0.0831, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0833, 0.0835],
        [0.0833, 0.0836, 0.0832, 0.0834, 0.0831, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0832, 0.0833, 0.0835],
        [0.0833, 0.0837, 0.0832, 0.0834, 0.0831, 0.0833, 0.0834, 0.0832, 0.0833,
         0.0832, 0.0833, 0.0836],
        [0.0834, 0.0836, 0.0832, 0.0834, 0.0831, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0832, 0.0833, 0.0835],
        [0.0833, 0.0837, 0.0832, 0.0834, 0.0831, 0.0833, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0833, 0.0836],
        [0.0834, 0.0837, 0.0832, 0.0834, 0.0831, 0.0834, 0.0834, 0.0832, 0.0832,
         0.0832, 0.0833, 0.0835],
        [0.0833, 0.0836, 0.0832, 0.0834, 0.0831, 0.0834, 0.0834, 0.0832, 0.0833,
         0.0833, 0.0833, 0.0835],
        [0.0834, 0.0837, 0.0832, 0.0834, 0.0831, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0833, 0.0835],
        [0.0833, 0.0837, 0.0832, 0.0834, 0.0831, 0.0834, 0.0834, 0.0833, 0.0833,
         0.0832, 0.0833, 0.0835]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
         0.0500, 0.0498],
        [0.0501, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1112, 0.1110, 0.1109, 0.1112],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1112, 0.1110, 0.1109, 0.1112],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1112, 0.1110, 0.1109, 0.1112],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1112, 0.1110, 0.1109, 0.1112],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1112, 0.1111, 0.1109, 0.1112],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1112, 0.1110, 0.1109, 0.1112],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1112, 0.1110, 0.1109, 0.1112],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1112, 0.1110, 0.1109, 0.1112],
        [0.1114, 0.1111, 0.1111, 0.1112, 0.1109, 0.1112, 0.1110, 0.1109, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1418, 0.1430, 0.1426, 0.1432, 0.1430, 0.1435, 0.1429],
        [0.1419, 0.1430, 0.1427, 0.1431, 0.1430, 0.1435, 0.1428],
        [0.1418, 0.1430, 0.1426, 0.1432, 0.1430, 0.1435, 0.1429],
        [0.1418, 0.1430, 0.1427, 0.1432, 0.1430, 0.1435, 0.1428],
        [0.1418, 0.1430, 0.1427, 0.1432, 0.1430, 0.1435, 0.1428],
        [0.1418, 0.1430, 0.1427, 0.1432, 0.1430, 0.1435, 0.1428],
        [0.1418, 0.1430, 0.1426, 0.1432, 0.1430, 0.1435, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0502, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0497, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0497, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0499, 0.0500, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0502, 0.0499, 0.0502, 0.0497, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0498, 0.0502, 0.0499,
         0.0501, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0502],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0499, 0.0502, 0.0500, 0.0499, 0.0500, 0.0502, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0502],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0497, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0497, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0498, 0.0502, 0.0499,
         0.0501, 0.0502],
        [0.0501, 0.0502, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0501, 0.0502],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0497, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0502, 0.0498,
         0.0500, 0.0506]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0502, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0497, 0.0500, 0.0501,
         0.0499, 0.0492],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0502, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0499, 0.0492],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0499, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0491],
        [0.0499, 0.0502, 0.0501, 0.0504, 0.0502, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0500, 0.0502,
         0.0499, 0.0491]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26323890686035156s
iter time cost:11.327695369720459s
-------------Round number: 53-------------
Evaluate global model
Averaged Train Loss: 0.5345
Averaged Test Accurancy: 0.7762
Std Test Accurancy: 0.1195
evaluate time cost:4.9897544384002686s
clients training time cost:5.018240451812744s
attn_optimize time cost:0.4826502799987793s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0768, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0768, 0.0768,
         0.0774, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0768, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0768, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0768, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0768, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1427, 0.1429, 0.1425, 0.1426, 0.1432, 0.1428],
        [0.1431, 0.1427, 0.1430, 0.1425, 0.1426, 0.1432, 0.1428],
        [0.1431, 0.1427, 0.1430, 0.1426, 0.1426, 0.1432, 0.1428],
        [0.1431, 0.1428, 0.1430, 0.1426, 0.1426, 0.1432, 0.1427],
        [0.1431, 0.1427, 0.1430, 0.1426, 0.1426, 0.1432, 0.1429],
        [0.1431, 0.1427, 0.1430, 0.1425, 0.1426, 0.1432, 0.1429],
        [0.1432, 0.1427, 0.1431, 0.1424, 0.1427, 0.1432, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0502, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0502, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0502, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0502, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0496],
        [0.0501, 0.0502, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0767, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0769, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0768],
        [0.0771, 0.0767, 0.0768, 0.0768, 0.0769, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0773, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0771, 0.0767, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0773, 0.0771, 0.0769, 0.0769],
        [0.0771, 0.0767, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0768],
        [0.0770, 0.0767, 0.0768, 0.0768, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0771, 0.0767, 0.0768, 0.0768, 0.0769, 0.0767, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0769, 0.0768, 0.0771, 0.0768, 0.0769,
         0.0773, 0.0771, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1434, 0.1429, 0.1422, 0.1419, 0.1430, 0.1425, 0.1441],
        [0.1434, 0.1430, 0.1422, 0.1420, 0.1430, 0.1425, 0.1439],
        [0.1434, 0.1429, 0.1422, 0.1420, 0.1430, 0.1425, 0.1440],
        [0.1434, 0.1430, 0.1422, 0.1420, 0.1430, 0.1425, 0.1439],
        [0.1434, 0.1429, 0.1422, 0.1419, 0.1430, 0.1425, 0.1441],
        [0.1433, 0.1429, 0.1422, 0.1420, 0.1430, 0.1424, 0.1442],
        [0.1434, 0.1429, 0.1420, 0.1418, 0.1430, 0.1423, 0.1446]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2510, 0.2507, 0.2514, 0.2469],
        [0.2509, 0.2505, 0.2512, 0.2474],
        [0.2508, 0.2506, 0.2513, 0.2473],
        [0.2509, 0.2509, 0.2513, 0.2469]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.0999, 0.1001, 0.0997, 0.0999, 0.1002, 0.1000, 0.1002, 0.1000,
         0.0999],
        [0.1001, 0.0999, 0.1001, 0.0997, 0.0999, 0.1002, 0.1000, 0.1003, 0.1000,
         0.0998],
        [0.1001, 0.0999, 0.1002, 0.0997, 0.0999, 0.1002, 0.1000, 0.1002, 0.1000,
         0.0999],
        [0.1001, 0.0999, 0.1001, 0.0997, 0.0999, 0.1002, 0.1000, 0.1003, 0.1001,
         0.0998],
        [0.1001, 0.0999, 0.1001, 0.0997, 0.0999, 0.1002, 0.0999, 0.1002, 0.1000,
         0.0999],
        [0.1001, 0.0999, 0.1001, 0.0997, 0.0999, 0.1002, 0.1000, 0.1002, 0.1000,
         0.0999],
        [0.1002, 0.0999, 0.1002, 0.0997, 0.0999, 0.1002, 0.0999, 0.1003, 0.1000,
         0.0999],
        [0.1001, 0.0999, 0.1001, 0.0997, 0.0999, 0.1002, 0.0999, 0.1002, 0.1001,
         0.0999],
        [0.1001, 0.0999, 0.1001, 0.0997, 0.0999, 0.1002, 0.0999, 0.1002, 0.1000,
         0.0999],
        [0.1001, 0.0999, 0.1001, 0.0997, 0.0999, 0.1002, 0.1000, 0.1002, 0.1000,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1112, 0.1112, 0.1108, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1113],
        [0.1112, 0.1112, 0.1108, 0.1112, 0.1111, 0.1110, 0.1110, 0.1112, 0.1114],
        [0.1112, 0.1112, 0.1107, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1114],
        [0.1112, 0.1112, 0.1107, 0.1111, 0.1111, 0.1111, 0.1110, 0.1113, 0.1114],
        [0.1112, 0.1112, 0.1108, 0.1112, 0.1111, 0.1110, 0.1110, 0.1112, 0.1114],
        [0.1112, 0.1111, 0.1108, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1114],
        [0.1112, 0.1112, 0.1107, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1114],
        [0.1112, 0.1112, 0.1107, 0.1112, 0.1111, 0.1111, 0.1110, 0.1113, 0.1113],
        [0.1112, 0.1112, 0.1108, 0.1112, 0.1111, 0.1111, 0.1110, 0.1112, 0.1114]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0621, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0621, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0621, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0621, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0626, 0.0625, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0621, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0621, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0621, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 7it [00:00, 368.10it/s, center_shift=0.000000, iteration=7, tol=0.000100]
intra_cluster_agg time cost:0.23320889472961426s
iter time cost:10.808935165405273s
-------------Round number: 54-------------
Evaluate global model
Averaged Train Loss: 0.5111
Averaged Test Accurancy: 0.7791
Std Test Accurancy: 0.1100
evaluate time cost:4.982959032058716s
clients training time cost:5.079138994216919s
[running kmeans]: 4it [00:00, 399.64it/s, center_shift=0.000000, iteration=4, tol=0.000100]
attn_optimize time cost:0.4362149238586426s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1674, 0.1670, 0.1663, 0.1670, 0.1657, 0.1666],
        [0.1673, 0.1671, 0.1663, 0.1670, 0.1657, 0.1666],
        [0.1673, 0.1671, 0.1664, 0.1669, 0.1657, 0.1666],
        [0.1673, 0.1671, 0.1663, 0.1670, 0.1657, 0.1666],
        [0.1674, 0.1671, 0.1663, 0.1669, 0.1656, 0.1667],
        [0.1674, 0.1671, 0.1663, 0.1669, 0.1657, 0.1666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0528,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0526, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0526, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0527],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0527, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0527],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0526, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0525, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0527],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0526, 0.0525, 0.0528, 0.0525, 0.0525, 0.0529,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0623, 0.0626, 0.0627, 0.0627],
        [0.0626, 0.0627, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0626, 0.0627, 0.0626],
        [0.0625, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0626, 0.0627, 0.0626],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627],
        [0.0626, 0.0627, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0626, 0.0627, 0.0626],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0625, 0.0624, 0.0623, 0.0626, 0.0627, 0.0627],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3316, 0.3338, 0.3346],
        [0.3316, 0.3338, 0.3346],
        [0.3316, 0.3339, 0.3345]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1001, 0.1003, 0.1001, 0.0994, 0.1000, 0.1003, 0.1001, 0.1001,
         0.0996],
        [0.1000, 0.1001, 0.1003, 0.1001, 0.0994, 0.1000, 0.1002, 0.1000, 0.1001,
         0.0996],
        [0.1001, 0.1001, 0.1004, 0.1001, 0.0994, 0.1000, 0.1003, 0.1000, 0.1001,
         0.0996],
        [0.1000, 0.1001, 0.1003, 0.1001, 0.0994, 0.1000, 0.1003, 0.1001, 0.1001,
         0.0996],
        [0.1000, 0.1001, 0.1003, 0.1001, 0.0994, 0.1000, 0.1003, 0.1001, 0.1001,
         0.0996],
        [0.1000, 0.1001, 0.1003, 0.1001, 0.0994, 0.1000, 0.1002, 0.1001, 0.1001,
         0.0996],
        [0.1000, 0.1001, 0.1004, 0.1001, 0.0994, 0.1000, 0.1003, 0.1001, 0.1001,
         0.0996],
        [0.1000, 0.1001, 0.1003, 0.1002, 0.0994, 0.1000, 0.1003, 0.1001, 0.1001,
         0.0996],
        [0.1000, 0.1001, 0.1004, 0.1001, 0.0994, 0.0999, 0.1003, 0.1001, 0.1001,
         0.0996],
        [0.1000, 0.1001, 0.1003, 0.1001, 0.0994, 0.1000, 0.1003, 0.1000, 0.1001,
         0.0996]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0498, 0.0502, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0502, 0.0498,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0498,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0498,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0499, 0.0502, 0.0499, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502, 0.0498,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0499, 0.0502, 0.0499, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0502],
        [0.0500, 0.0503, 0.0498, 0.0502, 0.0499, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0502, 0.0499, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502, 0.0498,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0498, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0502, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0501, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0499, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0499, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0502],
        [0.0499, 0.0503, 0.0498, 0.0502, 0.0498, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0499, 0.0500, 0.0498, 0.0501, 0.0500, 0.0503, 0.0498, 0.0502, 0.0498,
         0.0500, 0.0507]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0498, 0.0496],
        [0.0500, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0499, 0.0502, 0.0500, 0.0502, 0.0500, 0.0497, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500,
         0.0497, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2512, 0.2505, 0.2515, 0.2468],
        [0.2511, 0.2504, 0.2513, 0.2471],
        [0.2511, 0.2504, 0.2514, 0.2472],
        [0.2513, 0.2507, 0.2514, 0.2466]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2978184223175049s
iter time cost:10.874201774597168s
-------------Round number: 55-------------
Evaluate global model
Averaged Train Loss: 0.5354
Averaged Test Accurancy: 0.7790
Std Test Accurancy: 0.1056
evaluate time cost:4.977790594100952s
[running kmeans]: 2it [00:00, 399.67it/s, center_shift=0.000000, iteration=2, tol=0.000100]
clients training time cost:4.995170831680298s
attn_optimize time cost:0.4901299476623535s
running k-means on cuda..
device is :cuda
device is :cuda
weights:tensor([[0.1433, 0.1433, 0.1421, 0.1419, 0.1429, 0.1425, 0.1441],
        [0.1433, 0.1433, 0.1422, 0.1419, 0.1429, 0.1425, 0.1439],
        [0.1433, 0.1433, 0.1422, 0.1419, 0.1429, 0.1425, 0.1439],
        [0.1433, 0.1433, 0.1422, 0.1419, 0.1429, 0.1425, 0.1439],
        [0.1433, 0.1433, 0.1421, 0.1419, 0.1429, 0.1425, 0.1441],
        [0.1433, 0.1432, 0.1422, 0.1419, 0.1428, 0.1424, 0.1442],
        [0.1433, 0.1433, 0.1420, 0.1417, 0.1429, 0.1423, 0.1446]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0529,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0529,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0523, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0499, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0501, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0503, 0.0503, 0.0502, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0499, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.0998, 0.1000, 0.1000, 0.1002,
         0.1001],
        [0.1002, 0.1000, 0.1000, 0.0999, 0.0998, 0.0998, 0.1000, 0.1000, 0.1003,
         0.1001],
        [0.1001, 0.1000, 0.1000, 0.0999, 0.0998, 0.0998, 0.1000, 0.1000, 0.1002,
         0.1001],
        [0.1002, 0.1000, 0.0999, 0.0999, 0.0998, 0.0998, 0.1000, 0.1000, 0.1003,
         0.1001],
        [0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.0998, 0.1000, 0.1000, 0.1003,
         0.1001],
        [0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.0998, 0.1000, 0.1000, 0.1003,
         0.1001],
        [0.1002, 0.1000, 0.0999, 0.0999, 0.0998, 0.0998, 0.1000, 0.1000, 0.1003,
         0.1001],
        [0.1002, 0.1000, 0.0999, 0.1000, 0.0998, 0.0998, 0.1000, 0.1000, 0.1002,
         0.1001],
        [0.1002, 0.1000, 0.1000, 0.1000, 0.0998, 0.0998, 0.1000, 0.1000, 0.1002,
         0.1001],
        [0.1002, 0.1000, 0.1000, 0.0999, 0.0998, 0.0998, 0.1000, 0.1000, 0.1002,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1996, 0.2004, 0.2001, 0.2000, 0.1999],
        [0.1996, 0.2004, 0.2001, 0.1999, 0.1999],
        [0.1997, 0.2004, 0.2001, 0.1999, 0.2000],
        [0.1996, 0.2004, 0.2001, 0.2000, 0.1999],
        [0.1996, 0.2004, 0.2001, 0.2000, 0.1999]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1428, 0.1430, 0.1428, 0.1429, 0.1427, 0.1429],
        [0.1430, 0.1428, 0.1431, 0.1428, 0.1429, 0.1427, 0.1428],
        [0.1430, 0.1428, 0.1430, 0.1428, 0.1429, 0.1427, 0.1428],
        [0.1430, 0.1427, 0.1430, 0.1428, 0.1429, 0.1427, 0.1429],
        [0.1429, 0.1428, 0.1430, 0.1428, 0.1429, 0.1427, 0.1429],
        [0.1430, 0.1428, 0.1431, 0.1427, 0.1429, 0.1427, 0.1429],
        [0.1429, 0.1428, 0.1431, 0.1428, 0.1428, 0.1427, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.0999, 0.1002, 0.0999, 0.1000, 0.1003, 0.1000, 0.1001, 0.0999,
         0.0996],
        [0.1000, 0.1000, 0.1002, 0.0998, 0.1000, 0.1003, 0.1001, 0.1001, 0.0999,
         0.0995],
        [0.1000, 0.1000, 0.1003, 0.0998, 0.1000, 0.1003, 0.1001, 0.1001, 0.0999,
         0.0995],
        [0.1000, 0.1000, 0.1003, 0.0998, 0.1000, 0.1004, 0.1000, 0.1001, 0.0999,
         0.0995],
        [0.1000, 0.0999, 0.1002, 0.0999, 0.1000, 0.1004, 0.1000, 0.1001, 0.0999,
         0.0996],
        [0.1000, 0.1000, 0.1003, 0.0998, 0.1000, 0.1003, 0.1000, 0.1001, 0.0999,
         0.0995],
        [0.1001, 0.1000, 0.1003, 0.0998, 0.1000, 0.1003, 0.1000, 0.1001, 0.0999,
         0.0996],
        [0.1000, 0.1000, 0.1003, 0.0998, 0.1000, 0.1003, 0.1000, 0.1001, 0.0999,
         0.0996],
        [0.1000, 0.1000, 0.1003, 0.0998, 0.1000, 0.1003, 0.1000, 0.1001, 0.0999,
         0.0996],
        [0.1000, 0.1000, 0.1003, 0.0997, 0.0999, 0.1005, 0.1002, 0.1002, 0.0997,
         0.0997]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28122806549072266s
iter time cost:10.828397035598755s
-------------Round number: 56-------------
Evaluate global model
Averaged Train Loss: 0.5423
Averaged Test Accurancy: 0.7824
Std Test Accurancy: 0.1176
evaluate time cost:5.033906936645508s
clients training time cost:5.031518936157227s
[running kmeans]: 7it [00:00, 259.02it/s, center_shift=0.000000, iteration=7, tol=0.000100]
attn_optimize time cost:0.5652098655700684s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0997, 0.0999, 0.1001, 0.0998, 0.0999, 0.1004, 0.1002, 0.1004, 0.0999,
         0.0997],
        [0.0997, 0.0999, 0.1001, 0.0998, 0.0999, 0.1004, 0.1003, 0.1004, 0.0999,
         0.0996],
        [0.0997, 0.0999, 0.1002, 0.0998, 0.0999, 0.1004, 0.1003, 0.1004, 0.0999,
         0.0996],
        [0.0997, 0.0999, 0.1001, 0.0997, 0.0999, 0.1004, 0.1003, 0.1004, 0.0999,
         0.0996],
        [0.0997, 0.0999, 0.1001, 0.0998, 0.0999, 0.1004, 0.1002, 0.1004, 0.0999,
         0.0996],
        [0.0997, 0.0999, 0.1002, 0.0997, 0.0999, 0.1004, 0.1003, 0.1004, 0.0999,
         0.0996],
        [0.0997, 0.0999, 0.1002, 0.0997, 0.0999, 0.1004, 0.1002, 0.1004, 0.0999,
         0.0996],
        [0.0997, 0.0999, 0.1002, 0.0997, 0.0999, 0.1004, 0.1002, 0.1004, 0.0999,
         0.0996],
        [0.0997, 0.0999, 0.1002, 0.0998, 0.0999, 0.1004, 0.1003, 0.1004, 0.0999,
         0.0996],
        [0.0995, 0.0999, 0.1002, 0.0996, 0.0998, 0.1006, 0.1005, 0.1005, 0.0997,
         0.0998]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0251, 0.0252, 0.0250,  ..., 0.0250, 0.0249, 0.0249],
        [0.0251, 0.0252, 0.0250,  ..., 0.0250, 0.0248, 0.0249],
        [0.0250, 0.0251, 0.0250,  ..., 0.0250, 0.0249, 0.0249],
        ...,
        [0.0251, 0.0251, 0.0250,  ..., 0.0251, 0.0249, 0.0248],
        [0.0251, 0.0251, 0.0250,  ..., 0.0251, 0.0249, 0.0247],
        [0.0252, 0.0251, 0.0250,  ..., 0.0250, 0.0250, 0.0247]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1431, 0.1428, 0.1426, 0.1428, 0.1426, 0.1433, 0.1428],
        [0.1431, 0.1427, 0.1427, 0.1427, 0.1426, 0.1433, 0.1429],
        [0.1430, 0.1428, 0.1428, 0.1428, 0.1426, 0.1433, 0.1428],
        [0.1431, 0.1428, 0.1427, 0.1428, 0.1426, 0.1433, 0.1428],
        [0.1431, 0.1427, 0.1427, 0.1428, 0.1426, 0.1432, 0.1429],
        [0.1431, 0.1427, 0.1427, 0.1427, 0.1426, 0.1433, 0.1429],
        [0.1431, 0.1427, 0.1427, 0.1427, 0.1426, 0.1433, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0772, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0772, 0.0769, 0.0770, 0.0769, 0.0767, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0772, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0772, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0772, 0.0769, 0.0767, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3334, 0.3335, 0.3331],
        [0.3335, 0.3335, 0.3330],
        [0.3335, 0.3335, 0.3330]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1004, 0.1002, 0.0995, 0.0999, 0.0995, 0.1003, 0.1001, 0.1002,
         0.0997],
        [0.1001, 0.1004, 0.1002, 0.0995, 0.0999, 0.0996, 0.1003, 0.1001, 0.1002,
         0.0996],
        [0.1001, 0.1004, 0.1002, 0.0995, 0.0999, 0.0995, 0.1004, 0.1001, 0.1002,
         0.0996],
        [0.1001, 0.1004, 0.1002, 0.0995, 0.0999, 0.0996, 0.1003, 0.1001, 0.1002,
         0.0996],
        [0.1001, 0.1004, 0.1002, 0.0995, 0.1000, 0.0996, 0.1003, 0.1001, 0.1002,
         0.0996],
        [0.1001, 0.1004, 0.1002, 0.0995, 0.0999, 0.0995, 0.1004, 0.1001, 0.1002,
         0.0996],
        [0.1001, 0.1004, 0.1002, 0.0995, 0.0999, 0.0995, 0.1003, 0.1001, 0.1002,
         0.0997],
        [0.1001, 0.1004, 0.1002, 0.0995, 0.0999, 0.0995, 0.1003, 0.1001, 0.1002,
         0.0996],
        [0.1001, 0.1004, 0.1002, 0.0995, 0.0999, 0.0995, 0.1004, 0.1001, 0.1002,
         0.0996],
        [0.1001, 0.1004, 0.1002, 0.0995, 0.0999, 0.0996, 0.1003, 0.1001, 0.1002,
         0.0997]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3334, 0.3328, 0.3338],
        [0.3335, 0.3328, 0.3337],
        [0.3333, 0.3328, 0.3338]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.0999, 0.1000, 0.1001, 0.0994, 0.1001, 0.1000, 0.0999, 0.1005,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.1000, 0.0994, 0.1001, 0.1000, 0.0999, 0.1006,
         0.1000],
        [0.1001, 0.0999, 0.1000, 0.1001, 0.0994, 0.1001, 0.1000, 0.0999, 0.1006,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.1000, 0.0994, 0.1001, 0.1000, 0.0999, 0.1006,
         0.1000],
        [0.1000, 0.0999, 0.1000, 0.1000, 0.0994, 0.1001, 0.1000, 0.0999, 0.1006,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.1001, 0.0994, 0.1001, 0.1000, 0.0999, 0.1006,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.1000, 0.0994, 0.1001, 0.1000, 0.0998, 0.1006,
         0.1000],
        [0.1001, 0.0999, 0.1000, 0.1001, 0.0994, 0.1001, 0.1000, 0.0999, 0.1006,
         0.1001],
        [0.1001, 0.0999, 0.1000, 0.1001, 0.0994, 0.1001, 0.1000, 0.0999, 0.1005,
         0.1000],
        [0.1001, 0.0998, 0.1000, 0.1001, 0.0994, 0.1000, 0.1000, 0.0999, 0.1006,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3351, 0.3314, 0.3334],
        [0.3351, 0.3313, 0.3336],
        [0.3351, 0.3315, 0.3335]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.36195969581604004s
iter time cost:11.087681770324707s
-------------Round number: 57-------------
Evaluate global model
Averaged Train Loss: 0.5494
Averaged Test Accurancy: 0.7788
Std Test Accurancy: 0.0933
evaluate time cost:5.050476312637329s
clients training time cost:5.258521556854248s
attn_optimize time cost:0.902907133102417s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.3327, 0.3340, 0.3333],
        [0.3326, 0.3340, 0.3334],
        [0.3327, 0.3340, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1431, 0.1421, 0.1418, 0.1429, 0.1423, 0.1443],
        [0.1436, 0.1432, 0.1421, 0.1419, 0.1428, 0.1424, 0.1441],
        [0.1436, 0.1431, 0.1421, 0.1419, 0.1429, 0.1424, 0.1441],
        [0.1435, 0.1432, 0.1421, 0.1419, 0.1429, 0.1424, 0.1440],
        [0.1435, 0.1431, 0.1421, 0.1418, 0.1428, 0.1423, 0.1443],
        [0.1435, 0.1431, 0.1421, 0.1419, 0.1428, 0.1423, 0.1443],
        [0.1436, 0.1431, 0.1419, 0.1416, 0.1429, 0.1421, 0.1448]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1113, 0.1114, 0.1114, 0.1112, 0.1106, 0.1107, 0.1113, 0.1108, 0.1114],
        [0.1113, 0.1114, 0.1114, 0.1111, 0.1106, 0.1107, 0.1112, 0.1108, 0.1114],
        [0.1114, 0.1114, 0.1115, 0.1112, 0.1105, 0.1106, 0.1113, 0.1109, 0.1114],
        [0.1113, 0.1114, 0.1114, 0.1112, 0.1105, 0.1106, 0.1112, 0.1109, 0.1114],
        [0.1113, 0.1114, 0.1113, 0.1112, 0.1106, 0.1107, 0.1112, 0.1109, 0.1114],
        [0.1113, 0.1114, 0.1114, 0.1112, 0.1106, 0.1107, 0.1112, 0.1109, 0.1114],
        [0.1113, 0.1114, 0.1114, 0.1112, 0.1105, 0.1107, 0.1112, 0.1109, 0.1114],
        [0.1113, 0.1114, 0.1114, 0.1111, 0.1105, 0.1107, 0.1112, 0.1109, 0.1114],
        [0.1113, 0.1114, 0.1114, 0.1111, 0.1106, 0.1107, 0.1113, 0.1109, 0.1114]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5012, 0.4988],
        [0.5013, 0.4987]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2502, 0.2499, 0.2508, 0.2491],
        [0.2503, 0.2499, 0.2508, 0.2490],
        [0.2502, 0.2499, 0.2508, 0.2491],
        [0.2501, 0.2500, 0.2507, 0.2493]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0502, 0.0501,
         0.0499, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0251, 0.0250, 0.0250,  ..., 0.0251, 0.0249, 0.0249],
        [0.0251, 0.0250, 0.0250,  ..., 0.0250, 0.0249, 0.0248],
        [0.0251, 0.0250, 0.0250,  ..., 0.0251, 0.0249, 0.0249],
        ...,
        [0.0251, 0.0251, 0.0251,  ..., 0.0251, 0.0249, 0.0247],
        [0.0251, 0.0251, 0.0251,  ..., 0.0251, 0.0249, 0.0247],
        [0.0251, 0.0251, 0.0251,  ..., 0.0251, 0.0250, 0.0247]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0768, 0.0770, 0.0768, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0770, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0770, 0.0768, 0.0770, 0.0768, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0770, 0.0769, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0771, 0.0766, 0.0770, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0771, 0.0767, 0.0770, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0770, 0.0768, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0768, 0.0770],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0774, 0.0770, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.41022372245788574s
iter time cost:11.703202962875366s
-------------Round number: 58-------------
Evaluate global model
[running kmeans]: 6it [00:00, 374.65it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 0.5559
Averaged Test Accurancy: 0.7762
Std Test Accurancy: 0.1049
evaluate time cost:5.021888017654419s
clients training time cost:5.377722501754761s
attn_optimize time cost:1.0100910663604736s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1431, 0.1428, 0.1424, 0.1428, 0.1429, 0.1428, 0.1433],
        [0.1431, 0.1428, 0.1423, 0.1427, 0.1430, 0.1428, 0.1433],
        [0.1430, 0.1428, 0.1423, 0.1428, 0.1430, 0.1428, 0.1433],
        [0.1431, 0.1428, 0.1423, 0.1428, 0.1430, 0.1428, 0.1433],
        [0.1431, 0.1428, 0.1423, 0.1428, 0.1430, 0.1427, 0.1433],
        [0.1431, 0.1428, 0.1423, 0.1428, 0.1430, 0.1428, 0.1433],
        [0.1431, 0.1428, 0.1423, 0.1428, 0.1430, 0.1428, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1431, 0.1425, 0.1416, 0.1429, 0.1425, 0.1441],
        [0.1433, 0.1432, 0.1425, 0.1417, 0.1428, 0.1426, 0.1439],
        [0.1433, 0.1431, 0.1425, 0.1416, 0.1429, 0.1426, 0.1440],
        [0.1433, 0.1432, 0.1425, 0.1417, 0.1429, 0.1426, 0.1439],
        [0.1433, 0.1431, 0.1424, 0.1417, 0.1428, 0.1425, 0.1441],
        [0.1433, 0.1431, 0.1425, 0.1417, 0.1428, 0.1425, 0.1442],
        [0.1434, 0.1431, 0.1423, 0.1414, 0.1428, 0.1423, 0.1446]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0498, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0502],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0498, 0.0501, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0502,
         0.0499, 0.0500]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0499, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4994, 0.5006],
        [0.4995, 0.5005]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.0998, 0.1002, 0.0999, 0.0997, 0.0999, 0.1002, 0.1001, 0.1000,
         0.0998],
        [0.1002, 0.0998, 0.1003, 0.0998, 0.0997, 0.0999, 0.1003, 0.1002, 0.1000,
         0.0998],
        [0.1002, 0.0998, 0.1002, 0.0999, 0.0997, 0.0999, 0.1002, 0.1001, 0.1000,
         0.0998],
        [0.1002, 0.0998, 0.1002, 0.0999, 0.0997, 0.0999, 0.1003, 0.1002, 0.1000,
         0.0998],
        [0.1002, 0.0998, 0.1003, 0.0998, 0.0997, 0.0999, 0.1003, 0.1002, 0.1001,
         0.0997],
        [0.1001, 0.0998, 0.1002, 0.0998, 0.0998, 0.0999, 0.1003, 0.1001, 0.1000,
         0.0998],
        [0.1001, 0.0998, 0.1002, 0.0999, 0.0997, 0.0999, 0.1003, 0.1001, 0.1000,
         0.0998],
        [0.1002, 0.0998, 0.1002, 0.0999, 0.0997, 0.0999, 0.1003, 0.1002, 0.1001,
         0.0998],
        [0.1001, 0.0998, 0.1002, 0.0999, 0.0998, 0.0999, 0.1003, 0.1001, 0.1000,
         0.0998],
        [0.1002, 0.0998, 0.1003, 0.0999, 0.0997, 0.0999, 0.1003, 0.1001, 0.1000,
         0.0998]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0766, 0.0769, 0.0767, 0.0770, 0.0768, 0.0771, 0.0770, 0.0769,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0767, 0.0770, 0.0768, 0.0771, 0.0770, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0767, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0767, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0770, 0.0768, 0.0772, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0768, 0.0767, 0.0770, 0.0767, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0767, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0767, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0772, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0768, 0.0767, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0766, 0.0768, 0.0767, 0.0770, 0.0768, 0.0771, 0.0770, 0.0769,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0767, 0.0770, 0.0768, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0771, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26123666763305664s
iter time cost:11.758018493652344s
[running kmeans]: 6it [00:00, 299.74it/s, center_shift=0.000000, iteration=6, tol=0.000100]
-------------Round number: 59-------------
Evaluate global model
Averaged Train Loss: 0.4813
Averaged Test Accurancy: 0.7899
Std Test Accurancy: 0.1096
evaluate time cost:4.953514814376831s
[running kmeans]: 6it [00:00, 315.51it/s, center_shift=0.000000, iteration=6, tol=0.000100]
clients training time cost:5.330207824707031s
attn_optimize time cost:0.6197340488433838s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1002, 0.0999, 0.1001, 0.1000, 0.0998, 0.0999, 0.0999, 0.1005, 0.0997,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0998, 0.0999, 0.0999, 0.1005, 0.0997,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0998, 0.0999, 0.0999, 0.1005, 0.0997,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0998, 0.0999, 0.0999, 0.1005, 0.0997,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.0999, 0.0998, 0.0999, 0.0999, 0.1005, 0.0997,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0998, 0.0999, 0.0999, 0.1005, 0.0997,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0998, 0.0999, 0.0999, 0.1005, 0.0997,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0998, 0.0999, 0.0999, 0.1005, 0.0997,
         0.1000],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0998, 0.0999, 0.0999, 0.1005, 0.0997,
         0.1001],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0998, 0.0999, 0.0999, 0.1005, 0.0997,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0767, 0.0769, 0.0768, 0.0768, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0768, 0.0769, 0.0768, 0.0768, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0767, 0.0770, 0.0768, 0.0768, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0768, 0.0768, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0768, 0.0768, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0774, 0.0770, 0.0769, 0.0769],
        [0.0770, 0.0767, 0.0770, 0.0768, 0.0768, 0.0767, 0.0772, 0.0768, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0769],
        [0.0771, 0.0767, 0.0769, 0.0767, 0.0768, 0.0766, 0.0772, 0.0769, 0.0769,
         0.0774, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0767, 0.0770, 0.0768, 0.0768, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0770],
        [0.0771, 0.0767, 0.0770, 0.0768, 0.0768, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0769],
        [0.0771, 0.0768, 0.0770, 0.0768, 0.0768, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0773, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0768, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0770],
        [0.0771, 0.0767, 0.0769, 0.0768, 0.0768, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0768, 0.0768, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0774, 0.0770, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1004, 0.1000, 0.1000, 0.0999, 0.0997, 0.0999, 0.0999, 0.0997, 0.1004,
         0.1000],
        [0.1003, 0.1000, 0.1000, 0.0999, 0.0996, 0.0999, 0.0999, 0.0998, 0.1004,
         0.1001],
        [0.1003, 0.1000, 0.1001, 0.1000, 0.0997, 0.0999, 0.0999, 0.0998, 0.1004,
         0.1000],
        [0.1003, 0.1000, 0.1001, 0.0999, 0.0997, 0.0999, 0.0999, 0.0998, 0.1004,
         0.1000],
        [0.1003, 0.1000, 0.1000, 0.0999, 0.0996, 0.0999, 0.0999, 0.0997, 0.1004,
         0.1001],
        [0.1003, 0.1000, 0.1001, 0.0999, 0.0996, 0.0999, 0.0999, 0.0997, 0.1004,
         0.1001],
        [0.1003, 0.1000, 0.1000, 0.0999, 0.0997, 0.0999, 0.0999, 0.0997, 0.1004,
         0.1001],
        [0.1004, 0.1000, 0.1000, 0.0999, 0.0997, 0.0999, 0.0999, 0.0998, 0.1004,
         0.1001],
        [0.1003, 0.1000, 0.1001, 0.0999, 0.0997, 0.0999, 0.0999, 0.0997, 0.1004,
         0.1001],
        [0.1004, 0.1000, 0.1001, 0.0999, 0.0996, 0.1000, 0.1000, 0.0998, 0.1004,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0626, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0626, 0.0625, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1431, 0.1422, 0.1418, 0.1429, 0.1425, 0.1442],
        [0.1433, 0.1432, 0.1422, 0.1419, 0.1429, 0.1425, 0.1440],
        [0.1433, 0.1431, 0.1422, 0.1419, 0.1429, 0.1425, 0.1441],
        [0.1433, 0.1432, 0.1422, 0.1419, 0.1429, 0.1425, 0.1440],
        [0.1433, 0.1431, 0.1421, 0.1419, 0.1429, 0.1425, 0.1442],
        [0.1433, 0.1431, 0.1422, 0.1419, 0.1428, 0.1424, 0.1443],
        [0.1434, 0.1431, 0.1420, 0.1416, 0.1429, 0.1422, 0.1448]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0910, 0.0912, 0.0906, 0.0910, 0.0905, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0905, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0905, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0913, 0.0906, 0.0910, 0.0905, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0905, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0905, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0905, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0913, 0.0906, 0.0910, 0.0905, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0906, 0.0909, 0.0910, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0913, 0.0906, 0.0910, 0.0905, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912],
        [0.0910, 0.0912, 0.0906, 0.0910, 0.0905, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0912]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0502, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0502, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0501, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0501, 0.0502, 0.0501, 0.0502, 0.0500,
         0.0498, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1239, 0.1251, 0.1248, 0.1252, 0.1251, 0.1251, 0.1256, 0.1251],
        [0.1240, 0.1251, 0.1249, 0.1252, 0.1251, 0.1251, 0.1256, 0.1250],
        [0.1239, 0.1251, 0.1248, 0.1252, 0.1252, 0.1251, 0.1256, 0.1251],
        [0.1240, 0.1251, 0.1249, 0.1252, 0.1251, 0.1251, 0.1256, 0.1250],
        [0.1239, 0.1251, 0.1249, 0.1253, 0.1251, 0.1251, 0.1256, 0.1250],
        [0.1239, 0.1252, 0.1249, 0.1252, 0.1251, 0.1251, 0.1256, 0.1250],
        [0.1239, 0.1251, 0.1249, 0.1252, 0.1251, 0.1250, 0.1256, 0.1250],
        [0.1239, 0.1251, 0.1248, 0.1252, 0.1251, 0.1251, 0.1256, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2511, 0.2505, 0.2515, 0.2468],
        [0.2511, 0.2504, 0.2514, 0.2472],
        [0.2510, 0.2504, 0.2514, 0.2472],
        [0.2512, 0.2507, 0.2514, 0.2467]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.24181699752807617s
iter time cost:11.234353065490723s
-------------Round number: 60-------------
Evaluate global model
Averaged Train Loss: 0.4735
Averaged Test Accurancy: 0.7921
Std Test Accurancy: 0.0988
evaluate time cost:4.961011171340942s
[running kmeans]: 3it [00:00, 272.47it/s, center_shift=0.007828, iteration=4, tol=0.000100]
clients training time cost:5.216492414474487s
attn_optimize time cost:0.40210652351379395s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1257, 0.1253, 0.1243, 0.1250, 0.1245, 0.1253, 0.1253, 0.1246],
        [0.1256, 0.1253, 0.1243, 0.1250, 0.1245, 0.1253, 0.1253, 0.1246],
        [0.1256, 0.1253, 0.1243, 0.1250, 0.1245, 0.1253, 0.1253, 0.1246],
        [0.1256, 0.1253, 0.1244, 0.1251, 0.1245, 0.1253, 0.1253, 0.1246],
        [0.1257, 0.1254, 0.1243, 0.1250, 0.1245, 0.1253, 0.1253, 0.1246],
        [0.1256, 0.1254, 0.1243, 0.1250, 0.1245, 0.1253, 0.1253, 0.1246],
        [0.1257, 0.1253, 0.1243, 0.1250, 0.1245, 0.1253, 0.1253, 0.1246],
        [0.1256, 0.1253, 0.1243, 0.1250, 0.1245, 0.1253, 0.1253, 0.1246]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0497],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0497],
        [0.0501, 0.0502, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0497],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0502, 0.0503, 0.0502,
         0.0501, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0769, 0.0770, 0.0770, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0769, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0772, 0.0769, 0.0767, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1430, 0.1424, 0.1417, 0.1429, 0.1424, 0.1442],
        [0.1433, 0.1431, 0.1424, 0.1418, 0.1429, 0.1425, 0.1440],
        [0.1433, 0.1430, 0.1425, 0.1418, 0.1430, 0.1424, 0.1441],
        [0.1433, 0.1431, 0.1424, 0.1418, 0.1429, 0.1425, 0.1440],
        [0.1432, 0.1430, 0.1423, 0.1418, 0.1429, 0.1424, 0.1443],
        [0.1432, 0.1430, 0.1424, 0.1418, 0.1429, 0.1424, 0.1443],
        [0.1433, 0.1430, 0.1423, 0.1415, 0.1429, 0.1422, 0.1448]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2000, 0.1998, 0.2005, 0.1998],
        [0.2000, 0.2000, 0.1998, 0.2004, 0.1998],
        [0.2000, 0.1999, 0.1998, 0.2005, 0.1997],
        [0.2000, 0.2000, 0.1998, 0.2004, 0.1998],
        [0.2000, 0.2000, 0.1998, 0.2005, 0.1997]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501,
         0.0498, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2510, 0.2506, 0.2517, 0.2467],
        [0.2509, 0.2504, 0.2515, 0.2472],
        [0.2508, 0.2504, 0.2515, 0.2473],
        [0.2510, 0.2508, 0.2516, 0.2466]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1431, 0.1428, 0.1427, 0.1428, 0.1425, 0.1433, 0.1427],
        [0.1431, 0.1428, 0.1427, 0.1428, 0.1425, 0.1433, 0.1428],
        [0.1430, 0.1428, 0.1429, 0.1429, 0.1425, 0.1433, 0.1427],
        [0.1431, 0.1428, 0.1428, 0.1428, 0.1425, 0.1433, 0.1427],
        [0.1431, 0.1428, 0.1428, 0.1428, 0.1425, 0.1433, 0.1428],
        [0.1431, 0.1428, 0.1428, 0.1428, 0.1425, 0.1433, 0.1428],
        [0.1431, 0.1428, 0.1429, 0.1428, 0.1425, 0.1433, 0.1426]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3352, 0.3313, 0.3335],
        [0.3353, 0.3311, 0.3336],
        [0.3352, 0.3313, 0.3335]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0767, 0.0770, 0.0768, 0.0770, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0767, 0.0770, 0.0768, 0.0770, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0767, 0.0770, 0.0768, 0.0770,
         0.0774, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0770, 0.0768, 0.0770,
         0.0774, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0770, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0770, 0.0768, 0.0770,
         0.0774, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0767, 0.0770, 0.0768, 0.0770, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0771, 0.0769, 0.0770],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770, 0.0767, 0.0769,
         0.0774, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0770, 0.0769, 0.0770],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0770, 0.0767, 0.0770,
         0.0774, 0.0770, 0.0769, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.25979042053222656s
iter time cost:10.941493034362793s
-------------Round number: 61-------------

[running kmeans]: 9it [00:00, 333.03it/s, center_shift=0.000000, iteration=9, tol=0.000100]
Averaged Train Loss: 0.4809
Averaged Test Accurancy: 0.7883
Std Test Accurancy: 0.1041
evaluate time cost:4.992834806442261s
[running kmeans]: 5it [00:00, 312.23it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:5.187199115753174s
attn_optimize time cost:0.4270749092102051s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1431, 0.1429, 0.1423, 0.1429, 0.1428, 0.1428, 0.1433],
        [0.1431, 0.1429, 0.1423, 0.1428, 0.1428, 0.1428, 0.1433],
        [0.1430, 0.1429, 0.1423, 0.1429, 0.1428, 0.1428, 0.1433],
        [0.1431, 0.1429, 0.1423, 0.1429, 0.1428, 0.1428, 0.1433],
        [0.1430, 0.1429, 0.1423, 0.1429, 0.1428, 0.1427, 0.1433],
        [0.1431, 0.1429, 0.1422, 0.1429, 0.1428, 0.1429, 0.1432],
        [0.1431, 0.1429, 0.1423, 0.1429, 0.1428, 0.1428, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0716, 0.0717, 0.0712, 0.0715, 0.0712, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0716, 0.0717, 0.0712, 0.0715, 0.0712, 0.0714, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0716, 0.0717, 0.0712, 0.0715, 0.0712, 0.0715, 0.0714, 0.0714, 0.0713,
         0.0714, 0.0712, 0.0713, 0.0715, 0.0717],
        [0.0716, 0.0717, 0.0712, 0.0715, 0.0712, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0715, 0.0717, 0.0712, 0.0715, 0.0712, 0.0714, 0.0714, 0.0714, 0.0713,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0716, 0.0717, 0.0712, 0.0715, 0.0712, 0.0714, 0.0714, 0.0714, 0.0713,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0718],
        [0.0716, 0.0717, 0.0712, 0.0715, 0.0712, 0.0715, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0716, 0.0717, 0.0712, 0.0715, 0.0712, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0712, 0.0714, 0.0715, 0.0717],
        [0.0716, 0.0717, 0.0712, 0.0715, 0.0712, 0.0714, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0712, 0.0713, 0.0715, 0.0717],
        [0.0716, 0.0717, 0.0711, 0.0715, 0.0712, 0.0714, 0.0714, 0.0714, 0.0713,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0718],
        [0.0716, 0.0717, 0.0711, 0.0715, 0.0712, 0.0714, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0712, 0.0713, 0.0715, 0.0717],
        [0.0716, 0.0717, 0.0712, 0.0715, 0.0712, 0.0714, 0.0715, 0.0714, 0.0713,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0716, 0.0717, 0.0712, 0.0715, 0.0712, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0716, 0.0717, 0.0712, 0.0715, 0.0712, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1253, 0.1249, 0.1253, 0.1251, 0.1246, 0.1249, 0.1252, 0.1248],
        [0.1253, 0.1249, 0.1253, 0.1250, 0.1246, 0.1249, 0.1252, 0.1248],
        [0.1253, 0.1249, 0.1253, 0.1251, 0.1246, 0.1249, 0.1251, 0.1248],
        [0.1253, 0.1249, 0.1253, 0.1251, 0.1245, 0.1249, 0.1252, 0.1247],
        [0.1253, 0.1249, 0.1253, 0.1251, 0.1245, 0.1249, 0.1252, 0.1247],
        [0.1252, 0.1249, 0.1253, 0.1250, 0.1246, 0.1249, 0.1252, 0.1248],
        [0.1252, 0.1249, 0.1253, 0.1251, 0.1246, 0.1249, 0.1252, 0.1248],
        [0.1253, 0.1249, 0.1253, 0.1251, 0.1245, 0.1249, 0.1252, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0621, 0.0625, 0.0623,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0625, 0.0621, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0623,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0626, 0.0625, 0.0622, 0.0625, 0.0623,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0623,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0623]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2509, 0.2507, 0.2516, 0.2467],
        [0.2508, 0.2505, 0.2514, 0.2474],
        [0.2507, 0.2505, 0.2514, 0.2473],
        [0.2508, 0.2510, 0.2514, 0.2468]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1658, 0.1672, 0.1667, 0.1682, 0.1671, 0.1651],
        [0.1658, 0.1672, 0.1667, 0.1680, 0.1669, 0.1654],
        [0.1659, 0.1672, 0.1667, 0.1681, 0.1671, 0.1652],
        [0.1657, 0.1672, 0.1667, 0.1681, 0.1669, 0.1654],
        [0.1658, 0.1671, 0.1667, 0.1680, 0.1669, 0.1655],
        [0.1655, 0.1672, 0.1664, 0.1684, 0.1674, 0.1651]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0502, 0.0498, 0.0502, 0.0498, 0.0501, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0497, 0.0499,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0504],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0502, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0498, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0498, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0499,
         0.0500, 0.0505],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0503],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0503, 0.0497, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0498,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0507]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1427, 0.1427, 0.1427, 0.1426, 0.1432, 0.1429],
        [0.1432, 0.1427, 0.1428, 0.1426, 0.1426, 0.1432, 0.1429],
        [0.1431, 0.1427, 0.1429, 0.1427, 0.1426, 0.1432, 0.1429],
        [0.1432, 0.1427, 0.1428, 0.1427, 0.1426, 0.1432, 0.1428],
        [0.1431, 0.1427, 0.1428, 0.1427, 0.1426, 0.1432, 0.1429],
        [0.1431, 0.1427, 0.1428, 0.1427, 0.1426, 0.1432, 0.1429],
        [0.1433, 0.1426, 0.1429, 0.1426, 0.1426, 0.1432, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1997, 0.2005, 0.2003, 0.2007, 0.1988],
        [0.1998, 0.2006, 0.2002, 0.2005, 0.1989],
        [0.1998, 0.2005, 0.2001, 0.2007, 0.1989],
        [0.1997, 0.2006, 0.2002, 0.2007, 0.1989],
        [0.1994, 0.2006, 0.2003, 0.2007, 0.1990]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0769, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.24883008003234863s
iter time cost:10.946021318435669s
-------------Round number: 62-------------
Evaluate global model
Averaged Train Loss: 0.5585
Averaged Test Accurancy: 0.7732
Std Test Accurancy: 0.1086
evaluate time cost:4.908831834793091s
[running kmeans]: 5it [00:00, 416.28it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:5.228356122970581s
attn_optimize time cost:0.39672255516052246s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0501, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0500,
         0.0500, 0.0502],
        [0.0499, 0.0503, 0.0497, 0.0502, 0.0498, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0502, 0.0498,
         0.0500, 0.0508]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0911, 0.0913, 0.0906, 0.0910, 0.0905, 0.0908, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0911, 0.0913, 0.0906, 0.0910, 0.0906, 0.0908, 0.0910, 0.0908, 0.0908,
         0.0909, 0.0912],
        [0.0911, 0.0913, 0.0906, 0.0910, 0.0905, 0.0908, 0.0909, 0.0909, 0.0908,
         0.0909, 0.0911],
        [0.0911, 0.0913, 0.0906, 0.0910, 0.0905, 0.0908, 0.0909, 0.0909, 0.0908,
         0.0909, 0.0912],
        [0.0910, 0.0913, 0.0906, 0.0910, 0.0906, 0.0908, 0.0909, 0.0908, 0.0908,
         0.0909, 0.0911],
        [0.0911, 0.0913, 0.0906, 0.0910, 0.0905, 0.0908, 0.0909, 0.0909, 0.0908,
         0.0909, 0.0912],
        [0.0911, 0.0913, 0.0906, 0.0910, 0.0906, 0.0908, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0911, 0.0913, 0.0905, 0.0910, 0.0905, 0.0908, 0.0909, 0.0909, 0.0908,
         0.0909, 0.0912],
        [0.0911, 0.0913, 0.0906, 0.0910, 0.0906, 0.0908, 0.0910, 0.0908, 0.0909,
         0.0909, 0.0911],
        [0.0911, 0.0913, 0.0905, 0.0910, 0.0905, 0.0908, 0.0909, 0.0909, 0.0908,
         0.0909, 0.0912],
        [0.0911, 0.0913, 0.0906, 0.0910, 0.0906, 0.0908, 0.0909, 0.0909, 0.0908,
         0.0909, 0.0911]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1424, 0.1431, 0.1428, 0.1430, 0.1432, 0.1426],
        [0.1430, 0.1424, 0.1431, 0.1427, 0.1430, 0.1433, 0.1425],
        [0.1430, 0.1424, 0.1430, 0.1428, 0.1430, 0.1433, 0.1426],
        [0.1430, 0.1425, 0.1431, 0.1427, 0.1429, 0.1432, 0.1426],
        [0.1430, 0.1424, 0.1430, 0.1428, 0.1430, 0.1433, 0.1426],
        [0.1430, 0.1424, 0.1430, 0.1428, 0.1430, 0.1432, 0.1426],
        [0.1430, 0.1424, 0.1431, 0.1427, 0.1430, 0.1433, 0.1425]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1251, 0.1248, 0.1247, 0.1255, 0.1253, 0.1254, 0.1242],
        [0.1251, 0.1252, 0.1248, 0.1247, 0.1255, 0.1252, 0.1253, 0.1242],
        [0.1251, 0.1251, 0.1247, 0.1247, 0.1255, 0.1252, 0.1254, 0.1242],
        [0.1251, 0.1251, 0.1248, 0.1248, 0.1255, 0.1251, 0.1253, 0.1243],
        [0.1251, 0.1251, 0.1248, 0.1247, 0.1255, 0.1252, 0.1253, 0.1243],
        [0.1251, 0.1252, 0.1247, 0.1247, 0.1254, 0.1252, 0.1254, 0.1243],
        [0.1251, 0.1251, 0.1247, 0.1247, 0.1255, 0.1252, 0.1253, 0.1243],
        [0.1251, 0.1251, 0.1245, 0.1245, 0.1256, 0.1254, 0.1254, 0.1244]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1240, 0.1251, 0.1248, 0.1252, 0.1252, 0.1249, 0.1257, 0.1251],
        [0.1241, 0.1252, 0.1249, 0.1251, 0.1252, 0.1249, 0.1257, 0.1250],
        [0.1240, 0.1251, 0.1248, 0.1251, 0.1252, 0.1249, 0.1256, 0.1251],
        [0.1241, 0.1252, 0.1249, 0.1251, 0.1252, 0.1249, 0.1256, 0.1250],
        [0.1240, 0.1252, 0.1249, 0.1252, 0.1251, 0.1249, 0.1257, 0.1250],
        [0.1241, 0.1252, 0.1249, 0.1252, 0.1251, 0.1249, 0.1256, 0.1250],
        [0.1240, 0.1252, 0.1249, 0.1251, 0.1252, 0.1248, 0.1257, 0.1250],
        [0.1240, 0.1252, 0.1249, 0.1252, 0.1252, 0.1249, 0.1257, 0.1250]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2512, 0.2505, 0.2517, 0.2466],
        [0.2511, 0.2504, 0.2515, 0.2470],
        [0.2510, 0.2503, 0.2515, 0.2472],
        [0.2512, 0.2508, 0.2516, 0.2464]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.2001, 0.1998, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.1999, 0.2000, 0.2000],
        [0.2002, 0.2000, 0.1998, 0.2000, 0.2000],
        [0.2001, 0.2000, 0.1998, 0.2001, 0.2000],
        [0.2001, 0.2000, 0.1999, 0.2000, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0498, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0500, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0500, 0.0498, 0.0501, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0627, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0626, 0.0621, 0.0624, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0626, 0.0625, 0.0622, 0.0626, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0626, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0626, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0623]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2352137565612793s
iter time cost:10.850198745727539s
-------------Round number: 63-------------
Evaluate global model
Averaged Train Loss: 0.5074
Averaged Test Accurancy: 0.7811
Std Test Accurancy: 0.1045
evaluate time cost:4.838105201721191s
clients training time cost:5.340829372406006s
attn_optimize time cost:0.4389607906341553s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0626, 0.0627, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0623, 0.0627, 0.0623],
        [0.0626, 0.0627, 0.0628, 0.0626, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0626, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0626, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0627, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0623, 0.0627, 0.0623],
        [0.0627, 0.0627, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0626, 0.0623],
        [0.0626, 0.0627, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0626, 0.0627, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0626, 0.0626, 0.0628, 0.0627, 0.0626, 0.0626, 0.0622, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0623, 0.0626, 0.0623],
        [0.0626, 0.0627, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0623, 0.0627, 0.0623],
        [0.0626, 0.0627, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0627, 0.0626, 0.0626, 0.0620, 0.0623, 0.0627, 0.0623],
        [0.0626, 0.0627, 0.0628, 0.0627, 0.0626, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0623, 0.0627, 0.0623],
        [0.0626, 0.0627, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0623, 0.0627, 0.0623],
        [0.0627, 0.0627, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0619, 0.0624, 0.0627, 0.0623],
        [0.0626, 0.0627, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0626, 0.0627, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0624, 0.0627, 0.0623],
        [0.0626, 0.0627, 0.0628, 0.0627, 0.0626, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0623, 0.0627, 0.0623]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0501, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0499, 0.0497, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0502,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0500, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0501, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0497, 0.0500, 0.0500, 0.0501, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0502,
         0.0498, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 7it [00:00, 388.55it/s, center_shift=0.000000, iteration=7, tol=0.000100]
weights:tensor([[0.1434, 0.1429, 0.1422, 0.1418, 0.1429, 0.1424, 0.1443],
        [0.1435, 0.1431, 0.1422, 0.1419, 0.1429, 0.1424, 0.1440],
        [0.1435, 0.1429, 0.1422, 0.1419, 0.1430, 0.1424, 0.1441],
        [0.1435, 0.1430, 0.1422, 0.1419, 0.1430, 0.1424, 0.1440],
        [0.1435, 0.1430, 0.1421, 0.1419, 0.1429, 0.1424, 0.1443],
        [0.1434, 0.1429, 0.1422, 0.1419, 0.1429, 0.1423, 0.1444],
        [0.1436, 0.1429, 0.1420, 0.1416, 0.1429, 0.1421, 0.1448]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2509, 0.2507, 0.2517, 0.2467],
        [0.2508, 0.2504, 0.2515, 0.2473],
        [0.2507, 0.2504, 0.2515, 0.2474],
        [0.2508, 0.2508, 0.2515, 0.2469]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0526, 0.0524, 0.0528, 0.0525, 0.0528,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0526, 0.0526, 0.0524, 0.0527, 0.0525, 0.0528,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0525, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0525, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0526, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0528, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1428, 0.1429, 0.1427, 0.1423, 0.1425, 0.1435],
        [0.1432, 0.1427, 0.1429, 0.1427, 0.1423, 0.1426, 0.1435],
        [0.1432, 0.1428, 0.1430, 0.1428, 0.1423, 0.1425, 0.1434],
        [0.1432, 0.1428, 0.1429, 0.1428, 0.1423, 0.1425, 0.1434],
        [0.1433, 0.1428, 0.1429, 0.1427, 0.1423, 0.1426, 0.1435],
        [0.1432, 0.1428, 0.1430, 0.1428, 0.1423, 0.1425, 0.1434],
        [0.1432, 0.1428, 0.1430, 0.1427, 0.1423, 0.1425, 0.1434]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0766, 0.0769, 0.0767, 0.0769, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0769, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0769, 0.0768, 0.0771, 0.0768, 0.0768,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0770, 0.0768, 0.0772, 0.0768, 0.0768,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0767, 0.0769, 0.0767, 0.0772, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0769, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0769, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0769, 0.0768, 0.0772, 0.0768, 0.0768,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0771, 0.0766, 0.0768, 0.0767, 0.0769, 0.0767, 0.0772, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0770, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0769, 0.0768, 0.0771, 0.0768, 0.0768,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0770, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0767, 0.0769, 0.0767, 0.0772, 0.0768, 0.0768,
         0.0772, 0.0771, 0.0769, 0.0769],
        [0.0771, 0.0766, 0.0768, 0.0768, 0.0769, 0.0768, 0.0772, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0769, 0.0770],
        [0.0771, 0.0766, 0.0769, 0.0767, 0.0769, 0.0767, 0.0772, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0770, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0769, 0.0768, 0.0772, 0.0768, 0.0768,
         0.0773, 0.0771, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0832, 0.0832, 0.0838,
         0.0832, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0837,
         0.0833, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0832, 0.0832, 0.0837,
         0.0833, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0837,
         0.0832, 0.0831, 0.0834],
        [0.0836, 0.0833, 0.0834, 0.0833, 0.0831, 0.0834, 0.0833, 0.0832, 0.0838,
         0.0833, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0832, 0.0832, 0.0838,
         0.0832, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0832, 0.0832, 0.0838,
         0.0832, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0838,
         0.0833, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0832, 0.0832, 0.0838,
         0.0832, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0832, 0.0833, 0.0838,
         0.0832, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0832, 0.0832, 0.0837,
         0.0832, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0837,
         0.0832, 0.0831, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.289262056350708s
iter time cost:10.99423623085022s
-------------Round number: 64-------------
Evaluate global model
Averaged Train Loss: 0.6049
Averaged Test Accurancy: 0.7723
Std Test Accurancy: 0.1096
evaluate time cost:4.778843402862549s
[running kmeans]: 7it [00:00, 317.90it/s, center_shift=0.000000, iteration=7, tol=0.000100]
clients training time cost:5.272280931472778s
attn_optimize time cost:0.5248055458068848s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0495],
        [0.0502, 0.0503, 0.0495, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0493],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0500, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0496],
        [0.0502, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0502, 0.0504, 0.0495, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0502,
         0.0501, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0501, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0502],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0501],
        [0.0501, 0.0498, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0504, 0.0500, 0.0498, 0.0502,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1999, 0.2013, 0.1995, 0.2003, 0.1990],
        [0.1999, 0.2013, 0.1995, 0.2003, 0.1991],
        [0.2000, 0.2013, 0.1995, 0.2002, 0.1990],
        [0.1999, 0.2013, 0.1995, 0.2003, 0.1991],
        [0.1998, 0.2014, 0.1995, 0.2002, 0.1991]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0829, 0.0834, 0.0831, 0.0834, 0.0830, 0.0834, 0.0833, 0.0837,
         0.0836, 0.0833, 0.0834],
        [0.0834, 0.0830, 0.0834, 0.0831, 0.0834, 0.0831, 0.0834, 0.0833, 0.0837,
         0.0836, 0.0832, 0.0834],
        [0.0834, 0.0830, 0.0834, 0.0831, 0.0834, 0.0831, 0.0835, 0.0833, 0.0837,
         0.0836, 0.0832, 0.0834],
        [0.0834, 0.0830, 0.0834, 0.0831, 0.0834, 0.0830, 0.0835, 0.0833, 0.0837,
         0.0836, 0.0833, 0.0833],
        [0.0834, 0.0830, 0.0834, 0.0831, 0.0834, 0.0830, 0.0835, 0.0832, 0.0838,
         0.0835, 0.0833, 0.0834],
        [0.0834, 0.0830, 0.0834, 0.0831, 0.0834, 0.0831, 0.0835, 0.0832, 0.0837,
         0.0835, 0.0833, 0.0834],
        [0.0835, 0.0829, 0.0834, 0.0831, 0.0834, 0.0830, 0.0835, 0.0833, 0.0838,
         0.0836, 0.0833, 0.0834],
        [0.0834, 0.0830, 0.0834, 0.0832, 0.0834, 0.0831, 0.0834, 0.0832, 0.0837,
         0.0836, 0.0833, 0.0834],
        [0.0834, 0.0830, 0.0834, 0.0831, 0.0834, 0.0830, 0.0835, 0.0832, 0.0837,
         0.0836, 0.0833, 0.0834],
        [0.0834, 0.0829, 0.0833, 0.0831, 0.0834, 0.0831, 0.0835, 0.0832, 0.0837,
         0.0836, 0.0833, 0.0835],
        [0.0834, 0.0829, 0.0833, 0.0831, 0.0834, 0.0830, 0.0835, 0.0833, 0.0837,
         0.0836, 0.0833, 0.0834],
        [0.0834, 0.0829, 0.0834, 0.0831, 0.0834, 0.0830, 0.0835, 0.0832, 0.0838,
         0.0835, 0.0833, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1430, 0.1421, 0.1419, 0.1431, 0.1424, 0.1443],
        [0.1434, 0.1431, 0.1421, 0.1420, 0.1430, 0.1424, 0.1440],
        [0.1434, 0.1430, 0.1421, 0.1419, 0.1431, 0.1424, 0.1441],
        [0.1434, 0.1431, 0.1421, 0.1419, 0.1431, 0.1424, 0.1440],
        [0.1434, 0.1430, 0.1420, 0.1419, 0.1430, 0.1423, 0.1443],
        [0.1433, 0.1430, 0.1421, 0.1420, 0.1430, 0.1423, 0.1444],
        [0.1435, 0.1430, 0.1419, 0.1417, 0.1431, 0.1421, 0.1448]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0501,
         0.0499, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0502, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0501,
         0.0499, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0502, 0.0502, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0501,
         0.0499, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0501,
         0.0499, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0502, 0.0501, 0.0500, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0502, 0.0501, 0.0500, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0501,
         0.0500, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0503, 0.0501, 0.0501, 0.0498, 0.0501, 0.0499, 0.0498, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0498, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0502,
         0.0499, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5015, 0.4985],
        [0.5015, 0.4985]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0834, 0.0837, 0.0835, 0.0828, 0.0833, 0.0829, 0.0837, 0.0835,
         0.0834, 0.0835, 0.0830],
        [0.0835, 0.0834, 0.0837, 0.0835, 0.0828, 0.0833, 0.0829, 0.0836, 0.0834,
         0.0834, 0.0834, 0.0830],
        [0.0835, 0.0834, 0.0837, 0.0835, 0.0828, 0.0833, 0.0829, 0.0836, 0.0834,
         0.0834, 0.0834, 0.0829],
        [0.0835, 0.0834, 0.0837, 0.0835, 0.0828, 0.0833, 0.0829, 0.0837, 0.0835,
         0.0833, 0.0834, 0.0830],
        [0.0835, 0.0834, 0.0837, 0.0835, 0.0828, 0.0833, 0.0829, 0.0837, 0.0834,
         0.0833, 0.0834, 0.0830],
        [0.0835, 0.0834, 0.0837, 0.0835, 0.0828, 0.0834, 0.0829, 0.0836, 0.0835,
         0.0833, 0.0834, 0.0830],
        [0.0835, 0.0834, 0.0837, 0.0835, 0.0828, 0.0833, 0.0829, 0.0837, 0.0835,
         0.0833, 0.0834, 0.0829],
        [0.0835, 0.0834, 0.0837, 0.0835, 0.0828, 0.0833, 0.0829, 0.0836, 0.0834,
         0.0834, 0.0834, 0.0830],
        [0.0835, 0.0834, 0.0837, 0.0835, 0.0828, 0.0833, 0.0829, 0.0837, 0.0835,
         0.0833, 0.0834, 0.0829],
        [0.0835, 0.0834, 0.0838, 0.0835, 0.0828, 0.0833, 0.0829, 0.0837, 0.0835,
         0.0833, 0.0834, 0.0830],
        [0.0835, 0.0834, 0.0838, 0.0835, 0.0828, 0.0833, 0.0829, 0.0837, 0.0834,
         0.0834, 0.0834, 0.0830],
        [0.0835, 0.0834, 0.0837, 0.0835, 0.0828, 0.0833, 0.0829, 0.0837, 0.0834,
         0.0833, 0.0835, 0.0830]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.30527710914611816s
iter time cost:10.973289489746094s
-------------Round number: 65-------------
Evaluate global model
Averaged Train Loss: 0.5249
Averaged Test Accurancy: 0.7855
Std Test Accurancy: 0.0991
evaluate time cost:4.85730767250061s
clients training time cost:5.34293532371521s
[running kmeans]: 7it [00:00, 368.09it/s, center_shift=0.000000, iteration=7, tol=0.000100]
attn_optimize time cost:0.6882805824279785s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0770, 0.0767, 0.0768, 0.0768, 0.0770, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0768, 0.0768, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0767, 0.0768, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0768, 0.0768, 0.0770, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0768, 0.0768, 0.0770, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0768, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0767, 0.0767, 0.0767, 0.0770, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0768, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0768, 0.0768, 0.0770, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0768, 0.0768, 0.0768, 0.0770, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0767, 0.0768, 0.0770, 0.0767, 0.0771, 0.0767, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0767, 0.0768, 0.0770, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0767, 0.0768, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0775, 0.0771, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1429, 0.1426, 0.1426, 0.1426, 0.1435, 0.1426],
        [0.1431, 0.1428, 0.1427, 0.1426, 0.1426, 0.1435, 0.1427],
        [0.1430, 0.1428, 0.1428, 0.1427, 0.1426, 0.1434, 0.1426],
        [0.1431, 0.1429, 0.1427, 0.1427, 0.1426, 0.1435, 0.1426],
        [0.1431, 0.1428, 0.1427, 0.1426, 0.1426, 0.1434, 0.1428],
        [0.1431, 0.1428, 0.1427, 0.1426, 0.1426, 0.1434, 0.1428],
        [0.1432, 0.1429, 0.1428, 0.1426, 0.1426, 0.1435, 0.1425]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0499],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0501,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0498, 0.0497],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0501,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0500, 0.0498, 0.0502, 0.0501, 0.0502, 0.0499, 0.0498, 0.0500, 0.0500,
         0.0501, 0.0497, 0.0500, 0.0502, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501,
         0.0498, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1430, 0.1420, 0.1418, 0.1427, 0.1425, 0.1445],
        [0.1436, 0.1431, 0.1420, 0.1419, 0.1427, 0.1425, 0.1442],
        [0.1436, 0.1430, 0.1421, 0.1419, 0.1427, 0.1425, 0.1443],
        [0.1435, 0.1431, 0.1421, 0.1419, 0.1428, 0.1425, 0.1442],
        [0.1436, 0.1430, 0.1420, 0.1419, 0.1427, 0.1425, 0.1445],
        [0.1435, 0.1430, 0.1420, 0.1419, 0.1427, 0.1424, 0.1445],
        [0.1436, 0.1429, 0.1419, 0.1416, 0.1427, 0.1422, 0.1450]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0769, 0.0770, 0.0770, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0772, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0768, 0.0770, 0.0769, 0.0768, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0768, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0768, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0768,
         0.0772, 0.0769, 0.0767, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0526, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0526],
        [0.0527, 0.0530, 0.0522, 0.0526, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0530, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0530, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0522, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0530, 0.0522, 0.0526, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2511, 0.2505, 0.2517, 0.2467],
        [0.2510, 0.2503, 0.2515, 0.2472],
        [0.2509, 0.2503, 0.2515, 0.2473],
        [0.2511, 0.2506, 0.2515, 0.2468]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0669, 0.0668, 0.0669, 0.0668, 0.0668, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0668, 0.0661, 0.0665, 0.0669, 0.0664],
        [0.0669, 0.0668, 0.0669, 0.0668, 0.0668, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0668, 0.0665],
        [0.0669, 0.0668, 0.0669, 0.0668, 0.0667, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0668, 0.0665],
        [0.0669, 0.0669, 0.0669, 0.0669, 0.0667, 0.0662, 0.0666, 0.0663, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0668, 0.0664],
        [0.0669, 0.0668, 0.0669, 0.0668, 0.0668, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0668, 0.0664],
        [0.0669, 0.0668, 0.0669, 0.0668, 0.0667, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0668, 0.0664],
        [0.0669, 0.0668, 0.0669, 0.0668, 0.0667, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0668, 0.0664],
        [0.0669, 0.0668, 0.0669, 0.0668, 0.0667, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0668, 0.0664],
        [0.0669, 0.0668, 0.0669, 0.0668, 0.0667, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0668, 0.0661, 0.0665, 0.0668, 0.0665],
        [0.0669, 0.0668, 0.0669, 0.0668, 0.0668, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0668, 0.0664],
        [0.0669, 0.0668, 0.0669, 0.0669, 0.0668, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0668, 0.0664],
        [0.0669, 0.0668, 0.0669, 0.0669, 0.0668, 0.0663, 0.0666, 0.0664, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0668, 0.0664],
        [0.0669, 0.0668, 0.0669, 0.0669, 0.0667, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0669, 0.0664],
        [0.0669, 0.0668, 0.0669, 0.0669, 0.0667, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0668, 0.0661, 0.0665, 0.0668, 0.0664],
        [0.0669, 0.0668, 0.0669, 0.0668, 0.0667, 0.0663, 0.0667, 0.0664, 0.0670,
         0.0668, 0.0667, 0.0661, 0.0665, 0.0669, 0.0665]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.23827314376831055s
iter time cost:11.208871603012085s
-------------Round number: 66-------------
Evaluate global model
Averaged Train Loss: 0.4938
Averaged Test Accurancy: 0.7927
Std Test Accurancy: 0.0959
evaluate time cost:4.588287830352783s
[running kmeans]: 9it [00:00, 374.67it/s, center_shift=0.000000, iteration=9, tol=0.000100]
clients training time cost:5.413172245025635s
attn_optimize time cost:0.5811245441436768s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1998, 0.2000, 0.2000, 0.2002, 0.2000],
        [0.1998, 0.2000, 0.2000, 0.2001, 0.2000],
        [0.1998, 0.2001, 0.2000, 0.2001, 0.2000],
        [0.1997, 0.2000, 0.2000, 0.2003, 0.2001],
        [0.1997, 0.2000, 0.2000, 0.2003, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0715, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0717, 0.0715, 0.0712],
        [0.0715, 0.0713, 0.0714, 0.0712, 0.0715, 0.0715, 0.0715, 0.0712, 0.0715,
         0.0714, 0.0714, 0.0717, 0.0716, 0.0712],
        [0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0715, 0.0715, 0.0712, 0.0714,
         0.0715, 0.0714, 0.0716, 0.0716, 0.0712],
        [0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0716, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0713, 0.0717, 0.0715, 0.0712],
        [0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0715, 0.0715, 0.0713, 0.0715,
         0.0714, 0.0714, 0.0717, 0.0716, 0.0713],
        [0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0716, 0.0715, 0.0712, 0.0714,
         0.0714, 0.0713, 0.0717, 0.0715, 0.0713],
        [0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0715, 0.0715, 0.0712, 0.0715,
         0.0715, 0.0714, 0.0717, 0.0716, 0.0712],
        [0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0715, 0.0715, 0.0712, 0.0715,
         0.0714, 0.0714, 0.0717, 0.0716, 0.0712],
        [0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0716, 0.0714, 0.0712, 0.0715,
         0.0715, 0.0714, 0.0717, 0.0716, 0.0712],
        [0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0715, 0.0715, 0.0712, 0.0715,
         0.0715, 0.0714, 0.0716, 0.0715, 0.0712],
        [0.0716, 0.0714, 0.0714, 0.0712, 0.0715, 0.0715, 0.0715, 0.0712, 0.0714,
         0.0715, 0.0714, 0.0716, 0.0716, 0.0712],
        [0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0716, 0.0715, 0.0713, 0.0714,
         0.0714, 0.0714, 0.0717, 0.0715, 0.0713],
        [0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0716, 0.0715, 0.0712, 0.0715,
         0.0715, 0.0714, 0.0717, 0.0716, 0.0712],
        [0.0716, 0.0713, 0.0714, 0.0712, 0.0715, 0.0715, 0.0715, 0.0712, 0.0714,
         0.0715, 0.0714, 0.0717, 0.0716, 0.0712]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0768, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0768, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0768, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0768, 0.0770, 0.0769, 0.0768, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0768, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0768, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0768, 0.0767, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0501, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0501,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0501, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0501,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0503, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0502, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0499, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0501, 0.0497, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0498, 0.0502, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0499, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0502, 0.0498, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0498, 0.0501, 0.0499, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0499, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0502, 0.0498, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0501, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0501, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0499, 0.0500, 0.0498,
         0.0500, 0.0506],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0499, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0499, 0.0503, 0.0497, 0.0502, 0.0498, 0.0500, 0.0499, 0.0497, 0.0498,
         0.0497, 0.0501, 0.0498, 0.0502, 0.0500, 0.0503, 0.0499, 0.0501, 0.0497,
         0.0500, 0.0509]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1004, 0.0996, 0.1001, 0.0995, 0.1000, 0.1000, 0.0998, 0.1001,
         0.1003],
        [0.1001, 0.1004, 0.0996, 0.1001, 0.0996, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1003],
        [0.1001, 0.1004, 0.0996, 0.1001, 0.0996, 0.1000, 0.1000, 0.0998, 0.1000,
         0.1003],
        [0.1001, 0.1005, 0.0996, 0.1001, 0.0995, 0.1000, 0.1000, 0.0998, 0.1001,
         0.1003],
        [0.1001, 0.1004, 0.0996, 0.1001, 0.0996, 0.1000, 0.1000, 0.0998, 0.1001,
         0.1003],
        [0.1001, 0.1004, 0.0996, 0.1002, 0.0996, 0.1000, 0.1000, 0.0998, 0.1001,
         0.1004],
        [0.1001, 0.1004, 0.0996, 0.1001, 0.0996, 0.1000, 0.1000, 0.0998, 0.1001,
         0.1003],
        [0.1001, 0.1004, 0.0996, 0.1001, 0.0996, 0.1000, 0.1000, 0.0998, 0.1000,
         0.1003],
        [0.1001, 0.1005, 0.0995, 0.1001, 0.0995, 0.1000, 0.1000, 0.0998, 0.1001,
         0.1003],
        [0.1001, 0.1005, 0.0996, 0.1001, 0.0996, 0.1000, 0.1000, 0.0998, 0.1000,
         0.1003]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1102, 0.1112, 0.1109, 0.1113, 0.1112, 0.1114, 0.1111, 0.1117, 0.1111],
        [0.1103, 0.1113, 0.1109, 0.1112, 0.1112, 0.1113, 0.1111, 0.1117, 0.1110],
        [0.1103, 0.1112, 0.1109, 0.1112, 0.1112, 0.1113, 0.1111, 0.1116, 0.1111],
        [0.1103, 0.1113, 0.1109, 0.1112, 0.1112, 0.1113, 0.1110, 0.1116, 0.1111],
        [0.1103, 0.1113, 0.1109, 0.1113, 0.1112, 0.1113, 0.1110, 0.1117, 0.1110],
        [0.1102, 0.1113, 0.1110, 0.1113, 0.1111, 0.1113, 0.1111, 0.1117, 0.1110],
        [0.1103, 0.1113, 0.1109, 0.1113, 0.1112, 0.1113, 0.1111, 0.1117, 0.1110],
        [0.1102, 0.1113, 0.1109, 0.1112, 0.1112, 0.1113, 0.1110, 0.1117, 0.1110],
        [0.1103, 0.1113, 0.1109, 0.1113, 0.1112, 0.1113, 0.1111, 0.1117, 0.1110]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1427, 0.1427, 0.1428, 0.1425, 0.1435, 0.1427],
        [0.1431, 0.1427, 0.1428, 0.1427, 0.1425, 0.1435, 0.1428],
        [0.1430, 0.1427, 0.1429, 0.1428, 0.1424, 0.1434, 0.1427],
        [0.1431, 0.1427, 0.1428, 0.1428, 0.1425, 0.1434, 0.1426],
        [0.1431, 0.1427, 0.1428, 0.1428, 0.1425, 0.1434, 0.1428],
        [0.1431, 0.1427, 0.1428, 0.1427, 0.1425, 0.1434, 0.1428],
        [0.1432, 0.1427, 0.1429, 0.1428, 0.1425, 0.1435, 0.1425]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3448624610900879s
iter time cost:11.056561470031738s
-------------Round number: 67-------------
Evaluate global model
Averaged Train Loss: 0.4550
Averaged Test Accurancy: 0.7949
Std Test Accurancy: 0.0845
evaluate time cost:4.931963205337524s
clients training time cost:5.348224878311157s
[running kmeans]: 5it [00:00, 293.85it/s, center_shift=0.000000, iteration=5, tol=0.000100]
attn_optimize time cost:0.5600733757019043s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2492, 0.2509, 0.2517, 0.2482],
        [0.2492, 0.2508, 0.2516, 0.2484],
        [0.2490, 0.2508, 0.2513, 0.2489],
        [0.2486, 0.2505, 0.2524, 0.2485]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1666, 0.1665, 0.1672, 0.1671, 0.1659],
        [0.1666, 0.1665, 0.1666, 0.1674, 0.1671, 0.1658],
        [0.1665, 0.1666, 0.1666, 0.1673, 0.1670, 0.1659],
        [0.1667, 0.1666, 0.1666, 0.1673, 0.1670, 0.1659],
        [0.1666, 0.1665, 0.1666, 0.1673, 0.1671, 0.1659],
        [0.1665, 0.1663, 0.1664, 0.1675, 0.1672, 0.1661]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1434, 0.1427, 0.1427, 0.1427, 0.1423, 0.1427, 0.1435],
        [0.1434, 0.1426, 0.1429, 0.1427, 0.1422, 0.1427, 0.1435],
        [0.1433, 0.1427, 0.1429, 0.1428, 0.1423, 0.1426, 0.1434],
        [0.1434, 0.1426, 0.1429, 0.1428, 0.1423, 0.1426, 0.1435],
        [0.1434, 0.1427, 0.1428, 0.1427, 0.1422, 0.1427, 0.1435],
        [0.1433, 0.1427, 0.1429, 0.1428, 0.1422, 0.1426, 0.1435],
        [0.1433, 0.1426, 0.1429, 0.1428, 0.1423, 0.1426, 0.1434]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0766, 0.0769, 0.0767, 0.0768, 0.0768, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0767, 0.0768, 0.0768, 0.0772, 0.0768, 0.0769,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0768, 0.0768, 0.0772, 0.0768, 0.0769,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0767, 0.0768, 0.0767, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0768, 0.0768, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0767, 0.0768, 0.0768, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0766, 0.0768, 0.0767, 0.0768, 0.0767, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0769, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0768, 0.0768, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0767, 0.0768, 0.0767, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0769, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0767, 0.0768, 0.0768, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0769, 0.0769],
        [0.0769, 0.0766, 0.0768, 0.0767, 0.0768, 0.0768, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0770],
        [0.0769, 0.0766, 0.0768, 0.0767, 0.0768, 0.0767, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0769, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0767, 0.0768, 0.0768, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0501, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0492],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0501, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0503, 0.0501, 0.0497, 0.0497,
         0.0500, 0.0498, 0.0500, 0.0504, 0.0501, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0503, 0.0501, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0501, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0499, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0501, 0.0495, 0.0500, 0.0502,
         0.0498, 0.0490]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0832, 0.0832, 0.0837,
         0.0832, 0.0831, 0.0833],
        [0.0835, 0.0833, 0.0834, 0.0834, 0.0831, 0.0834, 0.0833, 0.0832, 0.0837,
         0.0833, 0.0831, 0.0834],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0832, 0.0832, 0.0837,
         0.0833, 0.0831, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0837,
         0.0833, 0.0831, 0.0834],
        [0.0836, 0.0832, 0.0834, 0.0833, 0.0831, 0.0834, 0.0833, 0.0832, 0.0837,
         0.0833, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0835, 0.0834, 0.0831, 0.0834, 0.0832, 0.0832, 0.0837,
         0.0833, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0835, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0837,
         0.0833, 0.0831, 0.0834],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0837,
         0.0833, 0.0831, 0.0834],
        [0.0835, 0.0833, 0.0835, 0.0834, 0.0831, 0.0834, 0.0833, 0.0832, 0.0837,
         0.0833, 0.0831, 0.0833],
        [0.0835, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0832, 0.0832, 0.0837,
         0.0833, 0.0832, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0837,
         0.0833, 0.0831, 0.0834],
        [0.0835, 0.0833, 0.0834, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0837,
         0.0832, 0.0831, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1434, 0.1430, 0.1421, 0.1417, 0.1431, 0.1423, 0.1444],
        [0.1435, 0.1432, 0.1421, 0.1418, 0.1431, 0.1423, 0.1441],
        [0.1435, 0.1430, 0.1422, 0.1417, 0.1431, 0.1423, 0.1442],
        [0.1434, 0.1431, 0.1422, 0.1418, 0.1431, 0.1423, 0.1441],
        [0.1434, 0.1430, 0.1421, 0.1418, 0.1430, 0.1422, 0.1444],
        [0.1434, 0.1430, 0.1421, 0.1418, 0.1430, 0.1422, 0.1445],
        [0.1435, 0.1430, 0.1419, 0.1415, 0.1431, 0.1420, 0.1450]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0625, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0626, 0.0626, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0625, 0.0627, 0.0628],
        [0.0626, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0625, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0625, 0.0624, 0.0625, 0.0625, 0.0627, 0.0627],
        [0.0626, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0624, 0.0623, 0.0625, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0625, 0.0627, 0.0628],
        [0.0626, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0624, 0.0623, 0.0624, 0.0625, 0.0626, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0624, 0.0624, 0.0624, 0.0625, 0.0626, 0.0627],
        [0.0626, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0626, 0.0624,
         0.0624, 0.0625, 0.0623, 0.0624, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0625, 0.0626, 0.0627]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0714, 0.0714, 0.0714, 0.0713, 0.0716, 0.0713, 0.0713, 0.0716, 0.0716,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0712],
        [0.0714, 0.0714, 0.0714, 0.0713, 0.0716, 0.0713, 0.0713, 0.0716, 0.0715,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0712],
        [0.0714, 0.0715, 0.0714, 0.0713, 0.0717, 0.0713, 0.0713, 0.0716, 0.0715,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0712],
        [0.0714, 0.0714, 0.0714, 0.0713, 0.0717, 0.0713, 0.0713, 0.0716, 0.0715,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0712],
        [0.0714, 0.0715, 0.0714, 0.0713, 0.0716, 0.0713, 0.0713, 0.0716, 0.0715,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0712],
        [0.0714, 0.0715, 0.0714, 0.0713, 0.0716, 0.0713, 0.0713, 0.0716, 0.0715,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0712],
        [0.0714, 0.0714, 0.0714, 0.0713, 0.0717, 0.0713, 0.0713, 0.0716, 0.0715,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0713],
        [0.0714, 0.0714, 0.0714, 0.0713, 0.0716, 0.0713, 0.0713, 0.0716, 0.0715,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0713],
        [0.0714, 0.0715, 0.0714, 0.0713, 0.0717, 0.0713, 0.0713, 0.0716, 0.0716,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0712],
        [0.0714, 0.0715, 0.0714, 0.0713, 0.0717, 0.0713, 0.0713, 0.0716, 0.0716,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0712],
        [0.0714, 0.0714, 0.0714, 0.0713, 0.0716, 0.0713, 0.0714, 0.0716, 0.0715,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0712],
        [0.0714, 0.0715, 0.0714, 0.0713, 0.0716, 0.0713, 0.0713, 0.0716, 0.0715,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0713],
        [0.0714, 0.0714, 0.0714, 0.0713, 0.0716, 0.0713, 0.0713, 0.0716, 0.0715,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0712],
        [0.0714, 0.0714, 0.0714, 0.0713, 0.0717, 0.0713, 0.0713, 0.0716, 0.0715,
         0.0713, 0.0714, 0.0716, 0.0715, 0.0712]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28987932205200195s
iter time cost:11.229231119155884s
-------------Round number: 68-------------
Evaluate global model
Averaged Train Loss: 0.4850
Averaged Test Accurancy: 0.7818
Std Test Accurancy: 0.1063
evaluate time cost:4.7790772914886475s
[running kmeans]: 6it [00:00, 260.63it/s, center_shift=0.000000, iteration=6, tol=0.000100]
clients training time cost:5.19599723815918s
attn_optimize time cost:0.4381897449493408s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0714, 0.0715, 0.0716, 0.0714, 0.0716, 0.0713, 0.0711, 0.0715, 0.0715,
         0.0713, 0.0714, 0.0717, 0.0714, 0.0713],
        [0.0715, 0.0715, 0.0716, 0.0715, 0.0716, 0.0713, 0.0711, 0.0714, 0.0715,
         0.0713, 0.0714, 0.0717, 0.0714, 0.0713],
        [0.0714, 0.0715, 0.0716, 0.0714, 0.0716, 0.0713, 0.0711, 0.0715, 0.0715,
         0.0714, 0.0714, 0.0717, 0.0714, 0.0713],
        [0.0714, 0.0714, 0.0716, 0.0714, 0.0716, 0.0713, 0.0711, 0.0714, 0.0715,
         0.0713, 0.0715, 0.0717, 0.0714, 0.0712],
        [0.0714, 0.0715, 0.0716, 0.0714, 0.0716, 0.0713, 0.0711, 0.0715, 0.0715,
         0.0714, 0.0714, 0.0717, 0.0714, 0.0713],
        [0.0714, 0.0714, 0.0715, 0.0715, 0.0716, 0.0713, 0.0711, 0.0715, 0.0715,
         0.0713, 0.0715, 0.0717, 0.0714, 0.0712],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0716, 0.0713, 0.0711, 0.0715, 0.0715,
         0.0713, 0.0714, 0.0717, 0.0714, 0.0713],
        [0.0714, 0.0714, 0.0716, 0.0714, 0.0716, 0.0713, 0.0711, 0.0715, 0.0715,
         0.0713, 0.0714, 0.0717, 0.0715, 0.0713],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0716, 0.0713, 0.0711, 0.0715, 0.0715,
         0.0713, 0.0714, 0.0717, 0.0714, 0.0713],
        [0.0714, 0.0715, 0.0715, 0.0714, 0.0716, 0.0713, 0.0711, 0.0715, 0.0715,
         0.0714, 0.0714, 0.0717, 0.0714, 0.0713],
        [0.0714, 0.0714, 0.0715, 0.0715, 0.0716, 0.0713, 0.0711, 0.0715, 0.0715,
         0.0714, 0.0714, 0.0717, 0.0715, 0.0713],
        [0.0714, 0.0715, 0.0716, 0.0714, 0.0716, 0.0713, 0.0711, 0.0715, 0.0715,
         0.0713, 0.0714, 0.0717, 0.0714, 0.0713],
        [0.0715, 0.0714, 0.0716, 0.0715, 0.0716, 0.0713, 0.0711, 0.0714, 0.0715,
         0.0713, 0.0714, 0.0717, 0.0715, 0.0713],
        [0.0714, 0.0715, 0.0716, 0.0714, 0.0716, 0.0713, 0.0711, 0.0715, 0.0715,
         0.0714, 0.0715, 0.0717, 0.0714, 0.0712]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1671, 0.1661, 0.1666, 0.1674, 0.1672, 0.1656],
        [0.1670, 0.1660, 0.1666, 0.1675, 0.1673, 0.1657],
        [0.1669, 0.1662, 0.1666, 0.1675, 0.1671, 0.1657],
        [0.1670, 0.1661, 0.1666, 0.1675, 0.1671, 0.1657],
        [0.1670, 0.1660, 0.1666, 0.1675, 0.1672, 0.1657],
        [0.1670, 0.1656, 0.1664, 0.1677, 0.1674, 0.1659]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501, 0.0497, 0.0499, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0503, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0503, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0503, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0503, 0.0502, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0503, 0.0502, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0503, 0.0502, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0504, 0.0503, 0.0497, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0501, 0.0495, 0.0500, 0.0502,
         0.0498, 0.0490]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0499, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0502,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0504, 0.0499, 0.0498, 0.0503,
         0.0499, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0622, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0625, 0.0627, 0.0628],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0625, 0.0623, 0.0624, 0.0625, 0.0628, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0622, 0.0625, 0.0625, 0.0624,
         0.0625, 0.0625, 0.0623, 0.0624, 0.0626, 0.0628, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0625, 0.0626, 0.0622, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0627, 0.0628],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0626, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0622, 0.0625, 0.0626, 0.0622, 0.0625, 0.0624, 0.0625,
         0.0624, 0.0625, 0.0624, 0.0623, 0.0625, 0.0627, 0.0628],
        [0.0625, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0624, 0.0623, 0.0624, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0622, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0625, 0.0623, 0.0624, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0622, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0625, 0.0623, 0.0624, 0.0625, 0.0628, 0.0627],
        [0.0625, 0.0628, 0.0622, 0.0625, 0.0626, 0.0622, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0625, 0.0628, 0.0628],
        [0.0625, 0.0628, 0.0622, 0.0624, 0.0626, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0625, 0.0623, 0.0624, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0625, 0.0626, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0622, 0.0625, 0.0624, 0.0624,
         0.0624, 0.0625, 0.0624, 0.0624, 0.0625, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0622, 0.0625, 0.0625, 0.0625,
         0.0624, 0.0625, 0.0623, 0.0624, 0.0625, 0.0628, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0626, 0.0623, 0.0625, 0.0625, 0.0624,
         0.0625, 0.0625, 0.0624, 0.0624, 0.0625, 0.0627, 0.0627]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2493, 0.2508, 0.2516, 0.2484],
        [0.2493, 0.2507, 0.2515, 0.2485],
        [0.2491, 0.2506, 0.2512, 0.2491],
        [0.2487, 0.2503, 0.2523, 0.2487]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3335, 0.3323, 0.3342],
        [0.3335, 0.3322, 0.3343],
        [0.3337, 0.3321, 0.3342]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1438, 0.1432, 0.1426, 0.1422, 0.1429, 0.1427, 0.1426],
        [0.1438, 0.1433, 0.1425, 0.1422, 0.1428, 0.1427, 0.1426],
        [0.1438, 0.1432, 0.1426, 0.1422, 0.1429, 0.1428, 0.1425],
        [0.1437, 0.1433, 0.1425, 0.1422, 0.1429, 0.1428, 0.1425],
        [0.1438, 0.1433, 0.1425, 0.1422, 0.1429, 0.1428, 0.1425],
        [0.1438, 0.1432, 0.1426, 0.1423, 0.1429, 0.1426, 0.1426],
        [0.1438, 0.1433, 0.1426, 0.1423, 0.1429, 0.1428, 0.1425]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1114, 0.1106, 0.1109, 0.1112, 0.1108, 0.1114, 0.1115, 0.1108, 0.1113],
        [0.1113, 0.1107, 0.1109, 0.1112, 0.1109, 0.1114, 0.1115, 0.1108, 0.1113],
        [0.1113, 0.1107, 0.1109, 0.1112, 0.1108, 0.1115, 0.1114, 0.1109, 0.1112],
        [0.1113, 0.1107, 0.1110, 0.1112, 0.1108, 0.1115, 0.1114, 0.1109, 0.1113],
        [0.1113, 0.1107, 0.1109, 0.1112, 0.1109, 0.1115, 0.1114, 0.1109, 0.1112],
        [0.1114, 0.1106, 0.1109, 0.1113, 0.1108, 0.1115, 0.1115, 0.1109, 0.1113],
        [0.1113, 0.1106, 0.1109, 0.1112, 0.1109, 0.1114, 0.1114, 0.1108, 0.1114],
        [0.1114, 0.1106, 0.1109, 0.1112, 0.1108, 0.1114, 0.1115, 0.1109, 0.1113],
        [0.1113, 0.1106, 0.1109, 0.1112, 0.1109, 0.1115, 0.1114, 0.1109, 0.1113]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.32557177543640137s
iter time cost:10.868954420089722s
-------------Round number: 69-------------
Evaluate global model
Averaged Train Loss: 0.6033
Averaged Test Accurancy: 0.7714
Std Test Accurancy: 0.0983
evaluate time cost:5.0410544872283936s
clients training time cost:5.219421148300171s
[running kmeans]: 6it [00:00, 399.64it/s, center_shift=0.000000, iteration=6, tol=0.000100]
attn_optimize time cost:0.4990265369415283s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1415, 0.1429, 0.1426, 0.1431, 0.1432, 0.1438, 0.1430],
        [0.1416, 0.1430, 0.1426, 0.1430, 0.1432, 0.1437, 0.1429],
        [0.1416, 0.1429, 0.1426, 0.1430, 0.1432, 0.1437, 0.1430],
        [0.1417, 0.1430, 0.1426, 0.1430, 0.1432, 0.1437, 0.1429],
        [0.1415, 0.1430, 0.1427, 0.1431, 0.1431, 0.1438, 0.1428],
        [0.1415, 0.1430, 0.1426, 0.1430, 0.1432, 0.1437, 0.1429],
        [0.1416, 0.1430, 0.1426, 0.1431, 0.1432, 0.1437, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2511, 0.2507, 0.2517, 0.2465],
        [0.2509, 0.2505, 0.2515, 0.2471],
        [0.2508, 0.2505, 0.2515, 0.2471],
        [0.2511, 0.2511, 0.2515, 0.2464]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0525, 0.0529,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0525, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0530, 0.0525, 0.0525, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0527, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0525, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0526, 0.0529, 0.0525, 0.0525, 0.0529,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0525, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0527, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0524, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0525, 0.0529,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0525, 0.0529,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0525, 0.0529,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0829, 0.0834, 0.0832, 0.0834, 0.0828, 0.0836, 0.0835, 0.0839,
         0.0836, 0.0831, 0.0833],
        [0.0832, 0.0830, 0.0834, 0.0832, 0.0834, 0.0829, 0.0836, 0.0835, 0.0838,
         0.0836, 0.0831, 0.0833],
        [0.0833, 0.0830, 0.0834, 0.0832, 0.0834, 0.0829, 0.0837, 0.0834, 0.0838,
         0.0836, 0.0831, 0.0833],
        [0.0833, 0.0830, 0.0834, 0.0832, 0.0833, 0.0829, 0.0837, 0.0834, 0.0838,
         0.0836, 0.0832, 0.0833],
        [0.0833, 0.0830, 0.0834, 0.0832, 0.0833, 0.0829, 0.0837, 0.0834, 0.0839,
         0.0835, 0.0831, 0.0833],
        [0.0833, 0.0830, 0.0834, 0.0832, 0.0833, 0.0829, 0.0837, 0.0834, 0.0838,
         0.0835, 0.0832, 0.0832],
        [0.0833, 0.0829, 0.0833, 0.0832, 0.0834, 0.0828, 0.0837, 0.0834, 0.0839,
         0.0836, 0.0832, 0.0833],
        [0.0833, 0.0830, 0.0834, 0.0832, 0.0833, 0.0829, 0.0836, 0.0834, 0.0838,
         0.0836, 0.0831, 0.0833],
        [0.0833, 0.0830, 0.0835, 0.0832, 0.0833, 0.0829, 0.0837, 0.0834, 0.0838,
         0.0836, 0.0832, 0.0833],
        [0.0833, 0.0829, 0.0833, 0.0832, 0.0834, 0.0830, 0.0837, 0.0833, 0.0838,
         0.0836, 0.0831, 0.0834],
        [0.0833, 0.0830, 0.0834, 0.0832, 0.0834, 0.0829, 0.0837, 0.0834, 0.0838,
         0.0836, 0.0832, 0.0833],
        [0.0832, 0.0829, 0.0834, 0.0832, 0.0834, 0.0829, 0.0837, 0.0834, 0.0839,
         0.0835, 0.0832, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1254, 0.1252, 0.1243, 0.1240, 0.1250, 0.1251, 0.1246, 0.1264],
        [0.1255, 0.1253, 0.1243, 0.1240, 0.1250, 0.1251, 0.1246, 0.1261],
        [0.1254, 0.1252, 0.1243, 0.1240, 0.1251, 0.1252, 0.1246, 0.1262],
        [0.1254, 0.1253, 0.1243, 0.1240, 0.1251, 0.1252, 0.1246, 0.1261],
        [0.1255, 0.1252, 0.1242, 0.1240, 0.1250, 0.1251, 0.1246, 0.1264],
        [0.1255, 0.1252, 0.1244, 0.1241, 0.1251, 0.1250, 0.1247, 0.1261],
        [0.1254, 0.1252, 0.1243, 0.1240, 0.1250, 0.1251, 0.1245, 0.1265],
        [0.1255, 0.1252, 0.1241, 0.1238, 0.1251, 0.1251, 0.1244, 0.1269]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0501, 0.0498, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0501, 0.0498, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0501, 0.0498, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0501, 0.0498, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0498],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0498, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0501, 0.0498, 0.0502, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0503, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0498, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0501, 0.0498, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0501, 0.0498, 0.0501, 0.0498, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0500, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0497, 0.0502, 0.0498, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0498, 0.0499, 0.0503, 0.0500, 0.0501, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0627, 0.0626, 0.0628, 0.0627, 0.0626, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0623, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0626, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0627, 0.0629, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0619, 0.0623, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0621,
         0.0629, 0.0627, 0.0625, 0.0619, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0626, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0626, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0619, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0619, 0.0623, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0626, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0626, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0619, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0625, 0.0619, 0.0624, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0624, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0625, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0626, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0620, 0.0623, 0.0627, 0.0623]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0837, 0.0831, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0832,
         0.0833, 0.0834, 0.0835],
        [0.0834, 0.0837, 0.0831, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0832,
         0.0832, 0.0834, 0.0836],
        [0.0834, 0.0837, 0.0831, 0.0834, 0.0831, 0.0834, 0.0833, 0.0832, 0.0832,
         0.0832, 0.0835, 0.0836],
        [0.0834, 0.0838, 0.0831, 0.0834, 0.0831, 0.0833, 0.0832, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0836],
        [0.0834, 0.0837, 0.0830, 0.0834, 0.0831, 0.0834, 0.0833, 0.0832, 0.0832,
         0.0832, 0.0835, 0.0836],
        [0.0834, 0.0837, 0.0830, 0.0834, 0.0831, 0.0833, 0.0832, 0.0833, 0.0833,
         0.0832, 0.0835, 0.0836],
        [0.0834, 0.0837, 0.0831, 0.0834, 0.0831, 0.0834, 0.0833, 0.0832, 0.0832,
         0.0832, 0.0834, 0.0835],
        [0.0834, 0.0838, 0.0830, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0836],
        [0.0834, 0.0838, 0.0830, 0.0835, 0.0831, 0.0833, 0.0833, 0.0832, 0.0831,
         0.0832, 0.0835, 0.0836],
        [0.0834, 0.0837, 0.0831, 0.0834, 0.0831, 0.0833, 0.0833, 0.0832, 0.0832,
         0.0832, 0.0834, 0.0835],
        [0.0834, 0.0838, 0.0830, 0.0834, 0.0831, 0.0834, 0.0832, 0.0833, 0.0832,
         0.0832, 0.0835, 0.0836],
        [0.0834, 0.0838, 0.0831, 0.0834, 0.0831, 0.0834, 0.0832, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0835]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.36689090728759766s
iter time cost:11.213470458984375s
-------------Round number: 70-------------
Evaluate global model
Averaged Train Loss: 0.6076
Averaged Test Accurancy: 0.7784
Std Test Accurancy: 0.1261
evaluate time cost:5.006245851516724s
[running kmeans]: 5it [00:00, 249.79it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:5.192754030227661s
attn_optimize time cost:0.531120777130127s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1003, 0.0999, 0.0999, 0.0999, 0.0996, 0.0998, 0.0998, 0.1004, 0.0998,
         0.1005],
        [0.1003, 0.0999, 0.1000, 0.1000, 0.0995, 0.0999, 0.0998, 0.1004, 0.0998,
         0.1005],
        [0.1002, 0.0999, 0.1000, 0.1000, 0.0996, 0.0998, 0.0998, 0.1003, 0.0998,
         0.1005],
        [0.1003, 0.0999, 0.1000, 0.1000, 0.0996, 0.0998, 0.0998, 0.1004, 0.0998,
         0.1005],
        [0.1003, 0.0999, 0.0999, 0.1000, 0.0995, 0.0999, 0.0998, 0.1004, 0.0998,
         0.1005],
        [0.1003, 0.0999, 0.1000, 0.1000, 0.0995, 0.0998, 0.0998, 0.1004, 0.0998,
         0.1005],
        [0.1003, 0.0999, 0.1000, 0.1000, 0.0996, 0.0998, 0.0998, 0.1003, 0.0998,
         0.1005],
        [0.1003, 0.0999, 0.0999, 0.1000, 0.0996, 0.0998, 0.0998, 0.1003, 0.0998,
         0.1005],
        [0.1003, 0.0999, 0.0999, 0.1000, 0.0996, 0.0998, 0.0998, 0.1003, 0.0998,
         0.1005],
        [0.1003, 0.0999, 0.1000, 0.1000, 0.0996, 0.0998, 0.0998, 0.1004, 0.0998,
         0.1005]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0501, 0.0500, 0.0504, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0498, 0.0500, 0.0498, 0.0500, 0.0498, 0.0496, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0501, 0.0498, 0.0496, 0.0501,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0498, 0.0500, 0.0498, 0.0496, 0.0501,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0498, 0.0500, 0.0498, 0.0496, 0.0501,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0500, 0.0500, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0501, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0500, 0.0498, 0.0500, 0.0498, 0.0496, 0.0501,
         0.0499, 0.0502, 0.0500, 0.0500, 0.0500, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0500, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0500, 0.0504, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0500, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0500, 0.0504, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0506],
        [0.0500, 0.0502, 0.0498, 0.0500, 0.0498, 0.0500, 0.0498, 0.0496, 0.0501,
         0.0499, 0.0502, 0.0499, 0.0500, 0.0500, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0501, 0.0503],
        [0.0500, 0.0502, 0.0498, 0.0500, 0.0498, 0.0500, 0.0498, 0.0497, 0.0501,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0498, 0.0500, 0.0498, 0.0496, 0.0501,
         0.0499, 0.0502, 0.0500, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0502],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0499, 0.0500, 0.0499, 0.0501, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0501, 0.0503, 0.0502, 0.0502, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0499, 0.0502,
         0.0499, 0.0492],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0501, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0503, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0502, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0501, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0503, 0.0501, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0502, 0.0501, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0499, 0.0503, 0.0501, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0505, 0.0502, 0.0500, 0.0495, 0.0500, 0.0502,
         0.0498, 0.0490]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1114, 0.1111, 0.1112, 0.1113, 0.1109, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1112, 0.1108, 0.1112, 0.1110, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1113, 0.1109, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1112, 0.1109, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1113, 0.1112, 0.1109, 0.1112, 0.1111, 0.1107, 0.1112],
        [0.1115, 0.1111, 0.1113, 0.1113, 0.1108, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1112, 0.1109, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1113, 0.1108, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1112, 0.1109, 0.1111, 0.1110, 0.1108, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2484, 0.2506, 0.2501, 0.2509],
        [0.2485, 0.2507, 0.2501, 0.2507],
        [0.2484, 0.2506, 0.2501, 0.2509],
        [0.2484, 0.2507, 0.2501, 0.2508]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0501, 0.0502, 0.0501, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0501, 0.0502, 0.0501, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0501, 0.0502, 0.0501, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0501, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0501, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0500, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0501, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0498],
        [0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0501, 0.0496, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0501, 0.0498, 0.0501, 0.0502, 0.0494, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0502,
         0.0498, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1117, 0.1111, 0.1106, 0.1110, 0.1111, 0.1110, 0.1111, 0.1114],
        [0.1111, 0.1116, 0.1112, 0.1106, 0.1109, 0.1111, 0.1109, 0.1111, 0.1115],
        [0.1111, 0.1117, 0.1112, 0.1106, 0.1110, 0.1111, 0.1109, 0.1111, 0.1115],
        [0.1110, 0.1116, 0.1112, 0.1106, 0.1110, 0.1111, 0.1109, 0.1112, 0.1114],
        [0.1111, 0.1117, 0.1112, 0.1106, 0.1109, 0.1110, 0.1109, 0.1111, 0.1115],
        [0.1111, 0.1116, 0.1112, 0.1106, 0.1110, 0.1111, 0.1109, 0.1111, 0.1114],
        [0.1111, 0.1116, 0.1112, 0.1106, 0.1110, 0.1111, 0.1110, 0.1111, 0.1114],
        [0.1111, 0.1117, 0.1112, 0.1105, 0.1110, 0.1110, 0.1109, 0.1111, 0.1115],
        [0.1111, 0.1117, 0.1111, 0.1106, 0.1110, 0.1111, 0.1109, 0.1111, 0.1115]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1662, 0.1666, 0.1666, 0.1666, 0.1665, 0.1674],
        [0.1663, 0.1666, 0.1667, 0.1667, 0.1664, 0.1674],
        [0.1662, 0.1667, 0.1666, 0.1666, 0.1664, 0.1675],
        [0.1661, 0.1666, 0.1665, 0.1667, 0.1666, 0.1674],
        [0.1662, 0.1667, 0.1666, 0.1667, 0.1665, 0.1674],
        [0.1663, 0.1666, 0.1666, 0.1667, 0.1663, 0.1675]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.4534122943878174s
iter time cost:11.341216325759888s
-------------Round number: 71-------------
Evaluate global model
Averaged Train Loss: 0.5411
Averaged Test Accurancy: 0.7716
Std Test Accurancy: 0.1089
evaluate time cost:5.194566965103149s
[running kmeans]: 4it [00:00, 307.43it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:5.163864850997925s
attn_optimize time cost:0.5691096782684326s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0493],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0496, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0497],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0502, 0.0504, 0.0502,
         0.0501, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.0999, 0.1001, 0.0999, 0.1001, 0.1002, 0.1002, 0.1004, 0.0999,
         0.0993],
        [0.1000, 0.0999, 0.1001, 0.0999, 0.1000, 0.1002, 0.1002, 0.1005, 0.0998,
         0.0993],
        [0.1000, 0.0999, 0.1002, 0.0998, 0.1001, 0.1002, 0.1002, 0.1005, 0.0999,
         0.0992],
        [0.1000, 0.0999, 0.1002, 0.0998, 0.1001, 0.1003, 0.1002, 0.1005, 0.0998,
         0.0992],
        [0.1000, 0.0999, 0.1001, 0.0999, 0.1001, 0.1003, 0.1001, 0.1004, 0.0999,
         0.0993],
        [0.1000, 0.0999, 0.1002, 0.0998, 0.1001, 0.1002, 0.1002, 0.1004, 0.0999,
         0.0993],
        [0.1001, 0.0999, 0.1002, 0.0998, 0.1001, 0.1001, 0.1001, 0.1005, 0.0999,
         0.0993],
        [0.1000, 0.0999, 0.1002, 0.0998, 0.1001, 0.1002, 0.1001, 0.1005, 0.0999,
         0.0992],
        [0.1000, 0.0999, 0.1002, 0.0998, 0.1001, 0.1002, 0.1002, 0.1004, 0.0999,
         0.0994],
        [0.0999, 0.0999, 0.1002, 0.0996, 0.1000, 0.1003, 0.1004, 0.1007, 0.0997,
         0.0995]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0627, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0624, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0626, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0626, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0624, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0624, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0626, 0.0625, 0.0624, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0626, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625],
        [0.0627, 0.0624, 0.0625, 0.0625, 0.0625, 0.0625, 0.0623, 0.0623, 0.0625,
         0.0624, 0.0624, 0.0627, 0.0625, 0.0623, 0.0629, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0623, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0627, 0.0629, 0.0627, 0.0627, 0.0626, 0.0620, 0.0624, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0626, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0623],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0627, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0621, 0.0624, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0623, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0623, 0.0627, 0.0623]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1434, 0.1431, 0.1421, 0.1418, 0.1429, 0.1423, 0.1444],
        [0.1435, 0.1432, 0.1421, 0.1418, 0.1429, 0.1423, 0.1442],
        [0.1434, 0.1431, 0.1422, 0.1418, 0.1430, 0.1423, 0.1443],
        [0.1434, 0.1432, 0.1421, 0.1418, 0.1430, 0.1423, 0.1441],
        [0.1434, 0.1431, 0.1420, 0.1418, 0.1429, 0.1422, 0.1445],
        [0.1434, 0.1431, 0.1421, 0.1419, 0.1429, 0.1422, 0.1445],
        [0.1435, 0.1431, 0.1419, 0.1415, 0.1430, 0.1419, 0.1451]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2510, 0.2497, 0.2496, 0.2497],
        [0.2507, 0.2501, 0.2494, 0.2498],
        [0.2507, 0.2499, 0.2494, 0.2499],
        [0.2512, 0.2500, 0.2495, 0.2493]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2511, 0.2507, 0.2517, 0.2465],
        [0.2509, 0.2504, 0.2515, 0.2472],
        [0.2508, 0.2505, 0.2515, 0.2472],
        [0.2511, 0.2510, 0.2515, 0.2464]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0766, 0.0768, 0.0768, 0.0770, 0.0766, 0.0771, 0.0769, 0.0768,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0771, 0.0770, 0.0768,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0771, 0.0769, 0.0768,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0770, 0.0766, 0.0772, 0.0769, 0.0769,
         0.0774, 0.0770, 0.0768, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0770, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0775, 0.0770, 0.0768, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0772, 0.0769, 0.0768,
         0.0774, 0.0770, 0.0768, 0.0769],
        [0.0771, 0.0765, 0.0768, 0.0767, 0.0770, 0.0766, 0.0772, 0.0769, 0.0769,
         0.0775, 0.0770, 0.0768, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0769, 0.0768,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0770, 0.0766, 0.0771, 0.0769, 0.0768,
         0.0775, 0.0770, 0.0768, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0767, 0.0770, 0.0766, 0.0772, 0.0769, 0.0768,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0771, 0.0765, 0.0768, 0.0768, 0.0770, 0.0767, 0.0772, 0.0769, 0.0768,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0771, 0.0766, 0.0768, 0.0768, 0.0770, 0.0766, 0.0771, 0.0770, 0.0768,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0768, 0.0770, 0.0766, 0.0772, 0.0769, 0.0769,
         0.0775, 0.0770, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1112, 0.1110, 0.1113, 0.1108, 0.1112, 0.1111, 0.1109, 0.1115, 0.1110],
        [0.1113, 0.1110, 0.1113, 0.1108, 0.1111, 0.1111, 0.1109, 0.1115, 0.1110],
        [0.1112, 0.1110, 0.1113, 0.1108, 0.1112, 0.1111, 0.1109, 0.1115, 0.1109],
        [0.1112, 0.1111, 0.1113, 0.1108, 0.1111, 0.1112, 0.1109, 0.1115, 0.1110],
        [0.1112, 0.1110, 0.1113, 0.1107, 0.1112, 0.1111, 0.1109, 0.1115, 0.1110],
        [0.1112, 0.1110, 0.1113, 0.1108, 0.1112, 0.1112, 0.1109, 0.1115, 0.1109],
        [0.1112, 0.1110, 0.1113, 0.1107, 0.1112, 0.1111, 0.1110, 0.1114, 0.1110],
        [0.1112, 0.1110, 0.1113, 0.1108, 0.1112, 0.1111, 0.1109, 0.1115, 0.1109],
        [0.1113, 0.1110, 0.1113, 0.1108, 0.1112, 0.1111, 0.1109, 0.1115, 0.1110]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3859124183654785s
iter time cost:11.399532318115234s
-------------Round number: 72-------------
Evaluate global model
Averaged Train Loss: 0.5249
Averaged Test Accurancy: 0.7675
Std Test Accurancy: 0.1025
evaluate time cost:5.017816543579102s
clients training time cost:5.606968879699707s
[running kmeans]: 5it [00:00, 312.22it/s, center_shift=0.000000, iteration=5, tol=0.000100]
attn_optimize time cost:0.4519979953765869s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0501, 0.0503, 0.0497, 0.0502, 0.0498, 0.0501, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0502, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0501, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0497, 0.0502, 0.0498, 0.0501, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0498, 0.0500, 0.0501, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0501, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0501, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0502, 0.0498, 0.0501, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0504],
        [0.0501, 0.0503, 0.0497, 0.0502, 0.0498, 0.0501, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0499, 0.0502, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0502, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0503, 0.0498, 0.0501, 0.0498, 0.0501, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0501, 0.0503, 0.0497, 0.0502, 0.0498, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0501, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0502, 0.0497, 0.0501, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0498, 0.0501, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0501, 0.0503, 0.0498, 0.0501, 0.0498, 0.0501, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0497, 0.0502, 0.0498, 0.0501, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0501, 0.0502, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0501, 0.0504],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0501, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0504, 0.0497, 0.0502, 0.0497, 0.0501, 0.0498, 0.0496, 0.0498,
         0.0498, 0.0500, 0.0498, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0509]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1251, 0.1249, 0.1244, 0.1249, 0.1255, 0.1246, 0.1257],
        [0.1250, 0.1252, 0.1250, 0.1244, 0.1248, 0.1254, 0.1246, 0.1256],
        [0.1250, 0.1251, 0.1249, 0.1244, 0.1249, 0.1255, 0.1246, 0.1256],
        [0.1250, 0.1250, 0.1249, 0.1244, 0.1249, 0.1255, 0.1246, 0.1257],
        [0.1250, 0.1251, 0.1249, 0.1245, 0.1249, 0.1254, 0.1246, 0.1257],
        [0.1250, 0.1250, 0.1249, 0.1245, 0.1249, 0.1255, 0.1246, 0.1257],
        [0.1250, 0.1250, 0.1249, 0.1245, 0.1249, 0.1254, 0.1246, 0.1257],
        [0.1250, 0.1251, 0.1249, 0.1245, 0.1249, 0.1254, 0.1246, 0.1256]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0503,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501, 0.0497, 0.0499, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0500, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0497, 0.0500, 0.0503,
         0.0499, 0.0490],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0496, 0.0500, 0.0505, 0.0502, 0.0501, 0.0495, 0.0500, 0.0503,
         0.0498, 0.0490]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1103, 0.1113, 0.1111, 0.1114, 0.1114, 0.1113, 0.1120, 0.1114, 0.1099],
        [0.1103, 0.1114, 0.1111, 0.1113, 0.1114, 0.1112, 0.1119, 0.1113, 0.1102],
        [0.1103, 0.1113, 0.1111, 0.1113, 0.1114, 0.1113, 0.1119, 0.1114, 0.1100],
        [0.1103, 0.1114, 0.1111, 0.1113, 0.1114, 0.1112, 0.1119, 0.1113, 0.1102],
        [0.1102, 0.1114, 0.1111, 0.1114, 0.1113, 0.1112, 0.1120, 0.1112, 0.1102],
        [0.1102, 0.1114, 0.1111, 0.1114, 0.1113, 0.1112, 0.1119, 0.1113, 0.1102],
        [0.1102, 0.1114, 0.1111, 0.1113, 0.1114, 0.1111, 0.1120, 0.1113, 0.1102],
        [0.1102, 0.1113, 0.1111, 0.1114, 0.1114, 0.1112, 0.1119, 0.1113, 0.1102],
        [0.1100, 0.1114, 0.1109, 0.1112, 0.1113, 0.1111, 0.1123, 0.1117, 0.1100]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0910, 0.0913, 0.0907, 0.0909, 0.0905, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0910, 0.0913],
        [0.0910, 0.0913, 0.0906, 0.0909, 0.0906, 0.0908, 0.0909, 0.0908, 0.0907,
         0.0909, 0.0913],
        [0.0910, 0.0913, 0.0906, 0.0909, 0.0905, 0.0909, 0.0909, 0.0908, 0.0907,
         0.0910, 0.0913],
        [0.0910, 0.0914, 0.0906, 0.0909, 0.0905, 0.0909, 0.0909, 0.0909, 0.0907,
         0.0910, 0.0913],
        [0.0910, 0.0913, 0.0906, 0.0909, 0.0906, 0.0909, 0.0909, 0.0908, 0.0907,
         0.0910, 0.0913],
        [0.0910, 0.0914, 0.0906, 0.0909, 0.0905, 0.0908, 0.0909, 0.0908, 0.0907,
         0.0910, 0.0913],
        [0.0910, 0.0913, 0.0907, 0.0909, 0.0906, 0.0909, 0.0909, 0.0908, 0.0907,
         0.0910, 0.0912],
        [0.0910, 0.0914, 0.0906, 0.0909, 0.0905, 0.0908, 0.0909, 0.0909, 0.0907,
         0.0910, 0.0913],
        [0.0910, 0.0913, 0.0907, 0.0909, 0.0906, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0909, 0.0912],
        [0.0910, 0.0914, 0.0906, 0.0909, 0.0905, 0.0909, 0.0909, 0.0909, 0.0907,
         0.0910, 0.0913],
        [0.0910, 0.0914, 0.0907, 0.0909, 0.0906, 0.0909, 0.0909, 0.0908, 0.0907,
         0.0909, 0.0913]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.0999, 0.1001, 0.1002, 0.0997, 0.0997, 0.1002, 0.0999, 0.1003,
         0.1000],
        [0.1001, 0.0999, 0.1000, 0.1002, 0.0997, 0.0997, 0.1002, 0.0998, 0.1004,
         0.1000],
        [0.1001, 0.0999, 0.1001, 0.1002, 0.0997, 0.0997, 0.1002, 0.0999, 0.1004,
         0.1000],
        [0.1001, 0.0999, 0.1000, 0.1002, 0.0997, 0.0997, 0.1002, 0.0999, 0.1004,
         0.1000],
        [0.1001, 0.0999, 0.1000, 0.1002, 0.0997, 0.0997, 0.1002, 0.0998, 0.1004,
         0.1000],
        [0.1001, 0.0999, 0.1000, 0.1002, 0.0997, 0.0997, 0.1002, 0.0998, 0.1004,
         0.1000],
        [0.1001, 0.0999, 0.1000, 0.1002, 0.0997, 0.0997, 0.1002, 0.0998, 0.1004,
         0.1000],
        [0.1001, 0.0999, 0.1000, 0.1002, 0.0997, 0.0997, 0.1002, 0.0999, 0.1003,
         0.1000],
        [0.1001, 0.0999, 0.1000, 0.1002, 0.0997, 0.0997, 0.1002, 0.0998, 0.1003,
         0.1000],
        [0.1001, 0.0999, 0.1000, 0.1002, 0.0997, 0.0996, 0.1002, 0.0998, 0.1003,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5012, 0.4988],
        [0.5011, 0.4989]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0998, 0.0999, 0.1001, 0.0999, 0.1001, 0.1003, 0.1002, 0.1003, 0.0998,
         0.0995],
        [0.0999, 0.1000, 0.1001, 0.0999, 0.1000, 0.1003, 0.1003, 0.1004, 0.0997,
         0.0995],
        [0.0998, 0.0999, 0.1002, 0.0999, 0.1001, 0.1003, 0.1003, 0.1004, 0.0998,
         0.0994],
        [0.0999, 0.1000, 0.1001, 0.0998, 0.1001, 0.1003, 0.1003, 0.1004, 0.0997,
         0.0994],
        [0.0999, 0.0999, 0.1001, 0.0999, 0.1001, 0.1003, 0.1002, 0.1003, 0.0998,
         0.0995],
        [0.0999, 0.1000, 0.1001, 0.0998, 0.1001, 0.1003, 0.1002, 0.1003, 0.0998,
         0.0995],
        [0.0999, 0.0999, 0.1001, 0.0998, 0.1001, 0.1002, 0.1002, 0.1004, 0.0998,
         0.0995],
        [0.0999, 0.0999, 0.1001, 0.0998, 0.1001, 0.1003, 0.1002, 0.1004, 0.0998,
         0.0995],
        [0.0998, 0.0999, 0.1001, 0.0998, 0.1000, 0.1002, 0.1003, 0.1003, 0.0998,
         0.0996],
        [0.0997, 0.0999, 0.1001, 0.0996, 0.1000, 0.1004, 0.1005, 0.1005, 0.0995,
         0.0997]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1115, 0.1111, 0.1112, 0.1112, 0.1109, 0.1110, 0.1111, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1112, 0.1108, 0.1111, 0.1111, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1112, 0.1109, 0.1110, 0.1111, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1112, 0.1109, 0.1110, 0.1111, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1113, 0.1112, 0.1109, 0.1111, 0.1111, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1113, 0.1112, 0.1108, 0.1110, 0.1111, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1112, 0.1109, 0.1110, 0.1111, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1112, 0.1108, 0.1110, 0.1111, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1112, 0.1108, 0.1110, 0.1111, 0.1108, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.30527734756469727s
iter time cost:11.48772931098938s
-------------Round number: 73-------------
Evaluate global model
Averaged Train Loss: 0.4240
Averaged Test Accurancy: 0.7980
Std Test Accurancy: 0.1008
evaluate time cost:4.942961692810059s
clients training time cost:5.310702085494995s
attn_optimize time cost:0.5296361446380615s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0497, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0501, 0.0499, 0.0499, 0.0504, 0.0499, 0.0498, 0.0503,
         0.0499, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0500, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0502, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0502, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0497, 0.0499, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0503, 0.0499, 0.0501, 0.0502, 0.0501, 0.0501,
         0.0498, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0835, 0.0837, 0.0835, 0.0826, 0.0834, 0.0829, 0.0837, 0.0835,
         0.0833, 0.0835, 0.0830],
        [0.0835, 0.0835, 0.0838, 0.0835, 0.0827, 0.0833, 0.0829, 0.0836, 0.0834,
         0.0833, 0.0835, 0.0830],
        [0.0836, 0.0835, 0.0838, 0.0835, 0.0827, 0.0833, 0.0829, 0.0837, 0.0834,
         0.0834, 0.0834, 0.0829],
        [0.0835, 0.0835, 0.0838, 0.0835, 0.0827, 0.0833, 0.0828, 0.0837, 0.0835,
         0.0833, 0.0834, 0.0830],
        [0.0836, 0.0834, 0.0838, 0.0835, 0.0827, 0.0833, 0.0829, 0.0837, 0.0834,
         0.0833, 0.0835, 0.0829],
        [0.0835, 0.0834, 0.0837, 0.0835, 0.0827, 0.0834, 0.0829, 0.0836, 0.0835,
         0.0833, 0.0834, 0.0829],
        [0.0835, 0.0834, 0.0838, 0.0836, 0.0827, 0.0833, 0.0828, 0.0837, 0.0835,
         0.0833, 0.0834, 0.0829],
        [0.0835, 0.0835, 0.0838, 0.0835, 0.0827, 0.0833, 0.0829, 0.0836, 0.0835,
         0.0833, 0.0834, 0.0830],
        [0.0835, 0.0834, 0.0837, 0.0836, 0.0827, 0.0834, 0.0829, 0.0837, 0.0835,
         0.0833, 0.0835, 0.0829],
        [0.0835, 0.0835, 0.0838, 0.0836, 0.0826, 0.0833, 0.0828, 0.0837, 0.0835,
         0.0833, 0.0834, 0.0830],
        [0.0836, 0.0835, 0.0838, 0.0835, 0.0827, 0.0833, 0.0828, 0.0837, 0.0834,
         0.0833, 0.0835, 0.0829],
        [0.0835, 0.0835, 0.0838, 0.0835, 0.0827, 0.0833, 0.0829, 0.0837, 0.0834,
         0.0833, 0.0835, 0.0830]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0991, 0.0999, 0.1001, 0.0998, 0.1002, 0.1002, 0.1002, 0.0999, 0.1007,
         0.1001],
        [0.0992, 0.0998, 0.1001, 0.0999, 0.1002, 0.1001, 0.1001, 0.0999, 0.1006,
         0.1000],
        [0.0992, 0.0999, 0.1001, 0.0998, 0.1001, 0.1002, 0.1001, 0.0999, 0.1006,
         0.1000],
        [0.0992, 0.1000, 0.1001, 0.0998, 0.1001, 0.1002, 0.1001, 0.0999, 0.1006,
         0.1001],
        [0.0993, 0.0999, 0.1001, 0.0998, 0.1001, 0.1002, 0.1001, 0.0998, 0.1006,
         0.1000],
        [0.0992, 0.0999, 0.1002, 0.0999, 0.1002, 0.1001, 0.1001, 0.0998, 0.1007,
         0.1000],
        [0.0992, 0.0998, 0.1002, 0.0999, 0.1002, 0.1001, 0.1002, 0.0999, 0.1006,
         0.0999],
        [0.0992, 0.0998, 0.1002, 0.0998, 0.1002, 0.1001, 0.1002, 0.0999, 0.1006,
         0.1000],
        [0.0992, 0.0999, 0.1002, 0.0998, 0.1001, 0.1002, 0.1002, 0.0998, 0.1006,
         0.1000],
        [0.0992, 0.0999, 0.1001, 0.0998, 0.1002, 0.1002, 0.1001, 0.0999, 0.1006,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1116, 0.1111, 0.1106, 0.1110, 0.1111, 0.1109, 0.1111, 0.1114],
        [0.1111, 0.1116, 0.1111, 0.1107, 0.1110, 0.1111, 0.1109, 0.1111, 0.1115],
        [0.1111, 0.1116, 0.1111, 0.1106, 0.1110, 0.1111, 0.1109, 0.1111, 0.1115],
        [0.1110, 0.1115, 0.1112, 0.1106, 0.1110, 0.1111, 0.1109, 0.1111, 0.1115],
        [0.1111, 0.1116, 0.1112, 0.1106, 0.1110, 0.1111, 0.1108, 0.1111, 0.1115],
        [0.1111, 0.1115, 0.1111, 0.1106, 0.1110, 0.1111, 0.1109, 0.1111, 0.1114],
        [0.1111, 0.1115, 0.1111, 0.1107, 0.1110, 0.1112, 0.1109, 0.1111, 0.1114],
        [0.1111, 0.1116, 0.1111, 0.1106, 0.1110, 0.1111, 0.1108, 0.1111, 0.1115],
        [0.1111, 0.1116, 0.1111, 0.1107, 0.1110, 0.1111, 0.1109, 0.1111, 0.1115]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1426, 0.1440, 0.1435, 0.1422, 0.1429, 0.1419, 0.1429],
        [0.1425, 0.1439, 0.1435, 0.1423, 0.1429, 0.1420, 0.1429],
        [0.1425, 0.1438, 0.1436, 0.1422, 0.1429, 0.1420, 0.1429],
        [0.1426, 0.1439, 0.1435, 0.1422, 0.1429, 0.1419, 0.1429],
        [0.1426, 0.1439, 0.1435, 0.1422, 0.1429, 0.1420, 0.1429],
        [0.1425, 0.1439, 0.1436, 0.1422, 0.1429, 0.1420, 0.1429],
        [0.1426, 0.1439, 0.1435, 0.1423, 0.1428, 0.1420, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0765, 0.0769, 0.0768, 0.0770, 0.0767, 0.0771, 0.0769, 0.0769,
         0.0774, 0.0772, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0770, 0.0768, 0.0772, 0.0769, 0.0769,
         0.0773, 0.0771, 0.0766, 0.0769],
        [0.0770, 0.0766, 0.0770, 0.0768, 0.0770, 0.0768, 0.0772, 0.0769, 0.0769,
         0.0773, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0770, 0.0768, 0.0769, 0.0767, 0.0772, 0.0769, 0.0770,
         0.0773, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0769, 0.0767, 0.0772, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0769, 0.0768, 0.0772, 0.0769, 0.0769,
         0.0773, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0770, 0.0767, 0.0772, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0769, 0.0768, 0.0772, 0.0769, 0.0769,
         0.0773, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0765, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0769, 0.0769,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0770, 0.0768, 0.0769, 0.0767, 0.0772, 0.0769, 0.0769,
         0.0773, 0.0772, 0.0767, 0.0769],
        [0.0770, 0.0765, 0.0768, 0.0768, 0.0770, 0.0768, 0.0772, 0.0768, 0.0769,
         0.0773, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0765, 0.0769, 0.0768, 0.0770, 0.0767, 0.0772, 0.0769, 0.0769,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0768, 0.0769, 0.0767, 0.0772, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1430, 0.1420, 0.1418, 0.1429, 0.1423, 0.1446],
        [0.1436, 0.1431, 0.1419, 0.1419, 0.1428, 0.1424, 0.1443],
        [0.1435, 0.1430, 0.1420, 0.1418, 0.1429, 0.1424, 0.1444],
        [0.1435, 0.1431, 0.1420, 0.1419, 0.1429, 0.1424, 0.1442],
        [0.1435, 0.1430, 0.1419, 0.1419, 0.1428, 0.1423, 0.1445],
        [0.1435, 0.1430, 0.1420, 0.1419, 0.1428, 0.1422, 0.1447],
        [0.1436, 0.1430, 0.1418, 0.1415, 0.1429, 0.1420, 0.1452]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.22820782661437988s
iter time cost:11.111664772033691s
-------------Round number: 74-------------
Evaluate global model
[running kmeans]: 10it [00:00, 308.50it/s, center_shift=0.000000, iteration=10, tol=0.000100]
Averaged Train Loss: 0.5509
Averaged Test Accurancy: 0.7790
Std Test Accurancy: 0.1043
evaluate time cost:4.898252725601196s
clients training time cost:5.309107303619385s
[running kmeans]: 5it [00:00, 356.82it/s, center_shift=0.000000, iteration=5, tol=0.000100]
attn_optimize time cost:0.5486128330230713s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1431, 0.1428, 0.1428, 0.1427, 0.1425, 0.1435, 0.1426],
        [0.1430, 0.1427, 0.1429, 0.1426, 0.1425, 0.1435, 0.1428],
        [0.1430, 0.1427, 0.1430, 0.1428, 0.1424, 0.1434, 0.1427],
        [0.1431, 0.1427, 0.1429, 0.1427, 0.1425, 0.1435, 0.1426],
        [0.1430, 0.1427, 0.1429, 0.1427, 0.1425, 0.1434, 0.1428],
        [0.1430, 0.1427, 0.1429, 0.1427, 0.1425, 0.1434, 0.1428],
        [0.1431, 0.1427, 0.1431, 0.1427, 0.1425, 0.1435, 0.1423]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0498, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0498,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0506],
        [0.0500, 0.0502, 0.0499, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0499, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0498, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0499, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0501, 0.0505],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0500, 0.0503, 0.0498, 0.0502, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0499, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0507],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0501, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0499, 0.0503, 0.0498, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0498,
         0.0498, 0.0501, 0.0498, 0.0501, 0.0500, 0.0504, 0.0498, 0.0501, 0.0497,
         0.0500, 0.0509]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1112, 0.1112, 0.1111, 0.1109, 0.1110, 0.1111, 0.1110, 0.1115],
        [0.1112, 0.1112, 0.1112, 0.1111, 0.1108, 0.1110, 0.1111, 0.1110, 0.1115],
        [0.1111, 0.1112, 0.1112, 0.1112, 0.1108, 0.1110, 0.1111, 0.1110, 0.1115],
        [0.1111, 0.1112, 0.1111, 0.1111, 0.1108, 0.1110, 0.1111, 0.1110, 0.1115],
        [0.1111, 0.1112, 0.1111, 0.1111, 0.1108, 0.1110, 0.1111, 0.1110, 0.1115],
        [0.1111, 0.1111, 0.1112, 0.1112, 0.1108, 0.1110, 0.1111, 0.1110, 0.1115],
        [0.1111, 0.1112, 0.1111, 0.1111, 0.1108, 0.1110, 0.1111, 0.1109, 0.1115],
        [0.1111, 0.1112, 0.1111, 0.1112, 0.1108, 0.1110, 0.1111, 0.1111, 0.1115],
        [0.1111, 0.1112, 0.1112, 0.1112, 0.1108, 0.1110, 0.1111, 0.1110, 0.1115]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1252, 0.1248, 0.1250, 0.1246, 0.1252, 0.1252, 0.1252, 0.1248],
        [0.1252, 0.1248, 0.1250, 0.1246, 0.1251, 0.1252, 0.1252, 0.1248],
        [0.1252, 0.1248, 0.1251, 0.1245, 0.1252, 0.1252, 0.1252, 0.1248],
        [0.1252, 0.1248, 0.1250, 0.1244, 0.1252, 0.1253, 0.1253, 0.1248],
        [0.1252, 0.1247, 0.1250, 0.1246, 0.1252, 0.1253, 0.1252, 0.1248],
        [0.1252, 0.1248, 0.1250, 0.1245, 0.1251, 0.1252, 0.1252, 0.1248],
        [0.1252, 0.1248, 0.1251, 0.1246, 0.1252, 0.1252, 0.1252, 0.1249],
        [0.1252, 0.1248, 0.1251, 0.1245, 0.1252, 0.1252, 0.1252, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0833, 0.0833, 0.0834, 0.0830, 0.0831, 0.0834, 0.0833, 0.0832,
         0.0838, 0.0833, 0.0833],
        [0.0835, 0.0833, 0.0833, 0.0834, 0.0831, 0.0831, 0.0834, 0.0833, 0.0832,
         0.0837, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0834, 0.0831, 0.0831, 0.0834, 0.0833, 0.0832,
         0.0837, 0.0833, 0.0833],
        [0.0835, 0.0833, 0.0833, 0.0834, 0.0831, 0.0831, 0.0833, 0.0833, 0.0832,
         0.0837, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0834, 0.0830, 0.0831, 0.0834, 0.0833, 0.0832,
         0.0838, 0.0833, 0.0833],
        [0.0835, 0.0833, 0.0833, 0.0833, 0.0832, 0.0830, 0.0834, 0.0833, 0.0832,
         0.0838, 0.0833, 0.0833],
        [0.0835, 0.0833, 0.0833, 0.0834, 0.0831, 0.0830, 0.0834, 0.0833, 0.0832,
         0.0838, 0.0833, 0.0833],
        [0.0836, 0.0833, 0.0833, 0.0834, 0.0830, 0.0831, 0.0834, 0.0833, 0.0832,
         0.0837, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0834, 0.0831, 0.0831, 0.0834, 0.0833, 0.0832,
         0.0837, 0.0833, 0.0834],
        [0.0835, 0.0833, 0.0833, 0.0834, 0.0831, 0.0831, 0.0834, 0.0833, 0.0832,
         0.0838, 0.0833, 0.0833],
        [0.0835, 0.0833, 0.0833, 0.0834, 0.0831, 0.0831, 0.0834, 0.0833, 0.0833,
         0.0838, 0.0833, 0.0833],
        [0.0835, 0.0833, 0.0833, 0.0834, 0.0831, 0.0831, 0.0834, 0.0833, 0.0832,
         0.0837, 0.0833, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0492],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0493],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0500, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0493, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0502, 0.0505, 0.0502,
         0.0502, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0503, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501, 0.0497, 0.0499, 0.0502,
         0.0498, 0.0492],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0503, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0502, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0497, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0503, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0501, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0490]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4988, 0.5012],
        [0.4988, 0.5012]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27825284004211426s
iter time cost:11.115298986434937s
-------------Round number: 75-------------
Evaluate global model
Averaged Train Loss: 0.5151
Averaged Test Accurancy: 0.7865
Std Test Accurancy: 0.1083
evaluate time cost:5.1361706256866455s
clients training time cost:5.344902515411377s
attn_optimize time cost:0.4824380874633789s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2000, 0.1992, 0.2000, 0.2010, 0.1998],
        [0.2001, 0.1992, 0.2000, 0.2010, 0.1998],
        [0.2000, 0.1993, 0.2000, 0.2009, 0.1998],
        [0.2000, 0.1993, 0.2000, 0.2009, 0.1998],
        [0.2000, 0.1993, 0.1999, 0.2009, 0.1998]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0832, 0.0836, 0.0831, 0.0835, 0.0831, 0.0833, 0.0835, 0.0833,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0832, 0.0835, 0.0832, 0.0834, 0.0831, 0.0833, 0.0835, 0.0833,
         0.0833, 0.0836, 0.0832],
        [0.0834, 0.0832, 0.0836, 0.0831, 0.0835, 0.0831, 0.0833, 0.0835, 0.0833,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0832, 0.0836, 0.0831, 0.0835, 0.0831, 0.0833, 0.0835, 0.0833,
         0.0834, 0.0835, 0.0832],
        [0.0834, 0.0832, 0.0836, 0.0831, 0.0834, 0.0831, 0.0833, 0.0835, 0.0834,
         0.0833, 0.0836, 0.0832],
        [0.0834, 0.0833, 0.0835, 0.0831, 0.0835, 0.0831, 0.0833, 0.0835, 0.0833,
         0.0833, 0.0836, 0.0832],
        [0.0834, 0.0832, 0.0835, 0.0831, 0.0835, 0.0830, 0.0833, 0.0835, 0.0833,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0832, 0.0835, 0.0831, 0.0835, 0.0831, 0.0833, 0.0835, 0.0833,
         0.0833, 0.0836, 0.0832],
        [0.0834, 0.0832, 0.0835, 0.0831, 0.0835, 0.0830, 0.0833, 0.0835, 0.0834,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0832, 0.0835, 0.0831, 0.0834, 0.0831, 0.0833, 0.0835, 0.0834,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0832, 0.0835, 0.0831, 0.0835, 0.0831, 0.0833, 0.0835, 0.0833,
         0.0833, 0.0835, 0.0832],
        [0.0834, 0.0832, 0.0836, 0.0832, 0.0835, 0.0831, 0.0833, 0.0834, 0.0833,
         0.0834, 0.0835, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0503, 0.0502, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501, 0.0497, 0.0499, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0501, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0502, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0502, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0498, 0.0498,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0499,
         0.0501, 0.0497, 0.0500, 0.0505, 0.0502, 0.0501, 0.0495, 0.0500, 0.0503,
         0.0498, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0766, 0.0768, 0.0768, 0.0769, 0.0766, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0770],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0767, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0769, 0.0766, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0769, 0.0766, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0769, 0.0767, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0768, 0.0767, 0.0769, 0.0766, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0770],
        [0.0769, 0.0767, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0770],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0769, 0.0766, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0767, 0.0769, 0.0767, 0.0769, 0.0766, 0.0771, 0.0768, 0.0770,
         0.0773, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0768, 0.0768, 0.0769, 0.0767, 0.0771, 0.0767, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0770],
        [0.0770, 0.0766, 0.0768, 0.0767, 0.0769, 0.0766, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0770],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0769, 0.0767, 0.0771, 0.0768, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1114, 0.1111, 0.1112, 0.1113, 0.1109, 0.1110, 0.1111, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1112, 0.1109, 0.1111, 0.1111, 0.1108, 0.1113],
        [0.1114, 0.1111, 0.1112, 0.1113, 0.1109, 0.1111, 0.1111, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1112, 0.1109, 0.1111, 0.1110, 0.1108, 0.1113],
        [0.1115, 0.1110, 0.1112, 0.1112, 0.1109, 0.1111, 0.1111, 0.1108, 0.1112],
        [0.1115, 0.1110, 0.1112, 0.1112, 0.1109, 0.1111, 0.1111, 0.1108, 0.1113],
        [0.1114, 0.1111, 0.1112, 0.1112, 0.1109, 0.1111, 0.1111, 0.1108, 0.1113],
        [0.1114, 0.1110, 0.1112, 0.1113, 0.1109, 0.1111, 0.1111, 0.1108, 0.1113],
        [0.1114, 0.1111, 0.1112, 0.1112, 0.1109, 0.1111, 0.1111, 0.1108, 0.1113]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0529,
         0.0525],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0526, 0.0524, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0529, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0526, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0526, 0.0530, 0.0521, 0.0526, 0.0526, 0.0524, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0529,
         0.0526],
        [0.0526, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0529,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0529,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0526],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0530, 0.0521, 0.0524, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0528, 0.0529,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0528, 0.0528,
         0.0525],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0529,
         0.0526],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0529, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0529,
         0.0526],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0529, 0.0529,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1429, 0.1424, 0.1419, 0.1428, 0.1423, 0.1444],
        [0.1434, 0.1431, 0.1423, 0.1420, 0.1427, 0.1423, 0.1442],
        [0.1433, 0.1429, 0.1424, 0.1419, 0.1428, 0.1423, 0.1443],
        [0.1433, 0.1431, 0.1423, 0.1420, 0.1428, 0.1423, 0.1442],
        [0.1433, 0.1430, 0.1422, 0.1420, 0.1427, 0.1423, 0.1445],
        [0.1433, 0.1429, 0.1423, 0.1420, 0.1427, 0.1422, 0.1446],
        [0.1434, 0.1429, 0.1421, 0.1417, 0.1427, 0.1420, 0.1451]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 5it [00:00, 384.27it/s, center_shift=0.000000, iteration=5, tol=0.000100]
weights:tensor([[0.1671, 0.1664, 0.1664, 0.1663, 0.1674, 0.1663],
        [0.1669, 0.1667, 0.1666, 0.1662, 0.1674, 0.1663],
        [0.1671, 0.1666, 0.1665, 0.1662, 0.1674, 0.1662],
        [0.1670, 0.1665, 0.1665, 0.1662, 0.1673, 0.1665],
        [0.1670, 0.1666, 0.1664, 0.1662, 0.1673, 0.1665],
        [0.1672, 0.1667, 0.1664, 0.1663, 0.1675, 0.1659]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1253, 0.1250, 0.1248, 0.1253, 0.1256, 0.1246, 0.1244],
        [0.1249, 0.1254, 0.1249, 0.1248, 0.1254, 0.1256, 0.1246, 0.1243],
        [0.1250, 0.1253, 0.1248, 0.1249, 0.1254, 0.1256, 0.1246, 0.1244],
        [0.1249, 0.1252, 0.1250, 0.1248, 0.1254, 0.1255, 0.1246, 0.1245],
        [0.1250, 0.1253, 0.1249, 0.1248, 0.1254, 0.1255, 0.1247, 0.1245],
        [0.1249, 0.1253, 0.1248, 0.1248, 0.1254, 0.1256, 0.1247, 0.1244],
        [0.1250, 0.1253, 0.1249, 0.1248, 0.1253, 0.1255, 0.1247, 0.1246],
        [0.1249, 0.1254, 0.1247, 0.1247, 0.1255, 0.1258, 0.1243, 0.1247]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3378763198852539s
iter time cost:11.376456260681152s
-------------Round number: 76-------------
Evaluate global model
Averaged Train Loss: 0.8162
Averaged Test Accurancy: 0.7553
Std Test Accurancy: 0.1314
evaluate time cost:4.866591930389404s
clients training time cost:5.003310441970825s
[running kmeans]: 4it [00:00, 333.03it/s, center_shift=0.000000, iteration=4, tol=0.000100]
attn_optimize time cost:0.48766350746154785s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0499,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0497, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0499,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0499,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0502, 0.0502, 0.0499,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0499,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0502, 0.0502, 0.0499,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0499,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0497, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0499,
         0.0500, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0502, 0.0502, 0.0499,
         0.0499, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0497, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0502, 0.0499, 0.0500, 0.0502, 0.0502, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0499,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0499,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0499, 0.0502, 0.0501, 0.0499,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0497, 0.0501, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0502, 0.0502, 0.0499,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0499,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0499, 0.0499, 0.0502, 0.0502, 0.0499,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0497, 0.0500, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0502, 0.0502, 0.0499,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0497, 0.0501, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0499,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0498, 0.0501, 0.0500, 0.0496, 0.0500, 0.0500,
         0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0501, 0.0501, 0.0503, 0.0500,
         0.0498, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1434, 0.1431, 0.1420, 0.1415, 0.1429, 0.1423, 0.1448],
        [0.1435, 0.1432, 0.1419, 0.1416, 0.1429, 0.1423, 0.1445],
        [0.1435, 0.1431, 0.1420, 0.1416, 0.1429, 0.1423, 0.1446],
        [0.1435, 0.1432, 0.1420, 0.1417, 0.1429, 0.1423, 0.1445],
        [0.1435, 0.1431, 0.1419, 0.1416, 0.1428, 0.1422, 0.1448],
        [0.1434, 0.1431, 0.1419, 0.1417, 0.1428, 0.1421, 0.1449],
        [0.1436, 0.1431, 0.1418, 0.1413, 0.1429, 0.1419, 0.1455]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0765, 0.0770, 0.0767, 0.0769, 0.0765, 0.0772, 0.0770, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0770, 0.0767, 0.0769, 0.0766, 0.0772, 0.0770, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0766, 0.0770, 0.0767, 0.0769, 0.0766, 0.0772, 0.0769, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0770, 0.0767, 0.0769, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0770, 0.0767, 0.0769, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0770, 0.0767, 0.0769, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0774, 0.0770, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0769, 0.0765, 0.0772, 0.0769, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0766, 0.0770, 0.0767, 0.0768, 0.0766, 0.0772, 0.0769, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0765, 0.0770, 0.0767, 0.0769, 0.0765, 0.0772, 0.0769, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0771, 0.0767, 0.0769, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0765, 0.0770, 0.0767, 0.0769, 0.0765, 0.0772, 0.0770, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0770, 0.0767, 0.0769, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0775, 0.0770, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0838, 0.0831, 0.0833, 0.0830, 0.0833, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0836],
        [0.0835, 0.0838, 0.0830, 0.0833, 0.0830, 0.0833, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0837],
        [0.0834, 0.0838, 0.0830, 0.0833, 0.0830, 0.0833, 0.0834, 0.0833, 0.0831,
         0.0832, 0.0834, 0.0836],
        [0.0834, 0.0838, 0.0831, 0.0833, 0.0830, 0.0833, 0.0833, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0836],
        [0.0834, 0.0838, 0.0830, 0.0833, 0.0830, 0.0833, 0.0833, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0836],
        [0.0835, 0.0838, 0.0830, 0.0833, 0.0830, 0.0833, 0.0833, 0.0833, 0.0833,
         0.0831, 0.0834, 0.0837],
        [0.0835, 0.0838, 0.0831, 0.0833, 0.0830, 0.0833, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0836],
        [0.0835, 0.0838, 0.0830, 0.0833, 0.0829, 0.0833, 0.0834, 0.0834, 0.0832,
         0.0832, 0.0834, 0.0837],
        [0.0835, 0.0838, 0.0830, 0.0833, 0.0830, 0.0833, 0.0834, 0.0833, 0.0831,
         0.0832, 0.0834, 0.0836],
        [0.0834, 0.0838, 0.0831, 0.0833, 0.0830, 0.0833, 0.0834, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0836],
        [0.0835, 0.0838, 0.0830, 0.0833, 0.0829, 0.0833, 0.0833, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0837],
        [0.0835, 0.0838, 0.0831, 0.0833, 0.0830, 0.0833, 0.0833, 0.0834, 0.0832,
         0.0832, 0.0834, 0.0836]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1241, 0.1253, 0.1250, 0.1253, 0.1254, 0.1260, 0.1254, 0.1234],
        [0.1241, 0.1254, 0.1250, 0.1251, 0.1254, 0.1259, 0.1253, 0.1239],
        [0.1241, 0.1253, 0.1250, 0.1253, 0.1254, 0.1259, 0.1254, 0.1236],
        [0.1241, 0.1253, 0.1250, 0.1252, 0.1254, 0.1259, 0.1253, 0.1239],
        [0.1240, 0.1254, 0.1250, 0.1253, 0.1253, 0.1259, 0.1252, 0.1239],
        [0.1240, 0.1254, 0.1250, 0.1252, 0.1254, 0.1259, 0.1253, 0.1239],
        [0.1240, 0.1253, 0.1249, 0.1253, 0.1253, 0.1259, 0.1253, 0.1239],
        [0.1237, 0.1254, 0.1248, 0.1250, 0.1253, 0.1263, 0.1259, 0.1236]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1253, 0.1249, 0.1245, 0.1248, 0.1248, 0.1254, 0.1247, 0.1256],
        [0.1253, 0.1249, 0.1244, 0.1248, 0.1248, 0.1254, 0.1247, 0.1257],
        [0.1253, 0.1250, 0.1244, 0.1248, 0.1248, 0.1254, 0.1247, 0.1256],
        [0.1253, 0.1249, 0.1244, 0.1248, 0.1248, 0.1254, 0.1247, 0.1256],
        [0.1253, 0.1249, 0.1245, 0.1248, 0.1248, 0.1253, 0.1247, 0.1257],
        [0.1253, 0.1249, 0.1245, 0.1248, 0.1248, 0.1253, 0.1247, 0.1256],
        [0.1253, 0.1249, 0.1245, 0.1247, 0.1248, 0.1253, 0.1248, 0.1257],
        [0.1253, 0.1249, 0.1245, 0.1248, 0.1248, 0.1253, 0.1247, 0.1256]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1115, 0.1111, 0.1112, 0.1113, 0.1109, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1112, 0.1109, 0.1112, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1109, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1113, 0.1109, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1112, 0.1109, 0.1112, 0.1110, 0.1107, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1108, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1109, 0.1112, 0.1110, 0.1107, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1108, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1114, 0.1111, 0.1112, 0.1113, 0.1109, 0.1111, 0.1110, 0.1108, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5002, 0.4998],
        [0.5002, 0.4998]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0497, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0497, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0500, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0499, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0500, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0500, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0500, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0499, 0.0503, 0.0502, 0.0504, 0.0504, 0.0503, 0.0503, 0.0496, 0.0498,
         0.0500, 0.0496, 0.0500, 0.0505, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3458876609802246s
iter time cost:10.844581127166748s
-------------Round number: 77-------------
Evaluate global model
Averaged Train Loss: 0.4729
Averaged Test Accurancy: 0.7857
Std Test Accurancy: 0.1173
evaluate time cost:5.271307706832886s
clients training time cost:5.031358242034912s
attn_optimize time cost:0.4504084587097168s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1112, 0.1112, 0.1116, 0.1112, 0.1112, 0.1114, 0.1105, 0.1113, 0.1104],
        [0.1112, 0.1112, 0.1116, 0.1112, 0.1112, 0.1114, 0.1105, 0.1112, 0.1104],
        [0.1113, 0.1112, 0.1116, 0.1112, 0.1113, 0.1114, 0.1106, 0.1112, 0.1104],
        [0.1112, 0.1112, 0.1116, 0.1113, 0.1112, 0.1114, 0.1105, 0.1112, 0.1104],
        [0.1113, 0.1112, 0.1116, 0.1112, 0.1112, 0.1115, 0.1105, 0.1111, 0.1103],
        [0.1112, 0.1112, 0.1116, 0.1112, 0.1112, 0.1114, 0.1105, 0.1112, 0.1104],
        [0.1112, 0.1112, 0.1116, 0.1112, 0.1112, 0.1115, 0.1105, 0.1112, 0.1103],
        [0.1113, 0.1112, 0.1116, 0.1112, 0.1112, 0.1114, 0.1105, 0.1112, 0.1104],
        [0.1112, 0.1112, 0.1116, 0.1113, 0.1112, 0.1114, 0.1105, 0.1112, 0.1104]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2512, 0.2506, 0.2518, 0.2464],
        [0.2511, 0.2504, 0.2515, 0.2470],
        [0.2509, 0.2504, 0.2516, 0.2471],
        [0.2513, 0.2508, 0.2515, 0.2464]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0908, 0.0909, 0.0909, 0.0911, 0.0906, 0.0907, 0.0910, 0.0910,
         0.0912, 0.0909],
        [0.0910, 0.0908, 0.0909, 0.0910, 0.0911, 0.0905, 0.0907, 0.0910, 0.0910,
         0.0912, 0.0908],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0911, 0.0906, 0.0907, 0.0910, 0.0910,
         0.0912, 0.0908],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0912, 0.0905, 0.0906, 0.0910, 0.0910,
         0.0912, 0.0908],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0911, 0.0905, 0.0907, 0.0910, 0.0911,
         0.0913, 0.0908],
        [0.0909, 0.0909, 0.0908, 0.0909, 0.0911, 0.0906, 0.0907, 0.0911, 0.0910,
         0.0912, 0.0909],
        [0.0909, 0.0908, 0.0909, 0.0910, 0.0912, 0.0905, 0.0907, 0.0910, 0.0910,
         0.0912, 0.0909],
        [0.0909, 0.0908, 0.0908, 0.0909, 0.0911, 0.0906, 0.0907, 0.0911, 0.0910,
         0.0913, 0.0908],
        [0.0909, 0.0909, 0.0908, 0.0909, 0.0912, 0.0905, 0.0907, 0.0910, 0.0911,
         0.0912, 0.0908],
        [0.0909, 0.0908, 0.0909, 0.0909, 0.0911, 0.0906, 0.0907, 0.0910, 0.0910,
         0.0912, 0.0908],
        [0.0910, 0.0908, 0.0908, 0.0910, 0.0911, 0.0905, 0.0907, 0.0910, 0.0910,
         0.0912, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0526, 0.0526, 0.0527, 0.0529, 0.0527, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0528, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0528, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0528, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0526, 0.0529, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0526, 0.0529, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0524,
         0.0525, 0.0524, 0.0526, 0.0525, 0.0526, 0.0529, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0526, 0.0525, 0.0526, 0.0529, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0529, 0.0527, 0.0526, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0526, 0.0529, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0527, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0525, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0526, 0.0528, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0528, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526, 0.0527, 0.0524,
         0.0525, 0.0524, 0.0526, 0.0526, 0.0526, 0.0529, 0.0526, 0.0525, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0528, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0526, 0.0529, 0.0525, 0.0525, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0526, 0.0526, 0.0526, 0.0528, 0.0525, 0.0525, 0.0530,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1422, 0.1433, 0.1423, 0.1436, 0.1434, 0.1417],
        [0.1434, 0.1422, 0.1433, 0.1424, 0.1435, 0.1434, 0.1418],
        [0.1434, 0.1423, 0.1434, 0.1424, 0.1435, 0.1433, 0.1418],
        [0.1435, 0.1422, 0.1433, 0.1424, 0.1436, 0.1434, 0.1418],
        [0.1435, 0.1422, 0.1433, 0.1424, 0.1435, 0.1433, 0.1418],
        [0.1435, 0.1422, 0.1433, 0.1423, 0.1436, 0.1434, 0.1418],
        [0.1436, 0.1422, 0.1432, 0.1423, 0.1436, 0.1434, 0.1417]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1112, 0.1112, 0.1109, 0.1111, 0.1115, 0.1114, 0.1114, 0.1110, 0.1102],
        [0.1111, 0.1113, 0.1109, 0.1112, 0.1115, 0.1113, 0.1114, 0.1111, 0.1102],
        [0.1112, 0.1112, 0.1108, 0.1112, 0.1116, 0.1113, 0.1114, 0.1110, 0.1102],
        [0.1111, 0.1112, 0.1110, 0.1112, 0.1116, 0.1112, 0.1113, 0.1111, 0.1103],
        [0.1112, 0.1113, 0.1109, 0.1112, 0.1116, 0.1113, 0.1113, 0.1111, 0.1102],
        [0.1111, 0.1113, 0.1108, 0.1111, 0.1115, 0.1113, 0.1114, 0.1111, 0.1102],
        [0.1111, 0.1113, 0.1108, 0.1112, 0.1116, 0.1113, 0.1114, 0.1111, 0.1103],
        [0.1111, 0.1113, 0.1109, 0.1111, 0.1115, 0.1114, 0.1113, 0.1111, 0.1103],
        [0.1111, 0.1112, 0.1106, 0.1110, 0.1117, 0.1116, 0.1115, 0.1108, 0.1104]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0765, 0.0769, 0.0767, 0.0770, 0.0767, 0.0770, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0770],
        [0.0769, 0.0766, 0.0769, 0.0767, 0.0770, 0.0768, 0.0770, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0766, 0.0770, 0.0767, 0.0770, 0.0768, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0766, 0.0770, 0.0767, 0.0769, 0.0767, 0.0771, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0767, 0.0771, 0.0768, 0.0770,
         0.0775, 0.0770, 0.0767, 0.0770],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0768, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0770, 0.0767, 0.0771, 0.0768, 0.0771,
         0.0775, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0769, 0.0768, 0.0770, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0769, 0.0767, 0.0770, 0.0768, 0.0770,
         0.0775, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0766, 0.0770, 0.0767, 0.0769, 0.0767, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0765, 0.0768, 0.0767, 0.0770, 0.0768, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0771],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0770, 0.0767, 0.0770, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0770, 0.0767, 0.0771, 0.0768, 0.0770,
         0.0775, 0.0770, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1429, 0.1420, 0.1417, 0.1430, 0.1421, 0.1447],
        [0.1436, 0.1431, 0.1420, 0.1418, 0.1430, 0.1422, 0.1444],
        [0.1436, 0.1429, 0.1421, 0.1417, 0.1431, 0.1421, 0.1445],
        [0.1435, 0.1430, 0.1420, 0.1418, 0.1430, 0.1422, 0.1444],
        [0.1436, 0.1429, 0.1419, 0.1418, 0.1430, 0.1421, 0.1447],
        [0.1435, 0.1429, 0.1420, 0.1418, 0.1429, 0.1420, 0.1448],
        [0.1437, 0.1429, 0.1418, 0.1415, 0.1430, 0.1418, 0.1454]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0502, 0.0503,
         0.0499, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0493],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0493],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0496],
        [0.0500, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0497],
        [0.0501, 0.0503, 0.0496, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0502, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0500, 0.0504, 0.0494, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0502,
         0.0502, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2878291606903076s
iter time cost:11.149003744125366s
-------------Round number: 78-------------
Evaluate global model
[running kmeans]: 6it [00:00, 399.65it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 0.4251
Averaged Test Accurancy: 0.7992
Std Test Accurancy: 0.0996
evaluate time cost:4.841869354248047s
clients training time cost:5.03632116317749s
[running kmeans]: 7it [00:00, 268.99it/s, center_shift=0.000000, iteration=7, tol=0.000100]
attn_optimize time cost:0.43415355682373047s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0499, 0.0503, 0.0497, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0499, 0.0502, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0499, 0.0503, 0.0497, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0498, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0506],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0499, 0.0502, 0.0497, 0.0502, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0501, 0.0506],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0502, 0.0500,
         0.0500, 0.0503],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0499, 0.0502, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0501, 0.0504],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0500, 0.0504, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0503],
        [0.0498, 0.0504, 0.0497, 0.0502, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0497, 0.0500, 0.0498, 0.0502, 0.0500, 0.0504, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0510]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2511, 0.2507, 0.2517, 0.2464],
        [0.2510, 0.2504, 0.2514, 0.2472],
        [0.2508, 0.2505, 0.2515, 0.2471],
        [0.2511, 0.2511, 0.2514, 0.2464]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0498, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0502, 0.0500, 0.0502,
         0.0499, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0498, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0502,
         0.0499, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0498, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0502, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0502,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0498, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0502,
         0.0499, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0499, 0.0499, 0.0502, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0498, 0.0501, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0502, 0.0500, 0.0501, 0.0497, 0.0502, 0.0499, 0.0498, 0.0499, 0.0500,
         0.0502, 0.0497, 0.0499, 0.0503, 0.0499, 0.0501, 0.0501, 0.0501, 0.0503,
         0.0498, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4992, 0.5008],
        [0.4993, 0.5007]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1239, 0.1251, 0.1247, 0.1251, 0.1251, 0.1249, 0.1258, 0.1252],
        [0.1240, 0.1252, 0.1248, 0.1250, 0.1251, 0.1249, 0.1258, 0.1252],
        [0.1240, 0.1251, 0.1247, 0.1251, 0.1251, 0.1250, 0.1257, 0.1253],
        [0.1241, 0.1252, 0.1247, 0.1251, 0.1251, 0.1249, 0.1257, 0.1252],
        [0.1239, 0.1252, 0.1248, 0.1251, 0.1251, 0.1250, 0.1257, 0.1250],
        [0.1240, 0.1252, 0.1247, 0.1252, 0.1251, 0.1249, 0.1257, 0.1251],
        [0.1239, 0.1252, 0.1248, 0.1251, 0.1251, 0.1249, 0.1258, 0.1252],
        [0.1240, 0.1252, 0.1247, 0.1251, 0.1251, 0.1249, 0.1258, 0.1252]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3327, 0.3340, 0.3333],
        [0.3326, 0.3341, 0.3333],
        [0.3327, 0.3340, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1672, 0.1666, 0.1663, 0.1664, 0.1670],
        [0.1665, 0.1672, 0.1667, 0.1662, 0.1663, 0.1670],
        [0.1665, 0.1672, 0.1666, 0.1663, 0.1664, 0.1671],
        [0.1665, 0.1672, 0.1667, 0.1662, 0.1664, 0.1671],
        [0.1665, 0.1672, 0.1666, 0.1663, 0.1664, 0.1670],
        [0.1666, 0.1672, 0.1666, 0.1663, 0.1663, 0.1670]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0620, 0.0626, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0620, 0.0623, 0.0627, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0622, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0629, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0627, 0.0626, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0626, 0.0626, 0.0621, 0.0626, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0626, 0.0626, 0.0620, 0.0626, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0627, 0.0626, 0.0628, 0.0627, 0.0627, 0.0626, 0.0621, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0504, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0497, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0498, 0.0501, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0498, 0.0499, 0.0505, 0.0500, 0.0498, 0.0503,
         0.0499, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.5250546932220459s
iter time cost:10.995542764663696s
-------------Round number: 79-------------
Evaluate global model
Averaged Train Loss: 0.4908
Averaged Test Accurancy: 0.7826
Std Test Accurancy: 0.1057
evaluate time cost:5.2010533809661865s
clients training time cost:4.919114828109741s
attn_optimize time cost:0.4302947521209717s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0770, 0.0769, 0.0771, 0.0768, 0.0771, 0.0767, 0.0769, 0.0770, 0.0769,
         0.0767, 0.0772, 0.0770, 0.0767],
        [0.0771, 0.0769, 0.0771, 0.0769, 0.0771, 0.0767, 0.0769, 0.0770, 0.0769,
         0.0767, 0.0773, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0771, 0.0768, 0.0771, 0.0767, 0.0769, 0.0770, 0.0768,
         0.0767, 0.0773, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0771, 0.0768, 0.0771, 0.0767, 0.0769, 0.0770, 0.0768,
         0.0767, 0.0773, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0771, 0.0768, 0.0770, 0.0767, 0.0770, 0.0770, 0.0769,
         0.0767, 0.0773, 0.0769, 0.0767],
        [0.0770, 0.0769, 0.0771, 0.0768, 0.0771, 0.0767, 0.0769, 0.0770, 0.0768,
         0.0767, 0.0773, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0771, 0.0766, 0.0769, 0.0770, 0.0769,
         0.0767, 0.0773, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0771, 0.0767, 0.0770, 0.0770, 0.0768,
         0.0767, 0.0773, 0.0770, 0.0767],
        [0.0771, 0.0769, 0.0771, 0.0768, 0.0771, 0.0767, 0.0770, 0.0770, 0.0768,
         0.0767, 0.0773, 0.0770, 0.0766],
        [0.0770, 0.0769, 0.0771, 0.0768, 0.0771, 0.0766, 0.0770, 0.0770, 0.0769,
         0.0767, 0.0772, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0771, 0.0768, 0.0771, 0.0767, 0.0769, 0.0770, 0.0768,
         0.0767, 0.0773, 0.0770, 0.0767],
        [0.0771, 0.0769, 0.0771, 0.0769, 0.0771, 0.0767, 0.0769, 0.0770, 0.0769,
         0.0767, 0.0773, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0771, 0.0768, 0.0771, 0.0767, 0.0769, 0.0770, 0.0768,
         0.0767, 0.0773, 0.0770, 0.0766]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1665, 0.1661, 0.1665, 0.1669, 0.1668, 0.1672],
        [0.1665, 0.1659, 0.1665, 0.1671, 0.1667, 0.1673],
        [0.1664, 0.1661, 0.1666, 0.1671, 0.1666, 0.1671],
        [0.1666, 0.1660, 0.1665, 0.1671, 0.1667, 0.1671],
        [0.1665, 0.1660, 0.1665, 0.1670, 0.1667, 0.1673],
        [0.1665, 0.1659, 0.1666, 0.1671, 0.1666, 0.1673]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0503, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0488],
        [0.0497, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0502, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501, 0.0497, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0502, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0501, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0498, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0503, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0501, 0.0495, 0.0500, 0.0502,
         0.0498, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0501, 0.0503, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0498, 0.0500, 0.0504, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3314, 0.3336, 0.3350],
        [0.3315, 0.3335, 0.3350],
        [0.3315, 0.3337, 0.3349]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0766, 0.0773, 0.0768, 0.0769,
         0.0774, 0.0772, 0.0769, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0767, 0.0769, 0.0767, 0.0773, 0.0769, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0767, 0.0770, 0.0767, 0.0773, 0.0768, 0.0769,
         0.0773, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0770, 0.0767, 0.0769, 0.0766, 0.0773, 0.0769, 0.0769,
         0.0774, 0.0771, 0.0769, 0.0768],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0766, 0.0773, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0767, 0.0773, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0765, 0.0768, 0.0766, 0.0769, 0.0766, 0.0773, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0767, 0.0769, 0.0767, 0.0773, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0766, 0.0770, 0.0767, 0.0769, 0.0766, 0.0773, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0766, 0.0770, 0.0767, 0.0769, 0.0766, 0.0773, 0.0768, 0.0769,
         0.0773, 0.0772, 0.0769, 0.0769],
        [0.0769, 0.0765, 0.0768, 0.0767, 0.0769, 0.0767, 0.0773, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0766, 0.0773, 0.0769, 0.0769,
         0.0774, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0769, 0.0767, 0.0773, 0.0768, 0.0769,
         0.0775, 0.0771, 0.0769, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0625, 0.0628, 0.0624, 0.0624, 0.0625, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0623, 0.0625, 0.0626, 0.0627, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0625, 0.0623, 0.0624, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0623, 0.0624, 0.0626, 0.0627, 0.0628],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0625, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0623, 0.0625, 0.0626, 0.0628, 0.0628],
        [0.0625, 0.0629, 0.0624, 0.0624, 0.0625, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0623, 0.0624, 0.0626, 0.0628, 0.0627],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0625, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0623, 0.0624, 0.0626, 0.0627, 0.0628],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0625, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0623, 0.0625, 0.0626, 0.0627, 0.0628],
        [0.0625, 0.0628, 0.0623, 0.0625, 0.0625, 0.0622, 0.0624, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0623, 0.0624, 0.0626, 0.0627, 0.0628],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0625, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0623, 0.0623, 0.0625, 0.0626, 0.0627, 0.0627],
        [0.0625, 0.0629, 0.0624, 0.0624, 0.0625, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0622, 0.0625, 0.0626, 0.0628, 0.0627],
        [0.0625, 0.0629, 0.0623, 0.0624, 0.0625, 0.0623, 0.0624, 0.0625, 0.0625,
         0.0625, 0.0623, 0.0622, 0.0625, 0.0626, 0.0628, 0.0628],
        [0.0625, 0.0629, 0.0623, 0.0624, 0.0625, 0.0623, 0.0624, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0623, 0.0624, 0.0625, 0.0627, 0.0628],
        [0.0625, 0.0629, 0.0623, 0.0624, 0.0625, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0622, 0.0625, 0.0626, 0.0627, 0.0628],
        [0.0625, 0.0628, 0.0623, 0.0624, 0.0625, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0623, 0.0623, 0.0625, 0.0626, 0.0627, 0.0627],
        [0.0625, 0.0629, 0.0623, 0.0624, 0.0625, 0.0622, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0623, 0.0624, 0.0626, 0.0627, 0.0628],
        [0.0625, 0.0629, 0.0624, 0.0624, 0.0625, 0.0623, 0.0624, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0622, 0.0625, 0.0625, 0.0628, 0.0628],
        [0.0625, 0.0628, 0.0624, 0.0624, 0.0625, 0.0623, 0.0625, 0.0625, 0.0625,
         0.0625, 0.0624, 0.0623, 0.0624, 0.0626, 0.0627, 0.0628]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1432, 0.1421, 0.1417, 0.1427, 0.1421, 0.1447],
        [0.1436, 0.1433, 0.1421, 0.1417, 0.1427, 0.1422, 0.1445],
        [0.1435, 0.1431, 0.1422, 0.1417, 0.1427, 0.1422, 0.1445],
        [0.1435, 0.1433, 0.1421, 0.1418, 0.1427, 0.1422, 0.1444],
        [0.1435, 0.1432, 0.1420, 0.1417, 0.1426, 0.1421, 0.1448],
        [0.1435, 0.1431, 0.1421, 0.1418, 0.1426, 0.1421, 0.1449],
        [0.1436, 0.1432, 0.1419, 0.1414, 0.1427, 0.1418, 0.1454]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.4145369529724121s
iter time cost:11.045072078704834s
-------------Round number: 80-------------
Evaluate global model
[running kmeans]: 5it [00:00, 384.27it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 0.4962
Averaged Test Accurancy: 0.7809
Std Test Accurancy: 0.0907
evaluate time cost:5.056851863861084s
[running kmeans]: 7it [00:00, 304.07it/s, center_shift=0.000000, iteration=7, tol=0.000100]
clients training time cost:5.183095932006836s
attn_optimize time cost:0.5280578136444092s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0770, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0772, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0769, 0.0767, 0.0772, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0770, 0.0767, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0768],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0772, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0768],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0772, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0768],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0769, 0.0767, 0.0773, 0.0768, 0.0771,
         0.0774, 0.0770, 0.0768, 0.0768],
        [0.0770, 0.0764, 0.0768, 0.0766, 0.0769, 0.0766, 0.0772, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0769, 0.0767, 0.0772, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0771, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0772, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0766, 0.0769, 0.0766, 0.0772, 0.0768, 0.0771,
         0.0774, 0.0772, 0.0768, 0.0768],
        [0.0770, 0.0764, 0.0768, 0.0767, 0.0769, 0.0767, 0.0772, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0768, 0.0766, 0.0769, 0.0766, 0.0772, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0769, 0.0769],
        [0.0770, 0.0764, 0.0769, 0.0767, 0.0769, 0.0767, 0.0772, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0525, 0.0526, 0.0526, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0525, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0525,
         0.0525, 0.0524, 0.0526, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0526, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0530, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0529, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0525, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0526, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0525, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1258, 0.1246, 0.1245, 0.1250, 0.1251, 0.1248, 0.1251],
        [0.1251, 0.1258, 0.1246, 0.1245, 0.1250, 0.1252, 0.1248, 0.1251],
        [0.1251, 0.1258, 0.1246, 0.1245, 0.1250, 0.1251, 0.1248, 0.1251],
        [0.1250, 0.1258, 0.1246, 0.1245, 0.1250, 0.1251, 0.1248, 0.1252],
        [0.1251, 0.1258, 0.1246, 0.1245, 0.1250, 0.1251, 0.1248, 0.1252],
        [0.1251, 0.1257, 0.1246, 0.1245, 0.1250, 0.1251, 0.1248, 0.1251],
        [0.1251, 0.1257, 0.1246, 0.1246, 0.1250, 0.1252, 0.1248, 0.1251],
        [0.1251, 0.1258, 0.1246, 0.1245, 0.1250, 0.1251, 0.1248, 0.1251]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0503, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0502, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0503, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0499, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0499, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0503, 0.0495, 0.0499,
         0.0501, 0.0496, 0.0499, 0.0505, 0.0503, 0.0501, 0.0494, 0.0500, 0.0502,
         0.0498, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1249, 0.1248, 0.1250, 0.1249, 0.1246, 0.1255, 0.1254],
        [0.1249, 0.1250, 0.1248, 0.1249, 0.1248, 0.1248, 0.1254, 0.1254],
        [0.1249, 0.1250, 0.1248, 0.1250, 0.1249, 0.1246, 0.1255, 0.1253],
        [0.1249, 0.1250, 0.1249, 0.1249, 0.1248, 0.1246, 0.1255, 0.1254],
        [0.1249, 0.1250, 0.1248, 0.1248, 0.1249, 0.1247, 0.1254, 0.1255],
        [0.1249, 0.1251, 0.1249, 0.1248, 0.1248, 0.1246, 0.1254, 0.1254],
        [0.1249, 0.1250, 0.1248, 0.1249, 0.1249, 0.1245, 0.1255, 0.1254],
        [0.1249, 0.1250, 0.1248, 0.1249, 0.1249, 0.1247, 0.1254, 0.1254]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0499, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0499, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0501, 0.0500, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0499, 0.0501,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0501, 0.0499, 0.0498, 0.0499, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0499, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0498, 0.0496],
        [0.0502, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0499, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0499, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0499, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0499, 0.0501,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0499, 0.0502,
         0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0499, 0.0502, 0.0499, 0.0502, 0.0499, 0.0497, 0.0499, 0.0502,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0501, 0.0502, 0.0501, 0.0501,
         0.0497, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1430, 0.1421, 0.1417, 0.1430, 0.1421, 0.1447],
        [0.1436, 0.1431, 0.1421, 0.1418, 0.1430, 0.1421, 0.1444],
        [0.1435, 0.1430, 0.1422, 0.1417, 0.1430, 0.1421, 0.1445],
        [0.1435, 0.1431, 0.1421, 0.1418, 0.1430, 0.1421, 0.1444],
        [0.1435, 0.1430, 0.1420, 0.1418, 0.1429, 0.1421, 0.1447],
        [0.1435, 0.1429, 0.1421, 0.1418, 0.1429, 0.1420, 0.1448],
        [0.1437, 0.1429, 0.1419, 0.1414, 0.1430, 0.1417, 0.1453]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3312, 0.3339, 0.3349],
        [0.3312, 0.3339, 0.3349],
        [0.3313, 0.3340, 0.3347]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.48374152183532715s
iter time cost:11.341829776763916s
-------------Round number: 81-------------
Evaluate global model
Averaged Train Loss: 0.5898
Averaged Test Accurancy: 0.7798
Std Test Accurancy: 0.1089
evaluate time cost:5.457269191741943s
clients training time cost:5.05597996711731s
attn_optimize time cost:0.536125898361206s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
[running kmeans]: 6it [00:00, 315.48it/s, center_shift=0.000000, iteration=6, tol=0.000100]
weights:tensor([[0.1430, 0.1436, 0.1432, 0.1416, 0.1434, 0.1430, 0.1422],
        [0.1430, 0.1436, 0.1433, 0.1415, 0.1434, 0.1430, 0.1421],
        [0.1430, 0.1436, 0.1433, 0.1416, 0.1435, 0.1430, 0.1421],
        [0.1430, 0.1436, 0.1433, 0.1416, 0.1435, 0.1430, 0.1421],
        [0.1430, 0.1436, 0.1432, 0.1415, 0.1434, 0.1430, 0.1422],
        [0.1430, 0.1435, 0.1433, 0.1416, 0.1434, 0.1431, 0.1421],
        [0.1430, 0.1435, 0.1433, 0.1416, 0.1435, 0.1430, 0.1422]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0498, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0498, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0498, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0498, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0497, 0.0503,
         0.0500, 0.0502],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0502],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0498, 0.0501, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0501, 0.0498, 0.0500, 0.0505, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0499]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0492],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0500, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0502, 0.0502,
         0.0501, 0.0493],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0498, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0498, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0498, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0505, 0.0493, 0.0499, 0.0501, 0.0497, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0502,
         0.0503, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0499, 0.0502, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0499, 0.0502, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0499, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0500, 0.0501, 0.0502, 0.0500,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0500, 0.0502, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0502, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0499, 0.0502, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0501, 0.0499, 0.0501, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0499, 0.0501, 0.0502, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0499, 0.0499, 0.0501,
         0.0499, 0.0499, 0.0499, 0.0502, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0499, 0.0499, 0.0500,
         0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0499, 0.0501, 0.0501, 0.0501,
         0.0499, 0.0497],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0500, 0.0499, 0.0500,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0499, 0.0498, 0.0499, 0.0503, 0.0502, 0.0501, 0.0500, 0.0502, 0.0501,
         0.0497, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1664, 0.1681, 0.1660, 0.1670, 0.1656, 0.1668],
        [0.1663, 0.1680, 0.1662, 0.1669, 0.1657, 0.1668],
        [0.1665, 0.1680, 0.1660, 0.1671, 0.1656, 0.1668],
        [0.1665, 0.1680, 0.1660, 0.1671, 0.1656, 0.1668],
        [0.1663, 0.1681, 0.1660, 0.1670, 0.1656, 0.1669],
        [0.1664, 0.1680, 0.1662, 0.1669, 0.1657, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0774, 0.0772, 0.0764, 0.0764, 0.0771, 0.0768, 0.0770, 0.0769,
         0.0773, 0.0769, 0.0771, 0.0766],
        [0.0769, 0.0774, 0.0771, 0.0764, 0.0763, 0.0771, 0.0768, 0.0771, 0.0769,
         0.0774, 0.0769, 0.0770, 0.0766],
        [0.0769, 0.0774, 0.0772, 0.0764, 0.0764, 0.0771, 0.0768, 0.0770, 0.0769,
         0.0774, 0.0769, 0.0770, 0.0765],
        [0.0769, 0.0774, 0.0771, 0.0764, 0.0763, 0.0771, 0.0768, 0.0770, 0.0769,
         0.0774, 0.0768, 0.0770, 0.0766],
        [0.0769, 0.0774, 0.0772, 0.0764, 0.0764, 0.0771, 0.0768, 0.0770, 0.0770,
         0.0774, 0.0768, 0.0771, 0.0766],
        [0.0769, 0.0774, 0.0771, 0.0765, 0.0764, 0.0772, 0.0768, 0.0770, 0.0769,
         0.0774, 0.0768, 0.0770, 0.0766],
        [0.0769, 0.0774, 0.0771, 0.0764, 0.0764, 0.0772, 0.0768, 0.0770, 0.0769,
         0.0773, 0.0768, 0.0771, 0.0766],
        [0.0769, 0.0774, 0.0772, 0.0764, 0.0764, 0.0771, 0.0768, 0.0770, 0.0770,
         0.0773, 0.0768, 0.0770, 0.0766],
        [0.0769, 0.0774, 0.0771, 0.0765, 0.0764, 0.0771, 0.0768, 0.0770, 0.0769,
         0.0773, 0.0769, 0.0770, 0.0766],
        [0.0769, 0.0774, 0.0771, 0.0764, 0.0764, 0.0772, 0.0768, 0.0770, 0.0769,
         0.0773, 0.0768, 0.0771, 0.0766],
        [0.0769, 0.0774, 0.0771, 0.0765, 0.0764, 0.0771, 0.0768, 0.0770, 0.0770,
         0.0773, 0.0768, 0.0770, 0.0766],
        [0.0770, 0.0773, 0.0771, 0.0764, 0.0763, 0.0772, 0.0768, 0.0769, 0.0770,
         0.0774, 0.0767, 0.0771, 0.0767],
        [0.0769, 0.0774, 0.0771, 0.0764, 0.0764, 0.0772, 0.0768, 0.0770, 0.0769,
         0.0773, 0.0769, 0.0771, 0.0766]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1672, 0.1668, 0.1666, 0.1656, 0.1667, 0.1671],
        [0.1673, 0.1668, 0.1666, 0.1655, 0.1666, 0.1672],
        [0.1672, 0.1667, 0.1668, 0.1656, 0.1666, 0.1671],
        [0.1672, 0.1668, 0.1666, 0.1655, 0.1667, 0.1671],
        [0.1673, 0.1669, 0.1666, 0.1655, 0.1667, 0.1671],
        [0.1673, 0.1668, 0.1665, 0.1656, 0.1667, 0.1671]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1662, 0.1670, 0.1664, 0.1670, 0.1663, 0.1670],
        [0.1662, 0.1670, 0.1665, 0.1670, 0.1663, 0.1670],
        [0.1663, 0.1671, 0.1664, 0.1670, 0.1663, 0.1669],
        [0.1662, 0.1670, 0.1665, 0.1669, 0.1663, 0.1670],
        [0.1662, 0.1670, 0.1665, 0.1669, 0.1664, 0.1669],
        [0.1661, 0.1670, 0.1665, 0.1670, 0.1663, 0.1671]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.33709001541137695s
iter time cost:11.470541000366211s
-------------Round number: 82-------------
Evaluate global model
Averaged Train Loss: 0.4446
Averaged Test Accurancy: 0.7973
Std Test Accurancy: 0.0765
evaluate time cost:4.970683813095093s
clients training time cost:5.017557621002197s
attn_optimize time cost:0.558570146560669s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0498, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0506],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0507],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0499, 0.0499, 0.0498, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0502, 0.0497, 0.0502, 0.0498, 0.0499, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0500, 0.0504, 0.0498, 0.0501, 0.0498,
         0.0499, 0.0506],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0499, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0499, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0505],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0499, 0.0499, 0.0497, 0.0499,
         0.0497, 0.0501, 0.0500, 0.0501, 0.0500, 0.0504, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0506],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0499, 0.0499, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0505],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0499, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0504],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0498, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0500, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0499, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0508],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0498, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0506],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0498, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0505],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0498, 0.0499,
         0.0497, 0.0501, 0.0500, 0.0501, 0.0500, 0.0503, 0.0498, 0.0500, 0.0499,
         0.0499, 0.0508],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0499, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0498, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0499, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0499, 0.0503, 0.0496, 0.0502, 0.0498, 0.0499, 0.0499, 0.0497, 0.0498,
         0.0498, 0.0501, 0.0499, 0.0502, 0.0500, 0.0504, 0.0498, 0.0501, 0.0498,
         0.0499, 0.0511]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0772, 0.0771, 0.0773, 0.0772, 0.0763, 0.0769, 0.0764, 0.0773, 0.0770,
         0.0770, 0.0766, 0.0771, 0.0766],
        [0.0772, 0.0771, 0.0773, 0.0772, 0.0763, 0.0769, 0.0764, 0.0773, 0.0770,
         0.0770, 0.0767, 0.0771, 0.0766],
        [0.0772, 0.0771, 0.0773, 0.0772, 0.0762, 0.0769, 0.0764, 0.0773, 0.0770,
         0.0770, 0.0767, 0.0771, 0.0765],
        [0.0772, 0.0771, 0.0773, 0.0772, 0.0763, 0.0769, 0.0764, 0.0773, 0.0770,
         0.0770, 0.0766, 0.0771, 0.0766],
        [0.0772, 0.0771, 0.0773, 0.0772, 0.0763, 0.0769, 0.0765, 0.0773, 0.0770,
         0.0770, 0.0766, 0.0771, 0.0765],
        [0.0772, 0.0771, 0.0773, 0.0772, 0.0763, 0.0770, 0.0765, 0.0773, 0.0770,
         0.0769, 0.0766, 0.0771, 0.0765],
        [0.0772, 0.0771, 0.0773, 0.0772, 0.0763, 0.0769, 0.0764, 0.0774, 0.0770,
         0.0769, 0.0766, 0.0771, 0.0765],
        [0.0772, 0.0771, 0.0774, 0.0772, 0.0763, 0.0769, 0.0764, 0.0773, 0.0770,
         0.0770, 0.0766, 0.0771, 0.0766],
        [0.0772, 0.0771, 0.0773, 0.0772, 0.0763, 0.0769, 0.0764, 0.0773, 0.0770,
         0.0769, 0.0766, 0.0771, 0.0765],
        [0.0772, 0.0771, 0.0774, 0.0772, 0.0763, 0.0769, 0.0764, 0.0773, 0.0770,
         0.0770, 0.0766, 0.0771, 0.0766],
        [0.0772, 0.0771, 0.0773, 0.0772, 0.0762, 0.0769, 0.0764, 0.0774, 0.0769,
         0.0770, 0.0767, 0.0771, 0.0765],
        [0.0772, 0.0771, 0.0773, 0.0772, 0.0763, 0.0769, 0.0764, 0.0773, 0.0770,
         0.0770, 0.0767, 0.0771, 0.0765],
        [0.0772, 0.0771, 0.0773, 0.0772, 0.0763, 0.0769, 0.0765, 0.0773, 0.0769,
         0.0770, 0.0766, 0.0771, 0.0766]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0526, 0.0528, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0526, 0.0530, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0526, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0526, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0527, 0.0527, 0.0527, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0525, 0.0525, 0.0530, 0.0526, 0.0524, 0.0530,
         0.0525],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0527, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0526, 0.0529, 0.0526, 0.0525, 0.0531,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0526, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1000, 0.0997, 0.1000, 0.1001, 0.1001, 0.0998, 0.1004, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.0998, 0.1000, 0.1002, 0.1000, 0.0997, 0.1005, 0.1001,
         0.0996],
        [0.1001, 0.1001, 0.0998, 0.1001, 0.1002, 0.1000, 0.0997, 0.1004, 0.1001,
         0.0995],
        [0.1001, 0.1000, 0.0997, 0.1000, 0.1001, 0.1001, 0.0997, 0.1004, 0.1002,
         0.0997],
        [0.1001, 0.1000, 0.0997, 0.1000, 0.1002, 0.1000, 0.0997, 0.1005, 0.1001,
         0.0997],
        [0.1001, 0.1000, 0.0997, 0.1001, 0.1001, 0.1001, 0.0998, 0.1005, 0.1002,
         0.0995],
        [0.1001, 0.1000, 0.0997, 0.1001, 0.1001, 0.1001, 0.0998, 0.1004, 0.1001,
         0.0996],
        [0.1001, 0.1000, 0.0997, 0.1000, 0.1002, 0.1001, 0.0997, 0.1005, 0.1001,
         0.0997],
        [0.1001, 0.1001, 0.0998, 0.1000, 0.1001, 0.1001, 0.0997, 0.1004, 0.1002,
         0.0996],
        [0.1001, 0.1000, 0.0997, 0.1000, 0.1001, 0.1001, 0.0998, 0.1005, 0.1001,
         0.0996]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2003, 0.2005, 0.1996, 0.1997],
        [0.2000, 0.2003, 0.2006, 0.1997, 0.1995],
        [0.2000, 0.2003, 0.2004, 0.1997, 0.1996],
        [0.2001, 0.2002, 0.2005, 0.1996, 0.1996],
        [0.2000, 0.2003, 0.2006, 0.1996, 0.1994]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1662, 0.1680, 0.1675, 0.1661, 0.1668, 0.1654],
        [0.1662, 0.1679, 0.1675, 0.1662, 0.1668, 0.1655],
        [0.1662, 0.1678, 0.1676, 0.1661, 0.1669, 0.1655],
        [0.1663, 0.1679, 0.1675, 0.1661, 0.1669, 0.1653],
        [0.1662, 0.1679, 0.1675, 0.1661, 0.1669, 0.1654],
        [0.1661, 0.1680, 0.1676, 0.1661, 0.1667, 0.1654]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0499, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0499, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0493],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0500, 0.0499, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0502, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0499, 0.0497],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0498, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0498, 0.0501, 0.0498, 0.0501,
         0.0502, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0497, 0.0502, 0.0499, 0.0501,
         0.0501, 0.0499, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0504, 0.0502,
         0.0502, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2008, 0.1998, 0.2007, 0.1988],
        [0.1999, 0.2007, 0.1999, 0.2006, 0.1989],
        [0.1999, 0.2005, 0.1998, 0.2009, 0.1989],
        [0.1999, 0.2007, 0.1998, 0.2008, 0.1987],
        [0.1994, 0.2006, 0.2001, 0.2009, 0.1989]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.36591672897338867s
iter time cost:11.058861017227173s
-------------Round number: 83-------------
Evaluate global model
[running kmeans]: 5it [00:00, 249.78it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 0.3848
Averaged Test Accurancy: 0.8056
Std Test Accurancy: 0.0784
evaluate time cost:5.199793815612793s
clients training time cost:5.036050796508789s
[running kmeans]: 7it [00:00, 317.89it/s, center_shift=0.000000, iteration=7, tol=0.000100]
attn_optimize time cost:0.4290001392364502s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1988, 0.2002, 0.2021, 0.2010, 0.1979],
        [0.1989, 0.2002, 0.2018, 0.2010, 0.1982],
        [0.1986, 0.2002, 0.2019, 0.2007, 0.1986],
        [0.1987, 0.2001, 0.2018, 0.2007, 0.1987],
        [0.1981, 0.1997, 0.2024, 0.2016, 0.1982]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0504, 0.0501, 0.0498, 0.0503,
         0.0499, 0.0498]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0501, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0504, 0.0497, 0.0502, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0504, 0.0498, 0.0501, 0.0498, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0498,
         0.0501, 0.0506],
        [0.0500, 0.0504, 0.0498, 0.0502, 0.0498, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0504, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0504, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0504, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0498,
         0.0497, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0499, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0504],
        [0.0499, 0.0505, 0.0497, 0.0502, 0.0497, 0.0500, 0.0498, 0.0496, 0.0497,
         0.0498, 0.0501, 0.0498, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0511]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0667, 0.0671, 0.0665, 0.0667, 0.0667, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0666, 0.0666, 0.0669],
        [0.0667, 0.0670, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0666, 0.0666, 0.0669],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0666, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0671, 0.0665, 0.0667, 0.0667, 0.0663, 0.0667, 0.0666, 0.0666,
         0.0667, 0.0667, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0666, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0670, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0670, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0666, 0.0667,
         0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0670],
        [0.0667, 0.0670, 0.0665, 0.0667, 0.0667, 0.0664, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0671, 0.0665, 0.0667, 0.0667, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0667, 0.0666, 0.0665, 0.0667, 0.0667, 0.0669],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0666, 0.0665, 0.0667, 0.0666, 0.0669],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0667, 0.0663, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0667, 0.0666, 0.0666, 0.0666, 0.0670],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0668, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0666, 0.0666, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0670, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0666, 0.0666, 0.0666, 0.0666, 0.0669],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0666, 0.0666,
         0.0667, 0.0667, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0671, 0.0665, 0.0667, 0.0667, 0.0664, 0.0666, 0.0666, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0666, 0.0666, 0.0669]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0716, 0.0715, 0.0716, 0.0712, 0.0716, 0.0712, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0713, 0.0717, 0.0715, 0.0712],
        [0.0716, 0.0715, 0.0716, 0.0712, 0.0716, 0.0712, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0713, 0.0717, 0.0715, 0.0712],
        [0.0716, 0.0715, 0.0716, 0.0712, 0.0716, 0.0712, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0712, 0.0717, 0.0715, 0.0712],
        [0.0716, 0.0715, 0.0716, 0.0712, 0.0716, 0.0712, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0714, 0.0717, 0.0715, 0.0712],
        [0.0716, 0.0715, 0.0716, 0.0712, 0.0716, 0.0712, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0713, 0.0717, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0716, 0.0712, 0.0716, 0.0712, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0712, 0.0717, 0.0715, 0.0712],
        [0.0716, 0.0715, 0.0716, 0.0712, 0.0716, 0.0711, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0713, 0.0717, 0.0715, 0.0712],
        [0.0716, 0.0715, 0.0716, 0.0712, 0.0716, 0.0712, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0713, 0.0717, 0.0715, 0.0712],
        [0.0717, 0.0715, 0.0716, 0.0711, 0.0716, 0.0711, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0714, 0.0717, 0.0715, 0.0711],
        [0.0716, 0.0715, 0.0716, 0.0712, 0.0716, 0.0711, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0713, 0.0717, 0.0715, 0.0712],
        [0.0716, 0.0715, 0.0716, 0.0712, 0.0716, 0.0711, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0713, 0.0717, 0.0715, 0.0712],
        [0.0716, 0.0715, 0.0716, 0.0712, 0.0716, 0.0712, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0713, 0.0717, 0.0715, 0.0712],
        [0.0717, 0.0715, 0.0716, 0.0712, 0.0716, 0.0711, 0.0713, 0.0715, 0.0714,
         0.0713, 0.0713, 0.0717, 0.0715, 0.0712],
        [0.0716, 0.0715, 0.0716, 0.0711, 0.0716, 0.0711, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0714, 0.0717, 0.0715, 0.0712]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1665, 0.1665, 0.1668, 0.1673, 0.1674, 0.1655],
        [0.1665, 0.1663, 0.1669, 0.1675, 0.1674, 0.1654],
        [0.1664, 0.1666, 0.1669, 0.1674, 0.1672, 0.1655],
        [0.1666, 0.1665, 0.1669, 0.1674, 0.1672, 0.1655],
        [0.1665, 0.1663, 0.1669, 0.1675, 0.1674, 0.1655],
        [0.1663, 0.1661, 0.1667, 0.1676, 0.1676, 0.1657]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2007, 0.2015, 0.1987, 0.1997, 0.1994],
        [0.2008, 0.2015, 0.1986, 0.1998, 0.1993],
        [0.2007, 0.2015, 0.1988, 0.1997, 0.1994],
        [0.2008, 0.2015, 0.1986, 0.1997, 0.1993],
        [0.2007, 0.2014, 0.1988, 0.1997, 0.1994]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1663, 0.1680, 0.1675, 0.1661, 0.1668, 0.1653],
        [0.1662, 0.1679, 0.1675, 0.1662, 0.1667, 0.1655],
        [0.1662, 0.1678, 0.1675, 0.1662, 0.1668, 0.1654],
        [0.1664, 0.1679, 0.1674, 0.1662, 0.1669, 0.1653],
        [0.1663, 0.1679, 0.1675, 0.1661, 0.1668, 0.1654],
        [0.1662, 0.1680, 0.1676, 0.1661, 0.1667, 0.1654]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1253, 0.1252, 0.1249, 0.1241, 0.1254, 0.1251, 0.1248, 0.1252],
        [0.1253, 0.1252, 0.1249, 0.1241, 0.1254, 0.1251, 0.1248, 0.1252],
        [0.1252, 0.1252, 0.1250, 0.1241, 0.1254, 0.1251, 0.1248, 0.1251],
        [0.1253, 0.1253, 0.1249, 0.1240, 0.1255, 0.1251, 0.1248, 0.1252],
        [0.1253, 0.1252, 0.1249, 0.1241, 0.1254, 0.1251, 0.1249, 0.1252],
        [0.1252, 0.1253, 0.1249, 0.1241, 0.1254, 0.1251, 0.1248, 0.1252],
        [0.1253, 0.1253, 0.1248, 0.1240, 0.1255, 0.1251, 0.1248, 0.1252],
        [0.1253, 0.1252, 0.1248, 0.1241, 0.1255, 0.1251, 0.1249, 0.1252]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.35648441314697266s
iter time cost:11.137434720993042s
-------------Round number: 84-------------
Evaluate global model
Averaged Train Loss: 0.4499
Averaged Test Accurancy: 0.7881
Std Test Accurancy: 0.0984
evaluate time cost:5.0096611976623535s
[running kmeans]: 5it [00:00, 416.28it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:4.9168055057525635s
attn_optimize time cost:0.46924853324890137s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1428, 0.1428, 0.1430, 0.1428, 0.1433, 0.1425, 0.1428],
        [0.1428, 0.1427, 0.1431, 0.1430, 0.1431, 0.1426, 0.1427],
        [0.1428, 0.1428, 0.1430, 0.1429, 0.1432, 0.1426, 0.1427],
        [0.1429, 0.1428, 0.1430, 0.1429, 0.1432, 0.1426, 0.1427],
        [0.1427, 0.1428, 0.1431, 0.1429, 0.1431, 0.1425, 0.1429],
        [0.1428, 0.1428, 0.1430, 0.1428, 0.1432, 0.1426, 0.1427],
        [0.1427, 0.1428, 0.1431, 0.1429, 0.1431, 0.1426, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1659, 0.1667, 0.1664, 0.1662, 0.1669, 0.1679],
        [0.1659, 0.1667, 0.1664, 0.1662, 0.1668, 0.1679],
        [0.1659, 0.1668, 0.1664, 0.1661, 0.1669, 0.1680],
        [0.1658, 0.1667, 0.1664, 0.1663, 0.1668, 0.1680],
        [0.1659, 0.1666, 0.1665, 0.1662, 0.1668, 0.1679],
        [0.1660, 0.1668, 0.1664, 0.1662, 0.1668, 0.1679]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0907, 0.0914, 0.0908, 0.0910, 0.0906, 0.0907, 0.0912, 0.0909, 0.0910,
         0.0910, 0.0906],
        [0.0908, 0.0914, 0.0907, 0.0911, 0.0906, 0.0907, 0.0912, 0.0909, 0.0910,
         0.0910, 0.0907],
        [0.0908, 0.0913, 0.0908, 0.0910, 0.0906, 0.0907, 0.0912, 0.0910, 0.0911,
         0.0910, 0.0906],
        [0.0907, 0.0914, 0.0907, 0.0910, 0.0906, 0.0907, 0.0912, 0.0909, 0.0910,
         0.0910, 0.0906],
        [0.0907, 0.0914, 0.0908, 0.0910, 0.0905, 0.0907, 0.0913, 0.0909, 0.0911,
         0.0911, 0.0905],
        [0.0908, 0.0914, 0.0907, 0.0909, 0.0906, 0.0907, 0.0913, 0.0908, 0.0910,
         0.0911, 0.0906],
        [0.0908, 0.0914, 0.0908, 0.0910, 0.0905, 0.0907, 0.0913, 0.0909, 0.0909,
         0.0911, 0.0907],
        [0.0908, 0.0914, 0.0908, 0.0911, 0.0905, 0.0907, 0.0912, 0.0909, 0.0911,
         0.0910, 0.0907],
        [0.0908, 0.0914, 0.0907, 0.0910, 0.0905, 0.0907, 0.0913, 0.0908, 0.0910,
         0.0911, 0.0906],
        [0.0908, 0.0913, 0.0908, 0.0910, 0.0906, 0.0907, 0.0913, 0.0908, 0.0910,
         0.0910, 0.0907],
        [0.0907, 0.0914, 0.0908, 0.0910, 0.0906, 0.0907, 0.0912, 0.0909, 0.0910,
         0.0910, 0.0906]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0499, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0502, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0493],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0498, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0497],
        [0.0501, 0.0503, 0.0495, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0496],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0501, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0504, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0498, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0499, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0502, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0502, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0498, 0.0500, 0.0498, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0500, 0.0499, 0.0499, 0.0502, 0.0505, 0.0502,
         0.0503, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1431, 0.1420, 0.1415, 0.1430, 0.1422, 0.1447],
        [0.1436, 0.1432, 0.1419, 0.1417, 0.1430, 0.1422, 0.1444],
        [0.1436, 0.1431, 0.1420, 0.1416, 0.1431, 0.1422, 0.1445],
        [0.1436, 0.1432, 0.1420, 0.1417, 0.1430, 0.1422, 0.1444],
        [0.1436, 0.1431, 0.1418, 0.1416, 0.1430, 0.1421, 0.1447],
        [0.1435, 0.1430, 0.1419, 0.1417, 0.1429, 0.1421, 0.1448],
        [0.1437, 0.1431, 0.1417, 0.1413, 0.1431, 0.1418, 0.1454]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0769, 0.0769, 0.0771, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0766, 0.0769],
        [0.0771, 0.0770, 0.0769, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0768, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0768, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0766, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0768, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0499, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0499, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0499,
         0.0501, 0.0495, 0.0500, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1250, 0.1252, 0.1245, 0.1247, 0.1254, 0.1247, 0.1255],
        [0.1251, 0.1250, 0.1252, 0.1244, 0.1247, 0.1254, 0.1247, 0.1256],
        [0.1250, 0.1250, 0.1252, 0.1244, 0.1247, 0.1254, 0.1247, 0.1255],
        [0.1250, 0.1251, 0.1251, 0.1244, 0.1247, 0.1255, 0.1247, 0.1256],
        [0.1250, 0.1250, 0.1252, 0.1244, 0.1247, 0.1254, 0.1247, 0.1256],
        [0.1250, 0.1250, 0.1251, 0.1244, 0.1247, 0.1255, 0.1246, 0.1256],
        [0.1250, 0.1250, 0.1252, 0.1243, 0.1247, 0.1255, 0.1248, 0.1255],
        [0.1250, 0.1250, 0.1252, 0.1244, 0.1247, 0.1254, 0.1246, 0.1255]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1434, 0.1428, 0.1426, 0.1426, 0.1425, 0.1437, 0.1425],
        [0.1433, 0.1426, 0.1427, 0.1426, 0.1425, 0.1437, 0.1427],
        [0.1431, 0.1427, 0.1428, 0.1428, 0.1424, 0.1436, 0.1426],
        [0.1433, 0.1427, 0.1428, 0.1427, 0.1424, 0.1436, 0.1424],
        [0.1432, 0.1427, 0.1428, 0.1427, 0.1424, 0.1436, 0.1427],
        [0.1432, 0.1427, 0.1428, 0.1426, 0.1424, 0.1436, 0.1427],
        [0.1435, 0.1427, 0.1429, 0.1426, 0.1425, 0.1437, 0.1421]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3639082908630371s
iter time cost:10.84670376777649s
-------------Round number: 85-------------
Evaluate global model
Averaged Train Loss: 0.3928
Averaged Test Accurancy: 0.8022
Std Test Accurancy: 0.0928
evaluate time cost:5.511548280715942s
clients training time cost:4.865746021270752s
attn_optimize time cost:0.4083707332611084s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1426, 0.1428, 0.1425, 0.1427, 0.1431, 0.1429, 0.1433],
        [0.1426, 0.1430, 0.1425, 0.1428, 0.1432, 0.1428, 0.1432],
        [0.1426, 0.1429, 0.1423, 0.1428, 0.1433, 0.1428, 0.1433],
        [0.1426, 0.1428, 0.1426, 0.1428, 0.1433, 0.1427, 0.1432],
        [0.1427, 0.1429, 0.1425, 0.1427, 0.1432, 0.1428, 0.1431],
        [0.1427, 0.1430, 0.1424, 0.1428, 0.1431, 0.1427, 0.1433],
        [0.1426, 0.1430, 0.1424, 0.1428, 0.1433, 0.1427, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0501,
         0.0497, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0501,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0501,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0500, 0.0498, 0.0497, 0.0501,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0498, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0497, 0.0501,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0501,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0502, 0.0500,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0497, 0.0501,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0498, 0.0500, 0.0499, 0.0497, 0.0501,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0499, 0.0504, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0498, 0.0502, 0.0501, 0.0504, 0.0497, 0.0501, 0.0498,
         0.0500, 0.0511]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0668, 0.0671, 0.0664, 0.0666, 0.0667, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0667, 0.0665, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0667, 0.0665, 0.0666, 0.0666, 0.0667, 0.0670],
        [0.0668, 0.0671, 0.0664, 0.0666, 0.0667, 0.0664, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0665, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0665, 0.0667, 0.0667, 0.0664, 0.0667, 0.0666, 0.0666,
         0.0667, 0.0666, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0666, 0.0667,
         0.0667, 0.0666, 0.0666, 0.0666, 0.0667, 0.0670],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0667, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0666, 0.0667,
         0.0667, 0.0665, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0668, 0.0670, 0.0665, 0.0667, 0.0667, 0.0664, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0665, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0671, 0.0665, 0.0667, 0.0667, 0.0664, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0666, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0665, 0.0665, 0.0667, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0666, 0.0666, 0.0667, 0.0670],
        [0.0668, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0667, 0.0667, 0.0667,
         0.0666, 0.0665, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0670, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0665, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0664, 0.0666, 0.0667, 0.0664, 0.0667, 0.0666, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0666, 0.0667, 0.0670],
        [0.0668, 0.0671, 0.0664, 0.0667, 0.0667, 0.0664, 0.0666, 0.0666, 0.0666,
         0.0667, 0.0665, 0.0666, 0.0666, 0.0667, 0.0669]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
[running kmeans]: 5it [00:00, 262.92it/s, center_shift=0.000000, iteration=5, tol=0.000100]
weights:tensor([[0.1003, 0.0999, 0.0999, 0.0998, 0.0994, 0.0998, 0.0999, 0.1006, 0.0997,
         0.1006],
        [0.1003, 0.0999, 0.1000, 0.0998, 0.0994, 0.0999, 0.0999, 0.1006, 0.0997,
         0.1006],
        [0.1002, 0.0999, 0.1001, 0.1000, 0.0994, 0.0998, 0.0998, 0.1005, 0.0997,
         0.1006],
        [0.1003, 0.0999, 0.1000, 0.0999, 0.0994, 0.0998, 0.0999, 0.1006, 0.0997,
         0.1006],
        [0.1003, 0.1000, 0.1000, 0.0999, 0.0994, 0.0998, 0.0999, 0.1006, 0.0997,
         0.1006],
        [0.1003, 0.0999, 0.1001, 0.0999, 0.0994, 0.0998, 0.0998, 0.1005, 0.0997,
         0.1006],
        [0.1002, 0.0999, 0.1000, 0.0999, 0.0995, 0.0998, 0.0999, 0.1005, 0.0997,
         0.1006],
        [0.1003, 0.0999, 0.0999, 0.0999, 0.0995, 0.0998, 0.0999, 0.1005, 0.0997,
         0.1006],
        [0.1003, 0.0999, 0.0999, 0.0999, 0.0995, 0.0998, 0.0999, 0.1005, 0.0997,
         0.1006],
        [0.1003, 0.0999, 0.1001, 0.0999, 0.0995, 0.0998, 0.0999, 0.1005, 0.0997,
         0.1006]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0832, 0.0831, 0.0834, 0.0833,
         0.0836, 0.0834, 0.0830],
        [0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0831, 0.0831, 0.0834, 0.0832,
         0.0837, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0832, 0.0831, 0.0834, 0.0833,
         0.0837, 0.0834, 0.0830],
        [0.0834, 0.0833, 0.0834, 0.0834, 0.0835, 0.0832, 0.0831, 0.0835, 0.0833,
         0.0837, 0.0834, 0.0830],
        [0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0832, 0.0831, 0.0834, 0.0833,
         0.0837, 0.0834, 0.0830],
        [0.0834, 0.0834, 0.0834, 0.0834, 0.0834, 0.0832, 0.0831, 0.0835, 0.0832,
         0.0837, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0831, 0.0831, 0.0834, 0.0832,
         0.0837, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0832, 0.0831, 0.0835, 0.0832,
         0.0837, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0831, 0.0831, 0.0834, 0.0833,
         0.0836, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0832, 0.0831, 0.0834, 0.0832,
         0.0837, 0.0834, 0.0831],
        [0.0835, 0.0833, 0.0834, 0.0834, 0.0834, 0.0831, 0.0831, 0.0834, 0.0832,
         0.0837, 0.0834, 0.0831],
        [0.0834, 0.0833, 0.0834, 0.0834, 0.0834, 0.0831, 0.0831, 0.0834, 0.0833,
         0.0837, 0.0834, 0.0830]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1987, 0.2003, 0.2020, 0.2011, 0.1979],
        [0.1988, 0.2002, 0.2018, 0.2010, 0.1983],
        [0.1986, 0.2002, 0.2018, 0.2008, 0.1987],
        [0.1986, 0.2001, 0.2018, 0.2008, 0.1987],
        [0.1979, 0.1997, 0.2023, 0.2017, 0.1983]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1115, 0.1111, 0.1112, 0.1113, 0.1108, 0.1111, 0.1110, 0.1108, 0.1111],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1107, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1108, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1108, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1110, 0.1113, 0.1112, 0.1107, 0.1112, 0.1111, 0.1108, 0.1111],
        [0.1115, 0.1111, 0.1113, 0.1113, 0.1107, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1107, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1107, 0.1111, 0.1110, 0.1109, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1107, 0.1111, 0.1110, 0.1109, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0497, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0503, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0499, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0498,
         0.0501, 0.0496, 0.0499, 0.0505, 0.0502, 0.0501, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3338782787322998s
iter time cost:11.264252185821533s
-------------Round number: 86-------------
Evaluate global model
Averaged Train Loss: 0.4228
Averaged Test Accurancy: 0.7946
Std Test Accurancy: 0.1020
evaluate time cost:5.1516923904418945s
[running kmeans]: 8it [00:00, 285.46it/s, center_shift=0.000000, iteration=8, tol=0.000100]
clients training time cost:4.8471362590789795s
attn_optimize time cost:0.4361398220062256s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0770, 0.0765, 0.0768, 0.0768, 0.0770, 0.0766, 0.0771, 0.0769, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0766, 0.0771, 0.0769, 0.0770,
         0.0774, 0.0772, 0.0767, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0766, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0769, 0.0766, 0.0772, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0769, 0.0766, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0768, 0.0767, 0.0770, 0.0765, 0.0772, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0768, 0.0769, 0.0766, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0768, 0.0770, 0.0766, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0770, 0.0766, 0.0772, 0.0768, 0.0770,
         0.0773, 0.0772, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0768, 0.0768, 0.0770, 0.0767, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0765, 0.0768, 0.0767, 0.0770, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0768, 0.0770, 0.0766, 0.0772, 0.0768, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1428, 0.1420, 0.1418, 0.1429, 0.1423, 0.1447],
        [0.1436, 0.1430, 0.1419, 0.1419, 0.1429, 0.1423, 0.1444],
        [0.1436, 0.1428, 0.1420, 0.1418, 0.1430, 0.1423, 0.1445],
        [0.1435, 0.1430, 0.1420, 0.1419, 0.1429, 0.1423, 0.1444],
        [0.1435, 0.1429, 0.1418, 0.1419, 0.1429, 0.1423, 0.1448],
        [0.1435, 0.1428, 0.1419, 0.1419, 0.1428, 0.1422, 0.1449],
        [0.1436, 0.1428, 0.1416, 0.1416, 0.1430, 0.1419, 0.1454]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0990, 0.0999, 0.1000, 0.0996, 0.1002, 0.1001, 0.1002, 0.0999, 0.1007,
         0.1003],
        [0.0990, 0.0998, 0.1001, 0.0997, 0.1002, 0.1001, 0.1002, 0.1000, 0.1007,
         0.1001],
        [0.0991, 0.0999, 0.1001, 0.0997, 0.1001, 0.1001, 0.1002, 0.0999, 0.1007,
         0.1002],
        [0.0990, 0.1001, 0.1000, 0.0996, 0.1001, 0.1001, 0.1001, 0.0999, 0.1006,
         0.1003],
        [0.0991, 0.0999, 0.1001, 0.0997, 0.1001, 0.1001, 0.1001, 0.0999, 0.1007,
         0.1002],
        [0.0990, 0.0999, 0.1001, 0.0997, 0.1002, 0.1001, 0.1002, 0.0999, 0.1007,
         0.1001],
        [0.0989, 0.0997, 0.1002, 0.0998, 0.1002, 0.1000, 0.1002, 0.1000, 0.1007,
         0.1001],
        [0.0991, 0.0998, 0.1002, 0.0997, 0.1002, 0.1001, 0.1002, 0.0999, 0.1007,
         0.1002],
        [0.0990, 0.0999, 0.1001, 0.0997, 0.1002, 0.1001, 0.1002, 0.0999, 0.1007,
         0.1002],
        [0.0990, 0.0999, 0.1001, 0.0997, 0.1002, 0.1001, 0.1001, 0.0999, 0.1007,
         0.1002]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0628, 0.0626, 0.0629, 0.0627, 0.0626, 0.0627, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0627, 0.0627, 0.0627, 0.0619, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0628, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0628, 0.0627, 0.0627, 0.0620, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0625, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0628, 0.0626, 0.0626, 0.0620, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0628, 0.0626, 0.0626, 0.0620, 0.0626, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0628, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0625, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0628, 0.0626, 0.0627, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0625, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0628, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0625, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0628, 0.0627, 0.0627, 0.0619, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0625, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0625, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0627, 0.0627, 0.0626, 0.0620, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0628, 0.0627, 0.0626, 0.0620, 0.0625, 0.0622,
         0.0628, 0.0626, 0.0625, 0.0619, 0.0623, 0.0627, 0.0622]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1664, 0.1675, 0.1664, 0.1664, 0.1663, 0.1670],
        [0.1664, 0.1674, 0.1665, 0.1663, 0.1663, 0.1671],
        [0.1664, 0.1674, 0.1664, 0.1664, 0.1663, 0.1671],
        [0.1664, 0.1673, 0.1665, 0.1663, 0.1664, 0.1671],
        [0.1664, 0.1675, 0.1664, 0.1664, 0.1663, 0.1670],
        [0.1664, 0.1674, 0.1664, 0.1664, 0.1663, 0.1671]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3326, 0.3340, 0.3335],
        [0.3325, 0.3340, 0.3335],
        [0.3325, 0.3340, 0.3334]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2512, 0.2507, 0.2519, 0.2462],
        [0.2510, 0.2504, 0.2517, 0.2469],
        [0.2509, 0.2503, 0.2516, 0.2472],
        [0.2513, 0.2509, 0.2516, 0.2461]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0501, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0498, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0500, 0.0500, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0500, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0501, 0.0503, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0500, 0.0500, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0501, 0.0503, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0500, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0500, 0.0500, 0.0501, 0.0503, 0.0501, 0.0500,
         0.0499, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0499, 0.0501, 0.0502, 0.0501, 0.0501,
         0.0499, 0.0495],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0499, 0.0496],
        [0.0501, 0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0501, 0.0503, 0.0500, 0.0500,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0500, 0.0500, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0500, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0500,
         0.0500, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0500, 0.0497],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0501, 0.0503, 0.0501, 0.0500,
         0.0500, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0499, 0.0503, 0.0498, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0497, 0.0498, 0.0501, 0.0500, 0.0503, 0.0502, 0.0502, 0.0501,
         0.0499, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0499,
         0.0500, 0.0498, 0.0501, 0.0498, 0.0500, 0.0504, 0.0500, 0.0498, 0.0503,
         0.0499, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.38995814323425293s
iter time cost:10.9906644821167s
-------------Round number: 87-------------
Evaluate global model
Averaged Train Loss: 0.3984
Averaged Test Accurancy: 0.8007
Std Test Accurancy: 0.1045
evaluate time cost:5.459740877151489s
clients training time cost:4.839254856109619s
[running kmeans]: 5it [00:00, 333.01it/s, center_shift=0.000000, iteration=5, tol=0.000100]
attn_optimize time cost:0.5616617202758789s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0502, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0499, 0.0497, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0499, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0502, 0.0499,
         0.0501, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0501, 0.0505, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0503],
        [0.0499, 0.0504, 0.0496, 0.0502, 0.0497, 0.0499, 0.0498, 0.0496, 0.0497,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0505, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0510]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2512, 0.2508, 0.2518, 0.2461],
        [0.2510, 0.2505, 0.2516, 0.2470],
        [0.2508, 0.2505, 0.2516, 0.2471],
        [0.2512, 0.2512, 0.2515, 0.2462]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0833, 0.0835, 0.0831, 0.0836, 0.0831, 0.0833, 0.0833, 0.0832,
         0.0837, 0.0835, 0.0829],
        [0.0835, 0.0833, 0.0834, 0.0832, 0.0836, 0.0831, 0.0833, 0.0834, 0.0831,
         0.0837, 0.0834, 0.0830],
        [0.0835, 0.0833, 0.0834, 0.0831, 0.0836, 0.0831, 0.0833, 0.0833, 0.0832,
         0.0837, 0.0835, 0.0829],
        [0.0834, 0.0833, 0.0834, 0.0831, 0.0837, 0.0831, 0.0833, 0.0834, 0.0831,
         0.0837, 0.0835, 0.0829],
        [0.0834, 0.0833, 0.0834, 0.0831, 0.0836, 0.0831, 0.0834, 0.0833, 0.0832,
         0.0837, 0.0834, 0.0829],
        [0.0834, 0.0834, 0.0834, 0.0831, 0.0836, 0.0831, 0.0833, 0.0834, 0.0831,
         0.0837, 0.0834, 0.0830],
        [0.0834, 0.0833, 0.0834, 0.0832, 0.0837, 0.0830, 0.0833, 0.0833, 0.0831,
         0.0837, 0.0835, 0.0830],
        [0.0835, 0.0833, 0.0834, 0.0832, 0.0836, 0.0831, 0.0834, 0.0834, 0.0831,
         0.0837, 0.0834, 0.0830],
        [0.0834, 0.0833, 0.0834, 0.0831, 0.0836, 0.0831, 0.0834, 0.0834, 0.0832,
         0.0836, 0.0835, 0.0830],
        [0.0835, 0.0833, 0.0834, 0.0831, 0.0836, 0.0831, 0.0834, 0.0834, 0.0831,
         0.0837, 0.0834, 0.0830],
        [0.0835, 0.0833, 0.0834, 0.0832, 0.0836, 0.0831, 0.0833, 0.0833, 0.0831,
         0.0837, 0.0835, 0.0830],
        [0.0834, 0.0833, 0.0834, 0.0831, 0.0836, 0.0831, 0.0834, 0.0833, 0.0832,
         0.0837, 0.0835, 0.0829]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1427, 0.1426, 0.1427, 0.1424, 0.1438, 0.1425],
        [0.1431, 0.1426, 0.1427, 0.1426, 0.1424, 0.1439, 0.1427],
        [0.1430, 0.1427, 0.1429, 0.1428, 0.1423, 0.1437, 0.1426],
        [0.1432, 0.1427, 0.1428, 0.1428, 0.1424, 0.1438, 0.1424],
        [0.1431, 0.1426, 0.1428, 0.1427, 0.1424, 0.1437, 0.1426],
        [0.1431, 0.1426, 0.1428, 0.1427, 0.1424, 0.1437, 0.1427],
        [0.1433, 0.1426, 0.1429, 0.1427, 0.1425, 0.1439, 0.1421]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0499, 0.0496],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0492],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0493],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0500, 0.0497],
        [0.0501, 0.0503, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0505, 0.0493, 0.0499, 0.0500, 0.0498, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0499, 0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0505, 0.0503,
         0.0503, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0769, 0.0770, 0.0771, 0.0766, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0766, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0766, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0775, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0768, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0771, 0.0768, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0766, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0768,
         0.0774, 0.0769, 0.0766, 0.0770],
        [0.0771, 0.0768, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0768, 0.0770, 0.0770, 0.0767, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0766, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0766, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1251, 0.1249, 0.1251, 0.1255, 0.1251, 0.1254, 0.1238],
        [0.1251, 0.1252, 0.1248, 0.1251, 0.1255, 0.1250, 0.1254, 0.1239],
        [0.1251, 0.1251, 0.1247, 0.1252, 0.1256, 0.1250, 0.1254, 0.1239],
        [0.1251, 0.1251, 0.1249, 0.1252, 0.1256, 0.1249, 0.1253, 0.1239],
        [0.1252, 0.1252, 0.1248, 0.1251, 0.1256, 0.1250, 0.1252, 0.1239],
        [0.1251, 0.1252, 0.1248, 0.1251, 0.1255, 0.1249, 0.1254, 0.1240],
        [0.1251, 0.1252, 0.1247, 0.1252, 0.1256, 0.1249, 0.1254, 0.1240],
        [0.1250, 0.1251, 0.1245, 0.1250, 0.1257, 0.1253, 0.1255, 0.1241]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3340, 0.3332, 0.3328],
        [0.3342, 0.3332, 0.3327],
        [0.3341, 0.3330, 0.3328]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0914, 0.0914, 0.0913, 0.0903, 0.0912, 0.0905, 0.0912, 0.0912, 0.0901,
         0.0908, 0.0907],
        [0.0915, 0.0914, 0.0912, 0.0903, 0.0911, 0.0905, 0.0912, 0.0912, 0.0901,
         0.0907, 0.0907],
        [0.0915, 0.0915, 0.0913, 0.0903, 0.0911, 0.0904, 0.0913, 0.0912, 0.0901,
         0.0908, 0.0907],
        [0.0915, 0.0914, 0.0912, 0.0903, 0.0911, 0.0905, 0.0912, 0.0912, 0.0901,
         0.0908, 0.0906],
        [0.0914, 0.0914, 0.0912, 0.0904, 0.0912, 0.0905, 0.0912, 0.0912, 0.0901,
         0.0907, 0.0906],
        [0.0915, 0.0915, 0.0912, 0.0903, 0.0911, 0.0905, 0.0912, 0.0912, 0.0901,
         0.0908, 0.0906],
        [0.0914, 0.0915, 0.0913, 0.0903, 0.0912, 0.0905, 0.0912, 0.0912, 0.0901,
         0.0907, 0.0906],
        [0.0915, 0.0915, 0.0913, 0.0903, 0.0911, 0.0904, 0.0913, 0.0912, 0.0901,
         0.0908, 0.0907],
        [0.0915, 0.0915, 0.0913, 0.0902, 0.0911, 0.0905, 0.0912, 0.0912, 0.0900,
         0.0908, 0.0906],
        [0.0915, 0.0915, 0.0912, 0.0902, 0.0911, 0.0905, 0.0912, 0.0912, 0.0901,
         0.0908, 0.0906],
        [0.0914, 0.0914, 0.0912, 0.0903, 0.0911, 0.0905, 0.0912, 0.0912, 0.0901,
         0.0908, 0.0907]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4994, 0.5006],
        [0.4995, 0.5005]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.4268810749053955s
iter time cost:11.421661138534546s
-------------Round number: 88-------------
Evaluate global model
Averaged Train Loss: 0.4217
Averaged Test Accurancy: 0.7944
Std Test Accurancy: 0.0962
evaluate time cost:5.264678716659546s
clients training time cost:4.9310688972473145s
attn_optimize time cost:0.4731597900390625s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1251, 0.1251, 0.1250, 0.1248, 0.1254, 0.1250, 0.1255, 0.1241],
        [0.1250, 0.1253, 0.1249, 0.1248, 0.1254, 0.1249, 0.1255, 0.1241],
        [0.1251, 0.1252, 0.1248, 0.1249, 0.1255, 0.1249, 0.1256, 0.1241],
        [0.1250, 0.1251, 0.1250, 0.1249, 0.1255, 0.1248, 0.1254, 0.1242],
        [0.1252, 0.1252, 0.1249, 0.1248, 0.1255, 0.1249, 0.1254, 0.1241],
        [0.1251, 0.1253, 0.1248, 0.1248, 0.1254, 0.1248, 0.1256, 0.1242],
        [0.1251, 0.1252, 0.1248, 0.1249, 0.1255, 0.1248, 0.1256, 0.1241],
        [0.1249, 0.1252, 0.1246, 0.1246, 0.1256, 0.1251, 0.1257, 0.1243]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0497, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0497, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0498, 0.0501, 0.0498, 0.0499, 0.0505, 0.0501, 0.0498, 0.0503,
         0.0500, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0914, 0.0913, 0.0912, 0.0903, 0.0911, 0.0905, 0.0912, 0.0912, 0.0900,
         0.0906, 0.0913],
        [0.0914, 0.0914, 0.0912, 0.0902, 0.0911, 0.0904, 0.0911, 0.0912, 0.0900,
         0.0907, 0.0912],
        [0.0914, 0.0913, 0.0912, 0.0902, 0.0911, 0.0904, 0.0912, 0.0911, 0.0900,
         0.0907, 0.0912],
        [0.0914, 0.0913, 0.0912, 0.0903, 0.0911, 0.0905, 0.0911, 0.0911, 0.0900,
         0.0907, 0.0913],
        [0.0914, 0.0912, 0.0912, 0.0903, 0.0912, 0.0905, 0.0912, 0.0911, 0.0900,
         0.0906, 0.0912],
        [0.0914, 0.0913, 0.0912, 0.0903, 0.0911, 0.0905, 0.0912, 0.0911, 0.0900,
         0.0906, 0.0912],
        [0.0914, 0.0913, 0.0912, 0.0903, 0.0911, 0.0905, 0.0911, 0.0911, 0.0900,
         0.0906, 0.0913],
        [0.0914, 0.0914, 0.0912, 0.0902, 0.0911, 0.0904, 0.0912, 0.0911, 0.0900,
         0.0906, 0.0912],
        [0.0914, 0.0914, 0.0913, 0.0902, 0.0911, 0.0904, 0.0911, 0.0912, 0.0900,
         0.0907, 0.0912],
        [0.0914, 0.0914, 0.0912, 0.0902, 0.0911, 0.0905, 0.0911, 0.0911, 0.0900,
         0.0907, 0.0913],
        [0.0914, 0.0914, 0.0912, 0.0903, 0.0911, 0.0905, 0.0911, 0.0912, 0.0900,
         0.0907, 0.0912]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2513, 0.2506, 0.2518, 0.2463],
        [0.2511, 0.2504, 0.2515, 0.2470],
        [0.2510, 0.2504, 0.2515, 0.2471],
        [0.2515, 0.2510, 0.2514, 0.2462]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0833, 0.0834, 0.0832, 0.0835, 0.0831, 0.0833, 0.0836, 0.0832,
         0.0837, 0.0833, 0.0830],
        [0.0835, 0.0833, 0.0834, 0.0832, 0.0835, 0.0830, 0.0833, 0.0836, 0.0832,
         0.0837, 0.0833, 0.0830],
        [0.0835, 0.0833, 0.0834, 0.0831, 0.0836, 0.0830, 0.0833, 0.0836, 0.0832,
         0.0837, 0.0833, 0.0830],
        [0.0834, 0.0833, 0.0834, 0.0832, 0.0836, 0.0830, 0.0833, 0.0836, 0.0832,
         0.0837, 0.0833, 0.0830],
        [0.0835, 0.0833, 0.0834, 0.0832, 0.0835, 0.0830, 0.0833, 0.0836, 0.0832,
         0.0838, 0.0833, 0.0830],
        [0.0834, 0.0834, 0.0833, 0.0832, 0.0835, 0.0830, 0.0833, 0.0836, 0.0832,
         0.0837, 0.0833, 0.0830],
        [0.0835, 0.0833, 0.0834, 0.0832, 0.0836, 0.0830, 0.0833, 0.0836, 0.0832,
         0.0837, 0.0833, 0.0831],
        [0.0835, 0.0833, 0.0833, 0.0832, 0.0835, 0.0830, 0.0833, 0.0836, 0.0831,
         0.0837, 0.0833, 0.0831],
        [0.0835, 0.0833, 0.0834, 0.0832, 0.0836, 0.0830, 0.0833, 0.0836, 0.0833,
         0.0837, 0.0833, 0.0830],
        [0.0835, 0.0833, 0.0834, 0.0831, 0.0835, 0.0830, 0.0833, 0.0836, 0.0832,
         0.0837, 0.0833, 0.0831],
        [0.0835, 0.0833, 0.0834, 0.0832, 0.0835, 0.0830, 0.0833, 0.0835, 0.0832,
         0.0837, 0.0833, 0.0830],
        [0.0835, 0.0833, 0.0834, 0.0831, 0.0836, 0.0830, 0.0833, 0.0836, 0.0833,
         0.0837, 0.0833, 0.0830]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0667, 0.0671, 0.0664, 0.0666, 0.0667, 0.0664, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0668, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0666, 0.0666, 0.0666, 0.0666, 0.0667, 0.0670],
        [0.0667, 0.0671, 0.0664, 0.0666, 0.0668, 0.0664, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0666, 0.0665, 0.0666, 0.0667, 0.0670],
        [0.0667, 0.0671, 0.0665, 0.0666, 0.0667, 0.0663, 0.0667, 0.0666, 0.0666,
         0.0667, 0.0666, 0.0665, 0.0666, 0.0668, 0.0670],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0667, 0.0663, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0667, 0.0671, 0.0664, 0.0666, 0.0668, 0.0664, 0.0667, 0.0667, 0.0666,
         0.0666, 0.0665, 0.0666, 0.0666, 0.0668, 0.0670],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0668, 0.0663, 0.0666, 0.0666, 0.0667,
         0.0667, 0.0666, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0667, 0.0670, 0.0664, 0.0667, 0.0668, 0.0664, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0665, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0671, 0.0665, 0.0666, 0.0667, 0.0664, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0666, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0668, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0666, 0.0665, 0.0665, 0.0666, 0.0667, 0.0670],
        [0.0667, 0.0671, 0.0664, 0.0667, 0.0668, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0666, 0.0666, 0.0666, 0.0666, 0.0667, 0.0670],
        [0.0667, 0.0671, 0.0664, 0.0666, 0.0668, 0.0664, 0.0667, 0.0667, 0.0666,
         0.0666, 0.0666, 0.0665, 0.0666, 0.0667, 0.0670],
        [0.0667, 0.0670, 0.0664, 0.0667, 0.0668, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0666, 0.0665, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0671, 0.0664, 0.0666, 0.0668, 0.0663, 0.0667, 0.0666, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0667, 0.0671, 0.0664, 0.0666, 0.0667, 0.0664, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0666, 0.0667, 0.0670]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0765, 0.0768, 0.0767, 0.0769, 0.0766, 0.0773, 0.0768, 0.0770,
         0.0775, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0767, 0.0773, 0.0769, 0.0769,
         0.0774, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0767, 0.0773, 0.0768, 0.0769,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0766, 0.0773, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0766, 0.0773, 0.0768, 0.0770,
         0.0775, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0767, 0.0773, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0768, 0.0766, 0.0769, 0.0766, 0.0774, 0.0768, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0768, 0.0767, 0.0773, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0773, 0.0768, 0.0770,
         0.0775, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0766, 0.0769, 0.0766, 0.0773, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0768, 0.0767, 0.0769, 0.0767, 0.0773, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0766, 0.0768, 0.0766, 0.0769, 0.0766, 0.0773, 0.0769, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0769, 0.0767, 0.0773, 0.0768, 0.0770,
         0.0775, 0.0771, 0.0767, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2004, 0.1999, 0.2007, 0.2005, 0.1985],
        [0.2004, 0.2000, 0.2007, 0.2004, 0.1986],
        [0.2005, 0.1999, 0.2007, 0.2004, 0.1984],
        [0.2003, 0.2000, 0.2008, 0.2003, 0.1985],
        [0.2003, 0.1999, 0.2007, 0.2005, 0.1985]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1986, 0.2000, 0.2023, 0.2013, 0.1977],
        [0.1987, 0.1999, 0.2021, 0.2013, 0.1980],
        [0.1984, 0.2000, 0.2021, 0.2010, 0.1985],
        [0.1984, 0.1999, 0.2021, 0.2010, 0.1986],
        [0.1978, 0.1994, 0.2028, 0.2020, 0.1980]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1430, 0.1420, 0.1415, 0.1429, 0.1422, 0.1448],
        [0.1437, 0.1432, 0.1419, 0.1416, 0.1429, 0.1422, 0.1445],
        [0.1436, 0.1430, 0.1420, 0.1415, 0.1430, 0.1422, 0.1446],
        [0.1436, 0.1432, 0.1420, 0.1416, 0.1429, 0.1422, 0.1445],
        [0.1436, 0.1431, 0.1419, 0.1416, 0.1429, 0.1421, 0.1449],
        [0.1436, 0.1430, 0.1419, 0.1417, 0.1428, 0.1421, 0.1450],
        [0.1437, 0.1430, 0.1417, 0.1413, 0.1430, 0.1418, 0.1455]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.20618748664855957s
iter time cost:10.960171222686768s
-------------Round number: 89-------------
Evaluate global model
[running kmeans]: 6it [00:00, 249.78it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 0.4139
Averaged Test Accurancy: 0.7993
Std Test Accurancy: 0.0836
evaluate time cost:5.380927324295044s
clients training time cost:4.966852426528931s
[running kmeans]: 3it [00:00, 333.01it/s, center_shift=0.000000, iteration=3, tol=0.000100]
attn_optimize time cost:0.3799464702606201s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0915, 0.0914, 0.0912, 0.0903, 0.0912, 0.0905, 0.0913, 0.0912, 0.0901,
         0.0907, 0.0907],
        [0.0915, 0.0915, 0.0912, 0.0902, 0.0911, 0.0904, 0.0912, 0.0912, 0.0901,
         0.0908, 0.0906],
        [0.0916, 0.0914, 0.0912, 0.0903, 0.0911, 0.0905, 0.0913, 0.0912, 0.0900,
         0.0908, 0.0906],
        [0.0915, 0.0914, 0.0912, 0.0903, 0.0912, 0.0906, 0.0913, 0.0912, 0.0901,
         0.0908, 0.0906],
        [0.0915, 0.0913, 0.0912, 0.0904, 0.0912, 0.0906, 0.0913, 0.0912, 0.0901,
         0.0907, 0.0906],
        [0.0915, 0.0914, 0.0912, 0.0903, 0.0912, 0.0905, 0.0913, 0.0912, 0.0901,
         0.0907, 0.0906],
        [0.0915, 0.0914, 0.0913, 0.0903, 0.0912, 0.0905, 0.0913, 0.0911, 0.0901,
         0.0907, 0.0906],
        [0.0915, 0.0915, 0.0913, 0.0903, 0.0911, 0.0904, 0.0913, 0.0912, 0.0900,
         0.0907, 0.0907],
        [0.0915, 0.0915, 0.0913, 0.0903, 0.0911, 0.0905, 0.0912, 0.0912, 0.0900,
         0.0908, 0.0906],
        [0.0915, 0.0915, 0.0912, 0.0903, 0.0911, 0.0905, 0.0912, 0.0912, 0.0901,
         0.0908, 0.0906],
        [0.0915, 0.0914, 0.0912, 0.0904, 0.0911, 0.0906, 0.0912, 0.0912, 0.0901,
         0.0907, 0.0907]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5011, 0.4989],
        [0.5011, 0.4989]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0502, 0.0500,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0498,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0504],
        [0.0499, 0.0504, 0.0497, 0.0502, 0.0497, 0.0500, 0.0498, 0.0496, 0.0497,
         0.0498, 0.0500, 0.0498, 0.0502, 0.0501, 0.0504, 0.0497, 0.0501, 0.0498,
         0.0500, 0.0512]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1671, 0.1663, 0.1667, 0.1673, 0.1672, 0.1654],
        [0.1670, 0.1661, 0.1667, 0.1674, 0.1673, 0.1655],
        [0.1669, 0.1664, 0.1667, 0.1674, 0.1671, 0.1655],
        [0.1671, 0.1663, 0.1667, 0.1674, 0.1670, 0.1655],
        [0.1670, 0.1661, 0.1667, 0.1674, 0.1672, 0.1655],
        [0.1670, 0.1658, 0.1664, 0.1675, 0.1674, 0.1658]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1655, 0.1672, 0.1669, 0.1684, 0.1675, 0.1646],
        [0.1654, 0.1672, 0.1668, 0.1681, 0.1672, 0.1653],
        [0.1655, 0.1671, 0.1668, 0.1682, 0.1674, 0.1649],
        [0.1653, 0.1672, 0.1668, 0.1682, 0.1672, 0.1653],
        [0.1654, 0.1671, 0.1668, 0.1682, 0.1672, 0.1654],
        [0.1648, 0.1672, 0.1665, 0.1687, 0.1680, 0.1649]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0715, 0.0718, 0.0713, 0.0714, 0.0711, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0713, 0.0713, 0.0714, 0.0715, 0.0717],
        [0.0715, 0.0718, 0.0712, 0.0714, 0.0712, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0713, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0715, 0.0718, 0.0712, 0.0715, 0.0711, 0.0714, 0.0714, 0.0715, 0.0715,
         0.0713, 0.0712, 0.0713, 0.0715, 0.0717],
        [0.0715, 0.0718, 0.0712, 0.0714, 0.0711, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0714, 0.0718, 0.0712, 0.0715, 0.0712, 0.0714, 0.0714, 0.0715, 0.0714,
         0.0713, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0715, 0.0718, 0.0712, 0.0715, 0.0711, 0.0714, 0.0714, 0.0715, 0.0715,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0718],
        [0.0715, 0.0718, 0.0713, 0.0714, 0.0712, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0713, 0.0712, 0.0713, 0.0715, 0.0717],
        [0.0715, 0.0719, 0.0713, 0.0714, 0.0711, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0714, 0.0712, 0.0714, 0.0715, 0.0717],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0714, 0.0715, 0.0715, 0.0715,
         0.0713, 0.0712, 0.0714, 0.0715, 0.0717],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0714, 0.0714, 0.0715, 0.0714,
         0.0714, 0.0713, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0719, 0.0712, 0.0715, 0.0712, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0713, 0.0712, 0.0713, 0.0715, 0.0717],
        [0.0715, 0.0718, 0.0713, 0.0715, 0.0712, 0.0714, 0.0715, 0.0715, 0.0715,
         0.0713, 0.0713, 0.0714, 0.0715, 0.0717],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0715, 0.0719, 0.0713, 0.0714, 0.0712, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3336, 0.3327, 0.3337],
        [0.3336, 0.3328, 0.3336],
        [0.3336, 0.3328, 0.3336]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2510, 0.2510, 0.2519, 0.2461],
        [0.2507, 0.2506, 0.2516, 0.2472],
        [0.2506, 0.2506, 0.2516, 0.2472],
        [0.2509, 0.2513, 0.2515, 0.2464]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0503, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0503, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0503, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0497, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0503, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0503, 0.0499, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0498, 0.0500, 0.0504, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0716, 0.0714, 0.0717, 0.0715, 0.0716, 0.0712, 0.0712, 0.0714, 0.0716,
         0.0713, 0.0712, 0.0717, 0.0714, 0.0711],
        [0.0716, 0.0715, 0.0717, 0.0715, 0.0716, 0.0713, 0.0712, 0.0714, 0.0716,
         0.0713, 0.0712, 0.0717, 0.0714, 0.0711],
        [0.0716, 0.0715, 0.0717, 0.0714, 0.0717, 0.0712, 0.0712, 0.0714, 0.0716,
         0.0713, 0.0712, 0.0717, 0.0714, 0.0711],
        [0.0715, 0.0714, 0.0717, 0.0715, 0.0717, 0.0713, 0.0712, 0.0713, 0.0716,
         0.0713, 0.0713, 0.0717, 0.0714, 0.0711],
        [0.0716, 0.0715, 0.0717, 0.0715, 0.0716, 0.0712, 0.0712, 0.0714, 0.0716,
         0.0714, 0.0712, 0.0718, 0.0714, 0.0711],
        [0.0716, 0.0714, 0.0717, 0.0715, 0.0716, 0.0713, 0.0712, 0.0714, 0.0716,
         0.0713, 0.0713, 0.0717, 0.0714, 0.0710],
        [0.0715, 0.0715, 0.0716, 0.0714, 0.0716, 0.0712, 0.0712, 0.0714, 0.0716,
         0.0713, 0.0712, 0.0718, 0.0714, 0.0711],
        [0.0716, 0.0714, 0.0717, 0.0715, 0.0717, 0.0713, 0.0712, 0.0714, 0.0716,
         0.0713, 0.0712, 0.0717, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0716, 0.0715, 0.0716, 0.0713, 0.0712, 0.0714, 0.0716,
         0.0713, 0.0712, 0.0718, 0.0714, 0.0712],
        [0.0716, 0.0715, 0.0717, 0.0715, 0.0716, 0.0713, 0.0712, 0.0714, 0.0716,
         0.0714, 0.0712, 0.0717, 0.0714, 0.0711],
        [0.0716, 0.0714, 0.0717, 0.0715, 0.0716, 0.0713, 0.0712, 0.0714, 0.0716,
         0.0714, 0.0712, 0.0717, 0.0714, 0.0711],
        [0.0716, 0.0715, 0.0717, 0.0714, 0.0716, 0.0713, 0.0712, 0.0714, 0.0716,
         0.0713, 0.0712, 0.0717, 0.0714, 0.0711],
        [0.0716, 0.0714, 0.0717, 0.0715, 0.0716, 0.0713, 0.0712, 0.0714, 0.0715,
         0.0713, 0.0713, 0.0717, 0.0714, 0.0711],
        [0.0716, 0.0714, 0.0717, 0.0714, 0.0716, 0.0713, 0.0712, 0.0714, 0.0716,
         0.0714, 0.0713, 0.0717, 0.0714, 0.0711]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.33830738067626953s
iter time cost:11.138099431991577s
-------------Round number: 90-------------
Evaluate global model
Averaged Train Loss: 0.4021
Averaged Test Accurancy: 0.7936
Std Test Accurancy: 0.0889
evaluate time cost:5.062212944030762s
[running kmeans]: 5it [00:00, 333.01it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:4.789936065673828s
attn_optimize time cost:0.4210035800933838s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0772, 0.0769, 0.0770, 0.0771, 0.0766, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0769, 0.0770, 0.0767, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0770, 0.0771, 0.0766, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0775, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0768, 0.0770, 0.0770, 0.0768, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0768, 0.0770, 0.0771, 0.0767, 0.0766, 0.0769, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0768, 0.0769],
        [0.0772, 0.0769, 0.0770, 0.0770, 0.0766, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0769, 0.0770, 0.0767, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0768, 0.0770, 0.0770, 0.0767, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0768, 0.0769],
        [0.0772, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0770, 0.0770, 0.0767, 0.0767, 0.0769, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1428, 0.1427, 0.1426, 0.1426, 0.1437, 0.1425],
        [0.1432, 0.1426, 0.1427, 0.1425, 0.1426, 0.1437, 0.1427],
        [0.1430, 0.1427, 0.1429, 0.1427, 0.1424, 0.1436, 0.1426],
        [0.1432, 0.1427, 0.1428, 0.1427, 0.1425, 0.1437, 0.1424],
        [0.1431, 0.1427, 0.1428, 0.1426, 0.1425, 0.1436, 0.1427],
        [0.1432, 0.1427, 0.1429, 0.1426, 0.1425, 0.1436, 0.1426],
        [0.1434, 0.1427, 0.1429, 0.1425, 0.1426, 0.1437, 0.1421]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1665, 0.1660, 0.1665, 0.1672, 0.1668, 0.1670],
        [0.1665, 0.1657, 0.1666, 0.1674, 0.1667, 0.1671],
        [0.1665, 0.1660, 0.1667, 0.1674, 0.1665, 0.1669],
        [0.1667, 0.1659, 0.1666, 0.1673, 0.1667, 0.1668],
        [0.1666, 0.1659, 0.1666, 0.1672, 0.1666, 0.1671],
        [0.1665, 0.1658, 0.1667, 0.1674, 0.1666, 0.1671]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2501, 0.2507, 0.2501, 0.2492],
        [0.2500, 0.2507, 0.2501, 0.2492],
        [0.2501, 0.2506, 0.2500, 0.2493],
        [0.2500, 0.2507, 0.2500, 0.2493]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1106, 0.1111, 0.1108, 0.1112, 0.1107, 0.1111, 0.1119, 0.1115, 0.1111],
        [0.1106, 0.1111, 0.1108, 0.1113, 0.1107, 0.1111, 0.1118, 0.1115, 0.1111],
        [0.1106, 0.1112, 0.1108, 0.1112, 0.1107, 0.1112, 0.1119, 0.1115, 0.1110],
        [0.1106, 0.1111, 0.1108, 0.1111, 0.1107, 0.1111, 0.1120, 0.1114, 0.1111],
        [0.1106, 0.1111, 0.1108, 0.1112, 0.1108, 0.1111, 0.1119, 0.1114, 0.1111],
        [0.1106, 0.1111, 0.1108, 0.1111, 0.1107, 0.1111, 0.1119, 0.1115, 0.1111],
        [0.1106, 0.1112, 0.1107, 0.1112, 0.1107, 0.1111, 0.1118, 0.1116, 0.1111],
        [0.1105, 0.1110, 0.1108, 0.1112, 0.1108, 0.1110, 0.1119, 0.1115, 0.1113],
        [0.1105, 0.1111, 0.1108, 0.1112, 0.1107, 0.1110, 0.1120, 0.1115, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1430, 0.1419, 0.1416, 0.1428, 0.1421, 0.1450],
        [0.1436, 0.1432, 0.1418, 0.1417, 0.1428, 0.1421, 0.1447],
        [0.1436, 0.1430, 0.1419, 0.1416, 0.1429, 0.1421, 0.1448],
        [0.1436, 0.1431, 0.1419, 0.1417, 0.1429, 0.1422, 0.1447],
        [0.1436, 0.1430, 0.1417, 0.1417, 0.1428, 0.1421, 0.1451],
        [0.1435, 0.1429, 0.1418, 0.1417, 0.1427, 0.1420, 0.1452],
        [0.1437, 0.1430, 0.1416, 0.1413, 0.1429, 0.1417, 0.1458]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0499, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0500, 0.0497, 0.0500, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0504, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0503, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0504, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0500, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0499, 0.0504, 0.0501, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0499,
         0.0501, 0.0495, 0.0500, 0.0506, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0769, 0.0770, 0.0768, 0.0770, 0.0769, 0.0769, 0.0770, 0.0769,
         0.0768, 0.0772, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0768, 0.0773, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0770, 0.0767, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0768, 0.0773, 0.0770, 0.0767],
        [0.0769, 0.0769, 0.0770, 0.0768, 0.0771, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0768, 0.0773, 0.0770, 0.0767],
        [0.0769, 0.0769, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0773, 0.0770, 0.0767],
        [0.0769, 0.0770, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0768, 0.0773, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0770, 0.0768, 0.0771, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0768, 0.0773, 0.0771, 0.0767],
        [0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0768, 0.0773, 0.0770, 0.0768],
        [0.0770, 0.0769, 0.0769, 0.0767, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0768, 0.0773, 0.0771, 0.0766],
        [0.0770, 0.0769, 0.0769, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0772, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0768, 0.0773, 0.0770, 0.0767],
        [0.0770, 0.0769, 0.0770, 0.0768, 0.0770, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0773, 0.0771, 0.0767],
        [0.0770, 0.0769, 0.0770, 0.0767, 0.0770, 0.0768, 0.0769, 0.0770, 0.0769,
         0.0769, 0.0773, 0.0770, 0.0767]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0505, 0.0495, 0.0499, 0.0499, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0492],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0493],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0497],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0504, 0.0496, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0496, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0502,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0495],
        [0.0501, 0.0505, 0.0493, 0.0499, 0.0500, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0505, 0.0502,
         0.0504, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2632272243499756s
iter time cost:10.615451097488403s
-------------Round number: 91-------------
Evaluate global model
Averaged Train Loss: 0.3989
Averaged Test Accurancy: 0.7959
Std Test Accurancy: 0.0951
evaluate time cost:5.356815576553345s
clients training time cost:4.70515251159668s
attn_optimize time cost:0.4379892349243164s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0497, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0501, 0.0503, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0502, 0.0498, 0.0500, 0.0504, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0715,
         0.0714, 0.0714, 0.0714, 0.0715, 0.0716],
        [0.0715, 0.0719, 0.0711, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0714, 0.0717],
        [0.0715, 0.0719, 0.0711, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0715,
         0.0714, 0.0713, 0.0714, 0.0715, 0.0717],
        [0.0715, 0.0719, 0.0711, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0715,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0717],
        [0.0715, 0.0719, 0.0711, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0717],
        [0.0715, 0.0719, 0.0711, 0.0715, 0.0711, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0714, 0.0714, 0.0713, 0.0715, 0.0717],
        [0.0715, 0.0718, 0.0712, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0715,
         0.0713, 0.0713, 0.0714, 0.0715, 0.0717],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0715,
         0.0714, 0.0713, 0.0714, 0.0715, 0.0716],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0713, 0.0714, 0.0714, 0.0717],
        [0.0715, 0.0719, 0.0711, 0.0714, 0.0711, 0.0713, 0.0715, 0.0714, 0.0714,
         0.0715, 0.0714, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0719, 0.0711, 0.0715, 0.0712, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0712, 0.0714, 0.0715, 0.0717],
        [0.0715, 0.0718, 0.0712, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0713, 0.0714, 0.0714, 0.0717],
        [0.0715, 0.0719, 0.0711, 0.0714, 0.0711, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0714, 0.0713, 0.0713, 0.0715, 0.0717],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0715,
         0.0714, 0.0713, 0.0713, 0.0714, 0.0717]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1246, 0.1259, 0.1257, 0.1244, 0.1250, 0.1255, 0.1239, 0.1250],
        [0.1245, 0.1259, 0.1256, 0.1245, 0.1249, 0.1256, 0.1240, 0.1249],
        [0.1246, 0.1258, 0.1257, 0.1244, 0.1250, 0.1255, 0.1240, 0.1250],
        [0.1247, 0.1259, 0.1257, 0.1244, 0.1250, 0.1254, 0.1239, 0.1250],
        [0.1246, 0.1259, 0.1257, 0.1244, 0.1250, 0.1255, 0.1240, 0.1249],
        [0.1246, 0.1259, 0.1257, 0.1245, 0.1249, 0.1255, 0.1240, 0.1249],
        [0.1245, 0.1259, 0.1257, 0.1244, 0.1249, 0.1255, 0.1240, 0.1250],
        [0.1246, 0.1259, 0.1256, 0.1245, 0.1249, 0.1255, 0.1240, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0670, 0.0666, 0.0668, 0.0667, 0.0668, 0.0666, 0.0664, 0.0665, 0.0667,
         0.0666, 0.0665, 0.0666, 0.0670, 0.0666, 0.0664],
        [0.0670, 0.0666, 0.0668, 0.0667, 0.0668, 0.0667, 0.0663, 0.0665, 0.0668,
         0.0666, 0.0665, 0.0666, 0.0670, 0.0666, 0.0664],
        [0.0670, 0.0666, 0.0668, 0.0667, 0.0669, 0.0666, 0.0663, 0.0665, 0.0667,
         0.0666, 0.0665, 0.0667, 0.0670, 0.0666, 0.0664],
        [0.0669, 0.0666, 0.0668, 0.0667, 0.0669, 0.0667, 0.0663, 0.0665, 0.0668,
         0.0666, 0.0666, 0.0666, 0.0670, 0.0666, 0.0664],
        [0.0670, 0.0666, 0.0668, 0.0667, 0.0668, 0.0666, 0.0663, 0.0665, 0.0668,
         0.0666, 0.0665, 0.0667, 0.0671, 0.0666, 0.0664],
        [0.0670, 0.0666, 0.0667, 0.0668, 0.0668, 0.0667, 0.0663, 0.0666, 0.0668,
         0.0666, 0.0665, 0.0667, 0.0670, 0.0667, 0.0664],
        [0.0669, 0.0667, 0.0667, 0.0667, 0.0668, 0.0666, 0.0664, 0.0665, 0.0668,
         0.0666, 0.0665, 0.0666, 0.0670, 0.0666, 0.0664],
        [0.0669, 0.0666, 0.0667, 0.0667, 0.0669, 0.0667, 0.0663, 0.0665, 0.0667,
         0.0666, 0.0666, 0.0666, 0.0670, 0.0667, 0.0665],
        [0.0670, 0.0666, 0.0667, 0.0667, 0.0668, 0.0666, 0.0663, 0.0665, 0.0668,
         0.0666, 0.0665, 0.0666, 0.0671, 0.0666, 0.0665],
        [0.0670, 0.0666, 0.0667, 0.0667, 0.0668, 0.0666, 0.0663, 0.0665, 0.0667,
         0.0666, 0.0665, 0.0667, 0.0670, 0.0667, 0.0664],
        [0.0670, 0.0666, 0.0667, 0.0668, 0.0668, 0.0666, 0.0663, 0.0665, 0.0668,
         0.0665, 0.0665, 0.0667, 0.0670, 0.0667, 0.0664],
        [0.0670, 0.0666, 0.0667, 0.0667, 0.0669, 0.0666, 0.0663, 0.0665, 0.0668,
         0.0666, 0.0665, 0.0667, 0.0670, 0.0666, 0.0664],
        [0.0670, 0.0666, 0.0668, 0.0667, 0.0668, 0.0666, 0.0663, 0.0665, 0.0668,
         0.0666, 0.0665, 0.0666, 0.0670, 0.0666, 0.0665],
        [0.0670, 0.0666, 0.0667, 0.0668, 0.0668, 0.0667, 0.0663, 0.0665, 0.0667,
         0.0666, 0.0666, 0.0666, 0.0670, 0.0667, 0.0664],
        [0.0670, 0.0666, 0.0668, 0.0667, 0.0669, 0.0667, 0.0663, 0.0665, 0.0667,
         0.0666, 0.0665, 0.0667, 0.0670, 0.0666, 0.0664]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1996, 0.2008, 0.2003, 0.2010, 0.1983],
        [0.1998, 0.2007, 0.2002, 0.2007, 0.1985],
        [0.1997, 0.2006, 0.2002, 0.2010, 0.1985],
        [0.1996, 0.2008, 0.2001, 0.2010, 0.1985],
        [0.1991, 0.2006, 0.2006, 0.2011, 0.1986]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1980, 0.2000, 0.1997, 0.2017, 0.2007],
        [0.1981, 0.2001, 0.1998, 0.2015, 0.2005],
        [0.1981, 0.2000, 0.1997, 0.2015, 0.2007],
        [0.1979, 0.2002, 0.1998, 0.2016, 0.2005],
        [0.1980, 0.2001, 0.1997, 0.2016, 0.2005]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0500, 0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0497, 0.0498, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0501, 0.0500, 0.0501, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0499, 0.0501, 0.0498,
         0.0500, 0.0507],
        [0.0501, 0.0503, 0.0496, 0.0500, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0496, 0.0501,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0499, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0506],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0501, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0503, 0.0496, 0.0501, 0.0497, 0.0498, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0496, 0.0499, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0508],
        [0.0501, 0.0503, 0.0496, 0.0500, 0.0497, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0501, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0500, 0.0499,
         0.0499, 0.0509],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0502, 0.0499,
         0.0501, 0.0505],
        [0.0501, 0.0503, 0.0497, 0.0500, 0.0497, 0.0498, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0500, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0504, 0.0496, 0.0501, 0.0496, 0.0498, 0.0499, 0.0496, 0.0498,
         0.0498, 0.0500, 0.0499, 0.0502, 0.0501, 0.0504, 0.0498, 0.0501, 0.0498,
         0.0499, 0.0512]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0912, 0.0911, 0.0914, 0.0912, 0.0900, 0.0910, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0913, 0.0911, 0.0915, 0.0912, 0.0900, 0.0909, 0.0903, 0.0913, 0.0910,
         0.0911, 0.0905],
        [0.0913, 0.0911, 0.0915, 0.0912, 0.0900, 0.0909, 0.0903, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0913, 0.0911, 0.0915, 0.0912, 0.0900, 0.0909, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0913, 0.0911, 0.0914, 0.0912, 0.0900, 0.0909, 0.0903, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0912, 0.0910, 0.0914, 0.0912, 0.0901, 0.0910, 0.0903, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0912, 0.0911, 0.0915, 0.0913, 0.0900, 0.0909, 0.0902, 0.0914, 0.0910,
         0.0911, 0.0904],
        [0.0912, 0.0911, 0.0915, 0.0912, 0.0900, 0.0909, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0912, 0.0911, 0.0914, 0.0913, 0.0900, 0.0910, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0913, 0.0911, 0.0915, 0.0912, 0.0900, 0.0909, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0912, 0.0911, 0.0914, 0.0912, 0.0901, 0.0909, 0.0903, 0.0913, 0.0909,
         0.0911, 0.0904]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28683948516845703s
iter time cost:10.919041156768799s
-------------Round number: 92-------------
Evaluate global model
[running kmeans]: 7it [00:00, 349.69it/s, center_shift=0.000000, iteration=7, tol=0.000100]
Averaged Train Loss: 0.4428
Averaged Test Accurancy: 0.7924
Std Test Accurancy: 0.0941
evaluate time cost:5.5461366176605225s
clients training time cost:4.685087442398071s
attn_optimize time cost:0.46111226081848145s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0526, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0527, 0.0524, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0526, 0.0526,
         0.0525],
        [0.0526, 0.0527, 0.0527, 0.0526, 0.0528, 0.0526, 0.0524, 0.0525, 0.0529,
         0.0527, 0.0523, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0526, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0527, 0.0523, 0.0526, 0.0527, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0525, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0527, 0.0529, 0.0527, 0.0526,
         0.0524],
        [0.0526, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0527, 0.0523, 0.0526, 0.0527, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0527, 0.0529, 0.0528, 0.0526,
         0.0524],
        [0.0526, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0526, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0526, 0.0526,
         0.0525],
        [0.0526, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0524, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0527, 0.0529, 0.0527, 0.0526,
         0.0524],
        [0.0526, 0.0527, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0525, 0.0529,
         0.0526, 0.0522, 0.0526, 0.0528, 0.0525, 0.0527, 0.0528, 0.0528, 0.0527,
         0.0524],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0524],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0527, 0.0529, 0.0527, 0.0526,
         0.0524],
        [0.0526, 0.0527, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0529,
         0.0527, 0.0523, 0.0526, 0.0528, 0.0526, 0.0526, 0.0528, 0.0527, 0.0526,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0529,
         0.0527, 0.0522, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0526, 0.0527, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0526, 0.0526,
         0.0525],
        [0.0526, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0524, 0.0525, 0.0529,
         0.0526, 0.0522, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0524],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0525, 0.0529,
         0.0526, 0.0523, 0.0527, 0.0528, 0.0525, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0525, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0527, 0.0529, 0.0527, 0.0526,
         0.0524]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0502, 0.0504, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0506],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0502, 0.0504, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0499, 0.0503, 0.0498, 0.0500, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0499, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0502, 0.0504, 0.0498, 0.0500, 0.0498,
         0.0500, 0.0507],
        [0.0499, 0.0503, 0.0497, 0.0500, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0502, 0.0499, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0499, 0.0503, 0.0498, 0.0500, 0.0497, 0.0500, 0.0498, 0.0497, 0.0501,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0499, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0502, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0498,
         0.0501, 0.0507],
        [0.0499, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0502, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0499, 0.0503, 0.0499, 0.0499, 0.0502, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0502, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0499, 0.0503, 0.0498, 0.0501, 0.0496, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0499, 0.0503, 0.0498, 0.0501, 0.0496, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0502, 0.0503, 0.0497, 0.0501, 0.0498,
         0.0500, 0.0508],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0499, 0.0503, 0.0498, 0.0500, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0502, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0499, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0502, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0509],
        [0.0499, 0.0502, 0.0498, 0.0500, 0.0497, 0.0499, 0.0499, 0.0496, 0.0501,
         0.0499, 0.0503, 0.0499, 0.0499, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0505],
        [0.0499, 0.0503, 0.0498, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0499, 0.0503, 0.0498, 0.0500, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0502, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0504],
        [0.0498, 0.0504, 0.0497, 0.0501, 0.0496, 0.0500, 0.0498, 0.0496, 0.0498,
         0.0498, 0.0501, 0.0498, 0.0501, 0.0502, 0.0504, 0.0497, 0.0500, 0.0497,
         0.0500, 0.0511]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0499, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0499, 0.0505, 0.0502, 0.0505, 0.0504, 0.0504, 0.0503, 0.0494, 0.0499,
         0.0501, 0.0495, 0.0499, 0.0506, 0.0502, 0.0501, 0.0494, 0.0499, 0.0502,
         0.0497, 0.0488]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1115, 0.1112, 0.1112, 0.1113, 0.1109, 0.1110, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1108, 0.1110, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1108, 0.1110, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1112, 0.1112, 0.1113, 0.1109, 0.1110, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1112, 0.1108, 0.1111, 0.1111, 0.1107, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1108, 0.1110, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1112, 0.1112, 0.1113, 0.1108, 0.1110, 0.1110, 0.1107, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1108, 0.1110, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1108, 0.1110, 0.1110, 0.1108, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0668, 0.0671, 0.0665, 0.0666, 0.0667, 0.0663, 0.0666, 0.0667, 0.0666,
         0.0668, 0.0666, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0670, 0.0664, 0.0666, 0.0667, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0668, 0.0671, 0.0664, 0.0666, 0.0667, 0.0664, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0666, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0665, 0.0666, 0.0667, 0.0664, 0.0667, 0.0666, 0.0666,
         0.0668, 0.0666, 0.0665, 0.0665, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0664, 0.0666, 0.0667, 0.0663, 0.0666, 0.0667, 0.0667,
         0.0668, 0.0666, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0668, 0.0670, 0.0664, 0.0666, 0.0667, 0.0664, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0665, 0.0666, 0.0665, 0.0667, 0.0669],
        [0.0668, 0.0670, 0.0664, 0.0667, 0.0667, 0.0663, 0.0666, 0.0666, 0.0667,
         0.0667, 0.0666, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0668, 0.0670, 0.0665, 0.0666, 0.0667, 0.0664, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0665, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0665, 0.0666, 0.0667, 0.0664, 0.0667, 0.0667, 0.0666,
         0.0668, 0.0666, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0664, 0.0666, 0.0667, 0.0663, 0.0666, 0.0668, 0.0667,
         0.0667, 0.0665, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0664, 0.0666, 0.0667, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0666, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0668, 0.0671, 0.0664, 0.0666, 0.0667, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0666, 0.0665, 0.0665, 0.0667, 0.0669],
        [0.0668, 0.0670, 0.0665, 0.0666, 0.0667, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0665, 0.0666, 0.0666, 0.0667, 0.0669],
        [0.0668, 0.0671, 0.0664, 0.0666, 0.0667, 0.0663, 0.0667, 0.0667, 0.0666,
         0.0668, 0.0666, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0668, 0.0671, 0.0665, 0.0666, 0.0667, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0668, 0.0666, 0.0666, 0.0665, 0.0667, 0.0669]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1672, 0.1663, 0.1663, 0.1662, 0.1678, 0.1662],
        [0.1669, 0.1666, 0.1665, 0.1660, 0.1676, 0.1664],
        [0.1671, 0.1665, 0.1664, 0.1661, 0.1677, 0.1661],
        [0.1670, 0.1665, 0.1663, 0.1661, 0.1676, 0.1664],
        [0.1671, 0.1665, 0.1663, 0.1661, 0.1677, 0.1664],
        [0.1674, 0.1666, 0.1663, 0.1662, 0.1678, 0.1657]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1987, 0.2003, 0.2023, 0.2011, 0.1977],
        [0.1987, 0.2002, 0.2020, 0.2010, 0.1980],
        [0.1985, 0.2002, 0.2021, 0.2007, 0.1985],
        [0.1985, 0.2001, 0.2020, 0.2007, 0.1986],
        [0.1978, 0.1997, 0.2027, 0.2017, 0.1981]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2488, 0.2499, 0.2516, 0.2496],
        [0.2490, 0.2500, 0.2514, 0.2496],
        [0.2490, 0.2500, 0.2515, 0.2496],
        [0.2490, 0.2499, 0.2514, 0.2497]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2679708003997803s
iter time cost:11.041381359100342s
-------------Round number: 93-------------
Evaluate global model
[running kmeans]: 3it [00:00, 374.65it/s, center_shift=0.000000, iteration=3, tol=0.000100]
Averaged Train Loss: 0.4188
Averaged Test Accurancy: 0.7991
Std Test Accurancy: 0.0883
evaluate time cost:5.902796983718872s
clients training time cost:4.819135904312134s
attn_optimize time cost:0.47602009773254395s
running k-means on cuda..
device is :cuda
[running kmeans]: 5it [00:00, 333.03it/s, center_shift=0.000000, iteration=5, tol=0.000100]
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1665, 0.1681, 0.1662, 0.1670, 0.1653, 0.1669],
        [0.1663, 0.1681, 0.1663, 0.1669, 0.1654, 0.1668],
        [0.1666, 0.1680, 0.1662, 0.1671, 0.1653, 0.1669],
        [0.1665, 0.1680, 0.1662, 0.1671, 0.1654, 0.1668],
        [0.1663, 0.1681, 0.1662, 0.1669, 0.1654, 0.1670],
        [0.1665, 0.1680, 0.1664, 0.1669, 0.1654, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0909, 0.0909, 0.0907, 0.0911, 0.0907, 0.0907, 0.0910, 0.0907,
         0.0913, 0.0911],
        [0.0909, 0.0910, 0.0908, 0.0907, 0.0911, 0.0906, 0.0907, 0.0911, 0.0907,
         0.0913, 0.0910],
        [0.0909, 0.0910, 0.0908, 0.0906, 0.0912, 0.0906, 0.0907, 0.0910, 0.0907,
         0.0913, 0.0911],
        [0.0908, 0.0909, 0.0908, 0.0907, 0.0912, 0.0906, 0.0907, 0.0911, 0.0907,
         0.0914, 0.0911],
        [0.0909, 0.0910, 0.0908, 0.0907, 0.0911, 0.0906, 0.0907, 0.0911, 0.0908,
         0.0914, 0.0910],
        [0.0909, 0.0910, 0.0908, 0.0907, 0.0911, 0.0906, 0.0907, 0.0911, 0.0907,
         0.0913, 0.0910],
        [0.0909, 0.0909, 0.0908, 0.0907, 0.0912, 0.0905, 0.0907, 0.0910, 0.0907,
         0.0913, 0.0911],
        [0.0909, 0.0910, 0.0908, 0.0907, 0.0911, 0.0906, 0.0908, 0.0911, 0.0907,
         0.0914, 0.0911],
        [0.0909, 0.0910, 0.0908, 0.0907, 0.0912, 0.0905, 0.0908, 0.0911, 0.0908,
         0.0913, 0.0911],
        [0.0909, 0.0910, 0.0908, 0.0907, 0.0912, 0.0906, 0.0908, 0.0911, 0.0907,
         0.0913, 0.0910],
        [0.0910, 0.0909, 0.0908, 0.0907, 0.0912, 0.0906, 0.0907, 0.0910, 0.0907,
         0.0913, 0.0911]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2007, 0.2001, 0.1986, 0.2001, 0.2004],
        [0.2008, 0.2002, 0.1985, 0.2001, 0.2004],
        [0.2008, 0.2002, 0.1986, 0.2001, 0.2003],
        [0.2008, 0.2002, 0.1985, 0.2001, 0.2004],
        [0.2007, 0.2001, 0.1986, 0.2002, 0.2004]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1110, 0.1114, 0.1111, 0.1110, 0.1115, 0.1114, 0.1114, 0.1107, 0.1104],
        [0.1109, 0.1115, 0.1111, 0.1111, 0.1116, 0.1114, 0.1114, 0.1108, 0.1103],
        [0.1110, 0.1114, 0.1110, 0.1111, 0.1117, 0.1114, 0.1115, 0.1107, 0.1102],
        [0.1109, 0.1114, 0.1111, 0.1111, 0.1117, 0.1112, 0.1113, 0.1108, 0.1104],
        [0.1110, 0.1115, 0.1110, 0.1111, 0.1116, 0.1113, 0.1112, 0.1108, 0.1103],
        [0.1109, 0.1116, 0.1110, 0.1111, 0.1115, 0.1113, 0.1114, 0.1109, 0.1103],
        [0.1109, 0.1115, 0.1109, 0.1111, 0.1117, 0.1112, 0.1114, 0.1108, 0.1104],
        [0.1109, 0.1115, 0.1110, 0.1110, 0.1115, 0.1114, 0.1113, 0.1108, 0.1105],
        [0.1107, 0.1115, 0.1108, 0.1109, 0.1118, 0.1117, 0.1115, 0.1105, 0.1105]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4998, 0.5002],
        [0.4998, 0.5002]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3359, 0.3313, 0.3328],
        [0.3360, 0.3314, 0.3326],
        [0.3358, 0.3314, 0.3327]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3326, 0.3340, 0.3334],
        [0.3326, 0.3340, 0.3335],
        [0.3326, 0.3341, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0503, 0.0498, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0500, 0.0504, 0.0498, 0.0500, 0.0499,
         0.0499, 0.0508],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0502, 0.0497, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0504, 0.0498, 0.0500, 0.0498,
         0.0499, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0506],
        [0.0500, 0.0504, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0506],
        [0.0501, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0499, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0506],
        [0.0501, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0499, 0.0503, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0496, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0508],
        [0.0501, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0500, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0506],
        [0.0501, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0500, 0.0504, 0.0498, 0.0500, 0.0499,
         0.0499, 0.0509],
        [0.0501, 0.0502, 0.0498, 0.0501, 0.0497, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0499, 0.0503, 0.0499, 0.0499, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0501, 0.0503, 0.0498, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0500, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0499, 0.0505],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0497, 0.0500, 0.0499, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0499, 0.0504, 0.0497, 0.0502, 0.0497, 0.0499, 0.0499, 0.0495, 0.0497,
         0.0498, 0.0502, 0.0498, 0.0501, 0.0501, 0.0504, 0.0498, 0.0500, 0.0498,
         0.0499, 0.0511]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0251, 0.0250, 0.0250,  ..., 0.0251, 0.0249, 0.0249],
        [0.0251, 0.0250, 0.0250,  ..., 0.0251, 0.0249, 0.0249],
        [0.0251, 0.0250, 0.0250,  ..., 0.0251, 0.0249, 0.0249],
        ...,
        [0.0251, 0.0251, 0.0251,  ..., 0.0251, 0.0249, 0.0246],
        [0.0251, 0.0251, 0.0251,  ..., 0.0250, 0.0250, 0.0247],
        [0.0251, 0.0250, 0.0252,  ..., 0.0251, 0.0251, 0.0246]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3989863395690918s
iter time cost:11.675009489059448s
-------------Round number: 94-------------
Evaluate global model
Averaged Train Loss: 0.3600
Averaged Test Accurancy: 0.8064
Std Test Accurancy: 0.0847
evaluate time cost:5.2632811069488525s
clients training time cost:4.783917188644409s
attn_optimize time cost:0.6773843765258789s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1994, 0.1996, 0.2000, 0.2010, 0.2000],
        [0.1994, 0.1997, 0.2001, 0.2009, 0.1999],
        [0.1995, 0.1999, 0.1999, 0.2011, 0.1996],
        [0.1994, 0.1997, 0.2000, 0.2011, 0.1998],
        [0.1993, 0.1998, 0.2000, 0.2011, 0.1998]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0772, 0.0769, 0.0770, 0.0771, 0.0766, 0.0766, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0769, 0.0770, 0.0767, 0.0766, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0772, 0.0769, 0.0770, 0.0771, 0.0767, 0.0766, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0770, 0.0770, 0.0771, 0.0767, 0.0766, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0772, 0.0769, 0.0770, 0.0771, 0.0766, 0.0766, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0768, 0.0770, 0.0770, 0.0768, 0.0765, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0769, 0.0770, 0.0771, 0.0767, 0.0765, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0770, 0.0771, 0.0766, 0.0766, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0769, 0.0771, 0.0767, 0.0766, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0772, 0.0769, 0.0770, 0.0771, 0.0767, 0.0766, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0770, 0.0771, 0.0767, 0.0766, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0770, 0.0771, 0.0767, 0.0766, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0772, 0.0769, 0.0770, 0.0771, 0.0767, 0.0766, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0669, 0.0666, 0.0669, 0.0666, 0.0668, 0.0665, 0.0665, 0.0668, 0.0667,
         0.0665, 0.0666, 0.0666, 0.0669, 0.0667, 0.0665],
        [0.0669, 0.0666, 0.0669, 0.0666, 0.0668, 0.0664, 0.0665, 0.0668, 0.0667,
         0.0664, 0.0666, 0.0666, 0.0670, 0.0667, 0.0665],
        [0.0669, 0.0666, 0.0669, 0.0666, 0.0669, 0.0664, 0.0665, 0.0668, 0.0667,
         0.0664, 0.0665, 0.0666, 0.0669, 0.0667, 0.0665],
        [0.0669, 0.0666, 0.0669, 0.0666, 0.0669, 0.0664, 0.0665, 0.0669, 0.0666,
         0.0664, 0.0666, 0.0666, 0.0670, 0.0667, 0.0665],
        [0.0669, 0.0666, 0.0669, 0.0666, 0.0668, 0.0664, 0.0666, 0.0668, 0.0667,
         0.0664, 0.0665, 0.0666, 0.0670, 0.0667, 0.0665],
        [0.0668, 0.0666, 0.0668, 0.0666, 0.0668, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0664, 0.0666, 0.0666, 0.0670, 0.0667, 0.0665],
        [0.0669, 0.0666, 0.0668, 0.0666, 0.0669, 0.0664, 0.0666, 0.0668, 0.0667,
         0.0664, 0.0666, 0.0666, 0.0669, 0.0668, 0.0665],
        [0.0669, 0.0666, 0.0668, 0.0666, 0.0668, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0664, 0.0666, 0.0666, 0.0670, 0.0667, 0.0666],
        [0.0669, 0.0666, 0.0669, 0.0666, 0.0669, 0.0664, 0.0665, 0.0668, 0.0667,
         0.0664, 0.0666, 0.0666, 0.0669, 0.0668, 0.0664],
        [0.0670, 0.0666, 0.0669, 0.0666, 0.0669, 0.0664, 0.0665, 0.0668, 0.0666,
         0.0664, 0.0666, 0.0666, 0.0669, 0.0668, 0.0664],
        [0.0669, 0.0666, 0.0668, 0.0666, 0.0668, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0664, 0.0666, 0.0666, 0.0669, 0.0668, 0.0664],
        [0.0669, 0.0666, 0.0668, 0.0666, 0.0669, 0.0664, 0.0666, 0.0668, 0.0667,
         0.0664, 0.0666, 0.0667, 0.0669, 0.0667, 0.0665],
        [0.0669, 0.0666, 0.0669, 0.0666, 0.0668, 0.0664, 0.0666, 0.0668, 0.0667,
         0.0664, 0.0666, 0.0666, 0.0669, 0.0667, 0.0665],
        [0.0669, 0.0666, 0.0669, 0.0666, 0.0668, 0.0664, 0.0665, 0.0668, 0.0667,
         0.0665, 0.0666, 0.0666, 0.0669, 0.0668, 0.0665],
        [0.0669, 0.0666, 0.0669, 0.0666, 0.0669, 0.0664, 0.0665, 0.0668, 0.0667,
         0.0664, 0.0666, 0.0667, 0.0670, 0.0667, 0.0665]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4978, 0.5022],
        [0.4979, 0.5021]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0496, 0.0502, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0496, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0497, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0502, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0497, 0.0501, 0.0498, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0497, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0502, 0.0497, 0.0499, 0.0499, 0.0496, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0502, 0.0498, 0.0499, 0.0499, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0504],
        [0.0500, 0.0504, 0.0496, 0.0501, 0.0498, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0496, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0502, 0.0500,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0498, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0502, 0.0500,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0496, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0497, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0500,
         0.0501, 0.0505],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0498, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0502, 0.0500,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0498, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0501, 0.0504],
        [0.0499, 0.0505, 0.0495, 0.0502, 0.0497, 0.0499, 0.0499, 0.0495, 0.0497,
         0.0497, 0.0500, 0.0498, 0.0502, 0.0502, 0.0505, 0.0497, 0.0501, 0.0498,
         0.0500, 0.0511]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1426, 0.1426, 0.1426, 0.1426, 0.1437, 0.1425],
        [0.1434, 0.1425, 0.1427, 0.1425, 0.1426, 0.1437, 0.1427],
        [0.1432, 0.1425, 0.1429, 0.1427, 0.1424, 0.1436, 0.1426],
        [0.1434, 0.1426, 0.1428, 0.1427, 0.1425, 0.1436, 0.1424],
        [0.1433, 0.1425, 0.1428, 0.1426, 0.1425, 0.1436, 0.1427],
        [0.1433, 0.1425, 0.1429, 0.1426, 0.1425, 0.1436, 0.1426],
        [0.1437, 0.1425, 0.1429, 0.1426, 0.1427, 0.1437, 0.1419]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0834, 0.0839, 0.0830, 0.0833, 0.0830, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0837],
        [0.0834, 0.0838, 0.0830, 0.0834, 0.0831, 0.0832, 0.0833, 0.0833, 0.0832,
         0.0832, 0.0833, 0.0837],
        [0.0834, 0.0839, 0.0830, 0.0834, 0.0830, 0.0833, 0.0833, 0.0833, 0.0831,
         0.0832, 0.0834, 0.0837],
        [0.0834, 0.0839, 0.0830, 0.0834, 0.0830, 0.0832, 0.0833, 0.0834, 0.0832,
         0.0832, 0.0834, 0.0837],
        [0.0834, 0.0838, 0.0829, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0832,
         0.0832, 0.0834, 0.0837],
        [0.0834, 0.0838, 0.0830, 0.0834, 0.0830, 0.0832, 0.0832, 0.0834, 0.0833,
         0.0831, 0.0834, 0.0838],
        [0.0834, 0.0838, 0.0830, 0.0834, 0.0831, 0.0833, 0.0833, 0.0833, 0.0831,
         0.0832, 0.0834, 0.0836],
        [0.0834, 0.0839, 0.0829, 0.0834, 0.0830, 0.0832, 0.0833, 0.0834, 0.0832,
         0.0832, 0.0833, 0.0838],
        [0.0834, 0.0839, 0.0830, 0.0834, 0.0831, 0.0832, 0.0833, 0.0833, 0.0831,
         0.0832, 0.0834, 0.0837],
        [0.0834, 0.0838, 0.0830, 0.0834, 0.0831, 0.0832, 0.0834, 0.0832, 0.0832,
         0.0832, 0.0833, 0.0837],
        [0.0834, 0.0839, 0.0830, 0.0834, 0.0830, 0.0832, 0.0832, 0.0834, 0.0832,
         0.0832, 0.0834, 0.0837],
        [0.0834, 0.0839, 0.0830, 0.0834, 0.0831, 0.0832, 0.0833, 0.0834, 0.0832,
         0.0832, 0.0833, 0.0837]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1998, 0.2009, 0.2001, 0.2009, 0.1983],
        [0.2000, 0.2010, 0.2000, 0.2006, 0.1984],
        [0.1998, 0.2008, 0.1999, 0.2009, 0.1985],
        [0.1997, 0.2011, 0.1999, 0.2009, 0.1984],
        [0.1992, 0.2010, 0.2003, 0.2010, 0.1984]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0501, 0.0495, 0.0500, 0.0502,
         0.0499, 0.0491],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0503, 0.0502, 0.0504, 0.0504, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0500, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0501, 0.0501, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0501, 0.0501, 0.0496, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0499, 0.0505, 0.0501, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0499,
         0.0501, 0.0495, 0.0500, 0.0505, 0.0502, 0.0501, 0.0494, 0.0500, 0.0502,
         0.0498, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2988145351409912s
iter time cost:11.117234706878662s
-------------Round number: 95-------------
Evaluate global model
[running kmeans]: 6it [00:00, 299.74it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 0.3789
Averaged Test Accurancy: 0.8050
Std Test Accurancy: 0.0945
evaluate time cost:5.948123216629028s
clients training time cost:4.900442123413086s
attn_optimize time cost:0.44254088401794434s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1001, 0.1006, 0.0998, 0.1000, 0.0994, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1004],
        [0.1001, 0.1006, 0.0997, 0.1001, 0.0995, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1005],
        [0.1001, 0.1006, 0.0996, 0.1001, 0.0994, 0.1000, 0.0999, 0.0999, 0.1000,
         0.1004],
        [0.1001, 0.1006, 0.0997, 0.1000, 0.0994, 0.0999, 0.0999, 0.0998, 0.1000,
         0.1005],
        [0.1000, 0.1006, 0.0996, 0.1001, 0.0995, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1004],
        [0.1001, 0.1006, 0.0996, 0.1001, 0.0994, 0.0999, 0.0999, 0.0998, 0.1000,
         0.1005],
        [0.1001, 0.1005, 0.0997, 0.1000, 0.0995, 0.1000, 0.1000, 0.0998, 0.1000,
         0.1003],
        [0.1001, 0.1005, 0.0997, 0.1001, 0.0995, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1004],
        [0.1001, 0.1007, 0.0997, 0.1001, 0.0994, 0.0999, 0.0999, 0.0998, 0.1000,
         0.1004],
        [0.1001, 0.1006, 0.0997, 0.1000, 0.0995, 0.0999, 0.0999, 0.0998, 0.1000,
         0.1004]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1665, 0.1660, 0.1668, 0.1664, 0.1669, 0.1674],
        [0.1664, 0.1659, 0.1670, 0.1665, 0.1668, 0.1675],
        [0.1665, 0.1659, 0.1669, 0.1664, 0.1668, 0.1675],
        [0.1665, 0.1660, 0.1669, 0.1665, 0.1668, 0.1674],
        [0.1666, 0.1659, 0.1668, 0.1664, 0.1668, 0.1675],
        [0.1664, 0.1659, 0.1667, 0.1666, 0.1668, 0.1676]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2010, 0.1999, 0.2005, 0.1987],
        [0.1999, 0.2009, 0.2001, 0.2004, 0.1987],
        [0.1999, 0.2007, 0.2000, 0.2007, 0.1987],
        [0.2000, 0.2009, 0.1999, 0.2006, 0.1986],
        [0.1994, 0.2008, 0.2004, 0.2007, 0.1987]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0668, 0.0667, 0.0668, 0.0666, 0.0669, 0.0666, 0.0665, 0.0667, 0.0668,
         0.0668, 0.0665, 0.0665, 0.0670, 0.0666, 0.0664],
        [0.0668, 0.0667, 0.0667, 0.0667, 0.0668, 0.0666, 0.0664, 0.0667, 0.0668,
         0.0668, 0.0665, 0.0665, 0.0670, 0.0665, 0.0664],
        [0.0668, 0.0667, 0.0668, 0.0666, 0.0669, 0.0666, 0.0665, 0.0667, 0.0668,
         0.0668, 0.0664, 0.0666, 0.0670, 0.0666, 0.0664],
        [0.0667, 0.0666, 0.0667, 0.0666, 0.0669, 0.0666, 0.0665, 0.0667, 0.0668,
         0.0668, 0.0665, 0.0665, 0.0670, 0.0666, 0.0664],
        [0.0668, 0.0667, 0.0667, 0.0666, 0.0668, 0.0666, 0.0665, 0.0667, 0.0668,
         0.0668, 0.0665, 0.0666, 0.0670, 0.0665, 0.0664],
        [0.0668, 0.0666, 0.0667, 0.0667, 0.0668, 0.0666, 0.0665, 0.0667, 0.0668,
         0.0668, 0.0665, 0.0665, 0.0670, 0.0666, 0.0663],
        [0.0667, 0.0667, 0.0667, 0.0666, 0.0668, 0.0666, 0.0665, 0.0667, 0.0668,
         0.0668, 0.0665, 0.0665, 0.0670, 0.0666, 0.0664],
        [0.0668, 0.0666, 0.0667, 0.0667, 0.0669, 0.0666, 0.0664, 0.0667, 0.0668,
         0.0668, 0.0665, 0.0665, 0.0670, 0.0666, 0.0664],
        [0.0668, 0.0667, 0.0667, 0.0666, 0.0668, 0.0666, 0.0665, 0.0667, 0.0668,
         0.0668, 0.0665, 0.0665, 0.0670, 0.0665, 0.0665],
        [0.0668, 0.0667, 0.0667, 0.0666, 0.0669, 0.0666, 0.0665, 0.0667, 0.0668,
         0.0668, 0.0664, 0.0666, 0.0670, 0.0666, 0.0663],
        [0.0668, 0.0667, 0.0668, 0.0666, 0.0669, 0.0667, 0.0664, 0.0667, 0.0668,
         0.0668, 0.0664, 0.0665, 0.0670, 0.0666, 0.0663],
        [0.0668, 0.0667, 0.0667, 0.0666, 0.0669, 0.0666, 0.0664, 0.0667, 0.0668,
         0.0668, 0.0665, 0.0666, 0.0670, 0.0665, 0.0664],
        [0.0668, 0.0667, 0.0667, 0.0666, 0.0669, 0.0666, 0.0665, 0.0667, 0.0668,
         0.0668, 0.0665, 0.0665, 0.0670, 0.0665, 0.0664],
        [0.0668, 0.0666, 0.0667, 0.0667, 0.0668, 0.0667, 0.0664, 0.0667, 0.0667,
         0.0668, 0.0665, 0.0665, 0.0670, 0.0666, 0.0664],
        [0.0668, 0.0666, 0.0667, 0.0666, 0.0669, 0.0666, 0.0664, 0.0667, 0.0668,
         0.0668, 0.0664, 0.0666, 0.0670, 0.0665, 0.0664]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0526, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0527, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0526, 0.0525, 0.0526, 0.0526, 0.0525, 0.0528, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0526, 0.0526, 0.0530, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0527, 0.0524,
         0.0525, 0.0525, 0.0527, 0.0525, 0.0526, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0525, 0.0527, 0.0525, 0.0526, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0526, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0527, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0525, 0.0525, 0.0529, 0.0525, 0.0523, 0.0531,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0525, 0.0523, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0527, 0.0526, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0526, 0.0525, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0526, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0525, 0.0527, 0.0525, 0.0526, 0.0529, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0530,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0991, 0.1002, 0.0999, 0.1004, 0.1003, 0.1003, 0.1000, 0.1009, 0.1004,
         0.0985],
        [0.0991, 0.1002, 0.0999, 0.1002, 0.1003, 0.1002, 0.0999, 0.1008, 0.1003,
         0.0991],
        [0.0991, 0.1002, 0.0999, 0.1003, 0.1003, 0.1002, 0.1000, 0.1008, 0.1004,
         0.0987],
        [0.0992, 0.1002, 0.0999, 0.1002, 0.1003, 0.1002, 0.0999, 0.1008, 0.1003,
         0.0990],
        [0.0991, 0.1003, 0.0999, 0.1003, 0.1002, 0.1002, 0.0999, 0.1009, 0.1001,
         0.0991],
        [0.0989, 0.1003, 0.0999, 0.1003, 0.1002, 0.1002, 0.1000, 0.1008, 0.1001,
         0.0993],
        [0.0991, 0.1003, 0.0999, 0.1003, 0.1002, 0.1002, 0.0999, 0.1008, 0.1003,
         0.0990],
        [0.0990, 0.1003, 0.0999, 0.1003, 0.1003, 0.1003, 0.0999, 0.1009, 0.1003,
         0.0990],
        [0.0990, 0.1002, 0.0998, 0.1003, 0.1003, 0.1002, 0.0999, 0.1009, 0.1003,
         0.0991],
        [0.0987, 0.1003, 0.0997, 0.1001, 0.1002, 0.1002, 0.0998, 0.1013, 0.1008,
         0.0989]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1673, 0.1663, 0.1649, 0.1668, 0.1656, 0.1691],
        [0.1674, 0.1666, 0.1650, 0.1667, 0.1657, 0.1686],
        [0.1673, 0.1666, 0.1650, 0.1667, 0.1657, 0.1687],
        [0.1673, 0.1664, 0.1649, 0.1667, 0.1656, 0.1691],
        [0.1673, 0.1663, 0.1651, 0.1666, 0.1655, 0.1693],
        [0.1674, 0.1663, 0.1645, 0.1668, 0.1651, 0.1699]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1245, 0.1249, 0.1253, 0.1251, 0.1257, 0.1247, 0.1248],
        [0.1250, 0.1244, 0.1248, 0.1254, 0.1251, 0.1257, 0.1247, 0.1247],
        [0.1250, 0.1245, 0.1247, 0.1254, 0.1252, 0.1258, 0.1247, 0.1248],
        [0.1250, 0.1243, 0.1248, 0.1254, 0.1252, 0.1258, 0.1247, 0.1248],
        [0.1250, 0.1244, 0.1248, 0.1253, 0.1251, 0.1257, 0.1247, 0.1249],
        [0.1250, 0.1244, 0.1248, 0.1254, 0.1251, 0.1256, 0.1248, 0.1248],
        [0.1250, 0.1244, 0.1249, 0.1254, 0.1251, 0.1257, 0.1247, 0.1249],
        [0.1249, 0.1245, 0.1248, 0.1254, 0.1251, 0.1258, 0.1247, 0.1248]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0499, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0504, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0500, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0501, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0501, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0499, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0498,
         0.0501, 0.0495, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0497, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.22120094299316406s
iter time cost:11.58937668800354s
-------------Round number: 96-------------
Evaluate global model
[running kmeans]: 4it [00:00, 399.64it/s, center_shift=0.000000, iteration=4, tol=0.000100]
Averaged Train Loss: 0.4232
Averaged Test Accurancy: 0.7985
Std Test Accurancy: 0.0882
evaluate time cost:5.299849271774292s
clients training time cost:4.8465049266815186s
attn_optimize time cost:0.4930088520050049s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0257, 0.0256, 0.0256,  ..., 0.0258, 0.0258, 0.0256],
        [0.0258, 0.0256, 0.0257,  ..., 0.0257, 0.0257, 0.0255],
        [0.0257, 0.0256, 0.0257,  ..., 0.0257, 0.0257, 0.0255],
        ...,
        [0.0257, 0.0257, 0.0257,  ..., 0.0258, 0.0257, 0.0256],
        [0.0257, 0.0257, 0.0257,  ..., 0.0257, 0.0257, 0.0255],
        [0.0257, 0.0257, 0.0258,  ..., 0.0257, 0.0257, 0.0256]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1247, 0.1259, 0.1257, 0.1245, 0.1249, 0.1256, 0.1238, 0.1250],
        [0.1246, 0.1259, 0.1257, 0.1246, 0.1249, 0.1256, 0.1238, 0.1249],
        [0.1247, 0.1258, 0.1257, 0.1245, 0.1250, 0.1255, 0.1239, 0.1250],
        [0.1248, 0.1258, 0.1257, 0.1245, 0.1250, 0.1255, 0.1238, 0.1250],
        [0.1247, 0.1259, 0.1257, 0.1245, 0.1249, 0.1256, 0.1238, 0.1249],
        [0.1246, 0.1258, 0.1257, 0.1245, 0.1249, 0.1256, 0.1239, 0.1249],
        [0.1246, 0.1259, 0.1257, 0.1245, 0.1249, 0.1256, 0.1238, 0.1251],
        [0.1247, 0.1258, 0.1256, 0.1246, 0.1249, 0.1255, 0.1239, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1430, 0.1417, 0.1416, 0.1432, 0.1420, 0.1452],
        [0.1435, 0.1432, 0.1417, 0.1417, 0.1432, 0.1420, 0.1448],
        [0.1434, 0.1430, 0.1418, 0.1417, 0.1432, 0.1419, 0.1449],
        [0.1434, 0.1432, 0.1418, 0.1417, 0.1432, 0.1420, 0.1449],
        [0.1434, 0.1430, 0.1416, 0.1417, 0.1431, 0.1419, 0.1452],
        [0.1433, 0.1430, 0.1417, 0.1418, 0.1431, 0.1418, 0.1453],
        [0.1435, 0.1430, 0.1414, 0.1414, 0.1433, 0.1415, 0.1459]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0913, 0.0910, 0.0914, 0.0912, 0.0900, 0.0910, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0913, 0.0911, 0.0915, 0.0912, 0.0900, 0.0909, 0.0902, 0.0913, 0.0909,
         0.0911, 0.0904],
        [0.0914, 0.0911, 0.0915, 0.0913, 0.0900, 0.0909, 0.0902, 0.0913, 0.0909,
         0.0911, 0.0903],
        [0.0913, 0.0910, 0.0915, 0.0912, 0.0900, 0.0909, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0913, 0.0910, 0.0915, 0.0913, 0.0900, 0.0909, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0913, 0.0910, 0.0914, 0.0912, 0.0901, 0.0910, 0.0903, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0913, 0.0910, 0.0915, 0.0913, 0.0900, 0.0909, 0.0902, 0.0914, 0.0910,
         0.0911, 0.0903],
        [0.0913, 0.0911, 0.0915, 0.0912, 0.0900, 0.0909, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0904],
        [0.0913, 0.0910, 0.0915, 0.0913, 0.0900, 0.0910, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0903],
        [0.0914, 0.0911, 0.0915, 0.0912, 0.0900, 0.0909, 0.0902, 0.0914, 0.0910,
         0.0911, 0.0904],
        [0.0913, 0.0910, 0.0915, 0.0912, 0.0900, 0.0909, 0.0902, 0.0913, 0.0909,
         0.0911, 0.0904]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1251, 0.1249, 0.1248, 0.1247, 0.1248, 0.1251, 0.1250, 0.1256],
        [0.1252, 0.1249, 0.1249, 0.1246, 0.1248, 0.1251, 0.1249, 0.1257],
        [0.1251, 0.1249, 0.1248, 0.1246, 0.1248, 0.1252, 0.1249, 0.1257],
        [0.1250, 0.1250, 0.1248, 0.1246, 0.1248, 0.1252, 0.1249, 0.1257],
        [0.1251, 0.1249, 0.1249, 0.1245, 0.1249, 0.1251, 0.1249, 0.1257],
        [0.1251, 0.1249, 0.1248, 0.1246, 0.1249, 0.1252, 0.1248, 0.1257],
        [0.1251, 0.1249, 0.1248, 0.1245, 0.1249, 0.1251, 0.1250, 0.1256],
        [0.1251, 0.1249, 0.1248, 0.1246, 0.1249, 0.1251, 0.1249, 0.1257]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0766, 0.0769, 0.0767, 0.0768, 0.0766, 0.0772, 0.0770, 0.0769,
         0.0775, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0768, 0.0766, 0.0772, 0.0770, 0.0769,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0769, 0.0766, 0.0773, 0.0770, 0.0769,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0768, 0.0766, 0.0773, 0.0770, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0768],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0768, 0.0766, 0.0772, 0.0770, 0.0770,
         0.0775, 0.0770, 0.0768, 0.0768],
        [0.0770, 0.0766, 0.0769, 0.0767, 0.0768, 0.0766, 0.0773, 0.0770, 0.0770,
         0.0774, 0.0770, 0.0768, 0.0768],
        [0.0771, 0.0765, 0.0768, 0.0767, 0.0769, 0.0765, 0.0773, 0.0770, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0768, 0.0768, 0.0766, 0.0772, 0.0770, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0771, 0.0766, 0.0769, 0.0767, 0.0768, 0.0766, 0.0772, 0.0770, 0.0769,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0766, 0.0770, 0.0767, 0.0768, 0.0766, 0.0773, 0.0769, 0.0769,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0768, 0.0767, 0.0769, 0.0767, 0.0773, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0766, 0.0768, 0.0767, 0.0769, 0.0765, 0.0773, 0.0770, 0.0769,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0768, 0.0766, 0.0773, 0.0769, 0.0770,
         0.0776, 0.0770, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3335, 0.3339, 0.3326],
        [0.3336, 0.3338, 0.3326],
        [0.3334, 0.3338, 0.3328]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1110, 0.1112, 0.1110, 0.1111, 0.1117, 0.1114, 0.1116, 0.1108, 0.1103],
        [0.1109, 0.1112, 0.1110, 0.1111, 0.1118, 0.1113, 0.1115, 0.1108, 0.1103],
        [0.1110, 0.1112, 0.1109, 0.1112, 0.1119, 0.1114, 0.1116, 0.1107, 0.1102],
        [0.1110, 0.1111, 0.1111, 0.1112, 0.1118, 0.1112, 0.1115, 0.1108, 0.1103],
        [0.1111, 0.1112, 0.1109, 0.1111, 0.1118, 0.1113, 0.1114, 0.1109, 0.1103],
        [0.1110, 0.1113, 0.1109, 0.1111, 0.1117, 0.1113, 0.1116, 0.1109, 0.1103],
        [0.1110, 0.1112, 0.1108, 0.1112, 0.1118, 0.1112, 0.1115, 0.1109, 0.1103],
        [0.1110, 0.1112, 0.1109, 0.1111, 0.1117, 0.1114, 0.1114, 0.1109, 0.1105],
        [0.1108, 0.1112, 0.1107, 0.1110, 0.1120, 0.1117, 0.1117, 0.1105, 0.1105]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.264240026473999s
iter time cost:10.996687889099121s
-------------Round number: 97-------------
Evaluate global model
[running kmeans]: 5it [00:00, 356.82it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 0.4411
Averaged Test Accurancy: 0.7943
Std Test Accurancy: 0.0880
evaluate time cost:6.036568641662598s
clients training time cost:4.867111921310425s
attn_optimize time cost:0.9400405883789062s
running k-means on cuda..
device is :cuda
device is :cuda
[running kmeans]: 4it [00:00, 333.03it/s, center_shift=0.000000, iteration=4, tol=0.000100]
device is :cuda
device is :cuda
weights:tensor([[0.1436, 0.1431, 0.1419, 0.1416, 0.1429, 0.1420, 0.1448],
        [0.1437, 0.1433, 0.1418, 0.1417, 0.1429, 0.1420, 0.1445],
        [0.1436, 0.1431, 0.1419, 0.1417, 0.1430, 0.1420, 0.1446],
        [0.1436, 0.1432, 0.1419, 0.1417, 0.1430, 0.1421, 0.1446],
        [0.1436, 0.1432, 0.1417, 0.1417, 0.1429, 0.1420, 0.1449],
        [0.1436, 0.1431, 0.1418, 0.1418, 0.1428, 0.1419, 0.1450],
        [0.1438, 0.1432, 0.1415, 0.1414, 0.1430, 0.1416, 0.1455]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1428, 0.1433, 0.1428, 0.1430, 0.1425, 0.1428],
        [0.1429, 0.1427, 0.1434, 0.1430, 0.1428, 0.1425, 0.1428],
        [0.1429, 0.1427, 0.1434, 0.1429, 0.1428, 0.1425, 0.1428],
        [0.1429, 0.1428, 0.1433, 0.1428, 0.1429, 0.1426, 0.1428],
        [0.1428, 0.1428, 0.1434, 0.1428, 0.1429, 0.1425, 0.1429],
        [0.1429, 0.1428, 0.1433, 0.1428, 0.1429, 0.1426, 0.1428],
        [0.1428, 0.1427, 0.1434, 0.1429, 0.1429, 0.1425, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1661, 0.1668, 0.1662, 0.1661, 0.1667, 0.1681],
        [0.1661, 0.1669, 0.1663, 0.1661, 0.1666, 0.1680],
        [0.1661, 0.1669, 0.1662, 0.1660, 0.1667, 0.1681],
        [0.1660, 0.1669, 0.1663, 0.1662, 0.1666, 0.1681],
        [0.1661, 0.1668, 0.1664, 0.1661, 0.1665, 0.1681],
        [0.1662, 0.1670, 0.1662, 0.1660, 0.1665, 0.1681]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0503, 0.0503,
         0.0499, 0.0495],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0499, 0.0498, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0491],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0504, 0.0502,
         0.0501, 0.0493],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0497],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0502,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0500, 0.0499, 0.0502, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0505, 0.0493, 0.0499, 0.0500, 0.0498, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0507, 0.0503,
         0.0504, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1002, 0.0998, 0.1000, 0.0994, 0.1000, 0.1004, 0.0999, 0.1005,
         0.0997],
        [0.1001, 0.1002, 0.0997, 0.1001, 0.0994, 0.1000, 0.1003, 0.1000, 0.1005,
         0.0996],
        [0.1001, 0.1002, 0.0998, 0.1001, 0.0994, 0.1000, 0.1004, 0.0999, 0.1005,
         0.0996],
        [0.1001, 0.1002, 0.0997, 0.0999, 0.0994, 0.1000, 0.1004, 0.1000, 0.1005,
         0.0996],
        [0.1002, 0.1001, 0.0997, 0.1000, 0.0995, 0.1000, 0.1004, 0.0999, 0.1005,
         0.0996],
        [0.1001, 0.1002, 0.0998, 0.1001, 0.0994, 0.1000, 0.1003, 0.0999, 0.1005,
         0.0997],
        [0.1001, 0.1001, 0.0998, 0.1000, 0.0994, 0.1000, 0.1004, 0.0999, 0.1005,
         0.0997],
        [0.1001, 0.1002, 0.0997, 0.1001, 0.0994, 0.1000, 0.1003, 0.1000, 0.1004,
         0.0997],
        [0.1001, 0.1002, 0.0997, 0.1000, 0.0995, 0.1000, 0.1004, 0.0999, 0.1005,
         0.0997],
        [0.1001, 0.1002, 0.0997, 0.1000, 0.0994, 0.1000, 0.1004, 0.1001, 0.1005,
         0.0996]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0628, 0.0627, 0.0629, 0.0628, 0.0627, 0.0627, 0.0619, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0629, 0.0627, 0.0629, 0.0628, 0.0627, 0.0627, 0.0619, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0619, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0618, 0.0622, 0.0627, 0.0622],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0626, 0.0618, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0626, 0.0622],
        [0.0628, 0.0627, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0625, 0.0617, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0626, 0.0629, 0.0628, 0.0626, 0.0626, 0.0620, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0630, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0618, 0.0622, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0629, 0.0628, 0.0627, 0.0627, 0.0619, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0625, 0.0618, 0.0622, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0630, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0625, 0.0617, 0.0622, 0.0627, 0.0622],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0627, 0.0619, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0618, 0.0623, 0.0627, 0.0622],
        [0.0628, 0.0627, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0618, 0.0622, 0.0627, 0.0622]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0500, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0501, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499,
         0.0500, 0.0497, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0497, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0503, 0.0499, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0501, 0.0505, 0.0500, 0.0498, 0.0503,
         0.0499, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5004, 0.4996],
        [0.5005, 0.4995]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2512, 0.2509, 0.2518, 0.2461],
        [0.2510, 0.2505, 0.2515, 0.2471],
        [0.2508, 0.2505, 0.2515, 0.2472],
        [0.2512, 0.2513, 0.2513, 0.2461]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1253, 0.1252, 0.1248, 0.1250, 0.1253, 0.1251, 0.1256, 0.1237],
        [0.1253, 0.1253, 0.1247, 0.1251, 0.1253, 0.1250, 0.1256, 0.1238],
        [0.1253, 0.1251, 0.1246, 0.1251, 0.1254, 0.1250, 0.1256, 0.1238],
        [0.1253, 0.1251, 0.1248, 0.1251, 0.1254, 0.1249, 0.1255, 0.1239],
        [0.1255, 0.1252, 0.1247, 0.1250, 0.1253, 0.1250, 0.1254, 0.1239],
        [0.1254, 0.1253, 0.1246, 0.1250, 0.1252, 0.1249, 0.1256, 0.1239],
        [0.1253, 0.1252, 0.1246, 0.1251, 0.1254, 0.1249, 0.1256, 0.1238],
        [0.1252, 0.1252, 0.1243, 0.1248, 0.1254, 0.1253, 0.1258, 0.1240]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2718017101287842s
iter time cost:12.207606315612793s
-------------Round number: 98-------------
Evaluate global model
Averaged Train Loss: 0.3916
Averaged Test Accurancy: 0.8017
Std Test Accurancy: 0.0908
evaluate time cost:5.13529109954834s
clients training time cost:4.795667886734009s
attn_optimize time cost:0.5747659206390381s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1251, 0.1246, 0.1250, 0.1245, 0.1255, 0.1253, 0.1248, 0.1252],
        [0.1251, 0.1246, 0.1249, 0.1246, 0.1256, 0.1254, 0.1249, 0.1250],
        [0.1251, 0.1246, 0.1249, 0.1245, 0.1256, 0.1254, 0.1248, 0.1251],
        [0.1251, 0.1246, 0.1249, 0.1246, 0.1256, 0.1253, 0.1248, 0.1250],
        [0.1251, 0.1244, 0.1250, 0.1244, 0.1256, 0.1254, 0.1249, 0.1252],
        [0.1251, 0.1246, 0.1249, 0.1246, 0.1255, 0.1253, 0.1249, 0.1252],
        [0.1251, 0.1245, 0.1250, 0.1245, 0.1256, 0.1253, 0.1249, 0.1251],
        [0.1250, 0.1246, 0.1249, 0.1246, 0.1256, 0.1254, 0.1248, 0.1252]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1427, 0.1428, 0.1434, 0.1433, 0.1433, 0.1417],
        [0.1429, 0.1424, 0.1428, 0.1436, 0.1432, 0.1434, 0.1417],
        [0.1428, 0.1427, 0.1429, 0.1436, 0.1430, 0.1432, 0.1418],
        [0.1430, 0.1425, 0.1428, 0.1436, 0.1432, 0.1431, 0.1417],
        [0.1429, 0.1425, 0.1428, 0.1435, 0.1431, 0.1434, 0.1418],
        [0.1429, 0.1424, 0.1429, 0.1437, 0.1431, 0.1433, 0.1418],
        [0.1426, 0.1422, 0.1425, 0.1437, 0.1437, 0.1435, 0.1419]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0504, 0.0503, 0.0506, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0492],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0501, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0501, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0494, 0.0500, 0.0502,
         0.0498, 0.0490],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0500, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0499, 0.0504, 0.0502, 0.0505, 0.0505, 0.0503, 0.0502, 0.0494, 0.0499,
         0.0501, 0.0495, 0.0499, 0.0506, 0.0502, 0.0501, 0.0493, 0.0500, 0.0503,
         0.0497, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1430, 0.1431, 0.1433, 0.1424, 0.1429, 0.1431, 0.1422],
        [0.1430, 0.1431, 0.1434, 0.1425, 0.1428, 0.1431, 0.1421],
        [0.1430, 0.1431, 0.1433, 0.1425, 0.1429, 0.1431, 0.1421],
        [0.1431, 0.1430, 0.1433, 0.1425, 0.1428, 0.1431, 0.1422],
        [0.1430, 0.1430, 0.1434, 0.1424, 0.1429, 0.1432, 0.1420],
        [0.1430, 0.1431, 0.1433, 0.1424, 0.1429, 0.1432, 0.1422],
        [0.1430, 0.1431, 0.1434, 0.1424, 0.1428, 0.1431, 0.1421]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1437, 0.1430, 0.1417, 0.1415, 0.1429, 0.1421, 0.1451],
        [0.1438, 0.1432, 0.1416, 0.1416, 0.1429, 0.1422, 0.1448],
        [0.1438, 0.1430, 0.1417, 0.1416, 0.1429, 0.1421, 0.1449],
        [0.1437, 0.1431, 0.1417, 0.1416, 0.1429, 0.1421, 0.1448],
        [0.1437, 0.1430, 0.1415, 0.1416, 0.1428, 0.1421, 0.1451],
        [0.1437, 0.1429, 0.1416, 0.1417, 0.1428, 0.1420, 0.1453],
        [0.1439, 0.1430, 0.1413, 0.1413, 0.1429, 0.1417, 0.1459]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0499, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0492],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0493],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0497],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0502,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0500, 0.0505, 0.0493, 0.0498, 0.0501, 0.0498, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0505, 0.0503,
         0.0504, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1668, 0.1661, 0.1668, 0.1667, 0.1661, 0.1675],
        [0.1667, 0.1661, 0.1668, 0.1668, 0.1660, 0.1676],
        [0.1668, 0.1662, 0.1667, 0.1667, 0.1661, 0.1675],
        [0.1667, 0.1661, 0.1668, 0.1668, 0.1659, 0.1676],
        [0.1667, 0.1661, 0.1669, 0.1667, 0.1662, 0.1674],
        [0.1668, 0.1661, 0.1668, 0.1668, 0.1660, 0.1676]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0525, 0.0527, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0525, 0.0528, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0525, 0.0526, 0.0525, 0.0525, 0.0528, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0525, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0527, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0526, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0527, 0.0527, 0.0528, 0.0526, 0.0528, 0.0527, 0.0524,
         0.0525, 0.0525, 0.0526, 0.0524, 0.0525, 0.0529, 0.0526, 0.0525, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0527, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0525, 0.0526, 0.0524, 0.0526, 0.0529, 0.0526, 0.0525, 0.0530,
         0.0526],
        [0.0528, 0.0525, 0.0527, 0.0527, 0.0528, 0.0527, 0.0527, 0.0526, 0.0523,
         0.0525, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0525, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0527, 0.0528, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0527, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0525, 0.0529, 0.0526, 0.0525, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0527, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0527, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0525, 0.0526, 0.0525, 0.0526, 0.0529, 0.0526, 0.0525, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0526, 0.0525, 0.0525, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0527, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0525, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0526, 0.0525, 0.0525, 0.0528, 0.0526, 0.0525, 0.0530,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1987, 0.1998, 0.1998, 0.2012, 0.2005],
        [0.1987, 0.1998, 0.1998, 0.2012, 0.2006],
        [0.1988, 0.1997, 0.1997, 0.2013, 0.2005],
        [0.1987, 0.1999, 0.1996, 0.2011, 0.2007],
        [0.1987, 0.1996, 0.1997, 0.2014, 0.2006]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3008441925048828s
iter time cost:10.902658224105835s
-------------Round number: 99-------------
Evaluate global model
[running kmeans]: 6it [00:00, 315.52it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 0.3513
Averaged Test Accurancy: 0.8084
Std Test Accurancy: 0.0925
evaluate time cost:5.59254264831543s
clients training time cost:4.783983469009399s
attn_optimize time cost:0.47051477432250977s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0498, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0498, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0502, 0.0504, 0.0497, 0.0500, 0.0500,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0503, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0502, 0.0496, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0499, 0.0502, 0.0499, 0.0501, 0.0502, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0499, 0.0502, 0.0499, 0.0501, 0.0502, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0499, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0503, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0502, 0.0504, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0506],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0503, 0.0499, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0498, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0502, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0499, 0.0496, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0495, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0499, 0.0502, 0.0499, 0.0501, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0500, 0.0500,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0501, 0.0503, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0502, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0509],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0496, 0.0498, 0.0499, 0.0495, 0.0500,
         0.0499, 0.0503, 0.0499, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0498, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0499, 0.0501, 0.0502, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0501, 0.0504],
        [0.0499, 0.0505, 0.0496, 0.0502, 0.0496, 0.0498, 0.0499, 0.0495, 0.0497,
         0.0499, 0.0501, 0.0498, 0.0502, 0.0502, 0.0504, 0.0497, 0.0500, 0.0498,
         0.0500, 0.0512]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2007, 0.2003, 0.2008, 0.1983],
        [0.2002, 0.2009, 0.2001, 0.2005, 0.1984],
        [0.2001, 0.2007, 0.2000, 0.2008, 0.1984],
        [0.2000, 0.2010, 0.1999, 0.2008, 0.1984],
        [0.1994, 0.2008, 0.2005, 0.2009, 0.1984]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0989, 0.0998, 0.0999, 0.0998, 0.1002, 0.1002, 0.1001, 0.0999, 0.1008,
         0.1003],
        [0.0990, 0.0997, 0.1000, 0.0999, 0.1002, 0.1002, 0.1001, 0.0999, 0.1008,
         0.1001],
        [0.0990, 0.0998, 0.1001, 0.0999, 0.1000, 0.1002, 0.1001, 0.0999, 0.1007,
         0.1003],
        [0.0989, 0.1000, 0.1000, 0.0998, 0.1001, 0.1002, 0.1000, 0.0999, 0.1007,
         0.1003],
        [0.0991, 0.0998, 0.1001, 0.0999, 0.1001, 0.1002, 0.1001, 0.0999, 0.1007,
         0.1002],
        [0.0989, 0.0998, 0.1001, 0.0999, 0.1002, 0.1002, 0.1001, 0.0999, 0.1008,
         0.1001],
        [0.0988, 0.0996, 0.1002, 0.1000, 0.1002, 0.1001, 0.1002, 0.1001, 0.1008,
         0.1001],
        [0.0990, 0.0997, 0.1002, 0.0999, 0.1002, 0.1001, 0.1001, 0.0999, 0.1008,
         0.1002],
        [0.0989, 0.0998, 0.1001, 0.0999, 0.1001, 0.1002, 0.1001, 0.0998, 0.1008,
         0.1002],
        [0.0989, 0.0999, 0.1000, 0.0998, 0.1002, 0.1002, 0.1000, 0.0999, 0.1008,
         0.1002]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1118, 0.1110, 0.1106, 0.1110, 0.1111, 0.1109, 0.1111, 0.1114],
        [0.1111, 0.1118, 0.1111, 0.1106, 0.1109, 0.1111, 0.1109, 0.1111, 0.1115],
        [0.1111, 0.1118, 0.1110, 0.1106, 0.1110, 0.1110, 0.1108, 0.1111, 0.1115],
        [0.1111, 0.1118, 0.1111, 0.1106, 0.1110, 0.1110, 0.1109, 0.1111, 0.1115],
        [0.1112, 0.1118, 0.1111, 0.1105, 0.1109, 0.1110, 0.1108, 0.1111, 0.1116],
        [0.1111, 0.1117, 0.1111, 0.1106, 0.1110, 0.1111, 0.1109, 0.1111, 0.1114],
        [0.1111, 0.1117, 0.1111, 0.1106, 0.1109, 0.1111, 0.1109, 0.1110, 0.1114],
        [0.1112, 0.1119, 0.1111, 0.1105, 0.1110, 0.1110, 0.1108, 0.1111, 0.1115],
        [0.1111, 0.1119, 0.1110, 0.1107, 0.1110, 0.1110, 0.1109, 0.1110, 0.1115]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1426, 0.1441, 0.1437, 0.1423, 0.1429, 0.1415, 0.1428],
        [0.1425, 0.1441, 0.1437, 0.1424, 0.1429, 0.1416, 0.1428],
        [0.1425, 0.1440, 0.1438, 0.1423, 0.1430, 0.1416, 0.1428],
        [0.1427, 0.1441, 0.1437, 0.1423, 0.1430, 0.1415, 0.1428],
        [0.1426, 0.1441, 0.1437, 0.1423, 0.1430, 0.1416, 0.1428],
        [0.1424, 0.1441, 0.1438, 0.1423, 0.1428, 0.1416, 0.1429],
        [0.1426, 0.1440, 0.1437, 0.1425, 0.1428, 0.1416, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0499, 0.0497, 0.0504,
         0.0500, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0497, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0500, 0.0500, 0.0499, 0.0504, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0497, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0498],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0497, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0497, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0499, 0.0497, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0499, 0.0497, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0497, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0497, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0501, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0505, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0668, 0.0667, 0.0669, 0.0667, 0.0668, 0.0665, 0.0666, 0.0668, 0.0667,
         0.0664, 0.0665, 0.0666, 0.0669, 0.0668, 0.0663],
        [0.0668, 0.0667, 0.0669, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0667,
         0.0664, 0.0665, 0.0666, 0.0670, 0.0667, 0.0664],
        [0.0668, 0.0667, 0.0669, 0.0667, 0.0669, 0.0665, 0.0666, 0.0668, 0.0667,
         0.0663, 0.0665, 0.0666, 0.0670, 0.0668, 0.0663],
        [0.0668, 0.0667, 0.0669, 0.0667, 0.0669, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0664, 0.0666, 0.0666, 0.0670, 0.0668, 0.0663],
        [0.0668, 0.0667, 0.0669, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0667,
         0.0664, 0.0665, 0.0666, 0.0670, 0.0667, 0.0663],
        [0.0668, 0.0668, 0.0668, 0.0667, 0.0668, 0.0665, 0.0666, 0.0669, 0.0667,
         0.0664, 0.0665, 0.0666, 0.0670, 0.0667, 0.0664],
        [0.0668, 0.0667, 0.0669, 0.0667, 0.0669, 0.0664, 0.0666, 0.0668, 0.0667,
         0.0664, 0.0666, 0.0666, 0.0670, 0.0668, 0.0664],
        [0.0668, 0.0667, 0.0668, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0667,
         0.0664, 0.0665, 0.0665, 0.0670, 0.0667, 0.0664],
        [0.0668, 0.0667, 0.0669, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0667,
         0.0664, 0.0665, 0.0666, 0.0670, 0.0668, 0.0663],
        [0.0669, 0.0667, 0.0669, 0.0667, 0.0669, 0.0664, 0.0666, 0.0669, 0.0667,
         0.0663, 0.0666, 0.0665, 0.0669, 0.0669, 0.0662],
        [0.0668, 0.0667, 0.0668, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0664, 0.0665, 0.0666, 0.0670, 0.0668, 0.0663],
        [0.0668, 0.0667, 0.0668, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0667,
         0.0664, 0.0665, 0.0666, 0.0669, 0.0668, 0.0664],
        [0.0668, 0.0667, 0.0669, 0.0667, 0.0668, 0.0665, 0.0666, 0.0669, 0.0667,
         0.0664, 0.0665, 0.0665, 0.0670, 0.0667, 0.0664],
        [0.0668, 0.0667, 0.0669, 0.0667, 0.0668, 0.0664, 0.0666, 0.0668, 0.0667,
         0.0664, 0.0666, 0.0665, 0.0670, 0.0668, 0.0664],
        [0.0668, 0.0667, 0.0669, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0667,
         0.0664, 0.0665, 0.0666, 0.0670, 0.0668, 0.0663]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0837, 0.0834, 0.0838, 0.0836, 0.0824, 0.0834, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0837, 0.0835, 0.0839, 0.0836, 0.0825, 0.0833, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0829],
        [0.0838, 0.0835, 0.0838, 0.0836, 0.0824, 0.0833, 0.0827, 0.0837, 0.0834,
         0.0835, 0.0835, 0.0828],
        [0.0837, 0.0835, 0.0838, 0.0836, 0.0825, 0.0833, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0838, 0.0834, 0.0838, 0.0837, 0.0825, 0.0833, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0837, 0.0834, 0.0838, 0.0836, 0.0825, 0.0834, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0837, 0.0834, 0.0838, 0.0837, 0.0825, 0.0833, 0.0827, 0.0838, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0837, 0.0835, 0.0839, 0.0836, 0.0825, 0.0833, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0829],
        [0.0837, 0.0834, 0.0838, 0.0837, 0.0825, 0.0834, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0837, 0.0835, 0.0839, 0.0837, 0.0824, 0.0833, 0.0826, 0.0838, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0838, 0.0835, 0.0839, 0.0836, 0.0825, 0.0833, 0.0827, 0.0838, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0837, 0.0834, 0.0838, 0.0836, 0.0825, 0.0833, 0.0827, 0.0837, 0.0833,
         0.0834, 0.0835, 0.0829]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2838771343231201s
iter time cost:11.223001956939697s
-------------Round number: 100-------------
Evaluate global model
[running kmeans]: 9it [00:00, 390.96it/s, center_shift=0.000000, iteration=9, tol=0.000100]
Averaged Train Loss: 0.3829
Averaged Test Accurancy: 0.8072
Std Test Accurancy: 0.0848
evaluate time cost:5.232663869857788s
clients training time cost:4.694985389709473s
attn_optimize time cost:0.45499348640441895s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0771, 0.0765, 0.0768, 0.0767, 0.0769, 0.0765, 0.0773, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0766, 0.0768, 0.0767, 0.0769, 0.0766, 0.0773, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0773, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0766, 0.0768, 0.0765, 0.0773, 0.0769, 0.0771,
         0.0774, 0.0771, 0.0769, 0.0769],
        [0.0771, 0.0765, 0.0768, 0.0767, 0.0768, 0.0765, 0.0773, 0.0768, 0.0771,
         0.0775, 0.0770, 0.0768, 0.0769],
        [0.0771, 0.0765, 0.0769, 0.0767, 0.0768, 0.0766, 0.0773, 0.0768, 0.0771,
         0.0774, 0.0771, 0.0769, 0.0769],
        [0.0771, 0.0765, 0.0767, 0.0766, 0.0769, 0.0764, 0.0773, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0769, 0.0770],
        [0.0770, 0.0766, 0.0768, 0.0767, 0.0768, 0.0766, 0.0772, 0.0768, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0771, 0.0765, 0.0769, 0.0767, 0.0769, 0.0765, 0.0772, 0.0768, 0.0770,
         0.0775, 0.0771, 0.0769, 0.0770],
        [0.0771, 0.0766, 0.0769, 0.0766, 0.0768, 0.0765, 0.0773, 0.0768, 0.0770,
         0.0774, 0.0772, 0.0769, 0.0769],
        [0.0771, 0.0765, 0.0767, 0.0767, 0.0769, 0.0766, 0.0773, 0.0768, 0.0771,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0771, 0.0765, 0.0767, 0.0766, 0.0769, 0.0765, 0.0773, 0.0769, 0.0770,
         0.0775, 0.0771, 0.0769, 0.0770],
        [0.0770, 0.0765, 0.0768, 0.0767, 0.0769, 0.0765, 0.0773, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0504,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0504,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0499, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0502],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0504,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0501, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0501, 0.0505, 0.0500, 0.0499, 0.0504,
         0.0499, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0769, 0.0771, 0.0769, 0.0771, 0.0768, 0.0768, 0.0771, 0.0769,
         0.0768, 0.0772, 0.0768, 0.0766],
        [0.0771, 0.0769, 0.0771, 0.0769, 0.0771, 0.0767, 0.0768, 0.0772, 0.0769,
         0.0767, 0.0773, 0.0768, 0.0766],
        [0.0771, 0.0769, 0.0771, 0.0769, 0.0772, 0.0767, 0.0768, 0.0771, 0.0768,
         0.0768, 0.0773, 0.0768, 0.0766],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0772, 0.0767, 0.0768, 0.0772, 0.0768,
         0.0768, 0.0773, 0.0768, 0.0766],
        [0.0771, 0.0769, 0.0771, 0.0769, 0.0771, 0.0767, 0.0768, 0.0772, 0.0769,
         0.0768, 0.0773, 0.0767, 0.0766],
        [0.0770, 0.0770, 0.0770, 0.0769, 0.0771, 0.0767, 0.0768, 0.0772, 0.0768,
         0.0767, 0.0773, 0.0768, 0.0766],
        [0.0771, 0.0769, 0.0771, 0.0769, 0.0772, 0.0766, 0.0768, 0.0771, 0.0768,
         0.0768, 0.0773, 0.0768, 0.0767],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0771, 0.0767, 0.0768, 0.0772, 0.0768,
         0.0767, 0.0773, 0.0768, 0.0767],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0771, 0.0767, 0.0768, 0.0771, 0.0768,
         0.0768, 0.0773, 0.0768, 0.0765],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0772, 0.0767, 0.0768, 0.0771, 0.0769,
         0.0768, 0.0772, 0.0768, 0.0766],
        [0.0771, 0.0769, 0.0771, 0.0769, 0.0771, 0.0767, 0.0768, 0.0772, 0.0768,
         0.0767, 0.0773, 0.0768, 0.0766],
        [0.0771, 0.0769, 0.0771, 0.0770, 0.0771, 0.0767, 0.0768, 0.0771, 0.0769,
         0.0767, 0.0773, 0.0768, 0.0766],
        [0.0771, 0.0769, 0.0771, 0.0769, 0.0772, 0.0767, 0.0768, 0.0771, 0.0768,
         0.0768, 0.0773, 0.0768, 0.0766]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1007, 0.0997, 0.0999, 0.0995, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1004],
        [0.1001, 0.1006, 0.0996, 0.1000, 0.0996, 0.0998, 0.1000, 0.0998, 0.1000,
         0.1005],
        [0.1001, 0.1006, 0.0996, 0.1000, 0.0995, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1004],
        [0.1001, 0.1007, 0.0996, 0.1000, 0.0995, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1005],
        [0.1000, 0.1006, 0.0995, 0.1000, 0.0996, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1005],
        [0.1001, 0.1006, 0.0996, 0.1001, 0.0995, 0.0998, 0.1000, 0.0997, 0.1000,
         0.1006],
        [0.1001, 0.1005, 0.0996, 0.1000, 0.0995, 0.0999, 0.1001, 0.0998, 0.1000,
         0.1004],
        [0.1001, 0.1006, 0.0996, 0.1000, 0.0996, 0.0999, 0.1001, 0.0999, 0.0999,
         0.1004],
        [0.1001, 0.1007, 0.0996, 0.1000, 0.0995, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1005],
        [0.1001, 0.1007, 0.0996, 0.1000, 0.0996, 0.0999, 0.1000, 0.0998, 0.0999,
         0.1005]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1437, 0.1428, 0.1419, 0.1414, 0.1428, 0.1421, 0.1452],
        [0.1438, 0.1431, 0.1418, 0.1415, 0.1428, 0.1421, 0.1448],
        [0.1438, 0.1428, 0.1420, 0.1414, 0.1429, 0.1421, 0.1450],
        [0.1437, 0.1430, 0.1419, 0.1415, 0.1428, 0.1421, 0.1449],
        [0.1438, 0.1429, 0.1417, 0.1415, 0.1428, 0.1421, 0.1452],
        [0.1437, 0.1428, 0.1418, 0.1416, 0.1427, 0.1420, 0.1454],
        [0.1439, 0.1429, 0.1415, 0.1411, 0.1429, 0.1417, 0.1460]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0991, 0.1001, 0.0999, 0.1003, 0.1003, 0.1003, 0.1000, 0.1010, 0.1004,
         0.0986],
        [0.0991, 0.1001, 0.0999, 0.1001, 0.1002, 0.1002, 0.1000, 0.1008, 0.1003,
         0.0991],
        [0.0991, 0.1001, 0.0999, 0.1002, 0.1003, 0.1002, 0.1001, 0.1009, 0.1004,
         0.0988],
        [0.0992, 0.1001, 0.0999, 0.1002, 0.1003, 0.1002, 0.1000, 0.1008, 0.1003,
         0.0991],
        [0.0991, 0.1002, 0.0999, 0.1003, 0.1002, 0.1001, 0.1000, 0.1009, 0.1001,
         0.0992],
        [0.0989, 0.1002, 0.1000, 0.1002, 0.1002, 0.1002, 0.1001, 0.1008, 0.1001,
         0.0994],
        [0.0991, 0.1002, 0.0999, 0.1003, 0.1002, 0.1002, 0.1000, 0.1008, 0.1003,
         0.0991],
        [0.0990, 0.1002, 0.0999, 0.1002, 0.1003, 0.1002, 0.0999, 0.1009, 0.1003,
         0.0991],
        [0.0990, 0.1001, 0.0999, 0.1003, 0.1003, 0.1002, 0.1000, 0.1009, 0.1003,
         0.0991],
        [0.0987, 0.1002, 0.0997, 0.1000, 0.1002, 0.1002, 0.0999, 0.1013, 0.1009,
         0.0990]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1991, 0.1998, 0.2008, 0.1998, 0.2004],
        [0.1995, 0.1999, 0.2008, 0.1996, 0.2002],
        [0.1994, 0.1999, 0.2008, 0.1998, 0.2002],
        [0.1994, 0.1999, 0.2006, 0.1997, 0.2005],
        [0.1992, 0.1999, 0.2008, 0.1996, 0.2004]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0492],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0499, 0.0506, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0494, 0.0499,
         0.0501, 0.0495, 0.0499, 0.0506, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0497, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2642393112182617s
iter time cost:10.737540245056152s
-------------Round number: 101-------------
Evaluate global model
[running kmeans]: 7it [00:00, 333.04it/s, center_shift=0.000000, iteration=7, tol=0.000100]
Averaged Train Loss: 0.3678
Averaged Test Accurancy: 0.8096
Std Test Accurancy: 0.0785
evaluate time cost:5.560281276702881s
clients training time cost:4.884173631668091s
attn_optimize time cost:0.4400777816772461s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1679, 0.1675, 0.1650, 0.1668, 0.1669, 0.1658],
        [0.1679, 0.1675, 0.1650, 0.1668, 0.1670, 0.1658],
        [0.1679, 0.1675, 0.1651, 0.1668, 0.1670, 0.1658],
        [0.1678, 0.1674, 0.1652, 0.1669, 0.1670, 0.1657],
        [0.1678, 0.1676, 0.1650, 0.1669, 0.1670, 0.1657],
        [0.1679, 0.1675, 0.1651, 0.1668, 0.1669, 0.1659]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3332, 0.3327, 0.3340],
        [0.3333, 0.3326, 0.3340],
        [0.3332, 0.3327, 0.3341]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0504, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0497, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0502],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0501, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0502, 0.0499, 0.0501, 0.0506, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1437, 0.1435, 0.1420, 0.1434, 0.1414, 0.1426, 0.1434],
        [0.1436, 0.1435, 0.1421, 0.1433, 0.1414, 0.1426, 0.1434],
        [0.1436, 0.1435, 0.1421, 0.1433, 0.1414, 0.1426, 0.1435],
        [0.1437, 0.1435, 0.1420, 0.1433, 0.1414, 0.1426, 0.1434],
        [0.1437, 0.1435, 0.1421, 0.1434, 0.1413, 0.1427, 0.1434],
        [0.1437, 0.1434, 0.1421, 0.1433, 0.1414, 0.1426, 0.1435],
        [0.1436, 0.1434, 0.1421, 0.1434, 0.1414, 0.1426, 0.1434]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0502, 0.0501, 0.0503, 0.0498, 0.0500, 0.0499,
         0.0499, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0496, 0.0502, 0.0496, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0498, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0502, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0506],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0507],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0505],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0496, 0.0500, 0.0499, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0509],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0499,
         0.0497, 0.0501, 0.0499, 0.0502, 0.0500, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0507],
        [0.0501, 0.0503, 0.0498, 0.0501, 0.0497, 0.0501, 0.0498, 0.0497, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0499, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0497, 0.0498,
         0.0497, 0.0501, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0500, 0.0499,
         0.0499, 0.0510],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0497, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0501, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0499, 0.0504, 0.0496, 0.0502, 0.0496, 0.0500, 0.0498, 0.0496, 0.0497,
         0.0498, 0.0500, 0.0498, 0.0503, 0.0501, 0.0504, 0.0497, 0.0500, 0.0498,
         0.0499, 0.0513]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3337, 0.3327, 0.3335],
        [0.3338, 0.3328, 0.3334],
        [0.3338, 0.3329, 0.3334]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0494],
        [0.0501, 0.0503, 0.0495, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0499, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0492],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0499, 0.0502,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0502, 0.0493],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0500, 0.0499, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0500, 0.0503, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0497],
        [0.0501, 0.0503, 0.0495, 0.0498, 0.0501, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0495],
        [0.0500, 0.0504, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0503, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0495],
        [0.0500, 0.0505, 0.0493, 0.0498, 0.0501, 0.0498, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0500, 0.0501, 0.0506, 0.0503,
         0.0505, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 4it [00:00, 363.30it/s, center_shift=0.000000, iteration=4, tol=0.000100]
weights:tensor([[0.0527, 0.0527, 0.0528, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0527,
         0.0527, 0.0525, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0523],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0527,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0527, 0.0527, 0.0528, 0.0526, 0.0529, 0.0525, 0.0525, 0.0526, 0.0527,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0529, 0.0525, 0.0524, 0.0526, 0.0527,
         0.0527, 0.0524, 0.0526, 0.0528, 0.0525, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0527, 0.0527, 0.0528, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0527,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0526, 0.0526, 0.0529, 0.0528, 0.0527,
         0.0523],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0527,
         0.0527, 0.0524, 0.0526, 0.0528, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0527, 0.0525, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0527,
         0.0527, 0.0524, 0.0525, 0.0528, 0.0526, 0.0526, 0.0529, 0.0528, 0.0527,
         0.0523],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0529, 0.0525, 0.0524, 0.0525, 0.0527,
         0.0527, 0.0524, 0.0525, 0.0528, 0.0525, 0.0526, 0.0529, 0.0528, 0.0528,
         0.0523],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0525, 0.0525, 0.0528, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0527,
         0.0527, 0.0524, 0.0525, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0528,
         0.0523],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0527,
         0.0527, 0.0524, 0.0525, 0.0528, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0527,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0528, 0.0527,
         0.0523],
        [0.0527, 0.0527, 0.0528, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0527, 0.0525, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0528,
         0.0527, 0.0523, 0.0525, 0.0528, 0.0526, 0.0525, 0.0529, 0.0528, 0.0528,
         0.0523],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0525, 0.0527,
         0.0527, 0.0524, 0.0526, 0.0528, 0.0525, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0527,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0523]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3210582733154297s
iter time cost:11.28265905380249s
-------------Round number: 102-------------
Evaluate global model
Averaged Train Loss: 0.4013
Averaged Test Accurancy: 0.8056
Std Test Accurancy: 0.0954
evaluate time cost:5.270476818084717s
clients training time cost:4.715186595916748s
attn_optimize time cost:0.5590932369232178s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1001, 0.1007, 0.0998, 0.0999, 0.0995, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1003],
        [0.1001, 0.1007, 0.0997, 0.1000, 0.0996, 0.0998, 0.1000, 0.0998, 0.1000,
         0.1004],
        [0.1001, 0.1007, 0.0996, 0.1000, 0.0995, 0.0999, 0.0999, 0.0998, 0.1000,
         0.1004],
        [0.1001, 0.1007, 0.0997, 0.1000, 0.0995, 0.0999, 0.0999, 0.0997, 0.1000,
         0.1004],
        [0.1000, 0.1007, 0.0996, 0.1000, 0.0996, 0.0999, 0.1000, 0.0998, 0.1001,
         0.1004],
        [0.1001, 0.1007, 0.0996, 0.1001, 0.0995, 0.0999, 0.0999, 0.0997, 0.1000,
         0.1005],
        [0.1001, 0.1006, 0.0997, 0.1000, 0.0996, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1003],
        [0.1001, 0.1006, 0.0997, 0.1000, 0.0996, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1003],
        [0.1001, 0.1008, 0.0997, 0.1000, 0.0995, 0.0999, 0.0999, 0.0997, 0.1000,
         0.1004],
        [0.1001, 0.1007, 0.0997, 0.0999, 0.0996, 0.0999, 0.0999, 0.0998, 0.1000,
         0.1004]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1436, 0.1428, 0.1418, 0.1418, 0.1429, 0.1418, 0.1452],
        [0.1438, 0.1431, 0.1417, 0.1419, 0.1429, 0.1418, 0.1448],
        [0.1438, 0.1428, 0.1419, 0.1418, 0.1430, 0.1418, 0.1449],
        [0.1437, 0.1430, 0.1418, 0.1418, 0.1429, 0.1419, 0.1449],
        [0.1437, 0.1429, 0.1416, 0.1419, 0.1429, 0.1418, 0.1453],
        [0.1437, 0.1428, 0.1418, 0.1420, 0.1427, 0.1417, 0.1454],
        [0.1439, 0.1428, 0.1414, 0.1415, 0.1430, 0.1414, 0.1460]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0769, 0.0769, 0.0771, 0.0766, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0766, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0766, 0.0768, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0767, 0.0768, 0.0770, 0.0769, 0.0768,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0770, 0.0771, 0.0766, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0768, 0.0769, 0.0770, 0.0767, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0771, 0.0768, 0.0769, 0.0771, 0.0767, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0769, 0.0769, 0.0771, 0.0766, 0.0768, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0767, 0.0768, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0767, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0771, 0.0768, 0.0769, 0.0771, 0.0767, 0.0768, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0766, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0767, 0.0768, 0.0770, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1099, 0.1111, 0.1108, 0.1113, 0.1113, 0.1112, 0.1109, 0.1120, 0.1114],
        [0.1100, 0.1112, 0.1109, 0.1111, 0.1113, 0.1112, 0.1110, 0.1119, 0.1114],
        [0.1101, 0.1111, 0.1108, 0.1112, 0.1113, 0.1111, 0.1110, 0.1119, 0.1115],
        [0.1101, 0.1112, 0.1109, 0.1112, 0.1113, 0.1112, 0.1110, 0.1119, 0.1113],
        [0.1100, 0.1113, 0.1109, 0.1113, 0.1112, 0.1111, 0.1110, 0.1120, 0.1112],
        [0.1099, 0.1113, 0.1110, 0.1112, 0.1112, 0.1113, 0.1112, 0.1119, 0.1112],
        [0.1100, 0.1113, 0.1109, 0.1113, 0.1112, 0.1112, 0.1110, 0.1119, 0.1113],
        [0.1099, 0.1113, 0.1109, 0.1112, 0.1113, 0.1112, 0.1109, 0.1120, 0.1113],
        [0.1100, 0.1112, 0.1108, 0.1113, 0.1113, 0.1111, 0.1110, 0.1120, 0.1113]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0528, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0524, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0525, 0.0530, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0526, 0.0529, 0.0528, 0.0527,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0524, 0.0530, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0526, 0.0528, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0524, 0.0530, 0.0526, 0.0527,
         0.0526],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0525, 0.0526, 0.0529, 0.0528, 0.0527,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0525, 0.0524, 0.0526, 0.0528, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0528, 0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0527, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0527, 0.0526, 0.0525, 0.0529, 0.0528, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0524, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0526, 0.0528, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0524, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0527, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0525]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0765, 0.0768, 0.0767, 0.0768, 0.0765, 0.0774, 0.0770, 0.0771,
         0.0776, 0.0772, 0.0767, 0.0769],
        [0.0768, 0.0765, 0.0768, 0.0767, 0.0768, 0.0766, 0.0774, 0.0770, 0.0770,
         0.0776, 0.0772, 0.0767, 0.0769],
        [0.0768, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0774, 0.0770, 0.0770,
         0.0775, 0.0772, 0.0767, 0.0768],
        [0.0769, 0.0765, 0.0769, 0.0766, 0.0768, 0.0765, 0.0774, 0.0770, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0768],
        [0.0769, 0.0765, 0.0768, 0.0767, 0.0768, 0.0765, 0.0774, 0.0769, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0768],
        [0.0769, 0.0765, 0.0768, 0.0767, 0.0768, 0.0766, 0.0774, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0768],
        [0.0769, 0.0764, 0.0767, 0.0766, 0.0768, 0.0765, 0.0775, 0.0769, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0770],
        [0.0768, 0.0766, 0.0768, 0.0767, 0.0767, 0.0766, 0.0774, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0767, 0.0769],
        [0.0769, 0.0765, 0.0768, 0.0767, 0.0768, 0.0765, 0.0774, 0.0769, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0769, 0.0766, 0.0768, 0.0765, 0.0775, 0.0769, 0.0771,
         0.0775, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0767, 0.0767, 0.0768, 0.0766, 0.0774, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0765, 0.0767, 0.0766, 0.0768, 0.0765, 0.0774, 0.0770, 0.0770,
         0.0776, 0.0772, 0.0768, 0.0769],
        [0.0768, 0.0765, 0.0768, 0.0767, 0.0768, 0.0766, 0.0774, 0.0769, 0.0771,
         0.0777, 0.0771, 0.0767, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0503, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0496, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0499, 0.0490],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0501, 0.0505, 0.0503, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0504, 0.0503, 0.0503, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0500, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0499, 0.0505, 0.0501, 0.0505, 0.0505, 0.0504, 0.0504, 0.0494, 0.0498,
         0.0501, 0.0495, 0.0499, 0.0506, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0497, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1427, 0.1426, 0.1427, 0.1424, 0.1439, 0.1424],
        [0.1432, 0.1425, 0.1427, 0.1426, 0.1424, 0.1439, 0.1426],
        [0.1430, 0.1426, 0.1429, 0.1429, 0.1423, 0.1438, 0.1426],
        [0.1433, 0.1426, 0.1428, 0.1428, 0.1423, 0.1438, 0.1423],
        [0.1432, 0.1426, 0.1428, 0.1427, 0.1423, 0.1438, 0.1426],
        [0.1432, 0.1426, 0.1428, 0.1427, 0.1423, 0.1438, 0.1426],
        [0.1435, 0.1426, 0.1429, 0.1427, 0.1424, 0.1439, 0.1418]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28184056282043457s
iter time cost:10.913677453994751s
-------------Round number: 103-------------
Evaluate global model
[running kmeans]: 5it [00:00, 333.03it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 0.3832
Averaged Test Accurancy: 0.8063
Std Test Accurancy: 0.0961
evaluate time cost:5.245481014251709s
clients training time cost:5.086951017379761s
attn_optimize time cost:0.4970109462738037s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1252, 0.1252, 0.1248, 0.1248, 0.1255, 0.1252, 0.1256, 0.1238],
        [0.1251, 0.1253, 0.1247, 0.1248, 0.1256, 0.1251, 0.1256, 0.1238],
        [0.1252, 0.1252, 0.1245, 0.1249, 0.1257, 0.1251, 0.1256, 0.1238],
        [0.1251, 0.1252, 0.1248, 0.1249, 0.1257, 0.1249, 0.1255, 0.1239],
        [0.1253, 0.1253, 0.1247, 0.1248, 0.1256, 0.1251, 0.1254, 0.1239],
        [0.1252, 0.1254, 0.1246, 0.1248, 0.1255, 0.1250, 0.1256, 0.1239],
        [0.1252, 0.1253, 0.1246, 0.1249, 0.1257, 0.1250, 0.1256, 0.1239],
        [0.1250, 0.1252, 0.1243, 0.1245, 0.1257, 0.1254, 0.1258, 0.1240]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0500, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0498,
         0.0500, 0.0498, 0.0501, 0.0498, 0.0501, 0.0505, 0.0500, 0.0499, 0.0504,
         0.0499, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0911, 0.0915, 0.0906, 0.0909, 0.0904, 0.0908, 0.0909, 0.0908, 0.0907,
         0.0910, 0.0913],
        [0.0910, 0.0915, 0.0906, 0.0909, 0.0905, 0.0908, 0.0909, 0.0908, 0.0907,
         0.0909, 0.0914],
        [0.0910, 0.0915, 0.0905, 0.0909, 0.0904, 0.0909, 0.0909, 0.0909, 0.0907,
         0.0910, 0.0913],
        [0.0911, 0.0915, 0.0905, 0.0909, 0.0904, 0.0908, 0.0909, 0.0908, 0.0907,
         0.0910, 0.0914],
        [0.0910, 0.0915, 0.0905, 0.0909, 0.0905, 0.0909, 0.0909, 0.0909, 0.0907,
         0.0910, 0.0913],
        [0.0911, 0.0915, 0.0905, 0.0910, 0.0904, 0.0908, 0.0908, 0.0909, 0.0906,
         0.0910, 0.0914],
        [0.0910, 0.0914, 0.0906, 0.0909, 0.0905, 0.0909, 0.0909, 0.0908, 0.0907,
         0.0910, 0.0913],
        [0.0910, 0.0916, 0.0906, 0.0908, 0.0904, 0.0909, 0.0909, 0.0908, 0.0908,
         0.0909, 0.0912],
        [0.0910, 0.0914, 0.0906, 0.0909, 0.0905, 0.0908, 0.0909, 0.0909, 0.0907,
         0.0909, 0.0913],
        [0.0911, 0.0916, 0.0905, 0.0909, 0.0904, 0.0909, 0.0908, 0.0908, 0.0907,
         0.0910, 0.0914],
        [0.0911, 0.0915, 0.0906, 0.0909, 0.0905, 0.0908, 0.0909, 0.0908, 0.0907,
         0.0909, 0.0914]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 5it [00:00, 217.19it/s, center_shift=0.000000, iteration=5, tol=0.000100]
weights:tensor([[0.1119, 0.1118, 0.1116, 0.1116, 0.1101, 0.1106, 0.1099, 0.1108, 0.1117],
        [0.1119, 0.1118, 0.1116, 0.1115, 0.1102, 0.1105, 0.1100, 0.1108, 0.1117],
        [0.1121, 0.1119, 0.1118, 0.1115, 0.1100, 0.1104, 0.1099, 0.1108, 0.1116],
        [0.1120, 0.1119, 0.1117, 0.1115, 0.1101, 0.1105, 0.1099, 0.1108, 0.1117],
        [0.1119, 0.1118, 0.1116, 0.1114, 0.1102, 0.1106, 0.1099, 0.1108, 0.1117],
        [0.1119, 0.1119, 0.1117, 0.1115, 0.1102, 0.1105, 0.1099, 0.1108, 0.1116],
        [0.1120, 0.1119, 0.1118, 0.1115, 0.1101, 0.1104, 0.1098, 0.1109, 0.1116],
        [0.1119, 0.1119, 0.1117, 0.1115, 0.1101, 0.1105, 0.1099, 0.1108, 0.1117],
        [0.1120, 0.1118, 0.1117, 0.1115, 0.1101, 0.1105, 0.1100, 0.1108, 0.1116]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0836, 0.0833, 0.0835, 0.0833, 0.0835, 0.0831, 0.0831, 0.0835, 0.0832,
         0.0837, 0.0833, 0.0830],
        [0.0836, 0.0833, 0.0835, 0.0833, 0.0835, 0.0830, 0.0831, 0.0835, 0.0832,
         0.0838, 0.0832, 0.0830],
        [0.0836, 0.0833, 0.0835, 0.0832, 0.0836, 0.0830, 0.0831, 0.0835, 0.0832,
         0.0837, 0.0833, 0.0830],
        [0.0835, 0.0833, 0.0835, 0.0833, 0.0836, 0.0830, 0.0831, 0.0836, 0.0832,
         0.0838, 0.0833, 0.0830],
        [0.0836, 0.0833, 0.0835, 0.0833, 0.0835, 0.0830, 0.0831, 0.0835, 0.0832,
         0.0838, 0.0832, 0.0830],
        [0.0835, 0.0834, 0.0834, 0.0833, 0.0835, 0.0830, 0.0831, 0.0836, 0.0832,
         0.0838, 0.0833, 0.0830],
        [0.0836, 0.0833, 0.0835, 0.0833, 0.0836, 0.0830, 0.0831, 0.0835, 0.0832,
         0.0837, 0.0833, 0.0830],
        [0.0836, 0.0833, 0.0834, 0.0833, 0.0835, 0.0830, 0.0831, 0.0836, 0.0831,
         0.0838, 0.0832, 0.0831],
        [0.0836, 0.0833, 0.0835, 0.0833, 0.0835, 0.0830, 0.0831, 0.0835, 0.0833,
         0.0837, 0.0833, 0.0830],
        [0.0836, 0.0833, 0.0835, 0.0833, 0.0835, 0.0830, 0.0831, 0.0835, 0.0832,
         0.0837, 0.0832, 0.0830],
        [0.0836, 0.0833, 0.0835, 0.0834, 0.0835, 0.0830, 0.0831, 0.0835, 0.0831,
         0.0837, 0.0833, 0.0830],
        [0.0836, 0.0833, 0.0835, 0.0833, 0.0835, 0.0830, 0.0831, 0.0835, 0.0833,
         0.0838, 0.0832, 0.0830]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0502, 0.0496, 0.0501, 0.0497, 0.0498, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0502, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0499, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0498,
         0.0501, 0.0507],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0502, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0499, 0.0501, 0.0503, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0501, 0.0502, 0.0497, 0.0501, 0.0496, 0.0499, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0504, 0.0498, 0.0501, 0.0498,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0499, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0502, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0501, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0499, 0.0502, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0501, 0.0503, 0.0496, 0.0501, 0.0497, 0.0498, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0502, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0496, 0.0499, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0499, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0502, 0.0504, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0509],
        [0.0501, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0501, 0.0499, 0.0500, 0.0501, 0.0504, 0.0499, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0501, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0498, 0.0502, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0501, 0.0500, 0.0500, 0.0502, 0.0504, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0510],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0499, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0497, 0.0498, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0502, 0.0505, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0504],
        [0.0499, 0.0504, 0.0496, 0.0502, 0.0496, 0.0498, 0.0499, 0.0495, 0.0497,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0502, 0.0505, 0.0498, 0.0500, 0.0497,
         0.0500, 0.0513]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3334, 0.3335, 0.3332],
        [0.3333, 0.3335, 0.3332],
        [0.3331, 0.3336, 0.3333]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2513, 0.2506, 0.2481],
        [0.2501, 0.2513, 0.2507, 0.2479],
        [0.2500, 0.2514, 0.2505, 0.2481],
        [0.2500, 0.2512, 0.2508, 0.2481]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1101, 0.1113, 0.1111, 0.1115, 0.1115, 0.1111, 0.1122, 0.1117, 0.1095],
        [0.1101, 0.1113, 0.1111, 0.1114, 0.1114, 0.1110, 0.1120, 0.1116, 0.1101],
        [0.1101, 0.1113, 0.1111, 0.1115, 0.1113, 0.1111, 0.1121, 0.1117, 0.1097],
        [0.1100, 0.1114, 0.1111, 0.1114, 0.1113, 0.1110, 0.1122, 0.1114, 0.1102],
        [0.1099, 0.1114, 0.1112, 0.1113, 0.1114, 0.1111, 0.1120, 0.1114, 0.1104],
        [0.1101, 0.1114, 0.1111, 0.1114, 0.1113, 0.1110, 0.1121, 0.1115, 0.1101],
        [0.1099, 0.1114, 0.1111, 0.1115, 0.1114, 0.1109, 0.1122, 0.1115, 0.1100],
        [0.1100, 0.1113, 0.1111, 0.1115, 0.1113, 0.1110, 0.1122, 0.1116, 0.1101],
        [0.1095, 0.1114, 0.1109, 0.1113, 0.1113, 0.1108, 0.1126, 0.1123, 0.1098]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2512, 0.2508, 0.2519, 0.2460],
        [0.2510, 0.2504, 0.2516, 0.2471],
        [0.2508, 0.2504, 0.2515, 0.2473],
        [0.2512, 0.2512, 0.2514, 0.2462]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2830820083618164s
iter time cost:11.199603796005249s
-------------Round number: 104-------------
Evaluate global model
Averaged Train Loss: 0.4497
Averaged Test Accurancy: 0.7962
Std Test Accurancy: 0.0859
evaluate time cost:5.007488489151001s
clients training time cost:4.988901376724243s
attn_optimize time cost:0.5350034236907959s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0989, 0.0999, 0.0999, 0.0998, 0.1002, 0.1002, 0.1002, 0.0998, 0.1008,
         0.1003],
        [0.0989, 0.0998, 0.1000, 0.0999, 0.1002, 0.1002, 0.1001, 0.0999, 0.1008,
         0.1001],
        [0.0990, 0.0999, 0.1000, 0.0999, 0.1000, 0.1002, 0.1002, 0.0999, 0.1007,
         0.1003],
        [0.0989, 0.1000, 0.0999, 0.0998, 0.1001, 0.1002, 0.1000, 0.0999, 0.1007,
         0.1004],
        [0.0990, 0.0999, 0.1000, 0.0999, 0.1000, 0.1002, 0.1001, 0.0999, 0.1007,
         0.1003],
        [0.0989, 0.0998, 0.1001, 0.0999, 0.1002, 0.1002, 0.1001, 0.0999, 0.1008,
         0.1001],
        [0.0988, 0.0997, 0.1001, 0.1000, 0.1001, 0.1002, 0.1002, 0.1000, 0.1007,
         0.1002],
        [0.0989, 0.0998, 0.1001, 0.0999, 0.1001, 0.1002, 0.1001, 0.0999, 0.1007,
         0.1003],
        [0.0988, 0.0999, 0.1001, 0.0999, 0.1001, 0.1002, 0.1002, 0.0998, 0.1008,
         0.1003],
        [0.0989, 0.0999, 0.1000, 0.0998, 0.1002, 0.1002, 0.1001, 0.0998, 0.1008,
         0.1003]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0251, 0.0250, 0.0250,  ..., 0.0250, 0.0249, 0.0250],
        [0.0251, 0.0250, 0.0250,  ..., 0.0249, 0.0249, 0.0250],
        [0.0251, 0.0250, 0.0250,  ..., 0.0249, 0.0249, 0.0249],
        ...,
        [0.0251, 0.0251, 0.0250,  ..., 0.0249, 0.0250, 0.0252],
        [0.0251, 0.0251, 0.0251,  ..., 0.0249, 0.0249, 0.0251],
        [0.0252, 0.0251, 0.0251,  ..., 0.0247, 0.0248, 0.0255]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3327, 0.3338, 0.3335],
        [0.3327, 0.3339, 0.3335],
        [0.3327, 0.3339, 0.3334]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1110, 0.1112, 0.1112, 0.1108, 0.1111, 0.1111, 0.1108, 0.1115],
        [0.1112, 0.1111, 0.1112, 0.1113, 0.1107, 0.1111, 0.1112, 0.1108, 0.1116],
        [0.1111, 0.1111, 0.1112, 0.1113, 0.1107, 0.1111, 0.1111, 0.1108, 0.1116],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1107, 0.1112, 0.1111, 0.1108, 0.1116],
        [0.1111, 0.1111, 0.1111, 0.1113, 0.1108, 0.1111, 0.1112, 0.1108, 0.1116],
        [0.1111, 0.1110, 0.1112, 0.1114, 0.1107, 0.1111, 0.1112, 0.1108, 0.1116],
        [0.1111, 0.1111, 0.1111, 0.1112, 0.1108, 0.1112, 0.1112, 0.1107, 0.1116],
        [0.1111, 0.1111, 0.1111, 0.1113, 0.1107, 0.1112, 0.1112, 0.1109, 0.1115],
        [0.1111, 0.1111, 0.1111, 0.1113, 0.1108, 0.1112, 0.1112, 0.1107, 0.1116]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2003, 0.1997, 0.1997, 0.1999, 0.2005],
        [0.2002, 0.1997, 0.1996, 0.1998, 0.2006],
        [0.2002, 0.1999, 0.1995, 0.1998, 0.2007],
        [0.2002, 0.1998, 0.1996, 0.1998, 0.2006],
        [0.2002, 0.1998, 0.1997, 0.1998, 0.2006]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1000, 0.1000, 0.1001, 0.0997, 0.1000, 0.1001, 0.1001, 0.1003, 0.1002,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.0997, 0.0999, 0.1000, 0.1002, 0.1004, 0.1002,
         0.0996],
        [0.1000, 0.0999, 0.1001, 0.0997, 0.0999, 0.1001, 0.1001, 0.1004, 0.1003,
         0.0996],
        [0.1000, 0.1000, 0.1000, 0.0995, 0.0999, 0.1002, 0.1001, 0.1004, 0.1003,
         0.0995],
        [0.1001, 0.0999, 0.1000, 0.0997, 0.0999, 0.1002, 0.1000, 0.1003, 0.1003,
         0.0996],
        [0.1001, 0.1001, 0.1001, 0.0996, 0.0999, 0.1001, 0.1001, 0.1002, 0.1003,
         0.0996],
        [0.1001, 0.1000, 0.1001, 0.0995, 0.0999, 0.1000, 0.1000, 0.1004, 0.1002,
         0.0997],
        [0.1000, 0.0999, 0.1001, 0.0995, 0.0999, 0.1002, 0.1000, 0.1004, 0.1003,
         0.0997],
        [0.1000, 0.1000, 0.1001, 0.0997, 0.0999, 0.1001, 0.1000, 0.1003, 0.1002,
         0.0997],
        [0.1000, 0.1000, 0.1001, 0.0996, 0.0999, 0.1000, 0.1002, 0.1003, 0.1002,
         0.0997]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0503, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0492],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0490],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0497, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0490],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0488],
        [0.0499, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0503, 0.0494, 0.0498,
         0.0502, 0.0495, 0.0499, 0.0505, 0.0502, 0.0501, 0.0492, 0.0499, 0.0503,
         0.0497, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3770177364349365s
iter time cost:11.012155771255493s
-------------Round number: 105-------------
Evaluate global model
[running kmeans]: 9it [00:00, 333.03it/s, center_shift=0.000000, iteration=9, tol=0.000100]
Averaged Train Loss: 0.3832
Averaged Test Accurancy: 0.8084
Std Test Accurancy: 0.0755
evaluate time cost:5.360515832901001s
clients training time cost:5.009290933609009s
[running kmeans]: 5it [00:00, 312.24it/s, center_shift=0.000000, iteration=5, tol=0.000100]
attn_optimize time cost:0.8646290302276611s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2497, 0.2492, 0.2491, 0.2519],
        [0.2498, 0.2491, 0.2489, 0.2522],
        [0.2497, 0.2492, 0.2491, 0.2520],
        [0.2498, 0.2491, 0.2490, 0.2520]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1003, 0.0999, 0.1000, 0.1002, 0.0996, 0.0999, 0.0999, 0.1007, 0.0996,
         0.0999],
        [0.1003, 0.0999, 0.1000, 0.1002, 0.0996, 0.1000, 0.0999, 0.1006, 0.0996,
         0.1000],
        [0.1003, 0.0999, 0.1000, 0.1002, 0.0996, 0.0999, 0.0999, 0.1006, 0.0996,
         0.0999],
        [0.1003, 0.0999, 0.1000, 0.1002, 0.0996, 0.0999, 0.0999, 0.1005, 0.0997,
         0.1000],
        [0.1004, 0.0998, 0.1000, 0.1001, 0.0996, 0.1000, 0.1000, 0.1007, 0.0996,
         0.0999],
        [0.1004, 0.0999, 0.1000, 0.1002, 0.0995, 0.0999, 0.0999, 0.1006, 0.0996,
         0.0999],
        [0.1003, 0.0999, 0.1000, 0.1002, 0.0996, 0.1000, 0.0999, 0.1006, 0.0996,
         0.1000],
        [0.1003, 0.0999, 0.1000, 0.1002, 0.0996, 0.0999, 0.0999, 0.1007, 0.0996,
         0.0999],
        [0.1004, 0.0999, 0.1000, 0.1002, 0.0996, 0.0999, 0.0999, 0.1006, 0.0997,
         0.1000],
        [0.1003, 0.0999, 0.1000, 0.1002, 0.0996, 0.0999, 0.0999, 0.1006, 0.0997,
         0.0999]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2494, 0.2488, 0.2514],
        [0.2502, 0.2492, 0.2490, 0.2516],
        [0.2502, 0.2494, 0.2489, 0.2515],
        [0.2503, 0.2493, 0.2489, 0.2515]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0501, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0498, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503, 0.0500, 0.0500,
         0.0498, 0.0498],
        [0.0502, 0.0501, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0499, 0.0498, 0.0499, 0.0503, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0498, 0.0497],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0499, 0.0498, 0.0499, 0.0502, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0499, 0.0498, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0498, 0.0499, 0.0503, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0499, 0.0498, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0498, 0.0499, 0.0503, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0497, 0.0499, 0.0503, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0499, 0.0498, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0501, 0.0502,
         0.0499, 0.0497, 0.0499, 0.0503, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0499, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0500, 0.0498, 0.0502, 0.0500, 0.0500,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0501, 0.0501,
         0.0499, 0.0497, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0497, 0.0499, 0.0503, 0.0500, 0.0498, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0498, 0.0499, 0.0503, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0497],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0498, 0.0499, 0.0502, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0498, 0.0497],
        [0.0502, 0.0500, 0.0502, 0.0498, 0.0503, 0.0498, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0496, 0.0498, 0.0504, 0.0500, 0.0501, 0.0502, 0.0502, 0.0502,
         0.0497, 0.0497]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1436, 0.1428, 0.1419, 0.1416, 0.1432, 0.1420, 0.1451],
        [0.1437, 0.1430, 0.1418, 0.1417, 0.1431, 0.1420, 0.1446],
        [0.1437, 0.1428, 0.1420, 0.1416, 0.1432, 0.1420, 0.1448],
        [0.1436, 0.1430, 0.1419, 0.1416, 0.1431, 0.1420, 0.1448],
        [0.1436, 0.1428, 0.1417, 0.1416, 0.1431, 0.1419, 0.1451],
        [0.1436, 0.1427, 0.1418, 0.1417, 0.1430, 0.1419, 0.1453],
        [0.1438, 0.1428, 0.1415, 0.1413, 0.1432, 0.1416, 0.1458]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0502, 0.0504, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0495],
        [0.0502, 0.0506, 0.0494, 0.0499, 0.0499, 0.0498, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0491],
        [0.0502, 0.0504, 0.0494, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0502, 0.0505, 0.0495, 0.0499, 0.0500, 0.0498, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0492],
        [0.0502, 0.0504, 0.0494, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0500, 0.0498, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0497],
        [0.0502, 0.0504, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0502, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0505, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0501, 0.0495],
        [0.0502, 0.0505, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0500, 0.0495],
        [0.0502, 0.0505, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0502, 0.0504, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0502, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0499, 0.0495],
        [0.0502, 0.0505, 0.0494, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0502, 0.0505, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0501, 0.0494],
        [0.0502, 0.0505, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0502, 0.0505, 0.0494, 0.0499, 0.0500, 0.0498, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0506, 0.0492, 0.0498, 0.0501, 0.0497, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0506, 0.0503,
         0.0504, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2005, 0.2001, 0.1992, 0.2002, 0.2000],
        [0.2003, 0.2000, 0.1993, 0.2003, 0.2001],
        [0.2002, 0.2000, 0.1992, 0.2004, 0.2001],
        [0.2003, 0.2000, 0.1993, 0.2004, 0.2000],
        [0.2000, 0.2002, 0.1994, 0.2003, 0.2001]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1110, 0.1105, 0.1111, 0.1115, 0.1110, 0.1113, 0.1115, 0.1110, 0.1111],
        [0.1109, 0.1106, 0.1111, 0.1115, 0.1111, 0.1112, 0.1114, 0.1110, 0.1111],
        [0.1111, 0.1106, 0.1110, 0.1116, 0.1110, 0.1114, 0.1113, 0.1110, 0.1111],
        [0.1111, 0.1104, 0.1111, 0.1115, 0.1109, 0.1114, 0.1114, 0.1111, 0.1111],
        [0.1110, 0.1106, 0.1110, 0.1115, 0.1110, 0.1113, 0.1114, 0.1110, 0.1112],
        [0.1111, 0.1105, 0.1110, 0.1115, 0.1109, 0.1113, 0.1114, 0.1111, 0.1111],
        [0.1110, 0.1105, 0.1111, 0.1116, 0.1109, 0.1114, 0.1114, 0.1110, 0.1113],
        [0.1110, 0.1105, 0.1111, 0.1115, 0.1111, 0.1112, 0.1114, 0.1111, 0.1111],
        [0.1110, 0.1105, 0.1111, 0.1116, 0.1109, 0.1114, 0.1114, 0.1110, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0492],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0506, 0.0503, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0497, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0501, 0.0506, 0.0503, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0500, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0499, 0.0505, 0.0501, 0.0506, 0.0504, 0.0503, 0.0503, 0.0494, 0.0499,
         0.0501, 0.0495, 0.0499, 0.0506, 0.0502, 0.0502, 0.0492, 0.0499, 0.0502,
         0.0497, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3089168071746826s
iter time cost:11.641441822052002s
-------------Round number: 106-------------
Evaluate global model
Averaged Train Loss: 0.4158
Averaged Test Accurancy: 0.8012
Std Test Accurancy: 0.0797
evaluate time cost:5.191295146942139s
clients training time cost:4.9821248054504395s
attn_optimize time cost:0.4560716152191162s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2514, 0.2508, 0.2519, 0.2460],
        [0.2511, 0.2504, 0.2515, 0.2470],
        [0.2509, 0.2504, 0.2515, 0.2472],
        [0.2515, 0.2512, 0.2513, 0.2460]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1672, 0.1663, 0.1663, 0.1662, 0.1679, 0.1661],
        [0.1668, 0.1666, 0.1665, 0.1660, 0.1678, 0.1663],
        [0.1671, 0.1665, 0.1664, 0.1661, 0.1679, 0.1660],
        [0.1670, 0.1665, 0.1663, 0.1661, 0.1678, 0.1664],
        [0.1670, 0.1665, 0.1662, 0.1661, 0.1678, 0.1663],
        [0.1674, 0.1666, 0.1662, 0.1663, 0.1680, 0.1654]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0629, 0.0626, 0.0629, 0.0628, 0.0627, 0.0627, 0.0618, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0627, 0.0617, 0.0623, 0.0627, 0.0622],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0627, 0.0618, 0.0625, 0.0621,
         0.0628, 0.0625, 0.0627, 0.0617, 0.0623, 0.0627, 0.0622],
        [0.0629, 0.0626, 0.0629, 0.0628, 0.0628, 0.0627, 0.0618, 0.0625, 0.0621,
         0.0628, 0.0625, 0.0627, 0.0618, 0.0623, 0.0626, 0.0621],
        [0.0629, 0.0627, 0.0629, 0.0628, 0.0627, 0.0626, 0.0618, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0622],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0626, 0.0617, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0626, 0.0621],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0623, 0.0626, 0.0622],
        [0.0629, 0.0626, 0.0630, 0.0628, 0.0627, 0.0626, 0.0619, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0622],
        [0.0629, 0.0626, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0622],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0626, 0.0618, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0626, 0.0618, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0627, 0.0617, 0.0622, 0.0627, 0.0622],
        [0.0629, 0.0626, 0.0629, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0626, 0.0622],
        [0.0630, 0.0626, 0.0630, 0.0629, 0.0628, 0.0627, 0.0618, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0623, 0.0626, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0629, 0.0628, 0.0626, 0.0618, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0626, 0.0618, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0627, 0.0617, 0.0623, 0.0627, 0.0621],
        [0.0629, 0.0626, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0625, 0.0621,
         0.0629, 0.0625, 0.0626, 0.0617, 0.0622, 0.0627, 0.0622]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0502, 0.0506, 0.0494, 0.0499, 0.0499, 0.0498, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0491],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0501,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0505, 0.0494, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0502, 0.0492],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0500, 0.0497],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0502,
         0.0501, 0.0495],
        [0.0502, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0505, 0.0493, 0.0498, 0.0500, 0.0499, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0496],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0502, 0.0505, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0499, 0.0499, 0.0501, 0.0497, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0504, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0506, 0.0492, 0.0499, 0.0500, 0.0498, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500, 0.0506, 0.0503,
         0.0505, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4993, 0.5007],
        [0.4992, 0.5008]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3324, 0.3331, 0.3345],
        [0.3326, 0.3332, 0.3342],
        [0.3325, 0.3331, 0.3344]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0495, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0496, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0499, 0.0500, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0496, 0.0502, 0.0495, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0498,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0495, 0.0501, 0.0499, 0.0495, 0.0500,
         0.0499, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0495, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0498,
         0.0501, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0499, 0.0503, 0.0500, 0.0499, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0495, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0499, 0.0500, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0495, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0498,
         0.0499, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0496, 0.0501, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503, 0.0497, 0.0502, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0501, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0499, 0.0510],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0496, 0.0500, 0.0499, 0.0495, 0.0500,
         0.0499, 0.0503, 0.0500, 0.0499, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0500, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0501, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0499, 0.0505, 0.0496, 0.0502, 0.0495, 0.0500, 0.0499, 0.0496, 0.0497,
         0.0498, 0.0501, 0.0499, 0.0501, 0.0501, 0.0505, 0.0497, 0.0500, 0.0497,
         0.0500, 0.0513]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0524, 0.0526, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0523, 0.0526, 0.0527, 0.0526, 0.0526, 0.0530, 0.0527, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0528, 0.0526, 0.0527, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0526, 0.0526, 0.0530, 0.0527, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0526, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0526, 0.0527, 0.0529, 0.0527, 0.0526,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0526, 0.0525, 0.0530, 0.0526, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0524, 0.0528, 0.0526, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0527, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0525, 0.0528,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0525, 0.0527, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0526, 0.0525, 0.0528, 0.0527, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0527, 0.0529, 0.0526, 0.0527,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0528,
         0.0527, 0.0524, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0526, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0523, 0.0526, 0.0527, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0526, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0526, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0526, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0526, 0.0528, 0.0525, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0525, 0.0528, 0.0526, 0.0524, 0.0526, 0.0528,
         0.0526, 0.0523, 0.0526, 0.0527, 0.0526, 0.0527, 0.0530, 0.0527, 0.0526,
         0.0525]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1115, 0.1111, 0.1112, 0.1114, 0.1109, 0.1111, 0.1110, 0.1107, 0.1111],
        [0.1115, 0.1110, 0.1112, 0.1114, 0.1108, 0.1111, 0.1111, 0.1108, 0.1112],
        [0.1115, 0.1110, 0.1112, 0.1114, 0.1108, 0.1111, 0.1111, 0.1107, 0.1111],
        [0.1115, 0.1111, 0.1112, 0.1114, 0.1108, 0.1111, 0.1110, 0.1108, 0.1112],
        [0.1115, 0.1110, 0.1112, 0.1113, 0.1108, 0.1111, 0.1111, 0.1107, 0.1111],
        [0.1115, 0.1111, 0.1112, 0.1113, 0.1108, 0.1111, 0.1111, 0.1107, 0.1112],
        [0.1115, 0.1110, 0.1112, 0.1114, 0.1108, 0.1111, 0.1111, 0.1108, 0.1111],
        [0.1115, 0.1110, 0.1112, 0.1114, 0.1108, 0.1111, 0.1111, 0.1108, 0.1112],
        [0.1115, 0.1110, 0.1112, 0.1113, 0.1108, 0.1111, 0.1111, 0.1108, 0.1112]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2789444923400879s
iter time cost:11.007527828216553s
-------------Round number: 107-------------
Evaluate global model
[running kmeans]: 5it [00:00, 333.03it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 0.4076
Averaged Test Accurancy: 0.8009
Std Test Accurancy: 0.0936
evaluate time cost:5.173824787139893s
clients training time cost:4.901986122131348s
[running kmeans]: 9it [00:00, 345.85it/s, center_shift=0.000000, iteration=9, tol=0.000100]
attn_optimize time cost:0.49833202362060547s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0500, 0.0500, 0.0500, 0.0504, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497,
         0.0499, 0.0497, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0497, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0502, 0.0499, 0.0501, 0.0505, 0.0501, 0.0498, 0.0504,
         0.0499, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0530, 0.0528,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0532, 0.0519, 0.0525, 0.0525, 0.0524, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0524, 0.0527, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0527,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0526, 0.0526, 0.0524, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0530, 0.0528,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0527, 0.0524, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0526],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0528,
         0.0526],
        [0.0527, 0.0531, 0.0521, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0528,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0519, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0527, 0.0524, 0.0526, 0.0526, 0.0531, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0526],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0524, 0.0527, 0.0523, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0524, 0.0527, 0.0527, 0.0530, 0.0529,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1436, 0.1430, 0.1418, 0.1413, 0.1431, 0.1420, 0.1453],
        [0.1438, 0.1432, 0.1417, 0.1414, 0.1431, 0.1420, 0.1449],
        [0.1437, 0.1430, 0.1419, 0.1413, 0.1431, 0.1420, 0.1450],
        [0.1436, 0.1432, 0.1417, 0.1414, 0.1431, 0.1420, 0.1450],
        [0.1437, 0.1431, 0.1416, 0.1414, 0.1430, 0.1419, 0.1453],
        [0.1436, 0.1429, 0.1417, 0.1414, 0.1430, 0.1419, 0.1455],
        [0.1438, 0.1430, 0.1413, 0.1410, 0.1432, 0.1416, 0.1461]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0837, 0.0835, 0.0838, 0.0837, 0.0823, 0.0834, 0.0827, 0.0837, 0.0835,
         0.0834, 0.0835, 0.0828],
        [0.0837, 0.0835, 0.0839, 0.0837, 0.0824, 0.0833, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0829],
        [0.0838, 0.0835, 0.0839, 0.0837, 0.0823, 0.0833, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0838, 0.0835, 0.0839, 0.0837, 0.0823, 0.0833, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0838, 0.0835, 0.0839, 0.0837, 0.0824, 0.0833, 0.0827, 0.0837, 0.0834,
         0.0833, 0.0835, 0.0828],
        [0.0837, 0.0834, 0.0838, 0.0837, 0.0824, 0.0834, 0.0827, 0.0837, 0.0835,
         0.0833, 0.0835, 0.0828],
        [0.0837, 0.0834, 0.0839, 0.0837, 0.0824, 0.0833, 0.0827, 0.0838, 0.0835,
         0.0833, 0.0835, 0.0828],
        [0.0837, 0.0835, 0.0839, 0.0837, 0.0823, 0.0833, 0.0827, 0.0836, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0837, 0.0834, 0.0838, 0.0837, 0.0824, 0.0834, 0.0827, 0.0837, 0.0835,
         0.0833, 0.0835, 0.0828],
        [0.0838, 0.0835, 0.0839, 0.0837, 0.0823, 0.0833, 0.0826, 0.0838, 0.0835,
         0.0833, 0.0835, 0.0828],
        [0.0838, 0.0835, 0.0839, 0.0837, 0.0823, 0.0833, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0837, 0.0835, 0.0839, 0.0837, 0.0824, 0.0833, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0836, 0.0828]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1426, 0.1441, 0.1437, 0.1423, 0.1429, 0.1415, 0.1428],
        [0.1425, 0.1441, 0.1438, 0.1424, 0.1428, 0.1416, 0.1428],
        [0.1426, 0.1440, 0.1438, 0.1423, 0.1430, 0.1416, 0.1428],
        [0.1427, 0.1441, 0.1437, 0.1423, 0.1429, 0.1415, 0.1428],
        [0.1426, 0.1441, 0.1438, 0.1423, 0.1429, 0.1416, 0.1428],
        [0.1424, 0.1442, 0.1439, 0.1423, 0.1428, 0.1415, 0.1430],
        [0.1426, 0.1441, 0.1437, 0.1425, 0.1428, 0.1416, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0626, 0.0625, 0.0626, 0.0625, 0.0626, 0.0624, 0.0624, 0.0624, 0.0627,
         0.0626, 0.0623, 0.0624, 0.0624, 0.0628, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0626, 0.0625, 0.0626, 0.0624, 0.0623, 0.0624, 0.0627,
         0.0625, 0.0623, 0.0624, 0.0624, 0.0629, 0.0626, 0.0623],
        [0.0626, 0.0626, 0.0626, 0.0625, 0.0627, 0.0623, 0.0624, 0.0624, 0.0627,
         0.0625, 0.0622, 0.0624, 0.0625, 0.0629, 0.0626, 0.0623],
        [0.0626, 0.0625, 0.0626, 0.0625, 0.0627, 0.0624, 0.0623, 0.0624, 0.0627,
         0.0625, 0.0623, 0.0624, 0.0624, 0.0629, 0.0626, 0.0622],
        [0.0626, 0.0625, 0.0626, 0.0625, 0.0626, 0.0623, 0.0624, 0.0624, 0.0627,
         0.0626, 0.0623, 0.0624, 0.0625, 0.0629, 0.0625, 0.0623],
        [0.0626, 0.0625, 0.0626, 0.0625, 0.0626, 0.0624, 0.0624, 0.0625, 0.0627,
         0.0625, 0.0623, 0.0624, 0.0624, 0.0628, 0.0626, 0.0622],
        [0.0626, 0.0626, 0.0626, 0.0625, 0.0626, 0.0624, 0.0624, 0.0624, 0.0627,
         0.0625, 0.0622, 0.0624, 0.0624, 0.0629, 0.0626, 0.0623],
        [0.0626, 0.0625, 0.0626, 0.0625, 0.0627, 0.0624, 0.0623, 0.0624, 0.0627,
         0.0625, 0.0623, 0.0624, 0.0624, 0.0628, 0.0626, 0.0623],
        [0.0626, 0.0625, 0.0626, 0.0625, 0.0626, 0.0624, 0.0624, 0.0624, 0.0627,
         0.0625, 0.0623, 0.0624, 0.0624, 0.0629, 0.0626, 0.0623],
        [0.0627, 0.0626, 0.0626, 0.0625, 0.0626, 0.0624, 0.0623, 0.0624, 0.0627,
         0.0625, 0.0622, 0.0624, 0.0625, 0.0628, 0.0626, 0.0622],
        [0.0627, 0.0626, 0.0626, 0.0625, 0.0627, 0.0624, 0.0623, 0.0624, 0.0627,
         0.0625, 0.0622, 0.0624, 0.0624, 0.0628, 0.0627, 0.0622],
        [0.0627, 0.0625, 0.0626, 0.0625, 0.0626, 0.0624, 0.0624, 0.0624, 0.0627,
         0.0625, 0.0623, 0.0624, 0.0625, 0.0629, 0.0626, 0.0622],
        [0.0626, 0.0626, 0.0626, 0.0625, 0.0627, 0.0624, 0.0623, 0.0624, 0.0627,
         0.0626, 0.0622, 0.0624, 0.0625, 0.0628, 0.0626, 0.0623],
        [0.0626, 0.0625, 0.0626, 0.0625, 0.0626, 0.0624, 0.0624, 0.0624, 0.0627,
         0.0625, 0.0623, 0.0624, 0.0624, 0.0628, 0.0626, 0.0623],
        [0.0627, 0.0625, 0.0626, 0.0625, 0.0626, 0.0624, 0.0623, 0.0624, 0.0626,
         0.0625, 0.0623, 0.0624, 0.0624, 0.0628, 0.0626, 0.0623],
        [0.0626, 0.0625, 0.0626, 0.0625, 0.0626, 0.0624, 0.0623, 0.0624, 0.0627,
         0.0625, 0.0622, 0.0624, 0.0625, 0.0629, 0.0626, 0.0623]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0765, 0.0768, 0.0767, 0.0768, 0.0765, 0.0772, 0.0770, 0.0772,
         0.0775, 0.0771, 0.0767, 0.0770],
        [0.0769, 0.0766, 0.0769, 0.0766, 0.0768, 0.0766, 0.0772, 0.0770, 0.0772,
         0.0775, 0.0771, 0.0767, 0.0770],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0772, 0.0770, 0.0771,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0766, 0.0768, 0.0765, 0.0772, 0.0770, 0.0772,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0767, 0.0765, 0.0772, 0.0770, 0.0773,
         0.0776, 0.0770, 0.0767, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0768, 0.0766, 0.0773, 0.0770, 0.0772,
         0.0775, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0768, 0.0766, 0.0768, 0.0764, 0.0773, 0.0770, 0.0773,
         0.0776, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0766, 0.0768, 0.0767, 0.0767, 0.0766, 0.0772, 0.0770, 0.0772,
         0.0775, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0768, 0.0765, 0.0772, 0.0770, 0.0772,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0766, 0.0769, 0.0766, 0.0768, 0.0765, 0.0772, 0.0769, 0.0772,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0767, 0.0767, 0.0768, 0.0766, 0.0773, 0.0769, 0.0772,
         0.0775, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0765, 0.0768, 0.0766, 0.0768, 0.0765, 0.0772, 0.0771, 0.0772,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0768, 0.0765, 0.0773, 0.0769, 0.0772,
         0.0776, 0.0771, 0.0767, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2513, 0.2503, 0.2507, 0.2477],
        [0.2510, 0.2502, 0.2512, 0.2476],
        [0.2514, 0.2500, 0.2510, 0.2476],
        [0.2510, 0.2506, 0.2510, 0.2473]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2950935363769531s
iter time cost:10.974334001541138s
-------------Round number: 108-------------
Evaluate global model
Averaged Train Loss: 0.3890
Averaged Test Accurancy: 0.8007
Std Test Accurancy: 0.0964
evaluate time cost:5.487352609634399s
clients training time cost:5.001667261123657s
attn_optimize time cost:0.4534120559692383s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1255, 0.1251, 0.1256, 0.1253, 0.1251, 0.1254, 0.1242, 0.1240],
        [0.1254, 0.1251, 0.1256, 0.1252, 0.1251, 0.1253, 0.1242, 0.1241],
        [0.1255, 0.1250, 0.1256, 0.1253, 0.1252, 0.1253, 0.1242, 0.1239],
        [0.1255, 0.1251, 0.1256, 0.1253, 0.1250, 0.1254, 0.1241, 0.1240],
        [0.1255, 0.1251, 0.1256, 0.1253, 0.1251, 0.1255, 0.1240, 0.1239],
        [0.1254, 0.1251, 0.1257, 0.1253, 0.1251, 0.1253, 0.1241, 0.1240],
        [0.1254, 0.1251, 0.1256, 0.1253, 0.1252, 0.1255, 0.1241, 0.1239],
        [0.1254, 0.1250, 0.1256, 0.1253, 0.1251, 0.1254, 0.1241, 0.1240]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2015, 0.1996, 0.2005, 0.1984],
        [0.1998, 0.2016, 0.1996, 0.2005, 0.1985],
        [0.2001, 0.2014, 0.1996, 0.2005, 0.1983],
        [0.2000, 0.2015, 0.1996, 0.2005, 0.1985],
        [0.1998, 0.2017, 0.1996, 0.2003, 0.1985]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0499, 0.0504,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0504,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499,
         0.0500, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0499, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0503, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0502, 0.0498, 0.0501, 0.0506, 0.0500, 0.0499, 0.0504,
         0.0499, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0500, 0.0505, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0502, 0.0496, 0.0501, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0499, 0.0500, 0.0504, 0.0497, 0.0502, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0496, 0.0502, 0.0496, 0.0501, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0505, 0.0497, 0.0501, 0.0498,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0501, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0504, 0.0497, 0.0502, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0505, 0.0497, 0.0501, 0.0498,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0505, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0499, 0.0499, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0504],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0499, 0.0500, 0.0501, 0.0505, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0496, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0505, 0.0497, 0.0502, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0501, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0500, 0.0505, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0499, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0498, 0.0496, 0.0498,
         0.0497, 0.0501, 0.0499, 0.0500, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0509],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0496, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0499, 0.0503, 0.0499, 0.0499, 0.0501, 0.0505, 0.0497, 0.0502, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0500, 0.0505, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0500, 0.0499, 0.0496, 0.0500,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0504],
        [0.0499, 0.0504, 0.0496, 0.0502, 0.0496, 0.0500, 0.0499, 0.0495, 0.0497,
         0.0498, 0.0501, 0.0498, 0.0502, 0.0501, 0.0506, 0.0497, 0.0501, 0.0497,
         0.0500, 0.0512]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1112, 0.1119, 0.1110, 0.1105, 0.1109, 0.1110, 0.1109, 0.1112, 0.1114],
        [0.1112, 0.1118, 0.1111, 0.1105, 0.1109, 0.1110, 0.1108, 0.1111, 0.1115],
        [0.1112, 0.1119, 0.1111, 0.1104, 0.1109, 0.1110, 0.1108, 0.1112, 0.1115],
        [0.1111, 0.1118, 0.1111, 0.1105, 0.1110, 0.1110, 0.1109, 0.1112, 0.1115],
        [0.1112, 0.1118, 0.1112, 0.1104, 0.1109, 0.1109, 0.1108, 0.1112, 0.1116],
        [0.1112, 0.1117, 0.1111, 0.1105, 0.1110, 0.1110, 0.1109, 0.1112, 0.1114],
        [0.1112, 0.1118, 0.1111, 0.1106, 0.1109, 0.1111, 0.1109, 0.1111, 0.1114],
        [0.1112, 0.1119, 0.1111, 0.1104, 0.1110, 0.1109, 0.1108, 0.1112, 0.1115],
        [0.1111, 0.1119, 0.1110, 0.1106, 0.1109, 0.1110, 0.1108, 0.1111, 0.1115]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0989, 0.0999, 0.0999, 0.0998, 0.1001, 0.1002, 0.1001, 0.0998, 0.1008,
         0.1004],
        [0.0989, 0.0998, 0.1000, 0.0999, 0.1001, 0.1003, 0.1001, 0.0998, 0.1008,
         0.1002],
        [0.0990, 0.0999, 0.1000, 0.0999, 0.0999, 0.1002, 0.1001, 0.0998, 0.1007,
         0.1004],
        [0.0990, 0.1000, 0.0999, 0.0998, 0.1000, 0.1003, 0.1000, 0.0998, 0.1007,
         0.1005],
        [0.0991, 0.0999, 0.1000, 0.0999, 0.1000, 0.1003, 0.1001, 0.0998, 0.1007,
         0.1003],
        [0.0989, 0.0998, 0.1001, 0.0999, 0.1001, 0.1002, 0.1000, 0.0998, 0.1009,
         0.1002],
        [0.0988, 0.0997, 0.1001, 0.1000, 0.1001, 0.1002, 0.1002, 0.1000, 0.1008,
         0.1002],
        [0.0990, 0.0998, 0.1001, 0.0999, 0.1001, 0.1002, 0.1001, 0.0998, 0.1008,
         0.1003],
        [0.0989, 0.0999, 0.1001, 0.0999, 0.1000, 0.1003, 0.1001, 0.0997, 0.1008,
         0.1003],
        [0.0989, 0.0999, 0.1000, 0.0998, 0.1001, 0.1003, 0.1000, 0.0998, 0.1008,
         0.1003]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1652, 0.1671, 0.1658, 0.1672, 0.1672, 0.1675],
        [0.1653, 0.1672, 0.1658, 0.1672, 0.1672, 0.1673],
        [0.1652, 0.1672, 0.1657, 0.1673, 0.1672, 0.1674],
        [0.1652, 0.1672, 0.1658, 0.1672, 0.1672, 0.1675],
        [0.1652, 0.1671, 0.1656, 0.1673, 0.1673, 0.1674],
        [0.1652, 0.1670, 0.1657, 0.1672, 0.1674, 0.1674]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0501,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0497],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0503, 0.0499, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0499, 0.0501, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0502, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0499, 0.0501, 0.0502, 0.0502, 0.0502,
         0.0496, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0499, 0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0501, 0.0502, 0.0501, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0500, 0.0500, 0.0500, 0.0502, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0500, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0502, 0.0501,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501,
         0.0497, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0500, 0.0500, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0496],
        [0.0501, 0.0501, 0.0502, 0.0499, 0.0503, 0.0500, 0.0500, 0.0499, 0.0501,
         0.0500, 0.0496, 0.0497, 0.0501, 0.0500, 0.0502, 0.0501, 0.0503, 0.0502,
         0.0495, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2899363040924072s
iter time cost:11.332051515579224s
-------------Round number: 109-------------
Evaluate global model
[running kmeans]: 6it [00:00, 322.37it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 0.3103
Averaged Test Accurancy: 0.8159
Std Test Accurancy: 0.0846
evaluate time cost:5.229863405227661s
clients training time cost:4.9422783851623535s
[running kmeans]: 5it [00:00, 312.21it/s, center_shift=0.000000, iteration=5, tol=0.000100]
attn_optimize time cost:0.48511815071105957s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0626, 0.0623, 0.0624, 0.0626, 0.0627, 0.0624, 0.0625, 0.0625, 0.0624,
         0.0623, 0.0624, 0.0628, 0.0624, 0.0622, 0.0630, 0.0624],
        [0.0626, 0.0623, 0.0624, 0.0625, 0.0627, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0622, 0.0624, 0.0628, 0.0624, 0.0622, 0.0630, 0.0624],
        [0.0626, 0.0623, 0.0624, 0.0625, 0.0627, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0622, 0.0624, 0.0628, 0.0624, 0.0622, 0.0630, 0.0624],
        [0.0626, 0.0624, 0.0624, 0.0626, 0.0627, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0623, 0.0624, 0.0628, 0.0624, 0.0622, 0.0630, 0.0625],
        [0.0627, 0.0622, 0.0625, 0.0626, 0.0627, 0.0625, 0.0624, 0.0624, 0.0624,
         0.0622, 0.0625, 0.0630, 0.0624, 0.0623, 0.0630, 0.0624],
        [0.0627, 0.0623, 0.0625, 0.0626, 0.0627, 0.0624, 0.0625, 0.0624, 0.0624,
         0.0622, 0.0624, 0.0629, 0.0624, 0.0622, 0.0631, 0.0624],
        [0.0627, 0.0622, 0.0624, 0.0626, 0.0626, 0.0624, 0.0626, 0.0625, 0.0623,
         0.0622, 0.0624, 0.0628, 0.0624, 0.0623, 0.0630, 0.0624],
        [0.0627, 0.0623, 0.0625, 0.0626, 0.0627, 0.0624, 0.0625, 0.0624, 0.0623,
         0.0622, 0.0624, 0.0629, 0.0624, 0.0623, 0.0630, 0.0624],
        [0.0627, 0.0622, 0.0624, 0.0626, 0.0627, 0.0625, 0.0626, 0.0625, 0.0624,
         0.0622, 0.0624, 0.0629, 0.0624, 0.0622, 0.0631, 0.0624],
        [0.0626, 0.0622, 0.0624, 0.0625, 0.0627, 0.0625, 0.0626, 0.0624, 0.0625,
         0.0622, 0.0624, 0.0628, 0.0624, 0.0622, 0.0630, 0.0624],
        [0.0626, 0.0623, 0.0624, 0.0625, 0.0627, 0.0625, 0.0625, 0.0624, 0.0624,
         0.0622, 0.0624, 0.0628, 0.0624, 0.0622, 0.0630, 0.0625],
        [0.0626, 0.0623, 0.0624, 0.0626, 0.0627, 0.0624, 0.0625, 0.0624, 0.0624,
         0.0622, 0.0624, 0.0629, 0.0624, 0.0622, 0.0631, 0.0624],
        [0.0626, 0.0623, 0.0624, 0.0626, 0.0627, 0.0624, 0.0624, 0.0625, 0.0623,
         0.0622, 0.0624, 0.0628, 0.0624, 0.0623, 0.0631, 0.0624],
        [0.0627, 0.0623, 0.0624, 0.0626, 0.0627, 0.0625, 0.0625, 0.0625, 0.0624,
         0.0622, 0.0624, 0.0628, 0.0624, 0.0622, 0.0630, 0.0625],
        [0.0627, 0.0622, 0.0625, 0.0625, 0.0627, 0.0624, 0.0626, 0.0624, 0.0624,
         0.0622, 0.0624, 0.0628, 0.0624, 0.0623, 0.0630, 0.0624],
        [0.0627, 0.0623, 0.0624, 0.0625, 0.0627, 0.0624, 0.0625, 0.0625, 0.0623,
         0.0622, 0.0624, 0.0628, 0.0624, 0.0623, 0.0630, 0.0625]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3323, 0.3342, 0.3335],
        [0.3326, 0.3342, 0.3333],
        [0.3322, 0.3343, 0.3335]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1428, 0.1419, 0.1414, 0.1432, 0.1419, 0.1452],
        [0.1437, 0.1431, 0.1417, 0.1415, 0.1432, 0.1419, 0.1448],
        [0.1437, 0.1428, 0.1420, 0.1414, 0.1433, 0.1419, 0.1449],
        [0.1436, 0.1430, 0.1418, 0.1415, 0.1432, 0.1420, 0.1449],
        [0.1436, 0.1429, 0.1417, 0.1415, 0.1431, 0.1419, 0.1453],
        [0.1436, 0.1428, 0.1418, 0.1416, 0.1430, 0.1418, 0.1454],
        [0.1438, 0.1428, 0.1414, 0.1411, 0.1433, 0.1415, 0.1460]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0530, 0.0521, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0528, 0.0531, 0.0520, 0.0524, 0.0525, 0.0524, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0530, 0.0521, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0526, 0.0525, 0.0526, 0.0523, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0521, 0.0526, 0.0525, 0.0524, 0.0526, 0.0524, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0530, 0.0528,
         0.0528],
        [0.0527, 0.0530, 0.0521, 0.0524, 0.0526, 0.0525, 0.0527, 0.0523, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0521, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0521, 0.0524, 0.0527, 0.0525, 0.0527, 0.0523, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0527],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0528,
         0.0528],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0523, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0521, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0531, 0.0521, 0.0524, 0.0526, 0.0525, 0.0527, 0.0523, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0524, 0.0526, 0.0523, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0530, 0.0529,
         0.0528]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0765, 0.0768, 0.0767, 0.0769, 0.0765, 0.0773, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0768, 0.0767, 0.0768, 0.0766, 0.0773, 0.0769, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0773, 0.0769, 0.0770,
         0.0774, 0.0771, 0.0768, 0.0768],
        [0.0770, 0.0765, 0.0769, 0.0766, 0.0768, 0.0765, 0.0773, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0768],
        [0.0770, 0.0765, 0.0768, 0.0767, 0.0768, 0.0765, 0.0773, 0.0769, 0.0771,
         0.0776, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0768, 0.0766, 0.0774, 0.0769, 0.0771,
         0.0775, 0.0770, 0.0769, 0.0768],
        [0.0771, 0.0765, 0.0767, 0.0766, 0.0769, 0.0764, 0.0774, 0.0769, 0.0771,
         0.0776, 0.0771, 0.0769, 0.0770],
        [0.0770, 0.0766, 0.0768, 0.0767, 0.0768, 0.0766, 0.0773, 0.0769, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0771, 0.0765, 0.0768, 0.0767, 0.0768, 0.0765, 0.0773, 0.0768, 0.0771,
         0.0775, 0.0770, 0.0769, 0.0769],
        [0.0770, 0.0766, 0.0769, 0.0766, 0.0768, 0.0765, 0.0774, 0.0768, 0.0771,
         0.0774, 0.0772, 0.0769, 0.0769],
        [0.0770, 0.0765, 0.0767, 0.0767, 0.0769, 0.0766, 0.0774, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0765, 0.0767, 0.0766, 0.0769, 0.0765, 0.0774, 0.0770, 0.0770,
         0.0775, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0769, 0.0765, 0.0774, 0.0768, 0.0771,
         0.0776, 0.0770, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0524, 0.0527, 0.0527,
         0.0526, 0.0525, 0.0525, 0.0527, 0.0526, 0.0524, 0.0529, 0.0526, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0523, 0.0527, 0.0528,
         0.0526, 0.0525, 0.0525, 0.0527, 0.0526, 0.0524, 0.0530, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0524, 0.0527, 0.0527,
         0.0526, 0.0524, 0.0525, 0.0527, 0.0526, 0.0524, 0.0530, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0523, 0.0527, 0.0528,
         0.0526, 0.0525, 0.0526, 0.0528, 0.0526, 0.0525, 0.0530, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0523, 0.0527, 0.0527,
         0.0526, 0.0525, 0.0525, 0.0527, 0.0526, 0.0525, 0.0530, 0.0527, 0.0526,
         0.0524],
        [0.0528, 0.0525, 0.0527, 0.0526, 0.0527, 0.0525, 0.0523, 0.0528, 0.0528,
         0.0526, 0.0525, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0527, 0.0528,
         0.0526, 0.0525, 0.0525, 0.0527, 0.0526, 0.0524, 0.0530, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0523, 0.0527, 0.0527,
         0.0526, 0.0525, 0.0526, 0.0528, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0528, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0527, 0.0528,
         0.0526, 0.0525, 0.0525, 0.0527, 0.0525, 0.0524, 0.0530, 0.0526, 0.0527,
         0.0525],
        [0.0529, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0523, 0.0527, 0.0527,
         0.0526, 0.0525, 0.0525, 0.0528, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0529, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0523, 0.0527, 0.0527,
         0.0525, 0.0524, 0.0526, 0.0528, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0529, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0524, 0.0527, 0.0528,
         0.0525, 0.0525, 0.0525, 0.0528, 0.0526, 0.0524, 0.0530, 0.0527, 0.0527,
         0.0524],
        [0.0529, 0.0525, 0.0527, 0.0526, 0.0527, 0.0526, 0.0523, 0.0527, 0.0527,
         0.0526, 0.0524, 0.0525, 0.0528, 0.0526, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0523, 0.0527, 0.0527,
         0.0526, 0.0525, 0.0526, 0.0528, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0523, 0.0528, 0.0527,
         0.0526, 0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0524, 0.0527, 0.0528,
         0.0526, 0.0525, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0525],
        [0.0529, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0523, 0.0527, 0.0528,
         0.0526, 0.0524, 0.0525, 0.0528, 0.0526, 0.0524, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0528, 0.0526, 0.0527, 0.0525, 0.0523, 0.0527, 0.0527,
         0.0526, 0.0525, 0.0526, 0.0528, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0523, 0.0527, 0.0527,
         0.0526, 0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0530, 0.0527, 0.0527,
         0.0524]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0497, 0.0492],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0499, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0500, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0501, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0500, 0.0505, 0.0501, 0.0505, 0.0505, 0.0503, 0.0503, 0.0493, 0.0499,
         0.0502, 0.0495, 0.0499, 0.0506, 0.0502, 0.0502, 0.0493, 0.0500, 0.0502,
         0.0497, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2988889217376709s
iter time cost:11.041224241256714s
-------------Round number: 110-------------
Evaluate global model
Averaged Train Loss: 0.3401
Averaged Test Accurancy: 0.8100
Std Test Accurancy: 0.1094
evaluate time cost:5.293784856796265s
clients training time cost:4.839458465576172s
attn_optimize time cost:0.6341264247894287s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0498, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0502, 0.0503, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0492],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0502, 0.0503, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0499, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0504, 0.0503, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0503, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0502, 0.0503, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0499, 0.0487],
        [0.0498, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0500, 0.0506, 0.0503, 0.0505, 0.0505, 0.0503, 0.0504, 0.0494, 0.0499,
         0.0501, 0.0495, 0.0499, 0.0506, 0.0502, 0.0501, 0.0492, 0.0499, 0.0502,
         0.0497, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0496],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0499, 0.0498, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0491],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0494],
        [0.0500, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0495],
        [0.0500, 0.0505, 0.0494, 0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501, 0.0503, 0.0502,
         0.0502, 0.0493],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0500, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0500, 0.0504, 0.0494, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0497],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0500, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0502,
         0.0502, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0501, 0.0495],
        [0.0500, 0.0504, 0.0493, 0.0498, 0.0501, 0.0499, 0.0501, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0496],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0502, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0502, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0500, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0502, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0497, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0495],
        [0.0500, 0.0506, 0.0492, 0.0499, 0.0501, 0.0498, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0506, 0.0503,
         0.0506, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1664, 0.1660, 0.1664, 0.1674, 0.1668, 0.1670],
        [0.1664, 0.1656, 0.1665, 0.1676, 0.1668, 0.1671],
        [0.1663, 0.1660, 0.1666, 0.1677, 0.1665, 0.1669],
        [0.1666, 0.1658, 0.1665, 0.1676, 0.1667, 0.1667],
        [0.1665, 0.1658, 0.1666, 0.1674, 0.1666, 0.1671],
        [0.1664, 0.1657, 0.1666, 0.1677, 0.1665, 0.1670]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0529, 0.0526, 0.0526, 0.0527, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0528, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0530, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0527, 0.0526, 0.0527, 0.0527, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0526, 0.0525,
         0.0526, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0523, 0.0531,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0525, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0527, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0527, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0530,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0772, 0.0769, 0.0770, 0.0767, 0.0772, 0.0768, 0.0768, 0.0771, 0.0769,
         0.0768, 0.0773, 0.0769, 0.0766],
        [0.0772, 0.0770, 0.0769, 0.0768, 0.0772, 0.0767, 0.0768, 0.0772, 0.0769,
         0.0767, 0.0773, 0.0769, 0.0766],
        [0.0772, 0.0770, 0.0769, 0.0767, 0.0773, 0.0767, 0.0768, 0.0771, 0.0768,
         0.0768, 0.0773, 0.0769, 0.0765],
        [0.0771, 0.0769, 0.0769, 0.0767, 0.0773, 0.0767, 0.0768, 0.0772, 0.0768,
         0.0767, 0.0773, 0.0769, 0.0765],
        [0.0772, 0.0769, 0.0769, 0.0767, 0.0772, 0.0767, 0.0768, 0.0772, 0.0769,
         0.0768, 0.0774, 0.0768, 0.0766],
        [0.0771, 0.0770, 0.0769, 0.0767, 0.0772, 0.0767, 0.0768, 0.0772, 0.0768,
         0.0767, 0.0773, 0.0769, 0.0766],
        [0.0772, 0.0769, 0.0769, 0.0767, 0.0773, 0.0766, 0.0768, 0.0771, 0.0769,
         0.0767, 0.0773, 0.0769, 0.0766],
        [0.0772, 0.0769, 0.0769, 0.0767, 0.0772, 0.0767, 0.0768, 0.0772, 0.0768,
         0.0767, 0.0774, 0.0769, 0.0766],
        [0.0773, 0.0770, 0.0769, 0.0767, 0.0772, 0.0767, 0.0768, 0.0772, 0.0769,
         0.0768, 0.0773, 0.0769, 0.0765],
        [0.0771, 0.0770, 0.0769, 0.0767, 0.0772, 0.0766, 0.0768, 0.0772, 0.0769,
         0.0768, 0.0772, 0.0769, 0.0766],
        [0.0772, 0.0769, 0.0769, 0.0767, 0.0772, 0.0767, 0.0768, 0.0772, 0.0768,
         0.0767, 0.0773, 0.0769, 0.0766],
        [0.0772, 0.0769, 0.0769, 0.0768, 0.0772, 0.0767, 0.0768, 0.0771, 0.0769,
         0.0767, 0.0773, 0.0769, 0.0766],
        [0.0772, 0.0769, 0.0769, 0.0767, 0.0772, 0.0767, 0.0768, 0.0772, 0.0768,
         0.0768, 0.0773, 0.0769, 0.0765]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1439, 0.1433, 0.1421, 0.1418, 0.1432, 0.1434, 0.1424],
        [0.1440, 0.1434, 0.1419, 0.1418, 0.1431, 0.1434, 0.1423],
        [0.1440, 0.1432, 0.1422, 0.1417, 0.1432, 0.1435, 0.1423],
        [0.1439, 0.1434, 0.1420, 0.1418, 0.1431, 0.1435, 0.1423],
        [0.1440, 0.1433, 0.1419, 0.1418, 0.1431, 0.1435, 0.1423],
        [0.1439, 0.1432, 0.1422, 0.1420, 0.1432, 0.1432, 0.1424],
        [0.1440, 0.1432, 0.1421, 0.1419, 0.1431, 0.1434, 0.1423]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0828, 0.0833, 0.0831, 0.0833, 0.0830, 0.0837, 0.0834, 0.0840,
         0.0836, 0.0832, 0.0834],
        [0.0833, 0.0829, 0.0834, 0.0830, 0.0832, 0.0830, 0.0837, 0.0835, 0.0839,
         0.0836, 0.0831, 0.0834],
        [0.0833, 0.0829, 0.0834, 0.0831, 0.0833, 0.0830, 0.0837, 0.0834, 0.0838,
         0.0836, 0.0831, 0.0833],
        [0.0833, 0.0829, 0.0834, 0.0830, 0.0832, 0.0830, 0.0837, 0.0834, 0.0839,
         0.0835, 0.0832, 0.0833],
        [0.0834, 0.0829, 0.0833, 0.0831, 0.0832, 0.0830, 0.0837, 0.0834, 0.0840,
         0.0835, 0.0832, 0.0833],
        [0.0834, 0.0829, 0.0834, 0.0831, 0.0832, 0.0831, 0.0838, 0.0834, 0.0839,
         0.0835, 0.0832, 0.0833],
        [0.0834, 0.0828, 0.0833, 0.0830, 0.0833, 0.0829, 0.0838, 0.0834, 0.0840,
         0.0835, 0.0832, 0.0834],
        [0.0833, 0.0829, 0.0833, 0.0831, 0.0831, 0.0830, 0.0837, 0.0834, 0.0839,
         0.0835, 0.0832, 0.0834],
        [0.0833, 0.0829, 0.0834, 0.0830, 0.0832, 0.0830, 0.0837, 0.0833, 0.0838,
         0.0836, 0.0832, 0.0833],
        [0.0834, 0.0828, 0.0832, 0.0831, 0.0833, 0.0831, 0.0837, 0.0833, 0.0839,
         0.0835, 0.0832, 0.0835],
        [0.0834, 0.0829, 0.0833, 0.0830, 0.0833, 0.0829, 0.0837, 0.0835, 0.0840,
         0.0836, 0.0832, 0.0834],
        [0.0833, 0.0828, 0.0834, 0.0831, 0.0832, 0.0830, 0.0837, 0.0833, 0.0840,
         0.0835, 0.0832, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2942945957183838s
iter time cost:11.149743795394897s
-------------Round number: 111-------------
Evaluate global model
[running kmeans]: 7it [00:00, 304.06it/s, center_shift=0.000000, iteration=7, tol=0.000100]
Averaged Train Loss: 0.3885
Averaged Test Accurancy: 0.7975
Std Test Accurancy: 0.0889
evaluate time cost:5.081909418106079s
clients training time cost:5.0691986083984375s
attn_optimize time cost:0.581122875213623s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1436, 0.1428, 0.1419, 0.1413, 0.1431, 0.1420, 0.1452],
        [0.1438, 0.1431, 0.1418, 0.1414, 0.1431, 0.1421, 0.1448],
        [0.1437, 0.1428, 0.1420, 0.1413, 0.1432, 0.1420, 0.1449],
        [0.1437, 0.1430, 0.1418, 0.1414, 0.1431, 0.1421, 0.1449],
        [0.1437, 0.1429, 0.1417, 0.1414, 0.1430, 0.1420, 0.1452],
        [0.1437, 0.1428, 0.1418, 0.1415, 0.1429, 0.1419, 0.1454],
        [0.1439, 0.1429, 0.1414, 0.1410, 0.1432, 0.1416, 0.1460]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0715, 0.0720, 0.0712, 0.0714, 0.0711, 0.0713, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0714, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0713, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0714, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0714, 0.0714, 0.0715, 0.0714,
         0.0714, 0.0713, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0720, 0.0712, 0.0714, 0.0710, 0.0713, 0.0714, 0.0714, 0.0715,
         0.0714, 0.0714, 0.0712, 0.0714, 0.0718],
        [0.0715, 0.0719, 0.0711, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0714, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0719, 0.0711, 0.0715, 0.0710, 0.0713, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0715, 0.0712, 0.0714, 0.0719],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0714, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0713, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0720, 0.0713, 0.0713, 0.0711, 0.0714, 0.0715, 0.0714, 0.0715,
         0.0714, 0.0713, 0.0714, 0.0714, 0.0717],
        [0.0715, 0.0720, 0.0712, 0.0714, 0.0711, 0.0713, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0713, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0720, 0.0711, 0.0714, 0.0710, 0.0713, 0.0715, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0714, 0.0719],
        [0.0715, 0.0720, 0.0711, 0.0715, 0.0711, 0.0713, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0712, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0713, 0.0715, 0.0714, 0.0714,
         0.0713, 0.0714, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0720, 0.0711, 0.0714, 0.0710, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0720, 0.0712, 0.0714, 0.0711, 0.0713, 0.0715, 0.0714, 0.0715,
         0.0714, 0.0714, 0.0713, 0.0714, 0.0718]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0497, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0497, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0502, 0.0498, 0.0501, 0.0506, 0.0501, 0.0498, 0.0504,
         0.0498, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0526, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0526, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525],
        [0.0527, 0.0525, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0527, 0.0526, 0.0527, 0.0529, 0.0528, 0.0526,
         0.0524],
        [0.0526, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0527,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0526, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0528,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0528, 0.0527,
         0.0524],
        [0.0527, 0.0526, 0.0528, 0.0526, 0.0528, 0.0525, 0.0524, 0.0525, 0.0527,
         0.0526, 0.0524, 0.0525, 0.0528, 0.0526, 0.0527, 0.0528, 0.0528, 0.0527,
         0.0524],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0525, 0.0525, 0.0528, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0524, 0.0525, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0528,
         0.0527, 0.0524, 0.0525, 0.0528, 0.0527, 0.0525, 0.0528, 0.0527, 0.0526,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0527, 0.0526, 0.0529, 0.0528, 0.0527,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0526,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0524, 0.0526, 0.0528,
         0.0527, 0.0523, 0.0525, 0.0528, 0.0526, 0.0525, 0.0529, 0.0528, 0.0527,
         0.0525],
        [0.0527, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0524, 0.0526, 0.0527,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0525],
        [0.0526, 0.0526, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0527, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0525]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1247, 0.1260, 0.1257, 0.1245, 0.1250, 0.1256, 0.1237, 0.1250],
        [0.1245, 0.1260, 0.1257, 0.1246, 0.1249, 0.1257, 0.1237, 0.1249],
        [0.1246, 0.1258, 0.1258, 0.1245, 0.1251, 0.1255, 0.1238, 0.1250],
        [0.1248, 0.1258, 0.1257, 0.1245, 0.1251, 0.1255, 0.1237, 0.1250],
        [0.1247, 0.1259, 0.1257, 0.1245, 0.1250, 0.1256, 0.1237, 0.1249],
        [0.1245, 0.1259, 0.1258, 0.1245, 0.1249, 0.1256, 0.1238, 0.1249],
        [0.1245, 0.1260, 0.1258, 0.1244, 0.1249, 0.1256, 0.1237, 0.1251],
        [0.1247, 0.1259, 0.1257, 0.1246, 0.1249, 0.1256, 0.1238, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0768, 0.0764, 0.0769, 0.0767, 0.0770, 0.0765, 0.0772, 0.0769, 0.0770,
         0.0776, 0.0772, 0.0768, 0.0769],
        [0.0768, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0776, 0.0772, 0.0767, 0.0770],
        [0.0768, 0.0765, 0.0769, 0.0767, 0.0770, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0775, 0.0772, 0.0768, 0.0769],
        [0.0768, 0.0765, 0.0769, 0.0767, 0.0769, 0.0765, 0.0773, 0.0769, 0.0771,
         0.0776, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0768, 0.0767, 0.0769, 0.0765, 0.0772, 0.0769, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0773, 0.0769, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0764, 0.0768, 0.0766, 0.0770, 0.0764, 0.0773, 0.0769, 0.0771,
         0.0777, 0.0772, 0.0768, 0.0770],
        [0.0768, 0.0765, 0.0769, 0.0768, 0.0769, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0776, 0.0772, 0.0768, 0.0770],
        [0.0769, 0.0764, 0.0769, 0.0767, 0.0769, 0.0765, 0.0772, 0.0768, 0.0770,
         0.0776, 0.0771, 0.0768, 0.0770],
        [0.0768, 0.0765, 0.0769, 0.0766, 0.0769, 0.0765, 0.0772, 0.0768, 0.0770,
         0.0775, 0.0773, 0.0768, 0.0769],
        [0.0769, 0.0764, 0.0767, 0.0767, 0.0770, 0.0766, 0.0773, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0771],
        [0.0768, 0.0765, 0.0768, 0.0766, 0.0770, 0.0765, 0.0772, 0.0770, 0.0770,
         0.0776, 0.0772, 0.0768, 0.0769],
        [0.0768, 0.0764, 0.0769, 0.0767, 0.0769, 0.0765, 0.0773, 0.0768, 0.0771,
         0.0777, 0.0771, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1653, 0.1672, 0.1666, 0.1686, 0.1680, 0.1644],
        [0.1652, 0.1671, 0.1665, 0.1682, 0.1677, 0.1653],
        [0.1653, 0.1671, 0.1665, 0.1683, 0.1680, 0.1647],
        [0.1650, 0.1673, 0.1665, 0.1684, 0.1676, 0.1652],
        [0.1650, 0.1671, 0.1664, 0.1684, 0.1677, 0.1653],
        [0.1642, 0.1673, 0.1659, 0.1691, 0.1688, 0.1648]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0914, 0.0911, 0.0915, 0.0913, 0.0898, 0.0910, 0.0902, 0.0913, 0.0910,
         0.0912, 0.0903],
        [0.0914, 0.0911, 0.0916, 0.0913, 0.0898, 0.0908, 0.0902, 0.0913, 0.0909,
         0.0911, 0.0904],
        [0.0915, 0.0911, 0.0916, 0.0913, 0.0898, 0.0909, 0.0902, 0.0913, 0.0909,
         0.0911, 0.0903],
        [0.0914, 0.0911, 0.0915, 0.0913, 0.0898, 0.0909, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0903],
        [0.0915, 0.0910, 0.0915, 0.0913, 0.0899, 0.0909, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0903],
        [0.0914, 0.0910, 0.0915, 0.0913, 0.0899, 0.0910, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0903],
        [0.0914, 0.0910, 0.0915, 0.0914, 0.0898, 0.0909, 0.0901, 0.0914, 0.0910,
         0.0911, 0.0902],
        [0.0914, 0.0911, 0.0916, 0.0913, 0.0898, 0.0908, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0903],
        [0.0914, 0.0910, 0.0915, 0.0914, 0.0898, 0.0910, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0903],
        [0.0915, 0.0911, 0.0916, 0.0913, 0.0898, 0.0908, 0.0902, 0.0914, 0.0910,
         0.0911, 0.0903],
        [0.0914, 0.0911, 0.0915, 0.0913, 0.0899, 0.0909, 0.0902, 0.0913, 0.0909,
         0.0912, 0.0903]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2672450542449951s
iter time cost:11.088124990463257s
-------------Round number: 112-------------
Evaluate global model
[running kmeans]: 7it [00:00, 284.65it/s, center_shift=0.000000, iteration=7, tol=0.000100]
Averaged Train Loss: 0.3423
Averaged Test Accurancy: 0.8093
Std Test Accurancy: 0.0762
evaluate time cost:5.063165187835693s
clients training time cost:5.026792049407959s
attn_optimize time cost:0.534074068069458s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0629, 0.0626, 0.0629, 0.0628, 0.0627, 0.0627, 0.0618, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0622],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0627, 0.0618, 0.0625, 0.0620,
         0.0628, 0.0625, 0.0626, 0.0617, 0.0623, 0.0627, 0.0622],
        [0.0629, 0.0627, 0.0629, 0.0628, 0.0628, 0.0627, 0.0618, 0.0625, 0.0620,
         0.0628, 0.0625, 0.0626, 0.0618, 0.0623, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0626, 0.0618, 0.0626, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0622],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0626, 0.0617, 0.0625, 0.0619,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0623, 0.0626, 0.0621],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0621],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0626, 0.0618, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0621],
        [0.0629, 0.0626, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0626, 0.0618, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0626, 0.0618, 0.0625, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0622],
        [0.0629, 0.0626, 0.0629, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0622],
        [0.0630, 0.0626, 0.0630, 0.0629, 0.0628, 0.0627, 0.0618, 0.0625, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0616, 0.0623, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0629, 0.0628, 0.0626, 0.0618, 0.0626, 0.0620,
         0.0629, 0.0625, 0.0626, 0.0617, 0.0623, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0628, 0.0626, 0.0618, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0621],
        [0.0629, 0.0626, 0.0629, 0.0628, 0.0627, 0.0626, 0.0619, 0.0626, 0.0621,
         0.0628, 0.0625, 0.0626, 0.0617, 0.0623, 0.0627, 0.0622]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2513, 0.2510, 0.2521, 0.2457],
        [0.2509, 0.2505, 0.2517, 0.2469],
        [0.2508, 0.2504, 0.2516, 0.2472],
        [0.2512, 0.2515, 0.2515, 0.2458]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2005, 0.1995, 0.1994, 0.2015, 0.1991],
        [0.2001, 0.2000, 0.1992, 0.2013, 0.1994],
        [0.2003, 0.1998, 0.1992, 0.2013, 0.1995],
        [0.2003, 0.1998, 0.1992, 0.2013, 0.1993],
        [0.2008, 0.2001, 0.1995, 0.2015, 0.1981]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1431, 0.1417, 0.1414, 0.1429, 0.1420, 0.1453],
        [0.1436, 0.1433, 0.1416, 0.1415, 0.1430, 0.1420, 0.1449],
        [0.1436, 0.1431, 0.1418, 0.1414, 0.1430, 0.1420, 0.1450],
        [0.1435, 0.1432, 0.1417, 0.1415, 0.1430, 0.1420, 0.1450],
        [0.1436, 0.1432, 0.1415, 0.1415, 0.1429, 0.1420, 0.1453],
        [0.1435, 0.1430, 0.1417, 0.1416, 0.1428, 0.1419, 0.1455],
        [0.1437, 0.1432, 0.1413, 0.1411, 0.1430, 0.1416, 0.1461]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0669, 0.0666, 0.0667, 0.0668, 0.0667, 0.0667, 0.0664, 0.0665, 0.0668,
         0.0666, 0.0666, 0.0671, 0.0666, 0.0664, 0.0666],
        [0.0668, 0.0666, 0.0666, 0.0668, 0.0667, 0.0668, 0.0664, 0.0664, 0.0668,
         0.0666, 0.0666, 0.0670, 0.0666, 0.0664, 0.0667],
        [0.0669, 0.0666, 0.0667, 0.0668, 0.0667, 0.0668, 0.0664, 0.0665, 0.0668,
         0.0666, 0.0666, 0.0671, 0.0666, 0.0664, 0.0666],
        [0.0668, 0.0666, 0.0667, 0.0668, 0.0667, 0.0667, 0.0664, 0.0665, 0.0667,
         0.0666, 0.0666, 0.0670, 0.0666, 0.0664, 0.0667],
        [0.0669, 0.0666, 0.0667, 0.0668, 0.0667, 0.0667, 0.0664, 0.0664, 0.0668,
         0.0666, 0.0667, 0.0671, 0.0666, 0.0664, 0.0666],
        [0.0669, 0.0666, 0.0667, 0.0668, 0.0666, 0.0667, 0.0664, 0.0665, 0.0668,
         0.0665, 0.0667, 0.0671, 0.0667, 0.0665, 0.0666],
        [0.0669, 0.0666, 0.0667, 0.0668, 0.0667, 0.0667, 0.0664, 0.0665, 0.0668,
         0.0666, 0.0666, 0.0671, 0.0666, 0.0665, 0.0666],
        [0.0669, 0.0665, 0.0667, 0.0667, 0.0668, 0.0667, 0.0665, 0.0664, 0.0668,
         0.0666, 0.0666, 0.0671, 0.0667, 0.0664, 0.0666],
        [0.0668, 0.0666, 0.0667, 0.0668, 0.0667, 0.0667, 0.0664, 0.0664, 0.0668,
         0.0666, 0.0666, 0.0671, 0.0667, 0.0665, 0.0666],
        [0.0669, 0.0666, 0.0667, 0.0668, 0.0667, 0.0667, 0.0663, 0.0664, 0.0668,
         0.0666, 0.0666, 0.0671, 0.0666, 0.0664, 0.0666],
        [0.0668, 0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0664, 0.0664, 0.0668,
         0.0666, 0.0666, 0.0671, 0.0667, 0.0664, 0.0667],
        [0.0669, 0.0666, 0.0667, 0.0668, 0.0667, 0.0667, 0.0664, 0.0664, 0.0668,
         0.0666, 0.0666, 0.0671, 0.0666, 0.0664, 0.0666],
        [0.0668, 0.0666, 0.0667, 0.0668, 0.0666, 0.0667, 0.0664, 0.0665, 0.0668,
         0.0666, 0.0667, 0.0671, 0.0667, 0.0665, 0.0666],
        [0.0669, 0.0666, 0.0667, 0.0668, 0.0667, 0.0667, 0.0664, 0.0664, 0.0668,
         0.0666, 0.0666, 0.0670, 0.0667, 0.0664, 0.0667],
        [0.0669, 0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0664, 0.0664, 0.0668,
         0.0666, 0.0666, 0.0670, 0.0666, 0.0665, 0.0667]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2498, 0.2510, 0.2499, 0.2493],
        [0.2497, 0.2510, 0.2500, 0.2493],
        [0.2498, 0.2509, 0.2498, 0.2495],
        [0.2497, 0.2510, 0.2498, 0.2494]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1106, 0.1110, 0.1107, 0.1109, 0.1108, 0.1112, 0.1121, 0.1115, 0.1112],
        [0.1105, 0.1111, 0.1108, 0.1111, 0.1107, 0.1112, 0.1120, 0.1115, 0.1111],
        [0.1106, 0.1111, 0.1107, 0.1109, 0.1107, 0.1112, 0.1121, 0.1115, 0.1111],
        [0.1106, 0.1110, 0.1109, 0.1109, 0.1107, 0.1111, 0.1122, 0.1114, 0.1111],
        [0.1106, 0.1111, 0.1108, 0.1109, 0.1108, 0.1112, 0.1121, 0.1114, 0.1112],
        [0.1106, 0.1110, 0.1109, 0.1108, 0.1108, 0.1111, 0.1121, 0.1115, 0.1112],
        [0.1106, 0.1111, 0.1107, 0.1109, 0.1107, 0.1111, 0.1120, 0.1117, 0.1112],
        [0.1105, 0.1108, 0.1108, 0.1110, 0.1108, 0.1110, 0.1121, 0.1115, 0.1114],
        [0.1105, 0.1111, 0.1108, 0.1110, 0.1107, 0.1111, 0.1122, 0.1114, 0.1113]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0530, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0530,
         0.0526],
        [0.0527, 0.0532, 0.0519, 0.0525, 0.0525, 0.0524, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0527, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0525, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0526, 0.0526, 0.0524, 0.0526, 0.0525, 0.0527,
         0.0526, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0527, 0.0529, 0.0528,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0530, 0.0530,
         0.0526],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0527, 0.0526, 0.0527, 0.0524, 0.0526,
         0.0525, 0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0527, 0.0529, 0.0530,
         0.0526],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0531, 0.0521, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0526],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0530, 0.0530,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0530,
         0.0526],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0524, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0530, 0.0529,
         0.0527]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0498, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0497],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0498, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0498, 0.0498, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0496, 0.0499, 0.0503, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502,
         0.0497, 0.0495],
        [0.0502, 0.0500, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0499, 0.0497, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0502, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0496, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0500, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0496, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0498, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0503,
         0.0500, 0.0496, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0498, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0496],
        [0.0501, 0.0500, 0.0503, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0495, 0.0498, 0.0503, 0.0499, 0.0502, 0.0502, 0.0504, 0.0502,
         0.0496, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27463459968566895s
iter time cost:10.987368106842041s
-------------Round number: 113-------------
Evaluate global model
[running kmeans]: 5it [00:00, 262.92it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 0.3579
Averaged Test Accurancy: 0.8051
Std Test Accurancy: 0.0894
evaluate time cost:5.136437177658081s
clients training time cost:5.34780740737915s
attn_optimize time cost:0.5440633296966553s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0497],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0503, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0504, 0.0500, 0.0502,
         0.0498, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0503, 0.0500, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0502, 0.0500, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0503, 0.0500, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0503, 0.0499, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0500, 0.0503, 0.0501, 0.0502,
         0.0497, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0501, 0.0502,
         0.0497, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0502, 0.0499, 0.0497, 0.0500, 0.0502,
         0.0499, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0504, 0.0500, 0.0502,
         0.0497, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0502, 0.0500, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0500, 0.0503, 0.0500, 0.0502,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0500, 0.0497, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0500, 0.0503, 0.0501, 0.0502,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0499, 0.0503, 0.0501, 0.0502,
         0.0497, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0497, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0503, 0.0500, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0497, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0504, 0.0499, 0.0496, 0.0499, 0.0501,
         0.0500, 0.0497, 0.0498, 0.0502, 0.0501, 0.0502, 0.0502, 0.0502, 0.0503,
         0.0495, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0525, 0.0527, 0.0525, 0.0526, 0.0529, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0529, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0525, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0525, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0525, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0524, 0.0525, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0525, 0.0524,
         0.0524, 0.0525, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0525, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0526, 0.0528, 0.0527, 0.0527, 0.0525, 0.0525,
         0.0526, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0525, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0525, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0525, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0527, 0.0526, 0.0525, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0525, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0524, 0.0525, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0525, 0.0531,
         0.0526],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0528, 0.0526, 0.0527, 0.0525, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0525, 0.0531,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2501, 0.2494, 0.2473, 0.2532],
        [0.2503, 0.2492, 0.2472, 0.2533],
        [0.2502, 0.2491, 0.2471, 0.2536],
        [0.2503, 0.2492, 0.2462, 0.2543]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0505, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0503, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0504, 0.0503, 0.0504, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0503, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0497, 0.0491],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0499, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0491],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0502, 0.0503, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0500, 0.0505, 0.0502, 0.0505, 0.0505, 0.0504, 0.0503, 0.0493, 0.0499,
         0.0502, 0.0495, 0.0499, 0.0506, 0.0503, 0.0501, 0.0493, 0.0499, 0.0502,
         0.0497, 0.0488]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0828, 0.0827, 0.0832, 0.0832, 0.0837, 0.0833, 0.0835, 0.0840,
         0.0835, 0.0832, 0.0834],
        [0.0834, 0.0829, 0.0827, 0.0833, 0.0832, 0.0838, 0.0833, 0.0835, 0.0839,
         0.0835, 0.0832, 0.0833],
        [0.0835, 0.0827, 0.0827, 0.0833, 0.0831, 0.0837, 0.0832, 0.0837, 0.0841,
         0.0834, 0.0832, 0.0833],
        [0.0834, 0.0828, 0.0827, 0.0833, 0.0833, 0.0838, 0.0833, 0.0835, 0.0839,
         0.0835, 0.0832, 0.0833],
        [0.0835, 0.0828, 0.0828, 0.0832, 0.0831, 0.0838, 0.0832, 0.0836, 0.0840,
         0.0834, 0.0832, 0.0832],
        [0.0835, 0.0827, 0.0828, 0.0831, 0.0832, 0.0838, 0.0832, 0.0836, 0.0840,
         0.0834, 0.0833, 0.0833],
        [0.0835, 0.0829, 0.0826, 0.0833, 0.0831, 0.0838, 0.0833, 0.0835, 0.0840,
         0.0835, 0.0833, 0.0834],
        [0.0835, 0.0828, 0.0828, 0.0833, 0.0831, 0.0837, 0.0832, 0.0835, 0.0840,
         0.0834, 0.0833, 0.0833],
        [0.0835, 0.0829, 0.0826, 0.0833, 0.0831, 0.0838, 0.0832, 0.0835, 0.0839,
         0.0836, 0.0833, 0.0833],
        [0.0835, 0.0828, 0.0826, 0.0831, 0.0832, 0.0838, 0.0832, 0.0836, 0.0840,
         0.0835, 0.0832, 0.0834],
        [0.0835, 0.0828, 0.0828, 0.0831, 0.0832, 0.0838, 0.0833, 0.0835, 0.0840,
         0.0835, 0.0833, 0.0833],
        [0.0834, 0.0828, 0.0828, 0.0833, 0.0832, 0.0838, 0.0832, 0.0836, 0.0841,
         0.0834, 0.0832, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0529, 0.0530,
         0.0526],
        [0.0528, 0.0532, 0.0519, 0.0525, 0.0525, 0.0524, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0524, 0.0527, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0527,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0526, 0.0525, 0.0524, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0526, 0.0529, 0.0528,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0523, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0529, 0.0530,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0521, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0529, 0.0528,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0519, 0.0524, 0.0527, 0.0525, 0.0527, 0.0523, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0526, 0.0524, 0.0527, 0.0523, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0526, 0.0530, 0.0529,
         0.0528]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5027, 0.4973],
        [0.5026, 0.4974]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5005, 0.4995],
        [0.5004, 0.4996]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.31385374069213867s
iter time cost:11.43224835395813s
-------------Round number: 114-------------
Evaluate global model
[running kmeans]: 6it [00:00, 315.50it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 0.3583
Averaged Test Accurancy: 0.8071
Std Test Accurancy: 0.0814
evaluate time cost:5.167661905288696s
clients training time cost:5.368680238723755s
[running kmeans]: 7it [00:00, 317.88it/s, center_shift=0.000000, iteration=7, tol=0.000100]
attn_optimize time cost:0.5351772308349609s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0629, 0.0627, 0.0629, 0.0628, 0.0627, 0.0627, 0.0618, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0627, 0.0618, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0623, 0.0626, 0.0622],
        [0.0630, 0.0627, 0.0630, 0.0628, 0.0628, 0.0627, 0.0617, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0627, 0.0618, 0.0623, 0.0626, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0626, 0.0618, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0622, 0.0626, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0626, 0.0617, 0.0625, 0.0619,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0626, 0.0621],
        [0.0630, 0.0626, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0623, 0.0626, 0.0621],
        [0.0630, 0.0626, 0.0630, 0.0629, 0.0627, 0.0626, 0.0618, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0623, 0.0627, 0.0621],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0626, 0.0619, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0622, 0.0626, 0.0621],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0626, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0626, 0.0618, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0623, 0.0626, 0.0622],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0626, 0.0622],
        [0.0630, 0.0627, 0.0631, 0.0629, 0.0628, 0.0627, 0.0617, 0.0625, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0616, 0.0623, 0.0626, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0626, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0623, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0628, 0.0627, 0.0626, 0.0618, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0626, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0627, 0.0618, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0621]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0497, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0497, 0.0495, 0.0499,
         0.0497, 0.0501, 0.0500, 0.0501, 0.0501, 0.0505, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0510],
        [0.0499, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0496, 0.0501, 0.0495, 0.0501, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0501, 0.0505, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0501, 0.0498, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0497, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0499, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0505],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0497, 0.0499, 0.0497, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0505, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0495, 0.0501, 0.0498, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0499, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0497, 0.0500, 0.0497, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0498, 0.0500, 0.0496, 0.0500, 0.0497, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0502, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0498,
         0.0497, 0.0501, 0.0500, 0.0501, 0.0501, 0.0504, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0511],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0497, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0499, 0.0497, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0501, 0.0505, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0505],
        [0.0498, 0.0505, 0.0496, 0.0501, 0.0496, 0.0500, 0.0498, 0.0495, 0.0496,
         0.0497, 0.0501, 0.0499, 0.0502, 0.0501, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0500, 0.0514]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0527, 0.0528, 0.0525, 0.0527, 0.0525, 0.0526, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0526, 0.0526,
         0.0524],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0530, 0.0527, 0.0526,
         0.0524],
        [0.0528, 0.0527, 0.0528, 0.0525, 0.0528, 0.0524, 0.0525, 0.0526, 0.0529,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0530, 0.0526, 0.0527,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0525, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0524, 0.0525, 0.0526, 0.0529,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0526, 0.0530, 0.0526, 0.0526,
         0.0524],
        [0.0528, 0.0526, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0529,
         0.0526, 0.0524, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0530, 0.0526, 0.0526,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0524, 0.0525, 0.0528, 0.0526, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0525],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0530, 0.0526, 0.0526,
         0.0525],
        [0.0528, 0.0527, 0.0527, 0.0525, 0.0527, 0.0524, 0.0525, 0.0526, 0.0529,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0523, 0.0525, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0525, 0.0528, 0.0526, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0524],
        [0.0528, 0.0526, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0525, 0.0528, 0.0526, 0.0526, 0.0529, 0.0526, 0.0527,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0527, 0.0525, 0.0529, 0.0527, 0.0526,
         0.0524],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0529,
         0.0527, 0.0523, 0.0525, 0.0527, 0.0527, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0527, 0.0527, 0.0525, 0.0527, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0529, 0.0526, 0.0526,
         0.0525],
        [0.0528, 0.0527, 0.0527, 0.0525, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0525, 0.0528, 0.0526, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0527, 0.0524, 0.0525, 0.0528, 0.0526, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0527, 0.0527, 0.0527, 0.0525, 0.0527, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0527, 0.0524, 0.0525, 0.0527, 0.0527, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0524]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2513, 0.2509, 0.2520, 0.2458],
        [0.2510, 0.2504, 0.2516, 0.2470],
        [0.2508, 0.2504, 0.2516, 0.2473],
        [0.2513, 0.2512, 0.2513, 0.2463]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0836, 0.0833, 0.0836, 0.0829, 0.0831, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0830, 0.0833],
        [0.0836, 0.0833, 0.0835, 0.0830, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0830, 0.0833],
        [0.0836, 0.0833, 0.0835, 0.0830, 0.0831, 0.0835, 0.0833, 0.0833, 0.0837,
         0.0833, 0.0831, 0.0833],
        [0.0836, 0.0834, 0.0836, 0.0829, 0.0830, 0.0835, 0.0832, 0.0833, 0.0838,
         0.0833, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0834, 0.0831, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0834, 0.0830, 0.0833],
        [0.0836, 0.0833, 0.0836, 0.0830, 0.0830, 0.0835, 0.0832, 0.0833, 0.0837,
         0.0834, 0.0831, 0.0832],
        [0.0836, 0.0833, 0.0835, 0.0829, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0835, 0.0830, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0834, 0.0830, 0.0833],
        [0.0836, 0.0833, 0.0835, 0.0830, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0830, 0.0833],
        [0.0836, 0.0833, 0.0835, 0.0830, 0.0830, 0.0835, 0.0832, 0.0833, 0.0837,
         0.0834, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0835, 0.0830, 0.0830, 0.0835, 0.0833, 0.0833, 0.0837,
         0.0834, 0.0831, 0.0833],
        [0.0836, 0.0833, 0.0835, 0.0830, 0.0830, 0.0835, 0.0833, 0.0833, 0.0837,
         0.0833, 0.0831, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0531, 0.0521, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0532, 0.0519, 0.0525, 0.0525, 0.0524, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0524, 0.0527, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0521, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0527,
         0.0525, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0526, 0.0525, 0.0524, 0.0526, 0.0525, 0.0527,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0527, 0.0529, 0.0528,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0521, 0.0524, 0.0526, 0.0524, 0.0527, 0.0524, 0.0527,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0523, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0529, 0.0530,
         0.0527],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0527,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0527, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0521, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0527,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0527, 0.0530, 0.0530,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0530, 0.0521, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0523, 0.0527,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0524, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0524, 0.0526, 0.0523, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0524, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0528]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1434, 0.1428, 0.1426, 0.1425, 0.1424, 0.1441, 0.1423],
        [0.1433, 0.1426, 0.1427, 0.1424, 0.1424, 0.1441, 0.1426],
        [0.1430, 0.1426, 0.1430, 0.1427, 0.1422, 0.1439, 0.1425],
        [0.1433, 0.1427, 0.1429, 0.1427, 0.1423, 0.1440, 0.1422],
        [0.1432, 0.1426, 0.1429, 0.1426, 0.1423, 0.1439, 0.1426],
        [0.1433, 0.1426, 0.1429, 0.1425, 0.1423, 0.1440, 0.1425],
        [0.1436, 0.1427, 0.1430, 0.1425, 0.1424, 0.1441, 0.1415]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.29498767852783203s
iter time cost:11.455587148666382s
-------------Round number: 115-------------
Evaluate global model
Averaged Train Loss: 0.4112
Averaged Test Accurancy: 0.7989
Std Test Accurancy: 0.0954
evaluate time cost:4.851223707199097s
clients training time cost:5.097640752792358s
attn_optimize time cost:0.48431873321533203s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2015, 0.1991, 0.1997, 0.2000, 0.1996],
        [0.2015, 0.1991, 0.1999, 0.1999, 0.1996],
        [0.2016, 0.1990, 0.1999, 0.1999, 0.1996],
        [0.2013, 0.1991, 0.2000, 0.2000, 0.1996],
        [0.2013, 0.1992, 0.1998, 0.2001, 0.1997]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0716, 0.0707, 0.0712, 0.0714, 0.0713, 0.0714, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0715, 0.0719, 0.0718, 0.0715],
        [0.0717, 0.0706, 0.0712, 0.0713, 0.0712, 0.0715, 0.0714, 0.0715, 0.0714,
         0.0712, 0.0715, 0.0720, 0.0718, 0.0717],
        [0.0716, 0.0706, 0.0712, 0.0714, 0.0713, 0.0715, 0.0715, 0.0715, 0.0714,
         0.0712, 0.0715, 0.0720, 0.0718, 0.0715],
        [0.0715, 0.0707, 0.0713, 0.0714, 0.0713, 0.0714, 0.0713, 0.0715, 0.0715,
         0.0712, 0.0715, 0.0719, 0.0718, 0.0717],
        [0.0716, 0.0706, 0.0714, 0.0714, 0.0712, 0.0714, 0.0714, 0.0716, 0.0714,
         0.0712, 0.0715, 0.0719, 0.0717, 0.0717],
        [0.0716, 0.0706, 0.0712, 0.0714, 0.0713, 0.0714, 0.0714, 0.0716, 0.0714,
         0.0714, 0.0715, 0.0719, 0.0719, 0.0715],
        [0.0715, 0.0707, 0.0713, 0.0714, 0.0713, 0.0714, 0.0714, 0.0716, 0.0714,
         0.0712, 0.0714, 0.0719, 0.0717, 0.0717],
        [0.0716, 0.0706, 0.0712, 0.0715, 0.0713, 0.0715, 0.0714, 0.0715, 0.0714,
         0.0712, 0.0714, 0.0720, 0.0718, 0.0715],
        [0.0716, 0.0706, 0.0711, 0.0715, 0.0713, 0.0714, 0.0714, 0.0715, 0.0715,
         0.0713, 0.0714, 0.0719, 0.0719, 0.0716],
        [0.0716, 0.0706, 0.0712, 0.0715, 0.0712, 0.0715, 0.0714, 0.0715, 0.0714,
         0.0712, 0.0715, 0.0719, 0.0718, 0.0716],
        [0.0716, 0.0706, 0.0711, 0.0714, 0.0713, 0.0715, 0.0714, 0.0715, 0.0715,
         0.0713, 0.0715, 0.0719, 0.0719, 0.0715],
        [0.0716, 0.0705, 0.0712, 0.0715, 0.0713, 0.0714, 0.0714, 0.0716, 0.0714,
         0.0712, 0.0714, 0.0720, 0.0718, 0.0716],
        [0.0716, 0.0706, 0.0712, 0.0714, 0.0713, 0.0714, 0.0714, 0.0716, 0.0714,
         0.0713, 0.0714, 0.0719, 0.0719, 0.0715],
        [0.0716, 0.0706, 0.0713, 0.0714, 0.0712, 0.0714, 0.0715, 0.0715, 0.0714,
         0.0712, 0.0715, 0.0720, 0.0718, 0.0716]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0764, 0.0769, 0.0767, 0.0769, 0.0765, 0.0773, 0.0770, 0.0772,
         0.0775, 0.0770, 0.0768, 0.0770],
        [0.0769, 0.0764, 0.0770, 0.0767, 0.0769, 0.0765, 0.0773, 0.0770, 0.0771,
         0.0775, 0.0770, 0.0767, 0.0770],
        [0.0769, 0.0764, 0.0770, 0.0767, 0.0769, 0.0765, 0.0773, 0.0769, 0.0771,
         0.0774, 0.0770, 0.0767, 0.0769],
        [0.0769, 0.0765, 0.0770, 0.0767, 0.0768, 0.0765, 0.0774, 0.0770, 0.0772,
         0.0775, 0.0770, 0.0768, 0.0769],
        [0.0769, 0.0764, 0.0769, 0.0768, 0.0768, 0.0765, 0.0773, 0.0769, 0.0772,
         0.0776, 0.0769, 0.0768, 0.0769],
        [0.0769, 0.0764, 0.0770, 0.0767, 0.0768, 0.0766, 0.0774, 0.0769, 0.0772,
         0.0775, 0.0769, 0.0768, 0.0769],
        [0.0770, 0.0763, 0.0769, 0.0767, 0.0769, 0.0764, 0.0774, 0.0769, 0.0772,
         0.0776, 0.0769, 0.0768, 0.0770],
        [0.0769, 0.0765, 0.0769, 0.0768, 0.0768, 0.0765, 0.0773, 0.0769, 0.0771,
         0.0775, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0764, 0.0770, 0.0767, 0.0769, 0.0765, 0.0773, 0.0769, 0.0771,
         0.0775, 0.0769, 0.0768, 0.0770],
        [0.0769, 0.0765, 0.0770, 0.0767, 0.0768, 0.0765, 0.0774, 0.0769, 0.0771,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0764, 0.0768, 0.0767, 0.0769, 0.0766, 0.0773, 0.0768, 0.0772,
         0.0775, 0.0770, 0.0768, 0.0770],
        [0.0769, 0.0764, 0.0769, 0.0767, 0.0769, 0.0764, 0.0773, 0.0770, 0.0771,
         0.0775, 0.0770, 0.0768, 0.0770],
        [0.0769, 0.0764, 0.0770, 0.0767, 0.0769, 0.0765, 0.0774, 0.0768, 0.0772,
         0.0776, 0.0769, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1436, 0.1428, 0.1416, 0.1412, 0.1432, 0.1422, 0.1454],
        [0.1438, 0.1431, 0.1414, 0.1413, 0.1432, 0.1422, 0.1449],
        [0.1438, 0.1428, 0.1417, 0.1412, 0.1433, 0.1421, 0.1451],
        [0.1437, 0.1431, 0.1415, 0.1413, 0.1432, 0.1422, 0.1451],
        [0.1437, 0.1429, 0.1414, 0.1413, 0.1432, 0.1421, 0.1454],
        [0.1437, 0.1428, 0.1415, 0.1414, 0.1431, 0.1420, 0.1456],
        [0.1439, 0.1429, 0.1411, 0.1408, 0.1434, 0.1417, 0.1462]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0497, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0504,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0501, 0.0502, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0502, 0.0498, 0.0501, 0.0506, 0.0500, 0.0499, 0.0504,
         0.0499, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0629, 0.0627, 0.0629, 0.0628, 0.0627, 0.0627, 0.0618, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0627, 0.0618, 0.0625, 0.0621,
         0.0628, 0.0625, 0.0626, 0.0617, 0.0622, 0.0627, 0.0622],
        [0.0630, 0.0627, 0.0630, 0.0628, 0.0628, 0.0627, 0.0618, 0.0625, 0.0621,
         0.0628, 0.0625, 0.0627, 0.0618, 0.0622, 0.0626, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0627, 0.0617, 0.0625, 0.0620,
         0.0630, 0.0626, 0.0626, 0.0616, 0.0622, 0.0626, 0.0621],
        [0.0630, 0.0626, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0626, 0.0621],
        [0.0630, 0.0626, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0626, 0.0619, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0626, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0627, 0.0618, 0.0625, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0617, 0.0622, 0.0627, 0.0622],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0626, 0.0622],
        [0.0630, 0.0627, 0.0631, 0.0629, 0.0628, 0.0627, 0.0618, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0623, 0.0626, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0627, 0.0618, 0.0625, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0628, 0.0627, 0.0627, 0.0618, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0626, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0628, 0.0627, 0.0627, 0.0618, 0.0625, 0.0621,
         0.0629, 0.0625, 0.0626, 0.0617, 0.0622, 0.0627, 0.0621]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2514, 0.2508, 0.2519, 0.2458],
        [0.2512, 0.2504, 0.2516, 0.2469],
        [0.2510, 0.2504, 0.2515, 0.2472],
        [0.2516, 0.2513, 0.2512, 0.2460]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0524, 0.0525, 0.0528, 0.0526, 0.0525, 0.0530, 0.0527, 0.0527, 0.0524,
         0.0523],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0526, 0.0526, 0.0530, 0.0526,
         0.0524, 0.0525, 0.0527, 0.0526, 0.0525, 0.0530, 0.0527, 0.0527, 0.0523,
         0.0520],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0525, 0.0525, 0.0528, 0.0526, 0.0526, 0.0530, 0.0527, 0.0527, 0.0523,
         0.0521],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0525, 0.0525, 0.0527, 0.0526, 0.0526, 0.0530, 0.0527, 0.0527, 0.0523,
         0.0522],
        [0.0527, 0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0525, 0.0525, 0.0528, 0.0526, 0.0527, 0.0530, 0.0528, 0.0527, 0.0523,
         0.0520],
        [0.0528, 0.0528, 0.0526, 0.0528, 0.0526, 0.0526, 0.0526, 0.0530, 0.0526,
         0.0525, 0.0525, 0.0528, 0.0526, 0.0525, 0.0530, 0.0527, 0.0527, 0.0524,
         0.0520],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0529, 0.0526,
         0.0525, 0.0525, 0.0528, 0.0526, 0.0526, 0.0530, 0.0527, 0.0527, 0.0524,
         0.0522],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0525, 0.0525, 0.0528, 0.0526, 0.0525, 0.0530, 0.0526, 0.0527, 0.0524,
         0.0521],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0524, 0.0525, 0.0528, 0.0526, 0.0526, 0.0530, 0.0528, 0.0528, 0.0523,
         0.0520],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0524, 0.0525, 0.0529, 0.0526, 0.0527, 0.0529, 0.0528, 0.0528, 0.0522,
         0.0520],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0530, 0.0525,
         0.0525, 0.0525, 0.0528, 0.0526, 0.0526, 0.0530, 0.0527, 0.0527, 0.0523,
         0.0521],
        [0.0527, 0.0527, 0.0526, 0.0528, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0524, 0.0525, 0.0528, 0.0526, 0.0526, 0.0530, 0.0527, 0.0528, 0.0523,
         0.0520],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0524, 0.0525, 0.0528, 0.0527, 0.0526, 0.0529, 0.0527, 0.0527, 0.0524,
         0.0521],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0527, 0.0530, 0.0526,
         0.0524, 0.0525, 0.0527, 0.0527, 0.0526, 0.0530, 0.0528, 0.0527, 0.0523,
         0.0520],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0525, 0.0525, 0.0528, 0.0526, 0.0526, 0.0530, 0.0526, 0.0527, 0.0524,
         0.0520],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0523, 0.0525, 0.0528, 0.0526, 0.0526, 0.0530, 0.0528, 0.0528, 0.0523,
         0.0521],
        [0.0527, 0.0528, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0529, 0.0526,
         0.0525, 0.0525, 0.0528, 0.0526, 0.0526, 0.0530, 0.0527, 0.0527, 0.0523,
         0.0522],
        [0.0527, 0.0528, 0.0526, 0.0528, 0.0526, 0.0525, 0.0526, 0.0530, 0.0526,
         0.0524, 0.0525, 0.0527, 0.0527, 0.0527, 0.0530, 0.0527, 0.0527, 0.0523,
         0.0522],
        [0.0527, 0.0528, 0.0525, 0.0529, 0.0526, 0.0524, 0.0525, 0.0530, 0.0526,
         0.0523, 0.0524, 0.0529, 0.0527, 0.0529, 0.0528, 0.0529, 0.0528, 0.0521,
         0.0522]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.27800846099853516s
iter time cost:10.872908115386963s
-------------Round number: 116-------------
Evaluate global model
[running kmeans]: 8it [00:00, 312.56it/s, center_shift=0.000000, iteration=8, tol=0.000100]
Averaged Train Loss: 0.3314
Averaged Test Accurancy: 0.8110
Std Test Accurancy: 0.0962
evaluate time cost:5.203857660293579s
clients training time cost:5.180111646652222s
attn_optimize time cost:0.5050063133239746s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1436, 0.1430, 0.1415, 0.1414, 0.1429, 0.1421, 0.1455],
        [0.1439, 0.1433, 0.1414, 0.1414, 0.1429, 0.1421, 0.1451],
        [0.1438, 0.1430, 0.1416, 0.1414, 0.1430, 0.1420, 0.1452],
        [0.1437, 0.1432, 0.1415, 0.1415, 0.1429, 0.1421, 0.1452],
        [0.1438, 0.1431, 0.1413, 0.1415, 0.1428, 0.1420, 0.1455],
        [0.1437, 0.1429, 0.1415, 0.1415, 0.1428, 0.1419, 0.1457],
        [0.1439, 0.1430, 0.1410, 0.1410, 0.1430, 0.1416, 0.1463]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0763, 0.0768, 0.0767, 0.0770, 0.0765, 0.0773, 0.0770, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0769],
        [0.0768, 0.0764, 0.0769, 0.0767, 0.0770, 0.0766, 0.0774, 0.0771, 0.0770,
         0.0775, 0.0770, 0.0768, 0.0769],
        [0.0769, 0.0764, 0.0769, 0.0767, 0.0770, 0.0766, 0.0773, 0.0770, 0.0770,
         0.0775, 0.0771, 0.0768, 0.0768],
        [0.0769, 0.0764, 0.0769, 0.0766, 0.0769, 0.0765, 0.0774, 0.0770, 0.0771,
         0.0775, 0.0770, 0.0768, 0.0768],
        [0.0769, 0.0764, 0.0768, 0.0767, 0.0769, 0.0765, 0.0774, 0.0769, 0.0772,
         0.0776, 0.0769, 0.0768, 0.0769],
        [0.0769, 0.0764, 0.0769, 0.0767, 0.0769, 0.0766, 0.0774, 0.0770, 0.0771,
         0.0775, 0.0770, 0.0769, 0.0768],
        [0.0770, 0.0763, 0.0767, 0.0766, 0.0770, 0.0765, 0.0774, 0.0770, 0.0771,
         0.0776, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0764, 0.0768, 0.0768, 0.0769, 0.0766, 0.0773, 0.0770, 0.0770,
         0.0775, 0.0770, 0.0768, 0.0769],
        [0.0769, 0.0763, 0.0769, 0.0767, 0.0770, 0.0765, 0.0773, 0.0770, 0.0771,
         0.0776, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0764, 0.0769, 0.0766, 0.0769, 0.0765, 0.0774, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0763, 0.0767, 0.0767, 0.0770, 0.0766, 0.0774, 0.0769, 0.0771,
         0.0775, 0.0770, 0.0768, 0.0770],
        [0.0769, 0.0764, 0.0767, 0.0766, 0.0770, 0.0765, 0.0774, 0.0771, 0.0770,
         0.0776, 0.0770, 0.0769, 0.0769],
        [0.0768, 0.0763, 0.0769, 0.0767, 0.0770, 0.0766, 0.0774, 0.0769, 0.0771,
         0.0776, 0.0770, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5004, 0.4996],
        [0.5002, 0.4998]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0833, 0.0834, 0.0835, 0.0834, 0.0831, 0.0831, 0.0834, 0.0833, 0.0838,
         0.0833, 0.0831, 0.0834],
        [0.0833, 0.0834, 0.0836, 0.0834, 0.0830, 0.0831, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0831, 0.0833],
        [0.0834, 0.0834, 0.0836, 0.0834, 0.0831, 0.0831, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0831, 0.0834],
        [0.0833, 0.0834, 0.0836, 0.0833, 0.0830, 0.0830, 0.0833, 0.0834, 0.0839,
         0.0833, 0.0831, 0.0833],
        [0.0833, 0.0834, 0.0836, 0.0834, 0.0830, 0.0831, 0.0833, 0.0833, 0.0839,
         0.0833, 0.0831, 0.0833],
        [0.0832, 0.0834, 0.0835, 0.0835, 0.0832, 0.0830, 0.0834, 0.0834, 0.0839,
         0.0833, 0.0830, 0.0833],
        [0.0834, 0.0834, 0.0836, 0.0834, 0.0830, 0.0831, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0831, 0.0834],
        [0.0834, 0.0833, 0.0835, 0.0835, 0.0831, 0.0831, 0.0834, 0.0833, 0.0838,
         0.0833, 0.0830, 0.0834],
        [0.0833, 0.0834, 0.0836, 0.0834, 0.0831, 0.0831, 0.0833, 0.0833, 0.0839,
         0.0833, 0.0830, 0.0833],
        [0.0833, 0.0834, 0.0836, 0.0833, 0.0831, 0.0831, 0.0833, 0.0834, 0.0838,
         0.0833, 0.0831, 0.0833],
        [0.0833, 0.0834, 0.0836, 0.0834, 0.0830, 0.0831, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0831, 0.0834],
        [0.0833, 0.0834, 0.0835, 0.0834, 0.0831, 0.0831, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0831, 0.0834]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0505, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0497, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0499, 0.0489],
        [0.0498, 0.0505, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0497, 0.0492],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0501, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0499, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0494, 0.0500, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0499, 0.0487],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0499, 0.0486],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0500, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0501, 0.0498, 0.0499, 0.0504, 0.0501, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0500, 0.0506, 0.0502, 0.0505, 0.0505, 0.0503, 0.0503, 0.0493, 0.0499,
         0.0501, 0.0495, 0.0499, 0.0506, 0.0502, 0.0501, 0.0493, 0.0500, 0.0501,
         0.0497, 0.0488]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2006, 0.1995, 0.1993, 0.2016, 0.1991],
        [0.2006, 0.1997, 0.1992, 0.2015, 0.1989],
        [0.2004, 0.1995, 0.1992, 0.2014, 0.1995],
        [0.2005, 0.1995, 0.1992, 0.2014, 0.1994],
        [0.2011, 0.1996, 0.1995, 0.2017, 0.1981]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0497],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0499, 0.0501, 0.0500,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0501, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0500, 0.0499, 0.0500, 0.0501, 0.0498, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0499, 0.0495],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0499, 0.0501, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0502, 0.0498, 0.0501, 0.0503, 0.0501, 0.0502,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0499, 0.0499, 0.0500, 0.0501, 0.0499, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0498, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0501,
         0.0499, 0.0497, 0.0500, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0498, 0.0500, 0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0500,
         0.0499, 0.0498, 0.0500, 0.0500, 0.0499, 0.0501, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0503, 0.0499, 0.0502, 0.0500, 0.0497, 0.0500, 0.0499,
         0.0499, 0.0497, 0.0499, 0.0502, 0.0499, 0.0503, 0.0502, 0.0503, 0.0502,
         0.0496, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0529, 0.0529,
         0.0527],
        [0.0528, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0525,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0529, 0.0530,
         0.0526],
        [0.0528, 0.0532, 0.0519, 0.0525, 0.0525, 0.0524, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0524, 0.0527, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0526, 0.0525, 0.0524, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0526, 0.0529, 0.0528,
         0.0528],
        [0.0528, 0.0530, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0528, 0.0526, 0.0526, 0.0525, 0.0527, 0.0529, 0.0530,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0529, 0.0530,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0525,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0529, 0.0530,
         0.0527],
        [0.0528, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0521, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0529, 0.0529,
         0.0528],
        [0.0528, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0519, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0525,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0527],
        [0.0528, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0529, 0.0529,
         0.0526],
        [0.0528, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0527, 0.0529, 0.0530,
         0.0527],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0525,
         0.0527, 0.0526, 0.0527, 0.0527, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0528, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0528, 0.0526, 0.0526, 0.0525, 0.0526, 0.0529, 0.0530,
         0.0527],
        [0.0528, 0.0531, 0.0519, 0.0525, 0.0526, 0.0524, 0.0526, 0.0523, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0528]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.306140661239624s
iter time cost:11.289828538894653s
-------------Round number: 117-------------
Evaluate global model
[running kmeans]: 6it [00:00, 360.59it/s, center_shift=0.000000, iteration=6, tol=0.000100]
Averaged Train Loss: 0.3737
Averaged Test Accurancy: 0.8036
Std Test Accurancy: 0.0933
evaluate time cost:4.858604192733765s
clients training time cost:5.134099245071411s
attn_optimize time cost:0.49834108352661133s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.4997, 0.5003],
        [0.4995, 0.5005]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0505, 0.0502, 0.0506, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0504, 0.0503, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0497, 0.0492],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0499, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0501, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0496, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0497, 0.0491],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0486],
        [0.0497, 0.0505, 0.0502, 0.0506, 0.0504, 0.0504, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0495, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0500, 0.0506, 0.0501, 0.0505, 0.0505, 0.0504, 0.0504, 0.0493, 0.0499,
         0.0502, 0.0494, 0.0500, 0.0506, 0.0502, 0.0501, 0.0492, 0.0499, 0.0501,
         0.0497, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1250, 0.1252, 0.1246, 0.1249, 0.1257, 0.1253, 0.1256, 0.1237],
        [0.1249, 0.1253, 0.1246, 0.1250, 0.1258, 0.1252, 0.1255, 0.1236],
        [0.1250, 0.1252, 0.1244, 0.1250, 0.1259, 0.1252, 0.1256, 0.1237],
        [0.1250, 0.1252, 0.1247, 0.1250, 0.1259, 0.1250, 0.1254, 0.1238],
        [0.1252, 0.1253, 0.1245, 0.1250, 0.1258, 0.1251, 0.1253, 0.1237],
        [0.1251, 0.1254, 0.1245, 0.1250, 0.1257, 0.1251, 0.1256, 0.1237],
        [0.1250, 0.1253, 0.1244, 0.1251, 0.1259, 0.1250, 0.1256, 0.1238],
        [0.1247, 0.1253, 0.1240, 0.1247, 0.1260, 0.1257, 0.1258, 0.1238]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0833, 0.0833, 0.0836, 0.0831, 0.0834, 0.0832, 0.0833, 0.0838,
         0.0833, 0.0830, 0.0832],
        [0.0835, 0.0832, 0.0833, 0.0835, 0.0830, 0.0834, 0.0833, 0.0833, 0.0838,
         0.0834, 0.0830, 0.0833],
        [0.0836, 0.0832, 0.0833, 0.0835, 0.0831, 0.0834, 0.0832, 0.0833, 0.0838,
         0.0834, 0.0830, 0.0832],
        [0.0835, 0.0833, 0.0833, 0.0835, 0.0831, 0.0834, 0.0832, 0.0833, 0.0837,
         0.0833, 0.0830, 0.0833],
        [0.0836, 0.0832, 0.0834, 0.0834, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0834, 0.0829, 0.0832],
        [0.0835, 0.0832, 0.0834, 0.0836, 0.0830, 0.0834, 0.0832, 0.0833, 0.0838,
         0.0834, 0.0830, 0.0832],
        [0.0836, 0.0833, 0.0834, 0.0835, 0.0830, 0.0834, 0.0832, 0.0833, 0.0838,
         0.0833, 0.0830, 0.0833],
        [0.0835, 0.0833, 0.0833, 0.0835, 0.0830, 0.0834, 0.0832, 0.0833, 0.0838,
         0.0834, 0.0830, 0.0833],
        [0.0835, 0.0832, 0.0833, 0.0835, 0.0830, 0.0834, 0.0832, 0.0833, 0.0839,
         0.0834, 0.0830, 0.0832],
        [0.0835, 0.0832, 0.0833, 0.0835, 0.0830, 0.0834, 0.0832, 0.0833, 0.0838,
         0.0834, 0.0831, 0.0832],
        [0.0836, 0.0832, 0.0833, 0.0835, 0.0830, 0.0834, 0.0832, 0.0833, 0.0838,
         0.0834, 0.0830, 0.0833],
        [0.0836, 0.0832, 0.0833, 0.0835, 0.0830, 0.0834, 0.0832, 0.0833, 0.0838,
         0.0834, 0.0831, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1433, 0.1427, 0.1427, 0.1425, 0.1424, 0.1441, 0.1422],
        [0.1431, 0.1425, 0.1429, 0.1424, 0.1424, 0.1442, 0.1425],
        [0.1429, 0.1426, 0.1430, 0.1427, 0.1422, 0.1440, 0.1425],
        [0.1432, 0.1426, 0.1430, 0.1427, 0.1423, 0.1441, 0.1421],
        [0.1431, 0.1425, 0.1429, 0.1426, 0.1423, 0.1440, 0.1426],
        [0.1432, 0.1425, 0.1430, 0.1425, 0.1423, 0.1440, 0.1424],
        [0.1435, 0.1426, 0.1432, 0.1425, 0.1425, 0.1442, 0.1415]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.1002, 0.0999, 0.1003, 0.0996, 0.1000, 0.1004, 0.0997, 0.1001,
         0.0996],
        [0.1002, 0.1002, 0.0998, 0.1004, 0.0997, 0.1000, 0.1004, 0.0998, 0.1001,
         0.0995],
        [0.1001, 0.1002, 0.0999, 0.1004, 0.0996, 0.1000, 0.1005, 0.0997, 0.1001,
         0.0995],
        [0.1001, 0.1002, 0.0999, 0.1003, 0.0996, 0.1001, 0.1004, 0.0998, 0.1000,
         0.0995],
        [0.1002, 0.1001, 0.0999, 0.1003, 0.0997, 0.1000, 0.1005, 0.0997, 0.1001,
         0.0995],
        [0.1001, 0.1002, 0.0999, 0.1004, 0.0996, 0.1000, 0.1003, 0.0997, 0.1001,
         0.0996],
        [0.1001, 0.1001, 0.0999, 0.1003, 0.0997, 0.1000, 0.1005, 0.0997, 0.1001,
         0.0996],
        [0.1001, 0.1002, 0.0998, 0.1004, 0.0996, 0.1001, 0.1004, 0.0999, 0.1001,
         0.0995],
        [0.1001, 0.1002, 0.1000, 0.1003, 0.0996, 0.1000, 0.1004, 0.0997, 0.1001,
         0.0996],
        [0.1001, 0.1002, 0.0999, 0.1003, 0.0996, 0.1000, 0.1004, 0.0999, 0.1001,
         0.0995]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0494, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0509],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0499, 0.0501, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0495, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0499, 0.0494, 0.0499,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0508],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0501, 0.0503, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0495, 0.0499, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0502, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0499, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0496, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0499, 0.0501, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0505],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0498, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0501, 0.0507],
        [0.0500, 0.0502, 0.0498, 0.0501, 0.0496, 0.0499, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0495, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0499, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0501, 0.0503, 0.0497, 0.0502, 0.0500,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0498, 0.0501, 0.0496, 0.0499, 0.0498, 0.0495, 0.0498,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0500, 0.0500,
         0.0500, 0.0510],
        [0.0500, 0.0502, 0.0498, 0.0500, 0.0496, 0.0499, 0.0499, 0.0494, 0.0500,
         0.0499, 0.0503, 0.0499, 0.0499, 0.0502, 0.0504, 0.0497, 0.0502, 0.0500,
         0.0502, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0500,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0499, 0.0500, 0.0502, 0.0505, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0504],
        [0.0498, 0.0505, 0.0496, 0.0502, 0.0495, 0.0499, 0.0499, 0.0494, 0.0496,
         0.0498, 0.0502, 0.0498, 0.0502, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0501, 0.0513]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0667, 0.0672, 0.0665, 0.0667, 0.0666, 0.0663, 0.0666, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0672, 0.0664, 0.0667, 0.0666, 0.0664, 0.0666, 0.0667, 0.0666,
         0.0666, 0.0666, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0667, 0.0672, 0.0664, 0.0667, 0.0667, 0.0663, 0.0667, 0.0666, 0.0667,
         0.0667, 0.0666, 0.0664, 0.0666, 0.0667, 0.0670],
        [0.0667, 0.0672, 0.0665, 0.0667, 0.0666, 0.0663, 0.0667, 0.0666, 0.0666,
         0.0667, 0.0667, 0.0665, 0.0665, 0.0668, 0.0670],
        [0.0667, 0.0672, 0.0664, 0.0667, 0.0666, 0.0663, 0.0666, 0.0666, 0.0666,
         0.0667, 0.0667, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0666, 0.0672, 0.0664, 0.0667, 0.0667, 0.0664, 0.0667, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0666, 0.0666, 0.0667, 0.0670],
        [0.0667, 0.0672, 0.0664, 0.0668, 0.0667, 0.0663, 0.0666, 0.0666, 0.0667,
         0.0667, 0.0667, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0667, 0.0671, 0.0665, 0.0668, 0.0666, 0.0664, 0.0667, 0.0667, 0.0667,
         0.0667, 0.0666, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0672, 0.0665, 0.0667, 0.0666, 0.0663, 0.0667, 0.0667, 0.0666,
         0.0667, 0.0667, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0672, 0.0665, 0.0667, 0.0666, 0.0663, 0.0666, 0.0667, 0.0667,
         0.0666, 0.0666, 0.0664, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0672, 0.0664, 0.0668, 0.0666, 0.0663, 0.0666, 0.0666, 0.0667,
         0.0666, 0.0667, 0.0666, 0.0665, 0.0667, 0.0670],
        [0.0667, 0.0672, 0.0664, 0.0668, 0.0667, 0.0664, 0.0666, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0664, 0.0666, 0.0667, 0.0670],
        [0.0667, 0.0671, 0.0665, 0.0668, 0.0666, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0666, 0.0665, 0.0666, 0.0667, 0.0669],
        [0.0667, 0.0672, 0.0664, 0.0667, 0.0666, 0.0663, 0.0667, 0.0666, 0.0666,
         0.0667, 0.0667, 0.0665, 0.0665, 0.0667, 0.0670],
        [0.0667, 0.0672, 0.0665, 0.0667, 0.0666, 0.0664, 0.0666, 0.0666, 0.0666,
         0.0667, 0.0667, 0.0665, 0.0665, 0.0667, 0.0670]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1983, 0.2002, 0.2025, 0.2018, 0.1971],
        [0.1983, 0.2002, 0.2022, 0.2018, 0.1976],
        [0.1980, 0.2002, 0.2023, 0.2014, 0.1981],
        [0.1980, 0.2000, 0.2023, 0.2014, 0.1983],
        [0.1969, 0.1995, 0.2031, 0.2029, 0.1976]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.24799227714538574s
iter time cost:10.830121517181396s
-------------Round number: 118-------------
Evaluate global model
[running kmeans]: 5it [00:00, 356.82it/s, center_shift=0.000000, iteration=5, tol=0.000100]
Averaged Train Loss: 0.3512
Averaged Test Accurancy: 0.8059
Std Test Accurancy: 0.0827
evaluate time cost:5.2294087409973145s
clients training time cost:5.26361608505249s
attn_optimize time cost:0.6051318645477295s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1003, 0.0998, 0.0997, 0.0998, 0.0994, 0.0996, 0.1001, 0.1007, 0.0998,
         0.1008],
        [0.1002, 0.0997, 0.0999, 0.0998, 0.0994, 0.0997, 0.1000, 0.1006, 0.0998,
         0.1009],
        [0.1001, 0.0998, 0.1000, 0.1000, 0.0994, 0.0996, 0.1000, 0.1005, 0.0998,
         0.1008],
        [0.1002, 0.0997, 0.0999, 0.0999, 0.0995, 0.0996, 0.1000, 0.1006, 0.0998,
         0.1008],
        [0.1003, 0.0998, 0.0998, 0.0998, 0.0993, 0.0997, 0.1000, 0.1006, 0.0998,
         0.1009],
        [0.1002, 0.0998, 0.1000, 0.0999, 0.0994, 0.0996, 0.1000, 0.1005, 0.0998,
         0.1008],
        [0.1002, 0.0998, 0.0999, 0.0999, 0.0995, 0.0996, 0.1001, 0.1005, 0.0998,
         0.1009],
        [0.1003, 0.0998, 0.0998, 0.0998, 0.0994, 0.0996, 0.1001, 0.1005, 0.0998,
         0.1009],
        [0.1003, 0.0998, 0.0997, 0.0999, 0.0995, 0.0996, 0.1000, 0.1005, 0.0998,
         0.1009],
        [0.1002, 0.0997, 0.1000, 0.0998, 0.0994, 0.0996, 0.1001, 0.1005, 0.0998,
         0.1008]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1115, 0.1111, 0.1111, 0.1115, 0.1108, 0.1110, 0.1111, 0.1108, 0.1111],
        [0.1115, 0.1110, 0.1111, 0.1114, 0.1107, 0.1111, 0.1112, 0.1108, 0.1111],
        [0.1115, 0.1110, 0.1111, 0.1114, 0.1108, 0.1111, 0.1111, 0.1108, 0.1111],
        [0.1115, 0.1111, 0.1111, 0.1114, 0.1108, 0.1111, 0.1111, 0.1108, 0.1111],
        [0.1116, 0.1110, 0.1112, 0.1113, 0.1108, 0.1112, 0.1112, 0.1107, 0.1111],
        [0.1116, 0.1111, 0.1112, 0.1114, 0.1107, 0.1111, 0.1111, 0.1108, 0.1111],
        [0.1115, 0.1111, 0.1111, 0.1114, 0.1107, 0.1111, 0.1111, 0.1107, 0.1111],
        [0.1116, 0.1110, 0.1111, 0.1114, 0.1107, 0.1111, 0.1111, 0.1108, 0.1111],
        [0.1115, 0.1110, 0.1111, 0.1114, 0.1107, 0.1111, 0.1111, 0.1109, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0500, 0.0502, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0501,
         0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0503, 0.0499, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0498, 0.0497],
        [0.0502, 0.0501, 0.0502, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0498, 0.0500, 0.0500, 0.0498, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0500, 0.0499, 0.0498, 0.0501, 0.0500, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0498, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0494],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0499, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0503, 0.0499, 0.0501,
         0.0499, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0502, 0.0500, 0.0499, 0.0501, 0.0501,
         0.0501, 0.0498, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0500, 0.0499, 0.0503, 0.0499, 0.0501,
         0.0499, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0498, 0.0498, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0502, 0.0500, 0.0503, 0.0499, 0.0498, 0.0499, 0.0500,
         0.0501, 0.0497, 0.0497, 0.0502, 0.0501, 0.0502, 0.0501, 0.0502, 0.0502,
         0.0497, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1653, 0.1672, 0.1668, 0.1686, 0.1680, 0.1642],
        [0.1652, 0.1671, 0.1667, 0.1681, 0.1677, 0.1652],
        [0.1653, 0.1671, 0.1667, 0.1683, 0.1680, 0.1646],
        [0.1650, 0.1673, 0.1666, 0.1684, 0.1676, 0.1651],
        [0.1651, 0.1671, 0.1666, 0.1684, 0.1677, 0.1652],
        [0.1641, 0.1672, 0.1661, 0.1690, 0.1689, 0.1647]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0501, 0.0501, 0.0501, 0.0505, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0502, 0.0501, 0.0501, 0.0502, 0.0506, 0.0497, 0.0499, 0.0499,
         0.0499, 0.0509],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0501, 0.0500, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0495, 0.0500, 0.0499, 0.0495, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0494, 0.0500,
         0.0498, 0.0502, 0.0501, 0.0501, 0.0502, 0.0505, 0.0496, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0502, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0499, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0501, 0.0501, 0.0502, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0499, 0.0507],
        [0.0500, 0.0502, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0501, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0498, 0.0500, 0.0499,
         0.0499, 0.0507],
        [0.0501, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0501, 0.0500, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0499, 0.0505],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0495, 0.0500,
         0.0496, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0502, 0.0498, 0.0500, 0.0496, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0501, 0.0501, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0496, 0.0500, 0.0499,
         0.0499, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0501, 0.0501, 0.0501, 0.0502, 0.0505, 0.0497, 0.0499, 0.0499,
         0.0499, 0.0510],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0496, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0502, 0.0505, 0.0496, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0501, 0.0501, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0506, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0504],
        [0.0499, 0.0505, 0.0496, 0.0502, 0.0495, 0.0499, 0.0499, 0.0495, 0.0497,
         0.0497, 0.0501, 0.0500, 0.0503, 0.0502, 0.0506, 0.0496, 0.0499, 0.0497,
         0.0499, 0.0513]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0838, 0.0835, 0.0839, 0.0837, 0.0823, 0.0834, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0828],
        [0.0838, 0.0836, 0.0839, 0.0837, 0.0823, 0.0833, 0.0827, 0.0837, 0.0833,
         0.0834, 0.0835, 0.0828],
        [0.0839, 0.0835, 0.0839, 0.0837, 0.0823, 0.0833, 0.0827, 0.0837, 0.0833,
         0.0835, 0.0834, 0.0827],
        [0.0839, 0.0835, 0.0839, 0.0837, 0.0823, 0.0834, 0.0826, 0.0837, 0.0834,
         0.0834, 0.0834, 0.0828],
        [0.0839, 0.0835, 0.0839, 0.0837, 0.0824, 0.0834, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0835, 0.0827],
        [0.0838, 0.0834, 0.0839, 0.0837, 0.0824, 0.0834, 0.0827, 0.0837, 0.0834,
         0.0834, 0.0834, 0.0827],
        [0.0838, 0.0835, 0.0839, 0.0838, 0.0823, 0.0834, 0.0826, 0.0838, 0.0834,
         0.0833, 0.0834, 0.0827],
        [0.0838, 0.0836, 0.0840, 0.0837, 0.0823, 0.0833, 0.0826, 0.0836, 0.0833,
         0.0834, 0.0835, 0.0828],
        [0.0838, 0.0835, 0.0839, 0.0838, 0.0823, 0.0834, 0.0826, 0.0837, 0.0834,
         0.0833, 0.0835, 0.0827],
        [0.0839, 0.0836, 0.0839, 0.0838, 0.0823, 0.0833, 0.0825, 0.0838, 0.0834,
         0.0833, 0.0834, 0.0828],
        [0.0839, 0.0835, 0.0839, 0.0837, 0.0823, 0.0833, 0.0826, 0.0838, 0.0833,
         0.0834, 0.0834, 0.0827],
        [0.0838, 0.0835, 0.0839, 0.0837, 0.0824, 0.0833, 0.0827, 0.0837, 0.0833,
         0.0834, 0.0835, 0.0828]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1441, 0.1438, 0.1423, 0.1429, 0.1413, 0.1428],
        [0.1425, 0.1442, 0.1438, 0.1424, 0.1428, 0.1414, 0.1428],
        [0.1427, 0.1440, 0.1439, 0.1423, 0.1429, 0.1414, 0.1428],
        [0.1429, 0.1440, 0.1438, 0.1423, 0.1429, 0.1413, 0.1428],
        [0.1427, 0.1441, 0.1438, 0.1423, 0.1429, 0.1414, 0.1428],
        [0.1425, 0.1442, 0.1439, 0.1422, 0.1427, 0.1414, 0.1430],
        [0.1427, 0.1441, 0.1438, 0.1425, 0.1428, 0.1414, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0715, 0.0720, 0.0712, 0.0714, 0.0711, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0713, 0.0714, 0.0713, 0.0714, 0.0717],
        [0.0715, 0.0720, 0.0712, 0.0714, 0.0711, 0.0713, 0.0714, 0.0714, 0.0715,
         0.0713, 0.0714, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0720, 0.0711, 0.0714, 0.0711, 0.0714, 0.0714, 0.0715, 0.0715,
         0.0714, 0.0712, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0720, 0.0711, 0.0714, 0.0710, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0714, 0.0714, 0.0712, 0.0714, 0.0718],
        [0.0715, 0.0720, 0.0711, 0.0715, 0.0711, 0.0714, 0.0714, 0.0715, 0.0714,
         0.0713, 0.0714, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0720, 0.0711, 0.0715, 0.0710, 0.0713, 0.0713, 0.0715, 0.0715,
         0.0714, 0.0714, 0.0712, 0.0714, 0.0718],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0713, 0.0713, 0.0713, 0.0714, 0.0717],
        [0.0715, 0.0720, 0.0712, 0.0714, 0.0711, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0714, 0.0713, 0.0714, 0.0714, 0.0717],
        [0.0715, 0.0720, 0.0712, 0.0714, 0.0711, 0.0714, 0.0715, 0.0715, 0.0715,
         0.0713, 0.0713, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0721, 0.0711, 0.0714, 0.0711, 0.0713, 0.0714, 0.0715, 0.0714,
         0.0714, 0.0714, 0.0713, 0.0713, 0.0718],
        [0.0716, 0.0720, 0.0711, 0.0715, 0.0711, 0.0714, 0.0714, 0.0714, 0.0714,
         0.0713, 0.0712, 0.0713, 0.0714, 0.0718],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0711, 0.0714, 0.0715, 0.0715, 0.0715,
         0.0712, 0.0714, 0.0713, 0.0714, 0.0717],
        [0.0716, 0.0720, 0.0711, 0.0714, 0.0710, 0.0714, 0.0713, 0.0714, 0.0715,
         0.0714, 0.0714, 0.0712, 0.0714, 0.0718],
        [0.0715, 0.0720, 0.0712, 0.0714, 0.0711, 0.0714, 0.0714, 0.0714, 0.0715,
         0.0714, 0.0714, 0.0713, 0.0714, 0.0718]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2672419548034668s
iter time cost:11.459485054016113s
-------------Round number: 119-------------
Evaluate global model
[running kmeans]: 4it [00:00, 307.39it/s, center_shift=0.000000, iteration=4, tol=0.000100]
Averaged Train Loss: 0.3223
Averaged Test Accurancy: 0.8163
Std Test Accurancy: 0.0936
evaluate time cost:5.016860246658325s
clients training time cost:5.33139705657959s
attn_optimize time cost:0.5520966053009033s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0770, 0.0765, 0.0769, 0.0767, 0.0768, 0.0765, 0.0773, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0766, 0.0770, 0.0766, 0.0768, 0.0766, 0.0773, 0.0769, 0.0771,
         0.0774, 0.0771, 0.0767, 0.0769],
        [0.0769, 0.0765, 0.0770, 0.0767, 0.0769, 0.0766, 0.0773, 0.0769, 0.0771,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0770, 0.0766, 0.0768, 0.0765, 0.0773, 0.0770, 0.0771,
         0.0774, 0.0771, 0.0768, 0.0768],
        [0.0769, 0.0765, 0.0770, 0.0767, 0.0767, 0.0765, 0.0773, 0.0769, 0.0772,
         0.0775, 0.0770, 0.0768, 0.0768],
        [0.0770, 0.0765, 0.0770, 0.0767, 0.0768, 0.0766, 0.0773, 0.0769, 0.0771,
         0.0774, 0.0770, 0.0768, 0.0768],
        [0.0770, 0.0764, 0.0769, 0.0766, 0.0768, 0.0765, 0.0773, 0.0769, 0.0772,
         0.0775, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0766, 0.0770, 0.0767, 0.0767, 0.0766, 0.0773, 0.0769, 0.0771,
         0.0774, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0770, 0.0767, 0.0768, 0.0766, 0.0773, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0766, 0.0771, 0.0766, 0.0768, 0.0765, 0.0773, 0.0768, 0.0771,
         0.0774, 0.0772, 0.0769, 0.0768],
        [0.0769, 0.0765, 0.0768, 0.0767, 0.0769, 0.0767, 0.0773, 0.0768, 0.0772,
         0.0774, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0765, 0.0769, 0.0766, 0.0769, 0.0765, 0.0773, 0.0770, 0.0771,
         0.0775, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0765, 0.0770, 0.0767, 0.0768, 0.0766, 0.0773, 0.0768, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2490, 0.2501, 0.2493, 0.2516],
        [0.2491, 0.2499, 0.2494, 0.2515],
        [0.2491, 0.2499, 0.2494, 0.2516],
        [0.2493, 0.2501, 0.2491, 0.2516]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3304, 0.3335, 0.3361],
        [0.3305, 0.3333, 0.3362],
        [0.3305, 0.3336, 0.3360]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0501, 0.0502, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501, 0.0502,
         0.0501, 0.0499, 0.0499, 0.0501, 0.0498, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0498, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0497],
        [0.0502, 0.0501, 0.0502, 0.0499, 0.0503, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0498, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0503, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0498, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0498, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0498, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0498, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0503, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0498, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0501, 0.0498, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0499, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0498, 0.0499, 0.0504, 0.0501, 0.0502,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0503, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0498, 0.0499, 0.0504, 0.0501, 0.0502,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0498, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0497, 0.0494],
        [0.0503, 0.0500, 0.0501, 0.0499, 0.0502, 0.0501, 0.0499, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0498, 0.0499, 0.0504, 0.0500, 0.0502,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0499, 0.0498, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501, 0.0502,
         0.0501, 0.0497, 0.0499, 0.0501, 0.0499, 0.0498, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0500, 0.0499, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0498, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0499, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0503, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0498, 0.0498, 0.0504, 0.0501, 0.0502,
         0.0498, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0498, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0502, 0.0497, 0.0503, 0.0499, 0.0498, 0.0500, 0.0501,
         0.0501, 0.0496, 0.0498, 0.0503, 0.0498, 0.0501, 0.0503, 0.0502, 0.0503,
         0.0496, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3363, 0.3351, 0.3286],
        [0.3358, 0.3345, 0.3298],
        [0.3363, 0.3353, 0.3284]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0835, 0.0840, 0.0833, 0.0833, 0.0829, 0.0832, 0.0832, 0.0832, 0.0833,
         0.0832, 0.0834, 0.0837],
        [0.0835, 0.0839, 0.0834, 0.0833, 0.0829, 0.0832, 0.0832, 0.0832, 0.0832,
         0.0831, 0.0833, 0.0838],
        [0.0835, 0.0840, 0.0833, 0.0832, 0.0828, 0.0833, 0.0831, 0.0832, 0.0833,
         0.0831, 0.0835, 0.0837],
        [0.0835, 0.0839, 0.0833, 0.0833, 0.0828, 0.0832, 0.0832, 0.0832, 0.0833,
         0.0831, 0.0834, 0.0838],
        [0.0834, 0.0839, 0.0833, 0.0833, 0.0829, 0.0833, 0.0832, 0.0833, 0.0832,
         0.0831, 0.0834, 0.0837],
        [0.0835, 0.0839, 0.0834, 0.0833, 0.0828, 0.0832, 0.0831, 0.0833, 0.0833,
         0.0830, 0.0834, 0.0838],
        [0.0835, 0.0838, 0.0834, 0.0833, 0.0829, 0.0833, 0.0833, 0.0832, 0.0832,
         0.0831, 0.0834, 0.0836],
        [0.0834, 0.0840, 0.0833, 0.0832, 0.0829, 0.0833, 0.0833, 0.0832, 0.0833,
         0.0832, 0.0833, 0.0836],
        [0.0834, 0.0840, 0.0834, 0.0833, 0.0828, 0.0832, 0.0832, 0.0832, 0.0833,
         0.0831, 0.0833, 0.0838],
        [0.0834, 0.0839, 0.0834, 0.0833, 0.0829, 0.0832, 0.0833, 0.0833, 0.0831,
         0.0832, 0.0833, 0.0837],
        [0.0835, 0.0840, 0.0833, 0.0833, 0.0828, 0.0833, 0.0832, 0.0832, 0.0833,
         0.0831, 0.0834, 0.0837],
        [0.0835, 0.0840, 0.0833, 0.0833, 0.0829, 0.0832, 0.0832, 0.0832, 0.0833,
         0.0831, 0.0833, 0.0837]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1438, 0.1428, 0.1417, 0.1414, 0.1430, 0.1419, 0.1455],
        [0.1440, 0.1431, 0.1416, 0.1415, 0.1430, 0.1419, 0.1451],
        [0.1439, 0.1428, 0.1418, 0.1414, 0.1431, 0.1418, 0.1452],
        [0.1438, 0.1430, 0.1417, 0.1415, 0.1430, 0.1419, 0.1452],
        [0.1439, 0.1429, 0.1415, 0.1415, 0.1429, 0.1418, 0.1455],
        [0.1438, 0.1427, 0.1416, 0.1415, 0.1428, 0.1417, 0.1457],
        [0.1440, 0.1428, 0.1412, 0.1410, 0.1431, 0.1414, 0.1463]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0592, 0.0590, 0.0592, 0.0592, 0.0590, 0.0591, 0.0581, 0.0589, 0.0584,
         0.0587, 0.0592, 0.0589, 0.0589, 0.0581, 0.0586, 0.0590, 0.0585],
        [0.0592, 0.0590, 0.0593, 0.0592, 0.0591, 0.0590, 0.0581, 0.0588, 0.0584,
         0.0587, 0.0591, 0.0589, 0.0589, 0.0581, 0.0586, 0.0590, 0.0585],
        [0.0593, 0.0590, 0.0593, 0.0592, 0.0591, 0.0590, 0.0581, 0.0588, 0.0584,
         0.0587, 0.0591, 0.0589, 0.0590, 0.0582, 0.0586, 0.0590, 0.0584],
        [0.0592, 0.0590, 0.0593, 0.0592, 0.0590, 0.0590, 0.0581, 0.0589, 0.0584,
         0.0587, 0.0592, 0.0589, 0.0589, 0.0581, 0.0586, 0.0590, 0.0585],
        [0.0593, 0.0591, 0.0593, 0.0592, 0.0591, 0.0590, 0.0581, 0.0588, 0.0583,
         0.0586, 0.0593, 0.0589, 0.0589, 0.0580, 0.0586, 0.0590, 0.0585],
        [0.0592, 0.0590, 0.0593, 0.0592, 0.0591, 0.0590, 0.0581, 0.0588, 0.0584,
         0.0587, 0.0592, 0.0589, 0.0589, 0.0581, 0.0586, 0.0590, 0.0584],
        [0.0593, 0.0590, 0.0593, 0.0592, 0.0590, 0.0590, 0.0582, 0.0589, 0.0584,
         0.0586, 0.0592, 0.0589, 0.0589, 0.0581, 0.0586, 0.0590, 0.0585],
        [0.0592, 0.0590, 0.0593, 0.0592, 0.0590, 0.0590, 0.0582, 0.0589, 0.0584,
         0.0586, 0.0592, 0.0590, 0.0589, 0.0581, 0.0586, 0.0590, 0.0585],
        [0.0592, 0.0590, 0.0593, 0.0592, 0.0591, 0.0590, 0.0582, 0.0589, 0.0584,
         0.0586, 0.0593, 0.0589, 0.0589, 0.0581, 0.0586, 0.0590, 0.0584],
        [0.0593, 0.0590, 0.0593, 0.0592, 0.0592, 0.0591, 0.0581, 0.0589, 0.0583,
         0.0587, 0.0592, 0.0589, 0.0590, 0.0581, 0.0586, 0.0590, 0.0584],
        [0.0592, 0.0590, 0.0593, 0.0592, 0.0591, 0.0590, 0.0581, 0.0588, 0.0584,
         0.0587, 0.0591, 0.0589, 0.0589, 0.0581, 0.0586, 0.0590, 0.0585],
        [0.0592, 0.0590, 0.0593, 0.0592, 0.0590, 0.0590, 0.0581, 0.0589, 0.0584,
         0.0586, 0.0592, 0.0589, 0.0589, 0.0581, 0.0586, 0.0590, 0.0584],
        [0.0592, 0.0590, 0.0593, 0.0592, 0.0591, 0.0590, 0.0581, 0.0588, 0.0583,
         0.0586, 0.0593, 0.0589, 0.0589, 0.0580, 0.0586, 0.0590, 0.0585],
        [0.0593, 0.0590, 0.0594, 0.0592, 0.0591, 0.0590, 0.0581, 0.0588, 0.0584,
         0.0586, 0.0592, 0.0589, 0.0589, 0.0580, 0.0586, 0.0590, 0.0584],
        [0.0592, 0.0590, 0.0593, 0.0592, 0.0591, 0.0590, 0.0581, 0.0589, 0.0584,
         0.0586, 0.0592, 0.0589, 0.0589, 0.0581, 0.0586, 0.0590, 0.0584],
        [0.0593, 0.0590, 0.0593, 0.0592, 0.0591, 0.0590, 0.0581, 0.0588, 0.0584,
         0.0587, 0.0592, 0.0589, 0.0590, 0.0581, 0.0586, 0.0590, 0.0584],
        [0.0592, 0.0590, 0.0593, 0.0592, 0.0591, 0.0590, 0.0582, 0.0588, 0.0584,
         0.0587, 0.0592, 0.0589, 0.0589, 0.0581, 0.0586, 0.0591, 0.0585]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0499, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0501, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0497,
         0.0498, 0.0499, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0498, 0.0501, 0.0498, 0.0497,
         0.0498, 0.0498, 0.0502, 0.0498, 0.0501, 0.0506, 0.0501, 0.0499, 0.0505,
         0.0499, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2840087413787842s
iter time cost:11.272442102432251s
-------------Round number: 120-------------
Evaluate global model
[running kmeans]: 3it [00:00, 333.06it/s, center_shift=0.000000, iteration=3, tol=0.000100]
Averaged Train Loss: 0.5223
Averaged Test Accurancy: 0.7836
Std Test Accurancy: 0.0973
evaluate time cost:4.768009185791016s
clients training time cost:5.333029747009277s
[running kmeans]: 4it [00:00, 285.46it/s, center_shift=0.000000, iteration=4, tol=0.000100]
attn_optimize time cost:0.5725212097167969s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0500, 0.0497, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0502, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0502, 0.0498, 0.0501, 0.0506, 0.0501, 0.0498, 0.0504,
         0.0498, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2021, 0.1995, 0.2004, 0.1980],
        [0.1997, 0.2021, 0.1997, 0.2003, 0.1982],
        [0.2001, 0.2019, 0.1995, 0.2005, 0.1980],
        [0.1999, 0.2020, 0.1995, 0.2004, 0.1982],
        [0.1997, 0.2023, 0.1995, 0.2003, 0.1982]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0502, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0502, 0.0496, 0.0500, 0.0495, 0.0499, 0.0498, 0.0494, 0.0500,
         0.0497, 0.0503, 0.0501, 0.0500, 0.0501, 0.0505, 0.0497, 0.0502, 0.0500,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0501, 0.0499, 0.0501, 0.0504, 0.0497, 0.0502, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0495, 0.0500, 0.0499, 0.0494, 0.0500,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0501, 0.0505, 0.0496, 0.0502, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0502, 0.0496, 0.0500, 0.0495, 0.0500, 0.0498, 0.0494, 0.0500,
         0.0498, 0.0503, 0.0501, 0.0500, 0.0502, 0.0505, 0.0496, 0.0502, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0501, 0.0499, 0.0501, 0.0504, 0.0497, 0.0502, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0500,
         0.0499, 0.0507],
        [0.0500, 0.0502, 0.0496, 0.0501, 0.0495, 0.0499, 0.0499, 0.0494, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0502, 0.0505, 0.0496, 0.0502, 0.0499,
         0.0501, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0502, 0.0505, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0507],
        [0.0501, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0501, 0.0499, 0.0501, 0.0504, 0.0497, 0.0502, 0.0500,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0496, 0.0499, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0502, 0.0505, 0.0497, 0.0502, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0502, 0.0498, 0.0500, 0.0495, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0500, 0.0498, 0.0494, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0502, 0.0505, 0.0496, 0.0502, 0.0500,
         0.0499, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0503, 0.0500,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0502, 0.0501, 0.0500, 0.0502, 0.0505, 0.0496, 0.0501, 0.0500,
         0.0499, 0.0510],
        [0.0501, 0.0502, 0.0497, 0.0500, 0.0496, 0.0499, 0.0499, 0.0494, 0.0500,
         0.0498, 0.0504, 0.0500, 0.0499, 0.0502, 0.0504, 0.0496, 0.0502, 0.0500,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0500,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0499, 0.0496, 0.0500, 0.0498, 0.0494, 0.0500,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0502, 0.0505, 0.0497, 0.0502, 0.0500,
         0.0500, 0.0504],
        [0.0499, 0.0505, 0.0496, 0.0502, 0.0495, 0.0499, 0.0498, 0.0494, 0.0497,
         0.0497, 0.0502, 0.0499, 0.0502, 0.0502, 0.0506, 0.0496, 0.0501, 0.0498,
         0.0499, 0.0513]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0527, 0.0528, 0.0526, 0.0528, 0.0525, 0.0526, 0.0526, 0.0528,
         0.0527, 0.0525, 0.0525, 0.0528, 0.0525, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0527, 0.0527, 0.0528, 0.0525, 0.0525, 0.0525, 0.0529,
         0.0526, 0.0524, 0.0525, 0.0529, 0.0525, 0.0525, 0.0529, 0.0527, 0.0526,
         0.0524],
        [0.0528, 0.0527, 0.0528, 0.0526, 0.0529, 0.0524, 0.0526, 0.0525, 0.0529,
         0.0526, 0.0524, 0.0524, 0.0528, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0525, 0.0529,
         0.0526, 0.0524, 0.0525, 0.0529, 0.0525, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0527, 0.0527, 0.0527, 0.0527, 0.0528, 0.0524, 0.0525, 0.0525, 0.0529,
         0.0526, 0.0524, 0.0524, 0.0528, 0.0525, 0.0526, 0.0529, 0.0527, 0.0526,
         0.0523],
        [0.0528, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0525, 0.0525, 0.0529, 0.0525, 0.0527, 0.0529, 0.0528, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0528, 0.0524, 0.0526, 0.0525, 0.0529,
         0.0526, 0.0524, 0.0525, 0.0528, 0.0525, 0.0525, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0525, 0.0528,
         0.0526, 0.0524, 0.0525, 0.0529, 0.0525, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0524],
        [0.0528, 0.0527, 0.0527, 0.0527, 0.0528, 0.0525, 0.0526, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0525, 0.0529, 0.0525, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0524],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0528, 0.0524, 0.0525, 0.0525, 0.0528,
         0.0526, 0.0524, 0.0525, 0.0529, 0.0525, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0529, 0.0525, 0.0525, 0.0525, 0.0528,
         0.0526, 0.0523, 0.0525, 0.0530, 0.0524, 0.0527, 0.0528, 0.0528, 0.0527,
         0.0522],
        [0.0528, 0.0527, 0.0527, 0.0527, 0.0528, 0.0524, 0.0525, 0.0525, 0.0529,
         0.0525, 0.0524, 0.0525, 0.0529, 0.0525, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0528, 0.0526, 0.0527, 0.0527, 0.0528, 0.0525, 0.0526, 0.0525, 0.0529,
         0.0526, 0.0523, 0.0524, 0.0529, 0.0525, 0.0526, 0.0529, 0.0526, 0.0527,
         0.0523],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0525, 0.0529, 0.0525, 0.0526, 0.0528, 0.0527, 0.0526,
         0.0524],
        [0.0528, 0.0527, 0.0527, 0.0527, 0.0528, 0.0525, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0525, 0.0528, 0.0525, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0526, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0525, 0.0528, 0.0525, 0.0526, 0.0529, 0.0526, 0.0527,
         0.0524],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0528, 0.0524, 0.0525, 0.0525, 0.0529,
         0.0526, 0.0523, 0.0525, 0.0530, 0.0525, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0527, 0.0527, 0.0528, 0.0525, 0.0525, 0.0525, 0.0528,
         0.0526, 0.0524, 0.0525, 0.0529, 0.0524, 0.0526, 0.0529, 0.0527, 0.0527,
         0.0523],
        [0.0527, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0525, 0.0529,
         0.0526, 0.0524, 0.0524, 0.0529, 0.0525, 0.0527, 0.0529, 0.0527, 0.0526,
         0.0523]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0523, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0530, 0.0528,
         0.0527],
        [0.0528, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0528, 0.0532, 0.0519, 0.0524, 0.0525, 0.0524, 0.0527, 0.0524, 0.0527,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0524, 0.0527, 0.0527, 0.0530, 0.0528,
         0.0528],
        [0.0528, 0.0530, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0528, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0523, 0.0526,
         0.0525, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0524, 0.0526, 0.0524, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0524, 0.0527, 0.0527, 0.0530, 0.0527,
         0.0528],
        [0.0528, 0.0531, 0.0520, 0.0524, 0.0527, 0.0525, 0.0526, 0.0523, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0528, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0523, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0528, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0528,
         0.0527],
        [0.0527, 0.0531, 0.0521, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0528,
         0.0528],
        [0.0528, 0.0531, 0.0520, 0.0524, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0531, 0.0529,
         0.0527],
        [0.0528, 0.0531, 0.0519, 0.0524, 0.0527, 0.0525, 0.0526, 0.0523, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0527],
        [0.0528, 0.0531, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0528, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0528, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0523, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0528, 0.0531, 0.0519, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0524, 0.0526, 0.0526, 0.0531, 0.0529,
         0.0528],
        [0.0528, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0528, 0.0531, 0.0519, 0.0525, 0.0526, 0.0524, 0.0526, 0.0523, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0524, 0.0527, 0.0527, 0.0530, 0.0528,
         0.0528]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0775, 0.0771, 0.0774, 0.0773, 0.0771, 0.0759, 0.0770, 0.0763, 0.0773,
         0.0770, 0.0765, 0.0771, 0.0764],
        [0.0775, 0.0772, 0.0775, 0.0773, 0.0771, 0.0760, 0.0769, 0.0763, 0.0773,
         0.0770, 0.0766, 0.0771, 0.0765],
        [0.0775, 0.0771, 0.0775, 0.0773, 0.0771, 0.0759, 0.0769, 0.0763, 0.0773,
         0.0770, 0.0766, 0.0771, 0.0763],
        [0.0775, 0.0771, 0.0775, 0.0773, 0.0770, 0.0759, 0.0770, 0.0763, 0.0773,
         0.0770, 0.0765, 0.0771, 0.0764],
        [0.0775, 0.0771, 0.0775, 0.0774, 0.0770, 0.0759, 0.0769, 0.0762, 0.0774,
         0.0771, 0.0765, 0.0771, 0.0764],
        [0.0775, 0.0771, 0.0775, 0.0773, 0.0770, 0.0760, 0.0769, 0.0763, 0.0773,
         0.0770, 0.0765, 0.0771, 0.0764],
        [0.0774, 0.0771, 0.0774, 0.0773, 0.0770, 0.0761, 0.0770, 0.0763, 0.0773,
         0.0770, 0.0765, 0.0771, 0.0764],
        [0.0775, 0.0771, 0.0775, 0.0774, 0.0770, 0.0760, 0.0770, 0.0763, 0.0774,
         0.0770, 0.0765, 0.0771, 0.0764],
        [0.0775, 0.0772, 0.0775, 0.0773, 0.0770, 0.0759, 0.0769, 0.0763, 0.0772,
         0.0770, 0.0765, 0.0771, 0.0765],
        [0.0774, 0.0771, 0.0774, 0.0774, 0.0771, 0.0760, 0.0770, 0.0763, 0.0773,
         0.0770, 0.0765, 0.0771, 0.0764],
        [0.0775, 0.0772, 0.0775, 0.0774, 0.0770, 0.0759, 0.0769, 0.0763, 0.0774,
         0.0770, 0.0765, 0.0771, 0.0764],
        [0.0775, 0.0771, 0.0775, 0.0773, 0.0770, 0.0759, 0.0769, 0.0763, 0.0774,
         0.0770, 0.0765, 0.0771, 0.0764],
        [0.0775, 0.0771, 0.0774, 0.0773, 0.0770, 0.0760, 0.0769, 0.0764, 0.0773,
         0.0769, 0.0765, 0.0772, 0.0764]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.34191298484802246s
iter time cost:11.110116004943848s
-------------Round number: 121-------------
Evaluate global model
Averaged Train Loss: 0.3627
Averaged Test Accurancy: 0.8010
Std Test Accurancy: 0.0846
evaluate time cost:4.773818016052246s
[running kmeans]: 4it [00:00, 307.40it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:5.3845744132995605s
attn_optimize time cost:0.6071310043334961s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1235, 0.1250, 0.1247, 0.1252, 0.1252, 0.1247, 0.1260, 0.1256],
        [0.1237, 0.1251, 0.1248, 0.1249, 0.1252, 0.1248, 0.1259, 0.1256],
        [0.1236, 0.1250, 0.1247, 0.1251, 0.1253, 0.1248, 0.1259, 0.1257],
        [0.1237, 0.1251, 0.1248, 0.1250, 0.1253, 0.1248, 0.1258, 0.1255],
        [0.1236, 0.1252, 0.1247, 0.1252, 0.1252, 0.1248, 0.1260, 0.1252],
        [0.1236, 0.1253, 0.1247, 0.1252, 0.1251, 0.1248, 0.1259, 0.1255],
        [0.1234, 0.1252, 0.1247, 0.1251, 0.1253, 0.1247, 0.1260, 0.1255],
        [0.1235, 0.1251, 0.1247, 0.1252, 0.1253, 0.1247, 0.1260, 0.1255]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0836, 0.0832, 0.0833, 0.0836, 0.0833, 0.0829, 0.0834, 0.0833, 0.0839,
         0.0832, 0.0830, 0.0833],
        [0.0835, 0.0832, 0.0833, 0.0835, 0.0833, 0.0830, 0.0835, 0.0833, 0.0838,
         0.0832, 0.0830, 0.0833],
        [0.0836, 0.0832, 0.0833, 0.0835, 0.0834, 0.0830, 0.0835, 0.0833, 0.0838,
         0.0832, 0.0830, 0.0833],
        [0.0835, 0.0832, 0.0833, 0.0835, 0.0833, 0.0830, 0.0834, 0.0833, 0.0838,
         0.0832, 0.0831, 0.0833],
        [0.0836, 0.0831, 0.0834, 0.0836, 0.0833, 0.0830, 0.0834, 0.0832, 0.0839,
         0.0832, 0.0830, 0.0832],
        [0.0835, 0.0832, 0.0834, 0.0836, 0.0834, 0.0829, 0.0834, 0.0832, 0.0839,
         0.0832, 0.0831, 0.0832],
        [0.0835, 0.0831, 0.0833, 0.0836, 0.0833, 0.0830, 0.0835, 0.0832, 0.0839,
         0.0832, 0.0831, 0.0832],
        [0.0836, 0.0832, 0.0833, 0.0836, 0.0833, 0.0829, 0.0835, 0.0833, 0.0838,
         0.0832, 0.0830, 0.0833],
        [0.0836, 0.0831, 0.0833, 0.0836, 0.0833, 0.0830, 0.0835, 0.0832, 0.0839,
         0.0832, 0.0830, 0.0832],
        [0.0835, 0.0831, 0.0833, 0.0836, 0.0833, 0.0830, 0.0834, 0.0832, 0.0838,
         0.0833, 0.0831, 0.0833],
        [0.0836, 0.0832, 0.0833, 0.0835, 0.0833, 0.0829, 0.0834, 0.0833, 0.0838,
         0.0833, 0.0831, 0.0833],
        [0.0836, 0.0832, 0.0833, 0.0835, 0.0833, 0.0830, 0.0834, 0.0833, 0.0838,
         0.0832, 0.0831, 0.0833]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1673, 0.1663, 0.1663, 0.1660, 0.1681, 0.1660],
        [0.1669, 0.1667, 0.1665, 0.1658, 0.1679, 0.1662],
        [0.1672, 0.1666, 0.1665, 0.1659, 0.1680, 0.1658],
        [0.1671, 0.1666, 0.1663, 0.1658, 0.1680, 0.1663],
        [0.1671, 0.1666, 0.1663, 0.1659, 0.1680, 0.1661],
        [0.1677, 0.1668, 0.1663, 0.1660, 0.1682, 0.1650]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0496, 0.0501, 0.0495, 0.0501, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0504, 0.0497, 0.0500, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0501, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0496, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0499, 0.0496, 0.0501, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0503, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0501, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0504, 0.0496, 0.0500, 0.0498,
         0.0501, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0502, 0.0504, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0507],
        [0.0501, 0.0504, 0.0498, 0.0500, 0.0496, 0.0501, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0502, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0505],
        [0.0501, 0.0504, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0495, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0501, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0504, 0.0496, 0.0500, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0498, 0.0500, 0.0496, 0.0501, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0501, 0.0501, 0.0503, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0498,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0502, 0.0504, 0.0497, 0.0499, 0.0499,
         0.0500, 0.0510],
        [0.0501, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0499, 0.0495, 0.0500,
         0.0499, 0.0503, 0.0500, 0.0500, 0.0502, 0.0504, 0.0496, 0.0501, 0.0499,
         0.0501, 0.0506],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0501, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0499, 0.0496, 0.0501, 0.0499, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0501, 0.0504],
        [0.0499, 0.0506, 0.0496, 0.0501, 0.0495, 0.0500, 0.0499, 0.0495, 0.0496,
         0.0498, 0.0501, 0.0499, 0.0503, 0.0502, 0.0505, 0.0496, 0.0499, 0.0497,
         0.0500, 0.0514]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4992, 0.5008],
        [0.4994, 0.5006]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1430, 0.1428, 0.1429, 0.1434, 0.1435, 0.1413],
        [0.1432, 0.1431, 0.1427, 0.1429, 0.1434, 0.1434, 0.1412],
        [0.1432, 0.1430, 0.1425, 0.1430, 0.1436, 0.1435, 0.1413],
        [0.1431, 0.1429, 0.1428, 0.1429, 0.1436, 0.1433, 0.1414],
        [0.1435, 0.1431, 0.1426, 0.1428, 0.1435, 0.1432, 0.1414],
        [0.1432, 0.1430, 0.1425, 0.1430, 0.1436, 0.1434, 0.1414],
        [0.1431, 0.1430, 0.1423, 0.1426, 0.1436, 0.1438, 0.1416]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0772, 0.0769, 0.0771, 0.0768, 0.0771, 0.0768, 0.0768, 0.0771, 0.0768,
         0.0767, 0.0773, 0.0769, 0.0765],
        [0.0772, 0.0770, 0.0771, 0.0768, 0.0771, 0.0766, 0.0768, 0.0771, 0.0768,
         0.0767, 0.0773, 0.0769, 0.0765],
        [0.0772, 0.0770, 0.0771, 0.0768, 0.0772, 0.0767, 0.0768, 0.0771, 0.0768,
         0.0767, 0.0773, 0.0769, 0.0765],
        [0.0771, 0.0769, 0.0771, 0.0768, 0.0772, 0.0767, 0.0768, 0.0771, 0.0768,
         0.0769, 0.0773, 0.0770, 0.0765],
        [0.0772, 0.0770, 0.0771, 0.0768, 0.0771, 0.0767, 0.0768, 0.0771, 0.0769,
         0.0768, 0.0773, 0.0769, 0.0765],
        [0.0771, 0.0770, 0.0770, 0.0768, 0.0771, 0.0767, 0.0768, 0.0772, 0.0768,
         0.0766, 0.0773, 0.0769, 0.0765],
        [0.0772, 0.0769, 0.0771, 0.0768, 0.0772, 0.0766, 0.0768, 0.0771, 0.0768,
         0.0768, 0.0773, 0.0770, 0.0766],
        [0.0772, 0.0770, 0.0770, 0.0768, 0.0771, 0.0767, 0.0768, 0.0772, 0.0767,
         0.0767, 0.0773, 0.0769, 0.0766],
        [0.0772, 0.0770, 0.0771, 0.0768, 0.0772, 0.0766, 0.0768, 0.0771, 0.0769,
         0.0768, 0.0772, 0.0769, 0.0765],
        [0.0772, 0.0769, 0.0770, 0.0768, 0.0771, 0.0766, 0.0769, 0.0771, 0.0769,
         0.0768, 0.0773, 0.0770, 0.0765],
        [0.0772, 0.0770, 0.0771, 0.0768, 0.0771, 0.0767, 0.0768, 0.0771, 0.0768,
         0.0768, 0.0773, 0.0769, 0.0766],
        [0.0773, 0.0769, 0.0771, 0.0769, 0.0771, 0.0766, 0.0768, 0.0770, 0.0767,
         0.0768, 0.0773, 0.0770, 0.0765],
        [0.0772, 0.0769, 0.0771, 0.0768, 0.0771, 0.0766, 0.0768, 0.0771, 0.0769,
         0.0769, 0.0773, 0.0769, 0.0765]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0505, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0504, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0494, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0497, 0.0492],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0501, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0497, 0.0491],
        [0.0497, 0.0504, 0.0503, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0499, 0.0486],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0497, 0.0505, 0.0502, 0.0506, 0.0504, 0.0504, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0500, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0497, 0.0504, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0499, 0.0505, 0.0501, 0.0506, 0.0505, 0.0504, 0.0504, 0.0493, 0.0499,
         0.0502, 0.0495, 0.0499, 0.0506, 0.0502, 0.0501, 0.0492, 0.0499, 0.0502,
         0.0497, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0911, 0.0916, 0.0907, 0.0908, 0.0904, 0.0908, 0.0909, 0.0909, 0.0907,
         0.0909, 0.0913],
        [0.0910, 0.0916, 0.0906, 0.0909, 0.0905, 0.0907, 0.0909, 0.0908, 0.0907,
         0.0909, 0.0914],
        [0.0910, 0.0916, 0.0906, 0.0909, 0.0904, 0.0908, 0.0909, 0.0909, 0.0907,
         0.0909, 0.0914],
        [0.0910, 0.0916, 0.0906, 0.0908, 0.0904, 0.0908, 0.0909, 0.0909, 0.0906,
         0.0909, 0.0914],
        [0.0910, 0.0916, 0.0905, 0.0909, 0.0905, 0.0908, 0.0909, 0.0909, 0.0907,
         0.0909, 0.0914],
        [0.0911, 0.0916, 0.0906, 0.0909, 0.0904, 0.0907, 0.0908, 0.0909, 0.0906,
         0.0909, 0.0915],
        [0.0910, 0.0915, 0.0907, 0.0909, 0.0905, 0.0908, 0.0909, 0.0908, 0.0907,
         0.0909, 0.0913],
        [0.0910, 0.0917, 0.0905, 0.0908, 0.0903, 0.0907, 0.0909, 0.0910, 0.0907,
         0.0908, 0.0915],
        [0.0910, 0.0915, 0.0907, 0.0909, 0.0905, 0.0908, 0.0910, 0.0908, 0.0907,
         0.0909, 0.0913],
        [0.0911, 0.0917, 0.0906, 0.0908, 0.0904, 0.0908, 0.0908, 0.0909, 0.0906,
         0.0909, 0.0914],
        [0.0910, 0.0916, 0.0907, 0.0908, 0.0904, 0.0908, 0.0909, 0.0909, 0.0907,
         0.0909, 0.0914]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26299357414245605s
iter time cost:11.118598699569702s
-------------Round number: 122-------------
Evaluate global model
Averaged Train Loss: 0.3138
Averaged Test Accurancy: 0.8130
Std Test Accurancy: 0.0846
evaluate time cost:4.968102216720581s
[running kmeans]: 3it [00:00, 272.50it/s, center_shift=0.000000, iteration=3, tol=0.000100]
clients training time cost:5.227657079696655s
attn_optimize time cost:0.42694640159606934s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1989, 0.2007, 0.2007, 0.2024, 0.1973],
        [0.1988, 0.2005, 0.2006, 0.2023, 0.1978],
        [0.1987, 0.2005, 0.2004, 0.2019, 0.1985],
        [0.1986, 0.2005, 0.2004, 0.2019, 0.1986],
        [0.1976, 0.2002, 0.2002, 0.2038, 0.1981]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0524, 0.0531, 0.0528, 0.0532, 0.0531, 0.0529, 0.0528, 0.0520, 0.0522,
         0.0527, 0.0522, 0.0525, 0.0530, 0.0528, 0.0528, 0.0518, 0.0524, 0.0528,
         0.0524],
        [0.0523, 0.0531, 0.0528, 0.0531, 0.0530, 0.0529, 0.0528, 0.0520, 0.0523,
         0.0528, 0.0523, 0.0525, 0.0530, 0.0528, 0.0528, 0.0519, 0.0524, 0.0529,
         0.0524],
        [0.0523, 0.0531, 0.0529, 0.0531, 0.0530, 0.0529, 0.0528, 0.0520, 0.0523,
         0.0527, 0.0523, 0.0526, 0.0529, 0.0527, 0.0528, 0.0520, 0.0524, 0.0528,
         0.0524],
        [0.0524, 0.0531, 0.0528, 0.0531, 0.0530, 0.0529, 0.0528, 0.0520, 0.0524,
         0.0527, 0.0523, 0.0526, 0.0529, 0.0527, 0.0528, 0.0520, 0.0524, 0.0528,
         0.0523],
        [0.0523, 0.0531, 0.0528, 0.0531, 0.0530, 0.0529, 0.0528, 0.0521, 0.0522,
         0.0527, 0.0523, 0.0525, 0.0530, 0.0528, 0.0528, 0.0520, 0.0524, 0.0528,
         0.0524],
        [0.0523, 0.0531, 0.0529, 0.0532, 0.0531, 0.0529, 0.0528, 0.0520, 0.0523,
         0.0527, 0.0522, 0.0525, 0.0531, 0.0528, 0.0528, 0.0519, 0.0524, 0.0528,
         0.0524],
        [0.0523, 0.0531, 0.0528, 0.0531, 0.0531, 0.0529, 0.0528, 0.0520, 0.0522,
         0.0527, 0.0522, 0.0525, 0.0531, 0.0528, 0.0528, 0.0519, 0.0524, 0.0528,
         0.0524],
        [0.0523, 0.0531, 0.0528, 0.0531, 0.0530, 0.0529, 0.0528, 0.0521, 0.0522,
         0.0528, 0.0523, 0.0525, 0.0530, 0.0528, 0.0528, 0.0519, 0.0525, 0.0529,
         0.0524],
        [0.0524, 0.0531, 0.0528, 0.0532, 0.0530, 0.0529, 0.0528, 0.0520, 0.0522,
         0.0527, 0.0522, 0.0525, 0.0530, 0.0528, 0.0528, 0.0519, 0.0525, 0.0528,
         0.0524],
        [0.0523, 0.0531, 0.0528, 0.0531, 0.0530, 0.0528, 0.0528, 0.0521, 0.0522,
         0.0528, 0.0523, 0.0525, 0.0530, 0.0528, 0.0528, 0.0519, 0.0524, 0.0528,
         0.0524],
        [0.0523, 0.0531, 0.0528, 0.0531, 0.0531, 0.0529, 0.0528, 0.0521, 0.0523,
         0.0528, 0.0522, 0.0524, 0.0531, 0.0528, 0.0528, 0.0519, 0.0524, 0.0528,
         0.0524],
        [0.0524, 0.0531, 0.0528, 0.0532, 0.0530, 0.0530, 0.0528, 0.0520, 0.0522,
         0.0527, 0.0522, 0.0525, 0.0530, 0.0528, 0.0528, 0.0519, 0.0525, 0.0528,
         0.0523],
        [0.0523, 0.0531, 0.0529, 0.0532, 0.0530, 0.0529, 0.0528, 0.0520, 0.0522,
         0.0527, 0.0523, 0.0525, 0.0529, 0.0528, 0.0528, 0.0520, 0.0524, 0.0529,
         0.0524],
        [0.0523, 0.0531, 0.0528, 0.0531, 0.0531, 0.0529, 0.0528, 0.0521, 0.0522,
         0.0528, 0.0523, 0.0525, 0.0530, 0.0528, 0.0528, 0.0519, 0.0524, 0.0529,
         0.0523],
        [0.0523, 0.0531, 0.0529, 0.0532, 0.0530, 0.0529, 0.0528, 0.0521, 0.0522,
         0.0527, 0.0522, 0.0524, 0.0531, 0.0528, 0.0528, 0.0519, 0.0524, 0.0528,
         0.0524],
        [0.0523, 0.0531, 0.0528, 0.0532, 0.0531, 0.0530, 0.0528, 0.0520, 0.0522,
         0.0527, 0.0522, 0.0524, 0.0530, 0.0528, 0.0528, 0.0519, 0.0525, 0.0528,
         0.0524],
        [0.0524, 0.0531, 0.0529, 0.0531, 0.0530, 0.0529, 0.0528, 0.0520, 0.0523,
         0.0527, 0.0523, 0.0525, 0.0530, 0.0527, 0.0528, 0.0519, 0.0524, 0.0529,
         0.0523],
        [0.0523, 0.0531, 0.0528, 0.0531, 0.0530, 0.0529, 0.0528, 0.0521, 0.0522,
         0.0527, 0.0522, 0.0525, 0.0530, 0.0528, 0.0528, 0.0519, 0.0524, 0.0528,
         0.0523],
        [0.0523, 0.0531, 0.0528, 0.0531, 0.0530, 0.0529, 0.0528, 0.0521, 0.0523,
         0.0527, 0.0523, 0.0525, 0.0530, 0.0527, 0.0528, 0.0520, 0.0524, 0.0529,
         0.0524]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.0995, 0.1000, 0.0998, 0.1002, 0.0995, 0.1005, 0.1004, 0.1000,
         0.1001],
        [0.1000, 0.0996, 0.1001, 0.0998, 0.1001, 0.0996, 0.1005, 0.1004, 0.0999,
         0.1001],
        [0.1000, 0.0995, 0.1001, 0.0998, 0.1003, 0.0996, 0.1005, 0.1004, 0.0999,
         0.1000],
        [0.1001, 0.0996, 0.1001, 0.0997, 0.1001, 0.0995, 0.1005, 0.1004, 0.1000,
         0.1000],
        [0.1001, 0.0996, 0.1000, 0.0999, 0.1000, 0.0995, 0.1006, 0.1002, 0.1000,
         0.1001],
        [0.1001, 0.0995, 0.1001, 0.0998, 0.1000, 0.0996, 0.1005, 0.1003, 0.1000,
         0.1000],
        [0.1001, 0.0994, 0.0999, 0.0997, 0.1003, 0.0994, 0.1005, 0.1003, 0.1001,
         0.1001],
        [0.1001, 0.0995, 0.0998, 0.0998, 0.1002, 0.0997, 0.1005, 0.1003, 0.1000,
         0.1002],
        [0.1001, 0.0995, 0.0999, 0.0997, 0.1002, 0.0995, 0.1005, 0.1004, 0.1001,
         0.1001],
        [0.1000, 0.0995, 0.1001, 0.0998, 0.1001, 0.0996, 0.1005, 0.1003, 0.1000,
         0.1001]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1430, 0.1416, 0.1415, 0.1430, 0.1419, 0.1456],
        [0.1437, 0.1432, 0.1415, 0.1416, 0.1430, 0.1419, 0.1451],
        [0.1436, 0.1429, 0.1417, 0.1415, 0.1431, 0.1419, 0.1453],
        [0.1435, 0.1431, 0.1416, 0.1416, 0.1430, 0.1419, 0.1453],
        [0.1436, 0.1430, 0.1414, 0.1416, 0.1429, 0.1419, 0.1456],
        [0.1435, 0.1429, 0.1415, 0.1416, 0.1429, 0.1418, 0.1458],
        [0.1438, 0.1430, 0.1411, 0.1411, 0.1431, 0.1414, 0.1465]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0500, 0.0500, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0498, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0498, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0500, 0.0499, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0500, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0502],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0504,
         0.0499, 0.0500],
        [0.0503, 0.0498, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0502, 0.0498, 0.0501, 0.0506, 0.0501, 0.0499, 0.0504,
         0.0498, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0716, 0.0719, 0.0712, 0.0713, 0.0713, 0.0713, 0.0713, 0.0714, 0.0714,
         0.0713, 0.0713, 0.0714, 0.0717, 0.0716],
        [0.0715, 0.0719, 0.0711, 0.0714, 0.0714, 0.0712, 0.0714, 0.0714, 0.0714,
         0.0713, 0.0712, 0.0713, 0.0716, 0.0717],
        [0.0715, 0.0719, 0.0711, 0.0713, 0.0714, 0.0713, 0.0713, 0.0714, 0.0714,
         0.0713, 0.0712, 0.0714, 0.0718, 0.0717],
        [0.0715, 0.0720, 0.0712, 0.0714, 0.0713, 0.0713, 0.0712, 0.0713, 0.0714,
         0.0714, 0.0712, 0.0714, 0.0718, 0.0717],
        [0.0715, 0.0719, 0.0711, 0.0714, 0.0713, 0.0713, 0.0713, 0.0714, 0.0715,
         0.0714, 0.0712, 0.0714, 0.0717, 0.0717],
        [0.0715, 0.0719, 0.0711, 0.0715, 0.0714, 0.0712, 0.0713, 0.0714, 0.0714,
         0.0713, 0.0711, 0.0714, 0.0717, 0.0718],
        [0.0715, 0.0718, 0.0712, 0.0714, 0.0714, 0.0713, 0.0714, 0.0714, 0.0714,
         0.0712, 0.0712, 0.0714, 0.0717, 0.0716],
        [0.0715, 0.0720, 0.0712, 0.0714, 0.0713, 0.0713, 0.0713, 0.0713, 0.0715,
         0.0713, 0.0713, 0.0713, 0.0717, 0.0716],
        [0.0715, 0.0719, 0.0711, 0.0714, 0.0713, 0.0713, 0.0714, 0.0714, 0.0714,
         0.0713, 0.0713, 0.0713, 0.0718, 0.0716],
        [0.0715, 0.0720, 0.0710, 0.0714, 0.0713, 0.0712, 0.0713, 0.0714, 0.0714,
         0.0714, 0.0712, 0.0713, 0.0717, 0.0718],
        [0.0715, 0.0719, 0.0712, 0.0714, 0.0714, 0.0713, 0.0714, 0.0714, 0.0714,
         0.0712, 0.0713, 0.0713, 0.0716, 0.0716],
        [0.0716, 0.0720, 0.0711, 0.0713, 0.0714, 0.0713, 0.0713, 0.0714, 0.0714,
         0.0714, 0.0712, 0.0714, 0.0717, 0.0717],
        [0.0715, 0.0720, 0.0712, 0.0714, 0.0713, 0.0712, 0.0714, 0.0713, 0.0714,
         0.0714, 0.0712, 0.0713, 0.0718, 0.0716],
        [0.0715, 0.0720, 0.0712, 0.0714, 0.0713, 0.0713, 0.0713, 0.0713, 0.0715,
         0.0714, 0.0712, 0.0713, 0.0716, 0.0717]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0501, 0.0503, 0.0500, 0.0502, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0501, 0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0502, 0.0501, 0.0503, 0.0500, 0.0503, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0502, 0.0499, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0495],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0495],
        [0.0502, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0502, 0.0499, 0.0500, 0.0503, 0.0502, 0.0500,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0502, 0.0499, 0.0499, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0497, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0502, 0.0499, 0.0500, 0.0503, 0.0502, 0.0500,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0497, 0.0501, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0503, 0.0498, 0.0500, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0499, 0.0499, 0.0503, 0.0501, 0.0500,
         0.0497, 0.0495],
        [0.0502, 0.0500, 0.0502, 0.0500, 0.0502, 0.0501, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0497, 0.0498, 0.0502, 0.0499, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0497, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0500,
         0.0498, 0.0495],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0502, 0.0502,
         0.0501, 0.0497, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0502, 0.0500,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0500,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0497, 0.0501, 0.0502,
         0.0501, 0.0497, 0.0498, 0.0502, 0.0499, 0.0499, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497, 0.0501, 0.0501,
         0.0501, 0.0498, 0.0498, 0.0502, 0.0498, 0.0499, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0496],
        [0.0501, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0503, 0.0499, 0.0503, 0.0499, 0.0496, 0.0500, 0.0501,
         0.0501, 0.0496, 0.0497, 0.0503, 0.0500, 0.0502, 0.0502, 0.0503, 0.0501,
         0.0496, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3325, 0.3325, 0.3349],
        [0.3324, 0.3325, 0.3351],
        [0.3325, 0.3327, 0.3348]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28501462936401367s
iter time cost:10.982788801193237s
-------------Round number: 123-------------
Evaluate global model
Averaged Train Loss: 0.2951
Averaged Test Accurancy: 0.8191
Std Test Accurancy: 0.0754
evaluate time cost:5.018332004547119s
[running kmeans]: 5it [00:00, 333.04it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:5.431693077087402s
attn_optimize time cost:0.5079452991485596s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0528, 0.0531, 0.0520, 0.0525, 0.0526, 0.0526, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0528, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0525,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0530,
         0.0526],
        [0.0528, 0.0532, 0.0519, 0.0525, 0.0525, 0.0524, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0526, 0.0526, 0.0524, 0.0527, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0524, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0525, 0.0526, 0.0527, 0.0526, 0.0525, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0526, 0.0526, 0.0525, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0525, 0.0524, 0.0527, 0.0527, 0.0530, 0.0528,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0526, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0530, 0.0530,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0528, 0.0526, 0.0527, 0.0524, 0.0525,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0530, 0.0530,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0521, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0528,
         0.0528],
        [0.0528, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0525,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0519, 0.0524, 0.0527, 0.0526, 0.0526, 0.0524, 0.0525,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0530, 0.0530,
         0.0527],
        [0.0528, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0526, 0.0526, 0.0524, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0525, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0526],
        [0.0528, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0525,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0524, 0.0526, 0.0526, 0.0531, 0.0529,
         0.0528],
        [0.0528, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0525, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0524, 0.0527, 0.0527, 0.0530, 0.0529,
         0.0528]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1434, 0.1428, 0.1426, 0.1425, 0.1423, 0.1442, 0.1422],
        [0.1432, 0.1425, 0.1427, 0.1424, 0.1424, 0.1442, 0.1425],
        [0.1430, 0.1426, 0.1429, 0.1427, 0.1422, 0.1440, 0.1425],
        [0.1433, 0.1427, 0.1428, 0.1427, 0.1423, 0.1441, 0.1421],
        [0.1432, 0.1426, 0.1428, 0.1426, 0.1422, 0.1441, 0.1426],
        [0.1433, 0.1426, 0.1429, 0.1425, 0.1422, 0.1441, 0.1424],
        [0.1436, 0.1427, 0.1430, 0.1425, 0.1424, 0.1443, 0.1414]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0502, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0494, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0497, 0.0491],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0502, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0504, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0502, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0502, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0499, 0.0505, 0.0503, 0.0506, 0.0504, 0.0502, 0.0502, 0.0494, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0503, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0502, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0497, 0.0490],
        [0.0498, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0502, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0486],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0500, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0502, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0500, 0.0506, 0.0502, 0.0506, 0.0506, 0.0503, 0.0504, 0.0493, 0.0499,
         0.0502, 0.0494, 0.0499, 0.0506, 0.0502, 0.0502, 0.0492, 0.0499, 0.0501,
         0.0497, 0.0488]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0769, 0.0771, 0.0769, 0.0770, 0.0767, 0.0768, 0.0771, 0.0769,
         0.0767, 0.0773, 0.0770, 0.0765],
        [0.0771, 0.0769, 0.0770, 0.0770, 0.0770, 0.0766, 0.0768, 0.0771, 0.0768,
         0.0767, 0.0774, 0.0769, 0.0765],
        [0.0771, 0.0769, 0.0771, 0.0769, 0.0771, 0.0766, 0.0768, 0.0771, 0.0768,
         0.0767, 0.0774, 0.0770, 0.0765],
        [0.0770, 0.0769, 0.0771, 0.0769, 0.0771, 0.0766, 0.0768, 0.0772, 0.0768,
         0.0767, 0.0774, 0.0770, 0.0765],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0770, 0.0766, 0.0768, 0.0771, 0.0768,
         0.0768, 0.0774, 0.0769, 0.0765],
        [0.0770, 0.0770, 0.0770, 0.0769, 0.0770, 0.0767, 0.0768, 0.0772, 0.0768,
         0.0767, 0.0774, 0.0770, 0.0765],
        [0.0771, 0.0769, 0.0771, 0.0769, 0.0771, 0.0766, 0.0768, 0.0771, 0.0768,
         0.0767, 0.0774, 0.0770, 0.0766],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0770, 0.0766, 0.0768, 0.0772, 0.0768,
         0.0766, 0.0774, 0.0770, 0.0766],
        [0.0772, 0.0769, 0.0770, 0.0769, 0.0771, 0.0766, 0.0768, 0.0771, 0.0768,
         0.0767, 0.0774, 0.0770, 0.0764],
        [0.0771, 0.0769, 0.0770, 0.0769, 0.0771, 0.0766, 0.0769, 0.0771, 0.0769,
         0.0768, 0.0773, 0.0770, 0.0765],
        [0.0771, 0.0769, 0.0771, 0.0769, 0.0770, 0.0766, 0.0768, 0.0771, 0.0768,
         0.0767, 0.0774, 0.0770, 0.0766],
        [0.0772, 0.0769, 0.0771, 0.0770, 0.0770, 0.0766, 0.0768, 0.0771, 0.0768,
         0.0766, 0.0774, 0.0770, 0.0766],
        [0.0771, 0.0768, 0.0771, 0.0769, 0.0771, 0.0766, 0.0768, 0.0771, 0.0768,
         0.0768, 0.0774, 0.0770, 0.0765]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0765, 0.0769, 0.0766, 0.0767, 0.0764, 0.0774, 0.0771, 0.0771,
         0.0776, 0.0771, 0.0767, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0766, 0.0767, 0.0765, 0.0774, 0.0771, 0.0771,
         0.0776, 0.0771, 0.0767, 0.0769],
        [0.0769, 0.0765, 0.0770, 0.0766, 0.0768, 0.0765, 0.0774, 0.0770, 0.0771,
         0.0775, 0.0771, 0.0767, 0.0769],
        [0.0769, 0.0765, 0.0770, 0.0766, 0.0767, 0.0764, 0.0774, 0.0771, 0.0772,
         0.0776, 0.0771, 0.0768, 0.0768],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0767, 0.0765, 0.0774, 0.0770, 0.0772,
         0.0776, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0770, 0.0766, 0.0767, 0.0765, 0.0774, 0.0770, 0.0772,
         0.0775, 0.0770, 0.0768, 0.0768],
        [0.0770, 0.0764, 0.0768, 0.0765, 0.0768, 0.0764, 0.0774, 0.0770, 0.0772,
         0.0777, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0766, 0.0769, 0.0767, 0.0766, 0.0765, 0.0774, 0.0770, 0.0771,
         0.0776, 0.0771, 0.0767, 0.0770],
        [0.0770, 0.0765, 0.0770, 0.0766, 0.0767, 0.0765, 0.0773, 0.0770, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0766, 0.0770, 0.0765, 0.0767, 0.0764, 0.0774, 0.0769, 0.0771,
         0.0775, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0768, 0.0766, 0.0768, 0.0766, 0.0774, 0.0769, 0.0772,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0765, 0.0768, 0.0765, 0.0768, 0.0764, 0.0774, 0.0771, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0769],
        [0.0768, 0.0764, 0.0770, 0.0766, 0.0767, 0.0765, 0.0774, 0.0769, 0.0772,
         0.0777, 0.0770, 0.0767, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1423, 0.1430, 0.1435, 0.1430, 0.1438, 0.1416],
        [0.1428, 0.1420, 0.1431, 0.1438, 0.1431, 0.1438, 0.1415],
        [0.1427, 0.1424, 0.1431, 0.1438, 0.1428, 0.1436, 0.1416],
        [0.1431, 0.1422, 0.1430, 0.1437, 0.1429, 0.1435, 0.1416],
        [0.1429, 0.1422, 0.1431, 0.1435, 0.1429, 0.1438, 0.1416],
        [0.1428, 0.1420, 0.1432, 0.1438, 0.1428, 0.1438, 0.1415],
        [0.1424, 0.1416, 0.1428, 0.1438, 0.1435, 0.1442, 0.1417]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1672, 0.1664, 0.1647, 0.1668, 0.1654, 0.1695],
        [0.1675, 0.1668, 0.1646, 0.1667, 0.1654, 0.1690],
        [0.1674, 0.1664, 0.1648, 0.1669, 0.1654, 0.1691],
        [0.1674, 0.1665, 0.1645, 0.1667, 0.1653, 0.1695],
        [0.1673, 0.1663, 0.1647, 0.1666, 0.1653, 0.1698],
        [0.1675, 0.1664, 0.1640, 0.1668, 0.1648, 0.1704]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0772, 0.0769, 0.0769, 0.0771, 0.0766, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0767, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0769, 0.0769, 0.0771, 0.0767, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0767, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0773, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0769, 0.0769, 0.0771, 0.0766, 0.0766, 0.0770, 0.0768, 0.0769,
         0.0775, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0770, 0.0768, 0.0766, 0.0771, 0.0769, 0.0770,
         0.0775, 0.0769, 0.0765, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0768, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0768],
        [0.0772, 0.0769, 0.0769, 0.0771, 0.0766, 0.0766, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0769, 0.0768, 0.0771, 0.0767, 0.0766, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0770, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0767, 0.0766, 0.0770, 0.0768, 0.0769,
         0.0775, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0767, 0.0767, 0.0770, 0.0768, 0.0770,
         0.0774, 0.0770, 0.0767, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0767, 0.0766, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0769, 0.0769, 0.0771, 0.0767, 0.0766, 0.0770, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.23987674713134766s
iter time cost:11.275918006896973s
-------------Round number: 124-------------
Evaluate global model
Averaged Train Loss: 0.3553
Averaged Test Accurancy: 0.8029
Std Test Accurancy: 0.0874
evaluate time cost:4.861969709396362s
[running kmeans]: 4it [00:00, 307.42it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:5.3827807903289795s
attn_optimize time cost:0.4610421657562256s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0502, 0.0500, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0497],
        [0.0502, 0.0501, 0.0502, 0.0499, 0.0503, 0.0498, 0.0499, 0.0500, 0.0502,
         0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0503, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0498, 0.0499, 0.0500, 0.0502,
         0.0501, 0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0503, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0503, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0501, 0.0502,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0499, 0.0503, 0.0499, 0.0498, 0.0499, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0502, 0.0502, 0.0502,
         0.0497, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0502, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0499, 0.0500, 0.0503, 0.0500, 0.0502,
         0.0498, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0499, 0.0503, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0499, 0.0502, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0503, 0.0499, 0.0498, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0501, 0.0502,
         0.0498, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0497],
        [0.0501, 0.0500, 0.0501, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0498, 0.0501, 0.0500, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0502, 0.0497, 0.0504, 0.0498, 0.0498, 0.0499, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0503, 0.0500, 0.0502, 0.0501, 0.0503, 0.0503,
         0.0496, 0.0496]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3334, 0.3324, 0.3342],
        [0.3334, 0.3328, 0.3338],
        [0.3336, 0.3326, 0.3338]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0775, 0.0767, 0.0768, 0.0765, 0.0768, 0.0769, 0.0769, 0.0770,
         0.0768, 0.0768, 0.0769, 0.0772],
        [0.0771, 0.0775, 0.0767, 0.0769, 0.0766, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0769, 0.0773],
        [0.0770, 0.0775, 0.0766, 0.0769, 0.0765, 0.0769, 0.0769, 0.0770, 0.0769,
         0.0768, 0.0768, 0.0769, 0.0773],
        [0.0771, 0.0775, 0.0766, 0.0769, 0.0765, 0.0768, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0767, 0.0770, 0.0773],
        [0.0770, 0.0775, 0.0766, 0.0769, 0.0766, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0770, 0.0773],
        [0.0771, 0.0775, 0.0766, 0.0770, 0.0765, 0.0768, 0.0768, 0.0770, 0.0769,
         0.0769, 0.0767, 0.0769, 0.0774],
        [0.0771, 0.0774, 0.0767, 0.0769, 0.0766, 0.0769, 0.0769, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0769, 0.0772],
        [0.0770, 0.0776, 0.0767, 0.0768, 0.0765, 0.0769, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0768, 0.0769, 0.0772],
        [0.0771, 0.0775, 0.0767, 0.0768, 0.0765, 0.0768, 0.0770, 0.0769, 0.0769,
         0.0768, 0.0768, 0.0769, 0.0772],
        [0.0771, 0.0776, 0.0766, 0.0769, 0.0765, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0768, 0.0769, 0.0774],
        [0.0771, 0.0774, 0.0767, 0.0769, 0.0766, 0.0768, 0.0770, 0.0769, 0.0769,
         0.0767, 0.0768, 0.0769, 0.0772],
        [0.0771, 0.0775, 0.0766, 0.0769, 0.0765, 0.0769, 0.0768, 0.0769, 0.0770,
         0.0769, 0.0767, 0.0770, 0.0773],
        [0.0771, 0.0775, 0.0767, 0.0768, 0.0766, 0.0768, 0.0769, 0.0768, 0.0770,
         0.0769, 0.0768, 0.0769, 0.0773]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0494, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0497, 0.0492],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0499, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0503, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0497, 0.0490],
        [0.0498, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0505, 0.0504, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0498, 0.0504, 0.0502, 0.0502, 0.0493, 0.0500, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0489],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0500, 0.0506, 0.0502, 0.0506, 0.0506, 0.0504, 0.0504, 0.0493, 0.0499,
         0.0502, 0.0494, 0.0498, 0.0506, 0.0502, 0.0501, 0.0492, 0.0499, 0.0502,
         0.0496, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1115, 0.1111, 0.1112, 0.1115, 0.1107, 0.1110, 0.1110, 0.1110, 0.1111],
        [0.1115, 0.1110, 0.1111, 0.1114, 0.1106, 0.1111, 0.1111, 0.1111, 0.1111],
        [0.1115, 0.1110, 0.1112, 0.1114, 0.1107, 0.1111, 0.1110, 0.1111, 0.1111],
        [0.1114, 0.1111, 0.1111, 0.1114, 0.1107, 0.1111, 0.1110, 0.1110, 0.1111],
        [0.1115, 0.1109, 0.1112, 0.1113, 0.1106, 0.1112, 0.1111, 0.1111, 0.1110],
        [0.1115, 0.1111, 0.1112, 0.1114, 0.1106, 0.1111, 0.1110, 0.1110, 0.1111],
        [0.1114, 0.1111, 0.1111, 0.1114, 0.1106, 0.1111, 0.1110, 0.1111, 0.1111],
        [0.1114, 0.1109, 0.1112, 0.1114, 0.1107, 0.1110, 0.1111, 0.1111, 0.1111],
        [0.1115, 0.1110, 0.1111, 0.1114, 0.1106, 0.1111, 0.1110, 0.1111, 0.1111]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1669, 0.1662, 0.1655, 0.1664, 0.1684],
        [0.1666, 0.1670, 0.1666, 0.1656, 0.1661, 0.1681],
        [0.1666, 0.1669, 0.1665, 0.1657, 0.1662, 0.1681],
        [0.1668, 0.1667, 0.1663, 0.1654, 0.1664, 0.1683],
        [0.1666, 0.1669, 0.1664, 0.1655, 0.1662, 0.1682],
        [0.1666, 0.1670, 0.1663, 0.1657, 0.1662, 0.1682]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1416, 0.1432, 0.1430, 0.1429, 0.1446, 0.1442, 0.1406],
        [0.1415, 0.1432, 0.1429, 0.1428, 0.1441, 0.1439, 0.1415],
        [0.1416, 0.1432, 0.1429, 0.1429, 0.1443, 0.1442, 0.1409],
        [0.1415, 0.1434, 0.1428, 0.1428, 0.1442, 0.1438, 0.1414],
        [0.1414, 0.1434, 0.1429, 0.1427, 0.1444, 0.1439, 0.1414],
        [0.1414, 0.1432, 0.1428, 0.1427, 0.1444, 0.1439, 0.1415],
        [0.1406, 0.1433, 0.1425, 0.1425, 0.1451, 0.1451, 0.1410]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0496, 0.0501, 0.0497, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0501, 0.0505, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0508],
        [0.0499, 0.0503, 0.0496, 0.0501, 0.0497, 0.0499, 0.0499, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0502, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0500, 0.0510],
        [0.0499, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0495, 0.0501, 0.0496, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0499, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0496, 0.0500, 0.0499, 0.0494, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0502, 0.0502, 0.0505, 0.0496, 0.0500, 0.0498,
         0.0500, 0.0508],
        [0.0499, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0503, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0499, 0.0495, 0.0498,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0501, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0499, 0.0499, 0.0495, 0.0498,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0497, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0502, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0505],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0497, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0501, 0.0507],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0499, 0.0503, 0.0497, 0.0501, 0.0495, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0501, 0.0502, 0.0504, 0.0496, 0.0500, 0.0498,
         0.0500, 0.0510],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0497, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0502, 0.0501, 0.0504, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0499, 0.0504, 0.0496, 0.0501, 0.0497, 0.0500, 0.0499, 0.0496, 0.0498,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0499, 0.0498,
         0.0499, 0.0511],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0496, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0498, 0.0504, 0.0500, 0.0500, 0.0502, 0.0504, 0.0496, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0501, 0.0501, 0.0501, 0.0505, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0499, 0.0504, 0.0496, 0.0500, 0.0497, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0505],
        [0.0498, 0.0506, 0.0495, 0.0502, 0.0496, 0.0499, 0.0499, 0.0495, 0.0496,
         0.0497, 0.0502, 0.0499, 0.0503, 0.0502, 0.0505, 0.0497, 0.0499, 0.0497,
         0.0499, 0.0514]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2992722988128662s
iter time cost:11.090141534805298s
-------------Round number: 125-------------
Evaluate global model
Averaged Train Loss: 0.3749
Averaged Test Accurancy: 0.8045
Std Test Accurancy: 0.0914
evaluate time cost:4.702018737792969s
[running kmeans]: 4it [00:00, 307.40it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:5.365673542022705s
attn_optimize time cost:0.5747017860412598s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.5005, 0.4995],
        [0.5005, 0.4995]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2515, 0.2509, 0.2520, 0.2457],
        [0.2511, 0.2504, 0.2517, 0.2468],
        [0.2509, 0.2504, 0.2516, 0.2471],
        [0.2516, 0.2513, 0.2512, 0.2459]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1426, 0.1432, 0.1425, 0.1431, 0.1431, 0.1426, 0.1429],
        [0.1426, 0.1431, 0.1424, 0.1431, 0.1432, 0.1429, 0.1428],
        [0.1424, 0.1432, 0.1425, 0.1431, 0.1430, 0.1429, 0.1428],
        [0.1427, 0.1432, 0.1425, 0.1432, 0.1429, 0.1427, 0.1429],
        [0.1424, 0.1431, 0.1424, 0.1431, 0.1433, 0.1429, 0.1428],
        [0.1426, 0.1432, 0.1426, 0.1431, 0.1430, 0.1426, 0.1429],
        [0.1426, 0.1432, 0.1425, 0.1432, 0.1428, 0.1428, 0.1428]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0617, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0617, 0.0625, 0.0620,
         0.0628, 0.0625, 0.0626, 0.0617, 0.0622, 0.0627, 0.0622],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0628, 0.0625, 0.0627, 0.0618, 0.0622, 0.0626, 0.0620],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0626, 0.0617, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0628, 0.0631, 0.0630, 0.0628, 0.0626, 0.0616, 0.0625, 0.0619,
         0.0630, 0.0626, 0.0626, 0.0615, 0.0622, 0.0626, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0630, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0626, 0.0618, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0626, 0.0630, 0.0629, 0.0627, 0.0626, 0.0618, 0.0627, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0630, 0.0627, 0.0626, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0631, 0.0629, 0.0627, 0.0626, 0.0617, 0.0625, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0630, 0.0627, 0.0627, 0.0617, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0631, 0.0629, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0626, 0.0621],
        [0.0630, 0.0627, 0.0631, 0.0629, 0.0628, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0615, 0.0623, 0.0626, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0626, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0626, 0.0617, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0629, 0.0627, 0.0630, 0.0629, 0.0627, 0.0626, 0.0618, 0.0626, 0.0621,
         0.0629, 0.0625, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0250, 0.0249, 0.0249,  ..., 0.0250, 0.0250, 0.0249],
        [0.0251, 0.0249, 0.0250,  ..., 0.0249, 0.0249, 0.0249],
        [0.0250, 0.0249, 0.0250,  ..., 0.0250, 0.0250, 0.0249],
        ...,
        [0.0250, 0.0250, 0.0249,  ..., 0.0251, 0.0250, 0.0248],
        [0.0250, 0.0250, 0.0249,  ..., 0.0251, 0.0250, 0.0248],
        [0.0249, 0.0249, 0.0248,  ..., 0.0252, 0.0249, 0.0249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0530, 0.0523, 0.0529, 0.0523, 0.0526, 0.0525, 0.0523, 0.0526,
         0.0523, 0.0529, 0.0526, 0.0527, 0.0527, 0.0531, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0527, 0.0530, 0.0523, 0.0528, 0.0523, 0.0526, 0.0525, 0.0522, 0.0526,
         0.0524, 0.0529, 0.0526, 0.0528, 0.0528, 0.0532, 0.0524, 0.0526, 0.0526,
         0.0526],
        [0.0527, 0.0530, 0.0523, 0.0528, 0.0523, 0.0526, 0.0525, 0.0523, 0.0526,
         0.0524, 0.0530, 0.0526, 0.0526, 0.0527, 0.0531, 0.0524, 0.0527, 0.0526,
         0.0526],
        [0.0527, 0.0531, 0.0522, 0.0529, 0.0522, 0.0527, 0.0525, 0.0522, 0.0526,
         0.0524, 0.0529, 0.0525, 0.0528, 0.0528, 0.0532, 0.0524, 0.0527, 0.0526,
         0.0527],
        [0.0527, 0.0530, 0.0523, 0.0528, 0.0523, 0.0527, 0.0525, 0.0522, 0.0526,
         0.0525, 0.0529, 0.0526, 0.0528, 0.0528, 0.0532, 0.0523, 0.0527, 0.0526,
         0.0527],
        [0.0527, 0.0531, 0.0523, 0.0527, 0.0523, 0.0527, 0.0525, 0.0522, 0.0527,
         0.0524, 0.0530, 0.0526, 0.0527, 0.0527, 0.0531, 0.0524, 0.0528, 0.0526,
         0.0526],
        [0.0527, 0.0531, 0.0523, 0.0528, 0.0523, 0.0526, 0.0524, 0.0523, 0.0526,
         0.0523, 0.0530, 0.0526, 0.0527, 0.0528, 0.0531, 0.0524, 0.0527, 0.0526,
         0.0526],
        [0.0527, 0.0530, 0.0523, 0.0528, 0.0522, 0.0526, 0.0526, 0.0522, 0.0525,
         0.0524, 0.0529, 0.0526, 0.0527, 0.0528, 0.0532, 0.0524, 0.0527, 0.0526,
         0.0528],
        [0.0527, 0.0530, 0.0523, 0.0529, 0.0523, 0.0526, 0.0525, 0.0522, 0.0525,
         0.0524, 0.0530, 0.0526, 0.0527, 0.0528, 0.0532, 0.0525, 0.0527, 0.0526,
         0.0526],
        [0.0528, 0.0530, 0.0523, 0.0528, 0.0523, 0.0527, 0.0525, 0.0522, 0.0526,
         0.0524, 0.0530, 0.0526, 0.0526, 0.0528, 0.0531, 0.0524, 0.0527, 0.0527,
         0.0526],
        [0.0528, 0.0530, 0.0522, 0.0528, 0.0523, 0.0525, 0.0524, 0.0523, 0.0526,
         0.0523, 0.0530, 0.0526, 0.0527, 0.0528, 0.0532, 0.0524, 0.0527, 0.0527,
         0.0527],
        [0.0527, 0.0529, 0.0524, 0.0528, 0.0522, 0.0526, 0.0525, 0.0523, 0.0525,
         0.0524, 0.0530, 0.0526, 0.0527, 0.0527, 0.0531, 0.0524, 0.0527, 0.0526,
         0.0526],
        [0.0527, 0.0530, 0.0523, 0.0528, 0.0522, 0.0527, 0.0525, 0.0522, 0.0526,
         0.0524, 0.0530, 0.0526, 0.0527, 0.0528, 0.0532, 0.0524, 0.0527, 0.0526,
         0.0526],
        [0.0527, 0.0530, 0.0523, 0.0528, 0.0523, 0.0526, 0.0525, 0.0523, 0.0526,
         0.0524, 0.0529, 0.0525, 0.0528, 0.0527, 0.0531, 0.0525, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0530, 0.0524, 0.0527, 0.0523, 0.0527, 0.0524, 0.0523, 0.0526,
         0.0524, 0.0530, 0.0525, 0.0527, 0.0527, 0.0531, 0.0524, 0.0528, 0.0527,
         0.0526],
        [0.0527, 0.0531, 0.0523, 0.0528, 0.0523, 0.0526, 0.0525, 0.0523, 0.0525,
         0.0523, 0.0529, 0.0526, 0.0528, 0.0528, 0.0532, 0.0524, 0.0526, 0.0526,
         0.0526],
        [0.0528, 0.0529, 0.0523, 0.0527, 0.0523, 0.0525, 0.0525, 0.0522, 0.0526,
         0.0525, 0.0530, 0.0526, 0.0526, 0.0528, 0.0531, 0.0523, 0.0527, 0.0527,
         0.0527],
        [0.0527, 0.0530, 0.0523, 0.0528, 0.0523, 0.0525, 0.0524, 0.0523, 0.0526,
         0.0523, 0.0530, 0.0526, 0.0527, 0.0527, 0.0531, 0.0525, 0.0527, 0.0527,
         0.0526],
        [0.0527, 0.0530, 0.0523, 0.0527, 0.0523, 0.0526, 0.0525, 0.0522, 0.0526,
         0.0524, 0.0530, 0.0525, 0.0527, 0.0528, 0.0532, 0.0524, 0.0527, 0.0526,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1998, 0.2012, 0.1993, 0.1993, 0.2004],
        [0.1998, 0.2011, 0.1992, 0.1993, 0.2007],
        [0.1997, 0.2010, 0.1991, 0.1993, 0.2008],
        [0.1997, 0.2012, 0.1993, 0.1993, 0.2006],
        [0.1997, 0.2012, 0.1993, 0.1992, 0.2007]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1973, 0.2001, 0.2003, 0.2015, 0.2008],
        [0.1978, 0.1998, 0.2004, 0.2012, 0.2007],
        [0.1975, 0.2001, 0.2004, 0.2016, 0.2004],
        [0.1973, 0.2000, 0.2005, 0.2016, 0.2007],
        [0.1974, 0.2001, 0.2003, 0.2015, 0.2007]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.32329368591308594s
iter time cost:11.045011758804321s
-------------Round number: 126-------------
Evaluate global model
Averaged Train Loss: 0.3127
Averaged Test Accurancy: 0.8140
Std Test Accurancy: 0.0895
evaluate time cost:4.940911531448364s
clients training time cost:5.317378520965576s
[running kmeans]: 4it [00:00, 266.43it/s, center_shift=0.000000, iteration=4, tol=0.000100]
attn_optimize time cost:0.6969921588897705s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1437, 0.1428, 0.1415, 0.1412, 0.1431, 0.1420, 0.1456],
        [0.1440, 0.1431, 0.1414, 0.1413, 0.1431, 0.1420, 0.1451],
        [0.1439, 0.1428, 0.1416, 0.1412, 0.1432, 0.1420, 0.1453],
        [0.1438, 0.1430, 0.1415, 0.1413, 0.1431, 0.1420, 0.1453],
        [0.1439, 0.1429, 0.1413, 0.1413, 0.1431, 0.1419, 0.1456],
        [0.1438, 0.1427, 0.1415, 0.1414, 0.1430, 0.1418, 0.1458],
        [0.1440, 0.1429, 0.1410, 0.1409, 0.1432, 0.1415, 0.1464]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1985, 0.2011, 0.1996, 0.2012, 0.1996],
        [0.1986, 0.2012, 0.1994, 0.2012, 0.1995],
        [0.1985, 0.2012, 0.1994, 0.2013, 0.1996],
        [0.1985, 0.2012, 0.1994, 0.2013, 0.1996],
        [0.1986, 0.2011, 0.1996, 0.2010, 0.1997]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0501, 0.0499, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0497],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0503, 0.0499, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0500, 0.0499, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0503, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0500, 0.0499, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0502, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0502, 0.0501, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0499, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0503, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0500, 0.0499, 0.0503, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0503, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0496, 0.0499, 0.0502, 0.0498, 0.0500, 0.0503, 0.0502, 0.0502,
         0.0496, 0.0494],
        [0.0502, 0.0501, 0.0500, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0502,
         0.0499, 0.0497, 0.0498, 0.0501, 0.0499, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0495],
        [0.0502, 0.0501, 0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0496, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0502,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0500, 0.0499, 0.0503, 0.0500, 0.0499, 0.0501, 0.0502,
         0.0501, 0.0497, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0496, 0.0498, 0.0500, 0.0500, 0.0499, 0.0503, 0.0502, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0500, 0.0500, 0.0503, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0496, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0498, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0503, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0500, 0.0500, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0498, 0.0504, 0.0499, 0.0499, 0.0500, 0.0501,
         0.0500, 0.0495, 0.0497, 0.0502, 0.0500, 0.0502, 0.0502, 0.0504, 0.0502,
         0.0495, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0765, 0.0768, 0.0766, 0.0769, 0.0765, 0.0771, 0.0770, 0.0772,
         0.0776, 0.0772, 0.0768, 0.0770],
        [0.0769, 0.0765, 0.0769, 0.0765, 0.0768, 0.0766, 0.0772, 0.0771, 0.0772,
         0.0775, 0.0772, 0.0768, 0.0770],
        [0.0769, 0.0765, 0.0769, 0.0766, 0.0769, 0.0765, 0.0772, 0.0770, 0.0771,
         0.0774, 0.0772, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0765, 0.0768, 0.0765, 0.0772, 0.0771, 0.0772,
         0.0775, 0.0771, 0.0768, 0.0768],
        [0.0770, 0.0765, 0.0769, 0.0766, 0.0768, 0.0765, 0.0772, 0.0769, 0.0773,
         0.0776, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0769, 0.0766, 0.0768, 0.0766, 0.0772, 0.0770, 0.0772,
         0.0775, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0764, 0.0768, 0.0765, 0.0769, 0.0764, 0.0772, 0.0770, 0.0773,
         0.0776, 0.0771, 0.0769, 0.0770],
        [0.0769, 0.0766, 0.0769, 0.0766, 0.0767, 0.0766, 0.0772, 0.0770, 0.0772,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0765, 0.0769, 0.0766, 0.0768, 0.0765, 0.0771, 0.0769, 0.0772,
         0.0775, 0.0771, 0.0769, 0.0770],
        [0.0769, 0.0766, 0.0770, 0.0765, 0.0768, 0.0765, 0.0772, 0.0769, 0.0772,
         0.0774, 0.0772, 0.0769, 0.0769],
        [0.0770, 0.0765, 0.0767, 0.0766, 0.0769, 0.0766, 0.0772, 0.0769, 0.0773,
         0.0775, 0.0771, 0.0768, 0.0771],
        [0.0770, 0.0765, 0.0768, 0.0765, 0.0769, 0.0764, 0.0772, 0.0771, 0.0772,
         0.0775, 0.0772, 0.0769, 0.0770],
        [0.0769, 0.0765, 0.0769, 0.0766, 0.0768, 0.0765, 0.0772, 0.0769, 0.0772,
         0.0776, 0.0771, 0.0768, 0.0770]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1247, 0.1260, 0.1258, 0.1244, 0.1250, 0.1257, 0.1234, 0.1249],
        [0.1245, 0.1261, 0.1258, 0.1245, 0.1249, 0.1258, 0.1235, 0.1249],
        [0.1247, 0.1258, 0.1258, 0.1244, 0.1251, 0.1257, 0.1236, 0.1249],
        [0.1248, 0.1259, 0.1258, 0.1244, 0.1251, 0.1256, 0.1234, 0.1249],
        [0.1247, 0.1260, 0.1258, 0.1244, 0.1250, 0.1257, 0.1235, 0.1249],
        [0.1246, 0.1260, 0.1259, 0.1245, 0.1249, 0.1257, 0.1236, 0.1249],
        [0.1245, 0.1261, 0.1259, 0.1244, 0.1249, 0.1258, 0.1235, 0.1250],
        [0.1247, 0.1260, 0.1258, 0.1246, 0.1249, 0.1257, 0.1235, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0526, 0.0526, 0.0526, 0.0523,
         0.0525, 0.0525, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0526, 0.0526, 0.0528, 0.0529, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0524, 0.0526, 0.0528, 0.0529, 0.0526, 0.0525, 0.0525, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0525, 0.0527, 0.0531, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0525, 0.0526, 0.0525, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0532,
         0.0525],
        [0.0528, 0.0524, 0.0526, 0.0528, 0.0528, 0.0526, 0.0527, 0.0527, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0528, 0.0525, 0.0526, 0.0526, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0526, 0.0526, 0.0526, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0532,
         0.0525],
        [0.0528, 0.0524, 0.0526, 0.0528, 0.0529, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0523, 0.0532,
         0.0525],
        [0.0528, 0.0524, 0.0526, 0.0527, 0.0529, 0.0527, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0523, 0.0532,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0532,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0528, 0.0526, 0.0526, 0.0526, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0532,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0523, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0532,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0526, 0.0525, 0.0526, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0532,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0526, 0.0526, 0.0526, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0532,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0525, 0.0527, 0.0526, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1670, 0.1663, 0.1669, 0.1667, 0.1666, 0.1663],
        [0.1670, 0.1664, 0.1671, 0.1667, 0.1666, 0.1662],
        [0.1672, 0.1663, 0.1670, 0.1668, 0.1666, 0.1661],
        [0.1670, 0.1664, 0.1670, 0.1668, 0.1667, 0.1662],
        [0.1670, 0.1664, 0.1672, 0.1667, 0.1665, 0.1662],
        [0.1671, 0.1663, 0.1671, 0.1667, 0.1667, 0.1661]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0505, 0.0494, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0502, 0.0493],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0503, 0.0504,
         0.0501, 0.0495],
        [0.0501, 0.0506, 0.0494, 0.0499, 0.0499, 0.0498, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501, 0.0504, 0.0503,
         0.0503, 0.0490],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0493],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0503, 0.0495],
        [0.0501, 0.0505, 0.0494, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0499, 0.0498, 0.0501, 0.0501, 0.0504, 0.0502,
         0.0503, 0.0492],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0497],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0497, 0.0499,
         0.0499, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0503, 0.0504,
         0.0501, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0505, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0502,
         0.0502, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0505, 0.0493, 0.0498, 0.0501, 0.0499, 0.0500, 0.0498, 0.0499,
         0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0504, 0.0504,
         0.0502, 0.0496],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0494],
        [0.0501, 0.0505, 0.0493, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0499,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0502, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0504,
         0.0501, 0.0493],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0500, 0.0499, 0.0500, 0.0497, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0494],
        [0.0500, 0.0506, 0.0491, 0.0499, 0.0501, 0.0498, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500, 0.0507, 0.0503,
         0.0507, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.32191038131713867s
iter time cost:11.372279167175293s
-------------Round number: 127-------------
Evaluate global model
Averaged Train Loss: 0.2737
Averaged Test Accurancy: 0.8191
Std Test Accurancy: 0.0770
evaluate time cost:4.631270408630371s
clients training time cost:5.529653549194336s
[running kmeans]: 5it [00:00, 277.54it/s, center_shift=0.000000, iteration=5, tol=0.000100]
attn_optimize time cost:0.7142059803009033s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0502, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0499, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0498, 0.0500, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0497],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0501, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0502],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0500, 0.0500],
        [0.0503, 0.0498, 0.0500, 0.0502, 0.0502, 0.0498, 0.0500, 0.0498, 0.0497,
         0.0498, 0.0498, 0.0503, 0.0498, 0.0501, 0.0506, 0.0501, 0.0499, 0.0505,
         0.0499, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1425, 0.1429, 0.1426, 0.1424, 0.1435, 0.1432],
        [0.1428, 0.1425, 0.1428, 0.1426, 0.1425, 0.1434, 0.1434],
        [0.1429, 0.1426, 0.1428, 0.1425, 0.1422, 0.1437, 0.1433],
        [0.1428, 0.1425, 0.1427, 0.1427, 0.1424, 0.1435, 0.1434],
        [0.1429, 0.1428, 0.1427, 0.1425, 0.1422, 0.1436, 0.1434],
        [0.1429, 0.1426, 0.1429, 0.1426, 0.1421, 0.1437, 0.1433],
        [0.1428, 0.1426, 0.1429, 0.1426, 0.1424, 0.1434, 0.1433]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0503, 0.0500, 0.0503, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0501,
         0.0498, 0.0494],
        [0.0503, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0499, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0503, 0.0501, 0.0503, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0503,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0500, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497, 0.0499, 0.0503,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0500, 0.0500, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0503, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498, 0.0500, 0.0503,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0503,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0503, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0503,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0499, 0.0499, 0.0504, 0.0499, 0.0501,
         0.0499, 0.0494],
        [0.0503, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0493],
        [0.0503, 0.0500, 0.0502, 0.0499, 0.0502, 0.0500, 0.0497, 0.0499, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0501, 0.0502,
         0.0497, 0.0494],
        [0.0503, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0497, 0.0494],
        [0.0503, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0503,
         0.0501, 0.0497, 0.0498, 0.0502, 0.0499, 0.0500, 0.0504, 0.0500, 0.0502,
         0.0498, 0.0494],
        [0.0502, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0503, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0503,
         0.0501, 0.0497, 0.0498, 0.0501, 0.0500, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0503, 0.0500, 0.0503, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0503,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0499, 0.0499, 0.0504, 0.0499, 0.0501,
         0.0498, 0.0493],
        [0.0503, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497, 0.0500, 0.0503,
         0.0501, 0.0497, 0.0499, 0.0502, 0.0499, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0503, 0.0500, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497, 0.0499, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0503, 0.0499, 0.0501, 0.0499, 0.0497, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0500, 0.0500, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0503, 0.0500, 0.0504, 0.0498, 0.0502, 0.0499, 0.0496, 0.0499, 0.0502,
         0.0501, 0.0496, 0.0497, 0.0503, 0.0500, 0.0503, 0.0502, 0.0502, 0.0502,
         0.0496, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0506, 0.0503, 0.0507, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0501, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0502, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0494, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0497, 0.0492],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0504, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0505, 0.0502, 0.0501, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0502, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0499, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0501, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0505, 0.0502, 0.0502, 0.0496, 0.0497,
         0.0503, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0497, 0.0491],
        [0.0498, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0502, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0485],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0500, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0500, 0.0506, 0.0502, 0.0506, 0.0506, 0.0503, 0.0504, 0.0492, 0.0499,
         0.0502, 0.0495, 0.0499, 0.0506, 0.0502, 0.0500, 0.0491, 0.0499, 0.0501,
         0.0497, 0.0488]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0501, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0499, 0.0503, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0501, 0.0501, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0510],
        [0.0499, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0502, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0496, 0.0501, 0.0495, 0.0501, 0.0499, 0.0495, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0501, 0.0499, 0.0494, 0.0500,
         0.0498, 0.0501, 0.0501, 0.0501, 0.0502, 0.0505, 0.0496, 0.0500, 0.0499,
         0.0500, 0.0509],
        [0.0499, 0.0504, 0.0497, 0.0499, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0502, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0502, 0.0501, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0499, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0495, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0501, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0500, 0.0502, 0.0504, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0501, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0504, 0.0496, 0.0500, 0.0496, 0.0499, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0502, 0.0501, 0.0500, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0499, 0.0503, 0.0498, 0.0500, 0.0495, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0508],
        [0.0499, 0.0504, 0.0497, 0.0500, 0.0495, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0498, 0.0502, 0.0501, 0.0501, 0.0502, 0.0504, 0.0496, 0.0500, 0.0499,
         0.0499, 0.0510],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0500,
         0.0498, 0.0501, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0498, 0.0500, 0.0495, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0507],
        [0.0499, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0501, 0.0501, 0.0501, 0.0502, 0.0504, 0.0497, 0.0499, 0.0499,
         0.0499, 0.0511],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0499, 0.0499, 0.0494, 0.0500,
         0.0499, 0.0503, 0.0500, 0.0500, 0.0502, 0.0504, 0.0496, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0496, 0.0500,
         0.0497, 0.0502, 0.0501, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0499, 0.0504, 0.0497, 0.0499, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0498, 0.0506, 0.0496, 0.0502, 0.0495, 0.0499, 0.0499, 0.0494, 0.0496,
         0.0498, 0.0500, 0.0500, 0.0503, 0.0502, 0.0505, 0.0496, 0.0499, 0.0497,
         0.0500, 0.0515]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.5005, 0.4995],
        [0.5003, 0.4997]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4976, 0.5024],
        [0.4977, 0.5023]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1441, 0.1424, 0.1423, 0.1427, 0.1430, 0.1427, 0.1429],
        [0.1440, 0.1424, 0.1422, 0.1428, 0.1429, 0.1427, 0.1429],
        [0.1440, 0.1423, 0.1423, 0.1428, 0.1429, 0.1427, 0.1430],
        [0.1441, 0.1424, 0.1422, 0.1427, 0.1429, 0.1426, 0.1430],
        [0.1439, 0.1425, 0.1423, 0.1428, 0.1430, 0.1427, 0.1429],
        [0.1439, 0.1425, 0.1423, 0.1427, 0.1431, 0.1427, 0.1428],
        [0.1442, 0.1424, 0.1422, 0.1428, 0.1428, 0.1426, 0.1429]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.36067843437194824s
iter time cost:11.329894304275513s
-------------Round number: 128-------------
Evaluate global model
Averaged Train Loss: 0.3082
Averaged Test Accurancy: 0.8141
Std Test Accurancy: 0.0854
evaluate time cost:4.759935140609741s
[running kmeans]: 5it [00:00, 454.14it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:5.385118246078491s
attn_optimize time cost:0.5321371555328369s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2515, 0.2509, 0.2519, 0.2456],
        [0.2511, 0.2505, 0.2515, 0.2469],
        [0.2509, 0.2504, 0.2515, 0.2471],
        [0.2516, 0.2515, 0.2510, 0.2459]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2506, 0.2496, 0.2496, 0.2502],
        [0.2507, 0.2495, 0.2497, 0.2502],
        [0.2506, 0.2494, 0.2499, 0.2502],
        [0.2507, 0.2494, 0.2499, 0.2500]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0503, 0.0500, 0.0501, 0.0501, 0.0505, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0508],
        [0.0501, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0499, 0.0498,
         0.0500, 0.0510],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0504, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0498,
         0.0500, 0.0508],
        [0.0501, 0.0504, 0.0496, 0.0502, 0.0495, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0500, 0.0508],
        [0.0501, 0.0503, 0.0496, 0.0500, 0.0496, 0.0500, 0.0498, 0.0494, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0496, 0.0500, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0498, 0.0501, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0502, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0499, 0.0508],
        [0.0501, 0.0503, 0.0496, 0.0501, 0.0495, 0.0499, 0.0499, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0501, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0501, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0504, 0.0500, 0.0500, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0505],
        [0.0501, 0.0504, 0.0496, 0.0501, 0.0496, 0.0498, 0.0497, 0.0495, 0.0500,
         0.0496, 0.0504, 0.0500, 0.0501, 0.0502, 0.0505, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0495, 0.0499, 0.0499, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0495, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0499, 0.0510],
        [0.0501, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0503, 0.0500, 0.0501, 0.0501, 0.0505, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0501, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0504, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0498,
         0.0496, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0499, 0.0499,
         0.0500, 0.0511],
        [0.0501, 0.0503, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0495, 0.0500,
         0.0498, 0.0504, 0.0500, 0.0500, 0.0502, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0501, 0.0504, 0.0497, 0.0500, 0.0496, 0.0498, 0.0498, 0.0496, 0.0500,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0501, 0.0505, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0504, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0505],
        [0.0499, 0.0506, 0.0496, 0.0502, 0.0495, 0.0499, 0.0499, 0.0495, 0.0496,
         0.0497, 0.0502, 0.0499, 0.0503, 0.0502, 0.0506, 0.0497, 0.0499, 0.0497,
         0.0500, 0.0514]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0911, 0.0908, 0.0908, 0.0911, 0.0907, 0.0911, 0.0908, 0.0909, 0.0915,
         0.0905, 0.0908],
        [0.0911, 0.0907, 0.0908, 0.0910, 0.0906, 0.0911, 0.0909, 0.0909, 0.0914,
         0.0905, 0.0909],
        [0.0911, 0.0908, 0.0908, 0.0911, 0.0906, 0.0911, 0.0908, 0.0909, 0.0915,
         0.0905, 0.0908],
        [0.0911, 0.0908, 0.0908, 0.0911, 0.0907, 0.0910, 0.0909, 0.0909, 0.0914,
         0.0905, 0.0909],
        [0.0912, 0.0907, 0.0908, 0.0910, 0.0906, 0.0911, 0.0909, 0.0909, 0.0915,
         0.0904, 0.0908],
        [0.0911, 0.0907, 0.0908, 0.0911, 0.0906, 0.0911, 0.0908, 0.0909, 0.0915,
         0.0905, 0.0908],
        [0.0912, 0.0908, 0.0908, 0.0911, 0.0906, 0.0911, 0.0908, 0.0909, 0.0915,
         0.0905, 0.0908],
        [0.0911, 0.0908, 0.0908, 0.0910, 0.0906, 0.0911, 0.0909, 0.0909, 0.0915,
         0.0905, 0.0909],
        [0.0911, 0.0907, 0.0908, 0.0911, 0.0906, 0.0911, 0.0908, 0.0909, 0.0915,
         0.0905, 0.0908],
        [0.0912, 0.0907, 0.0908, 0.0911, 0.0906, 0.0911, 0.0908, 0.0909, 0.0915,
         0.0905, 0.0909],
        [0.0912, 0.0908, 0.0908, 0.0910, 0.0906, 0.0910, 0.0909, 0.0909, 0.0914,
         0.0906, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0910, 0.0909, 0.0911, 0.0906, 0.0911, 0.0906, 0.0908, 0.0911, 0.0906,
         0.0913, 0.0909],
        [0.0910, 0.0909, 0.0910, 0.0907, 0.0912, 0.0904, 0.0908, 0.0912, 0.0905,
         0.0914, 0.0908],
        [0.0910, 0.0909, 0.0911, 0.0906, 0.0912, 0.0905, 0.0908, 0.0912, 0.0906,
         0.0914, 0.0909],
        [0.0909, 0.0908, 0.0910, 0.0906, 0.0912, 0.0905, 0.0908, 0.0913, 0.0905,
         0.0914, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0906, 0.0911, 0.0905, 0.0908, 0.0912, 0.0906,
         0.0915, 0.0908],
        [0.0909, 0.0910, 0.0910, 0.0906, 0.0911, 0.0905, 0.0908, 0.0913, 0.0905,
         0.0914, 0.0909],
        [0.0910, 0.0908, 0.0910, 0.0907, 0.0912, 0.0904, 0.0908, 0.0912, 0.0905,
         0.0914, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0906, 0.0911, 0.0905, 0.0909, 0.0913, 0.0905,
         0.0914, 0.0908],
        [0.0910, 0.0909, 0.0910, 0.0906, 0.0912, 0.0904, 0.0909, 0.0912, 0.0907,
         0.0913, 0.0909],
        [0.0910, 0.0909, 0.0910, 0.0906, 0.0911, 0.0905, 0.0908, 0.0912, 0.0905,
         0.0914, 0.0909],
        [0.0911, 0.0909, 0.0910, 0.0907, 0.0911, 0.0904, 0.0908, 0.0912, 0.0905,
         0.0914, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2503, 0.2486, 0.2489, 0.2522],
        [0.2497, 0.2484, 0.2492, 0.2527],
        [0.2502, 0.2484, 0.2490, 0.2524],
        [0.2501, 0.2486, 0.2490, 0.2523]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0505, 0.0494, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0492],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0495],
        [0.0502, 0.0506, 0.0493, 0.0499, 0.0499, 0.0498, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0498, 0.0501, 0.0501, 0.0504, 0.0503,
         0.0503, 0.0489],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0493],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0503, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501, 0.0504, 0.0502,
         0.0503, 0.0491],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0500, 0.0498, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0497],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0497, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0505, 0.0495, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0502,
         0.0502, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0505, 0.0493, 0.0498, 0.0501, 0.0499, 0.0500, 0.0497, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0504, 0.0504,
         0.0502, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0501, 0.0499, 0.0500,
         0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0502, 0.0505, 0.0494, 0.0499, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0493],
        [0.0501, 0.0505, 0.0493, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0502, 0.0493],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0493],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0500, 0.0498, 0.0500, 0.0497, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0494],
        [0.0500, 0.0506, 0.0491, 0.0499, 0.0501, 0.0498, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500, 0.0507, 0.0503,
         0.0507, 0.0492]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0628, 0.0626, 0.0627, 0.0616, 0.0623, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0627, 0.0617, 0.0625, 0.0620,
         0.0628, 0.0625, 0.0627, 0.0616, 0.0623, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0627, 0.0617, 0.0625, 0.0620,
         0.0628, 0.0625, 0.0627, 0.0617, 0.0623, 0.0627, 0.0620],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0626, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0628, 0.0631, 0.0630, 0.0628, 0.0627, 0.0616, 0.0625, 0.0619,
         0.0630, 0.0626, 0.0626, 0.0615, 0.0622, 0.0626, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0630, 0.0626, 0.0626, 0.0615, 0.0623, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0626, 0.0618, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0623, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0626, 0.0618, 0.0626, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0630, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0630, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0631, 0.0629, 0.0627, 0.0626, 0.0617, 0.0625, 0.0620,
         0.0628, 0.0625, 0.0627, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0630, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0620],
        [0.0630, 0.0627, 0.0631, 0.0629, 0.0627, 0.0627, 0.0617, 0.0625, 0.0619,
         0.0630, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0627, 0.0631, 0.0629, 0.0628, 0.0627, 0.0617, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0615, 0.0623, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0625, 0.0626, 0.0616, 0.0623, 0.0627, 0.0620],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0626, 0.0617, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0627, 0.0616, 0.0623, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0625, 0.0621,
         0.0629, 0.0625, 0.0626, 0.0616, 0.0622, 0.0628, 0.0621]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1112, 0.1112, 0.1110, 0.1112, 0.1116, 0.1112, 0.1117, 0.1107, 0.1101],
        [0.1112, 0.1113, 0.1109, 0.1112, 0.1117, 0.1112, 0.1117, 0.1107, 0.1100],
        [0.1112, 0.1112, 0.1107, 0.1113, 0.1119, 0.1113, 0.1117, 0.1106, 0.1100],
        [0.1112, 0.1112, 0.1110, 0.1112, 0.1118, 0.1110, 0.1116, 0.1108, 0.1102],
        [0.1115, 0.1113, 0.1108, 0.1111, 0.1117, 0.1111, 0.1115, 0.1109, 0.1101],
        [0.1113, 0.1113, 0.1108, 0.1112, 0.1116, 0.1110, 0.1117, 0.1109, 0.1101],
        [0.1112, 0.1113, 0.1107, 0.1113, 0.1119, 0.1110, 0.1117, 0.1109, 0.1101],
        [0.1112, 0.1113, 0.1109, 0.1111, 0.1116, 0.1112, 0.1115, 0.1108, 0.1104],
        [0.1110, 0.1113, 0.1105, 0.1110, 0.1119, 0.1116, 0.1120, 0.1104, 0.1102]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.26624178886413574s
iter time cost:11.021205186843872s
-------------Round number: 129-------------
Evaluate global model
Averaged Train Loss: 0.2962
Averaged Test Accurancy: 0.8140
Std Test Accurancy: 0.0871
evaluate time cost:4.832799673080444s
clients training time cost:5.2860870361328125s
attn_optimize time cost:0.5072553157806396s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1250, 0.1251, 0.1249, 0.1248, 0.1255, 0.1252, 0.1257, 0.1238],
        [0.1249, 0.1253, 0.1248, 0.1249, 0.1256, 0.1251, 0.1256, 0.1237],
        [0.1250, 0.1251, 0.1246, 0.1249, 0.1258, 0.1252, 0.1257, 0.1237],
        [0.1249, 0.1251, 0.1250, 0.1249, 0.1258, 0.1250, 0.1255, 0.1239],
        [0.1252, 0.1253, 0.1248, 0.1248, 0.1257, 0.1251, 0.1254, 0.1238],
        [0.1250, 0.1253, 0.1247, 0.1249, 0.1255, 0.1250, 0.1257, 0.1238],
        [0.1249, 0.1252, 0.1246, 0.1249, 0.1258, 0.1250, 0.1257, 0.1238],
        [0.1246, 0.1252, 0.1244, 0.1244, 0.1258, 0.1257, 0.1260, 0.1239]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0506, 0.0503, 0.0506, 0.0506, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0503, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0486],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0503, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0502, 0.0503, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0494, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0497, 0.0491],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0503, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0506, 0.0502, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0503, 0.0498, 0.0499, 0.0504, 0.0503, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0506, 0.0502, 0.0506, 0.0504, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0497, 0.0490],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0503, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0505, 0.0502, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0503, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0486],
        [0.0497, 0.0506, 0.0502, 0.0506, 0.0505, 0.0504, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0498, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0494, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0503, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0500, 0.0507, 0.0501, 0.0505, 0.0506, 0.0503, 0.0504, 0.0492, 0.0499,
         0.0502, 0.0494, 0.0499, 0.0506, 0.0503, 0.0502, 0.0491, 0.0499, 0.0501,
         0.0496, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1001, 0.1008, 0.0997, 0.0999, 0.0995, 0.0998, 0.0999, 0.0999, 0.0999,
         0.1004],
        [0.1001, 0.1008, 0.0996, 0.0999, 0.0995, 0.0998, 0.0999, 0.0998, 0.0999,
         0.1006],
        [0.1001, 0.1008, 0.0996, 0.1000, 0.0995, 0.0999, 0.0999, 0.0999, 0.1000,
         0.1005],
        [0.1001, 0.1008, 0.0996, 0.0999, 0.0994, 0.0999, 0.0999, 0.0998, 0.1000,
         0.1006],
        [0.1000, 0.1008, 0.0995, 0.1000, 0.0995, 0.0999, 0.0999, 0.0999, 0.1000,
         0.1005],
        [0.1001, 0.1008, 0.0996, 0.1001, 0.0994, 0.0998, 0.0998, 0.0998, 0.1000,
         0.1006],
        [0.1001, 0.1007, 0.0997, 0.1000, 0.0995, 0.0999, 0.1000, 0.0999, 0.1000,
         0.1004],
        [0.1001, 0.1007, 0.0996, 0.1000, 0.0995, 0.0998, 0.1000, 0.0999, 0.0999,
         0.1005],
        [0.1001, 0.1009, 0.0996, 0.1000, 0.0994, 0.0999, 0.0998, 0.0998, 0.1000,
         0.1005],
        [0.1001, 0.1008, 0.0997, 0.0999, 0.0995, 0.0998, 0.0999, 0.0998, 0.0999,
         0.1005]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0909, 0.0912, 0.0908, 0.0910, 0.0906, 0.0908, 0.0913, 0.0906, 0.0915,
         0.0909, 0.0904],
        [0.0909, 0.0912, 0.0907, 0.0911, 0.0906, 0.0908, 0.0912, 0.0907, 0.0914,
         0.0910, 0.0903],
        [0.0909, 0.0912, 0.0908, 0.0911, 0.0906, 0.0908, 0.0913, 0.0906, 0.0915,
         0.0910, 0.0903],
        [0.0909, 0.0912, 0.0908, 0.0910, 0.0906, 0.0909, 0.0913, 0.0907, 0.0915,
         0.0909, 0.0903],
        [0.0910, 0.0911, 0.0907, 0.0910, 0.0906, 0.0908, 0.0913, 0.0906, 0.0915,
         0.0910, 0.0904],
        [0.0909, 0.0912, 0.0908, 0.0911, 0.0905, 0.0908, 0.0912, 0.0906, 0.0914,
         0.0910, 0.0904],
        [0.0909, 0.0911, 0.0908, 0.0910, 0.0906, 0.0909, 0.0913, 0.0906, 0.0915,
         0.0909, 0.0905],
        [0.0909, 0.0911, 0.0907, 0.0911, 0.0905, 0.0909, 0.0913, 0.0907, 0.0913,
         0.0910, 0.0904],
        [0.0909, 0.0912, 0.0907, 0.0910, 0.0906, 0.0909, 0.0913, 0.0906, 0.0914,
         0.0910, 0.0904],
        [0.0909, 0.0912, 0.0908, 0.0910, 0.0906, 0.0908, 0.0912, 0.0906, 0.0914,
         0.0910, 0.0904],
        [0.0908, 0.0912, 0.0907, 0.0910, 0.0906, 0.0908, 0.0913, 0.0908, 0.0915,
         0.0910, 0.0903]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0500, 0.0500, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0500, 0.0500, 0.0502, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0497],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0502],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0502],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0500, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0501, 0.0502, 0.0503, 0.0498, 0.0500, 0.0498, 0.0497,
         0.0498, 0.0498, 0.0502, 0.0498, 0.0501, 0.0506, 0.0501, 0.0499, 0.0504,
         0.0498, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 6it [00:00, 299.74it/s, center_shift=0.000000, iteration=6, tol=0.000100]
weights:tensor([[0.0526, 0.0530, 0.0523, 0.0528, 0.0522, 0.0526, 0.0524, 0.0522, 0.0526,
         0.0522, 0.0529, 0.0527, 0.0527, 0.0527, 0.0524, 0.0528, 0.0527, 0.0526,
         0.0535],
        [0.0526, 0.0530, 0.0523, 0.0528, 0.0522, 0.0526, 0.0524, 0.0521, 0.0526,
         0.0523, 0.0528, 0.0527, 0.0528, 0.0528, 0.0524, 0.0527, 0.0527, 0.0526,
         0.0537],
        [0.0526, 0.0530, 0.0524, 0.0527, 0.0522, 0.0526, 0.0524, 0.0522, 0.0526,
         0.0523, 0.0529, 0.0527, 0.0526, 0.0528, 0.0523, 0.0528, 0.0526, 0.0527,
         0.0535],
        [0.0526, 0.0530, 0.0522, 0.0528, 0.0521, 0.0527, 0.0525, 0.0521, 0.0526,
         0.0524, 0.0529, 0.0526, 0.0527, 0.0528, 0.0523, 0.0527, 0.0526, 0.0527,
         0.0535],
        [0.0526, 0.0530, 0.0523, 0.0527, 0.0522, 0.0527, 0.0525, 0.0520, 0.0526,
         0.0524, 0.0529, 0.0527, 0.0527, 0.0529, 0.0523, 0.0527, 0.0527, 0.0527,
         0.0535],
        [0.0526, 0.0530, 0.0524, 0.0526, 0.0522, 0.0527, 0.0524, 0.0521, 0.0527,
         0.0523, 0.0529, 0.0527, 0.0526, 0.0527, 0.0524, 0.0528, 0.0526, 0.0526,
         0.0536],
        [0.0526, 0.0531, 0.0524, 0.0527, 0.0522, 0.0527, 0.0524, 0.0522, 0.0526,
         0.0523, 0.0529, 0.0527, 0.0527, 0.0528, 0.0524, 0.0528, 0.0527, 0.0526,
         0.0535],
        [0.0526, 0.0529, 0.0523, 0.0528, 0.0521, 0.0526, 0.0525, 0.0521, 0.0526,
         0.0523, 0.0529, 0.0527, 0.0527, 0.0529, 0.0523, 0.0527, 0.0526, 0.0528,
         0.0536],
        [0.0526, 0.0530, 0.0524, 0.0528, 0.0523, 0.0526, 0.0525, 0.0521, 0.0525,
         0.0523, 0.0529, 0.0526, 0.0527, 0.0528, 0.0524, 0.0527, 0.0527, 0.0526,
         0.0535],
        [0.0527, 0.0530, 0.0524, 0.0527, 0.0522, 0.0527, 0.0525, 0.0522, 0.0526,
         0.0524, 0.0530, 0.0527, 0.0526, 0.0528, 0.0524, 0.0527, 0.0527, 0.0526,
         0.0532],
        [0.0526, 0.0530, 0.0523, 0.0527, 0.0522, 0.0525, 0.0524, 0.0522, 0.0526,
         0.0522, 0.0529, 0.0527, 0.0527, 0.0528, 0.0524, 0.0527, 0.0527, 0.0527,
         0.0535],
        [0.0526, 0.0529, 0.0524, 0.0527, 0.0521, 0.0526, 0.0525, 0.0522, 0.0526,
         0.0523, 0.0529, 0.0527, 0.0527, 0.0528, 0.0524, 0.0528, 0.0527, 0.0527,
         0.0535],
        [0.0526, 0.0530, 0.0524, 0.0527, 0.0521, 0.0527, 0.0525, 0.0521, 0.0526,
         0.0524, 0.0529, 0.0527, 0.0527, 0.0529, 0.0523, 0.0527, 0.0527, 0.0526,
         0.0537],
        [0.0526, 0.0530, 0.0523, 0.0527, 0.0522, 0.0526, 0.0524, 0.0522, 0.0526,
         0.0523, 0.0529, 0.0526, 0.0528, 0.0528, 0.0524, 0.0527, 0.0527, 0.0527,
         0.0535],
        [0.0526, 0.0530, 0.0523, 0.0527, 0.0522, 0.0526, 0.0525, 0.0522, 0.0525,
         0.0522, 0.0528, 0.0527, 0.0527, 0.0528, 0.0523, 0.0526, 0.0527, 0.0526,
         0.0538],
        [0.0527, 0.0529, 0.0524, 0.0527, 0.0522, 0.0526, 0.0525, 0.0521, 0.0527,
         0.0524, 0.0530, 0.0526, 0.0526, 0.0529, 0.0523, 0.0528, 0.0527, 0.0528,
         0.0534],
        [0.0526, 0.0530, 0.0524, 0.0527, 0.0522, 0.0525, 0.0524, 0.0522, 0.0526,
         0.0522, 0.0529, 0.0527, 0.0527, 0.0528, 0.0524, 0.0528, 0.0527, 0.0527,
         0.0534],
        [0.0526, 0.0530, 0.0523, 0.0526, 0.0523, 0.0527, 0.0525, 0.0521, 0.0526,
         0.0523, 0.0530, 0.0526, 0.0527, 0.0528, 0.0524, 0.0528, 0.0527, 0.0527,
         0.0531],
        [0.0524, 0.0532, 0.0522, 0.0529, 0.0521, 0.0526, 0.0525, 0.0521, 0.0523,
         0.0523, 0.0527, 0.0526, 0.0529, 0.0529, 0.0523, 0.0526, 0.0525, 0.0526,
         0.0542]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1097, 0.1110, 0.1108, 0.1113, 0.1113, 0.1113, 0.1109, 0.1121, 0.1118],
        [0.1099, 0.1112, 0.1109, 0.1110, 0.1112, 0.1112, 0.1109, 0.1119, 0.1117],
        [0.1099, 0.1111, 0.1108, 0.1111, 0.1113, 0.1111, 0.1109, 0.1119, 0.1118],
        [0.1100, 0.1112, 0.1109, 0.1111, 0.1113, 0.1112, 0.1109, 0.1119, 0.1117],
        [0.1098, 0.1113, 0.1108, 0.1112, 0.1113, 0.1111, 0.1110, 0.1121, 0.1114],
        [0.1096, 0.1113, 0.1109, 0.1112, 0.1112, 0.1113, 0.1111, 0.1119, 0.1115],
        [0.1098, 0.1114, 0.1108, 0.1112, 0.1112, 0.1111, 0.1109, 0.1120, 0.1117],
        [0.1097, 0.1113, 0.1108, 0.1111, 0.1114, 0.1112, 0.1108, 0.1121, 0.1116],
        [0.1097, 0.1111, 0.1108, 0.1113, 0.1113, 0.1111, 0.1108, 0.1121, 0.1117]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.23440194129943848s
iter time cost:10.955628633499146s
-------------Round number: 130-------------
Evaluate global model
Averaged Train Loss: 0.3073
Averaged Test Accurancy: 0.8085
Std Test Accurancy: 0.0898
evaluate time cost:5.141559600830078s
[running kmeans]: 7it [00:00, 340.10it/s, center_shift=0.000000, iteration=7, tol=0.000100]
clients training time cost:5.0681493282318115s
attn_optimize time cost:0.523080587387085s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1670, 0.1667, 0.1673, 0.1661, 0.1660, 0.1669],
        [0.1669, 0.1667, 0.1674, 0.1662, 0.1658, 0.1670],
        [0.1669, 0.1667, 0.1673, 0.1661, 0.1661, 0.1669],
        [0.1671, 0.1666, 0.1672, 0.1662, 0.1660, 0.1669],
        [0.1670, 0.1666, 0.1675, 0.1660, 0.1657, 0.1672],
        [0.1669, 0.1667, 0.1673, 0.1660, 0.1661, 0.1670]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0251, 0.0253, 0.0248,  ..., 0.0252, 0.0249, 0.0242],
        [0.0251, 0.0253, 0.0248,  ..., 0.0251, 0.0249, 0.0241],
        [0.0250, 0.0252, 0.0246,  ..., 0.0253, 0.0250, 0.0247],
        ...,
        [0.0252, 0.0252, 0.0248,  ..., 0.0250, 0.0248, 0.0243],
        [0.0252, 0.0252, 0.0248,  ..., 0.0251, 0.0248, 0.0243],
        [0.0251, 0.0252, 0.0248,  ..., 0.0250, 0.0248, 0.0244]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2505, 0.2501, 0.2500, 0.2494],
        [0.2507, 0.2500, 0.2500, 0.2492],
        [0.2505, 0.2499, 0.2502, 0.2494],
        [0.2508, 0.2499, 0.2499, 0.2494]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0500, 0.0500, 0.0504, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0497],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0498, 0.0500, 0.0502, 0.0501, 0.0499, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0502, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0498, 0.0500],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0500, 0.0500, 0.0503, 0.0499, 0.0499, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0498, 0.0500, 0.0502, 0.0502, 0.0498, 0.0500, 0.0498, 0.0497,
         0.0498, 0.0498, 0.0503, 0.0498, 0.0502, 0.0507, 0.0501, 0.0499, 0.0504,
         0.0498, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.0994, 0.0999, 0.0997, 0.0999, 0.0995, 0.1006, 0.1009, 0.0998,
         0.1001],
        [0.1001, 0.0995, 0.1000, 0.0997, 0.0999, 0.0996, 0.1007, 0.1008, 0.0997,
         0.1000],
        [0.1001, 0.0995, 0.1001, 0.0997, 0.1000, 0.0996, 0.1006, 0.1007, 0.0997,
         0.0999],
        [0.1002, 0.0995, 0.1001, 0.0996, 0.0998, 0.0995, 0.1007, 0.1009, 0.0999,
         0.0999],
        [0.1002, 0.0995, 0.1000, 0.0998, 0.0998, 0.0995, 0.1006, 0.1009, 0.0998,
         0.0999],
        [0.1002, 0.0995, 0.1000, 0.0997, 0.0998, 0.0996, 0.1007, 0.1008, 0.0999,
         0.0999],
        [0.1003, 0.0993, 0.0998, 0.0996, 0.0999, 0.0994, 0.1007, 0.1010, 0.0999,
         0.1001],
        [0.1002, 0.0995, 0.1001, 0.0996, 0.0998, 0.0995, 0.1007, 0.1007, 0.0999,
         0.1000],
        [0.1002, 0.0995, 0.0998, 0.0996, 0.1000, 0.0995, 0.1007, 0.1009, 0.0999,
         0.1000],
        [0.1001, 0.0994, 0.1000, 0.0997, 0.0999, 0.0995, 0.1006, 0.1010, 0.0998,
         0.1000]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1121, 0.1113, 0.1104, 0.1100, 0.1113, 0.1115, 0.1115, 0.1105, 0.1114],
        [0.1122, 0.1115, 0.1102, 0.1101, 0.1112, 0.1114, 0.1116, 0.1105, 0.1114],
        [0.1121, 0.1112, 0.1104, 0.1099, 0.1113, 0.1115, 0.1117, 0.1104, 0.1115],
        [0.1120, 0.1114, 0.1103, 0.1101, 0.1113, 0.1114, 0.1116, 0.1105, 0.1115],
        [0.1120, 0.1113, 0.1103, 0.1102, 0.1113, 0.1112, 0.1115, 0.1105, 0.1116],
        [0.1122, 0.1113, 0.1102, 0.1101, 0.1113, 0.1114, 0.1117, 0.1104, 0.1115],
        [0.1121, 0.1112, 0.1105, 0.1103, 0.1111, 0.1114, 0.1114, 0.1106, 0.1115],
        [0.1122, 0.1113, 0.1104, 0.1102, 0.1113, 0.1114, 0.1116, 0.1105, 0.1113],
        [0.1120, 0.1112, 0.1104, 0.1101, 0.1113, 0.1112, 0.1117, 0.1105, 0.1117]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2516, 0.2501, 0.2506, 0.2476],
        [0.2512, 0.2500, 0.2511, 0.2476],
        [0.2518, 0.2498, 0.2509, 0.2475],
        [0.2513, 0.2506, 0.2509, 0.2471]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.1999, 0.2003, 0.1990, 0.2007],
        [0.2001, 0.1998, 0.2003, 0.1989, 0.2008],
        [0.2000, 0.1998, 0.2005, 0.1987, 0.2009],
        [0.2000, 0.2000, 0.2004, 0.1992, 0.2005],
        [0.2001, 0.1998, 0.2004, 0.1988, 0.2008]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3480343818664551s
iter time cost:11.218512773513794s
-------------Round number: 131-------------
Evaluate global model
Averaged Train Loss: 0.3002
Averaged Test Accurancy: 0.8167
Std Test Accurancy: 0.0809
evaluate time cost:4.81801700592041s
clients training time cost:5.104773759841919s
attn_optimize time cost:0.6688482761383057s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
[running kmeans]: 4it [00:00, 307.43it/s, center_shift=0.000000, iteration=4, tol=0.000100]
weights:tensor([[0.1667, 0.1666, 0.1672, 0.1668, 0.1675, 0.1652],
        [0.1666, 0.1667, 0.1676, 0.1665, 0.1673, 0.1653],
        [0.1671, 0.1665, 0.1674, 0.1666, 0.1671, 0.1652],
        [0.1668, 0.1667, 0.1672, 0.1666, 0.1675, 0.1652],
        [0.1666, 0.1668, 0.1676, 0.1664, 0.1674, 0.1652],
        [0.1662, 0.1661, 0.1674, 0.1673, 0.1678, 0.1653]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.1008, 0.0997, 0.0998, 0.0995, 0.0999, 0.1000, 0.0998, 0.0999,
         0.1004],
        [0.1002, 0.1007, 0.0996, 0.0999, 0.0996, 0.0998, 0.1000, 0.0997, 0.0999,
         0.1005],
        [0.1001, 0.1007, 0.0996, 0.1000, 0.0995, 0.0999, 0.0999, 0.0998, 0.1000,
         0.1005],
        [0.1002, 0.1008, 0.0996, 0.0999, 0.0994, 0.0999, 0.0999, 0.0997, 0.1000,
         0.1006],
        [0.1001, 0.1007, 0.0995, 0.1000, 0.0995, 0.0999, 0.1000, 0.0998, 0.1000,
         0.1005],
        [0.1002, 0.1008, 0.0996, 0.1000, 0.0994, 0.0998, 0.0999, 0.0997, 0.1000,
         0.1006],
        [0.1002, 0.1006, 0.0997, 0.0999, 0.0995, 0.1000, 0.1000, 0.0998, 0.1000,
         0.1004],
        [0.1001, 0.1007, 0.0997, 0.0999, 0.0996, 0.0998, 0.1001, 0.0998, 0.0999,
         0.1004],
        [0.1002, 0.1009, 0.0996, 0.0999, 0.0994, 0.0999, 0.0999, 0.0997, 0.1000,
         0.1005],
        [0.1001, 0.1008, 0.0997, 0.0999, 0.0996, 0.0999, 0.0999, 0.0997, 0.0999,
         0.1005]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0717, 0.0715, 0.0717, 0.0713, 0.0716, 0.0712, 0.0713, 0.0716, 0.0714,
         0.0711, 0.0713, 0.0718, 0.0715, 0.0710],
        [0.0717, 0.0715, 0.0717, 0.0713, 0.0716, 0.0711, 0.0713, 0.0716, 0.0714,
         0.0710, 0.0712, 0.0719, 0.0715, 0.0710],
        [0.0717, 0.0715, 0.0717, 0.0713, 0.0717, 0.0712, 0.0713, 0.0716, 0.0714,
         0.0710, 0.0713, 0.0719, 0.0715, 0.0709],
        [0.0717, 0.0715, 0.0717, 0.0713, 0.0717, 0.0712, 0.0713, 0.0716, 0.0713,
         0.0711, 0.0712, 0.0719, 0.0716, 0.0710],
        [0.0717, 0.0715, 0.0717, 0.0713, 0.0716, 0.0712, 0.0714, 0.0716, 0.0714,
         0.0711, 0.0713, 0.0719, 0.0715, 0.0710],
        [0.0716, 0.0716, 0.0716, 0.0713, 0.0716, 0.0712, 0.0714, 0.0717, 0.0713,
         0.0710, 0.0712, 0.0719, 0.0715, 0.0710],
        [0.0717, 0.0715, 0.0717, 0.0713, 0.0717, 0.0711, 0.0713, 0.0716, 0.0714,
         0.0711, 0.0712, 0.0719, 0.0716, 0.0710],
        [0.0717, 0.0715, 0.0716, 0.0713, 0.0716, 0.0712, 0.0714, 0.0717, 0.0713,
         0.0711, 0.0712, 0.0719, 0.0715, 0.0711],
        [0.0718, 0.0715, 0.0717, 0.0713, 0.0716, 0.0711, 0.0713, 0.0716, 0.0714,
         0.0710, 0.0713, 0.0719, 0.0716, 0.0709],
        [0.0718, 0.0716, 0.0717, 0.0713, 0.0717, 0.0712, 0.0713, 0.0716, 0.0713,
         0.0709, 0.0712, 0.0718, 0.0717, 0.0708],
        [0.0717, 0.0715, 0.0717, 0.0713, 0.0717, 0.0711, 0.0714, 0.0716, 0.0714,
         0.0710, 0.0714, 0.0718, 0.0715, 0.0710],
        [0.0717, 0.0715, 0.0717, 0.0713, 0.0716, 0.0712, 0.0714, 0.0716, 0.0714,
         0.0711, 0.0712, 0.0719, 0.0715, 0.0710],
        [0.0718, 0.0715, 0.0717, 0.0714, 0.0716, 0.0711, 0.0713, 0.0715, 0.0714,
         0.0711, 0.0712, 0.0719, 0.0716, 0.0710],
        [0.0717, 0.0715, 0.0717, 0.0713, 0.0716, 0.0711, 0.0713, 0.0716, 0.0714,
         0.0710, 0.0714, 0.0719, 0.0715, 0.0710]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2005, 0.1996, 0.1991, 0.2019, 0.1988],
        [0.2000, 0.2001, 0.1989, 0.2017, 0.1993],
        [0.2002, 0.1999, 0.1989, 0.2017, 0.1994],
        [0.2003, 0.2000, 0.1989, 0.2017, 0.1991],
        [0.2009, 0.2002, 0.1992, 0.2020, 0.1976]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0495, 0.0502, 0.0501, 0.0501, 0.0501, 0.0505, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0496, 0.0502, 0.0501, 0.0502, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0510],
        [0.0499, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0496, 0.0501, 0.0495, 0.0501, 0.0499, 0.0495, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0495, 0.0501, 0.0499, 0.0494, 0.0499,
         0.0497, 0.0502, 0.0501, 0.0502, 0.0502, 0.0505, 0.0496, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0496, 0.0502, 0.0501, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0502, 0.0501, 0.0501, 0.0502, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0499, 0.0508],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0495, 0.0499, 0.0499, 0.0495, 0.0499,
         0.0496, 0.0502, 0.0501, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0501, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0495, 0.0498,
         0.0496, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0501, 0.0500, 0.0502, 0.0505, 0.0497, 0.0501, 0.0500,
         0.0499, 0.0505],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0495, 0.0503, 0.0501, 0.0501, 0.0502, 0.0505, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0508],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0495, 0.0500, 0.0499, 0.0496, 0.0499,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0495, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0497, 0.0502, 0.0501, 0.0501, 0.0502, 0.0504, 0.0497, 0.0500, 0.0499,
         0.0499, 0.0510],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0502, 0.0500, 0.0502, 0.0501, 0.0504, 0.0498, 0.0500, 0.0500,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0503, 0.0500, 0.0501, 0.0502, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0498,
         0.0495, 0.0502, 0.0501, 0.0501, 0.0502, 0.0505, 0.0497, 0.0499, 0.0499,
         0.0499, 0.0511],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0496, 0.0499, 0.0499, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0501, 0.0505, 0.0498, 0.0501, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0505],
        [0.0498, 0.0505, 0.0495, 0.0502, 0.0495, 0.0499, 0.0499, 0.0495, 0.0495,
         0.0496, 0.0501, 0.0500, 0.0504, 0.0502, 0.0506, 0.0497, 0.0499, 0.0498,
         0.0499, 0.0514]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0775, 0.0771, 0.0774, 0.0773, 0.0771, 0.0759, 0.0770, 0.0763, 0.0772,
         0.0769, 0.0770, 0.0771, 0.0763],
        [0.0775, 0.0771, 0.0775, 0.0773, 0.0771, 0.0759, 0.0768, 0.0763, 0.0772,
         0.0768, 0.0770, 0.0771, 0.0764],
        [0.0776, 0.0771, 0.0774, 0.0773, 0.0771, 0.0758, 0.0769, 0.0763, 0.0773,
         0.0768, 0.0770, 0.0771, 0.0763],
        [0.0775, 0.0771, 0.0774, 0.0773, 0.0770, 0.0759, 0.0769, 0.0763, 0.0773,
         0.0769, 0.0770, 0.0771, 0.0763],
        [0.0775, 0.0770, 0.0774, 0.0774, 0.0771, 0.0758, 0.0769, 0.0762, 0.0774,
         0.0769, 0.0769, 0.0771, 0.0763],
        [0.0775, 0.0770, 0.0774, 0.0773, 0.0770, 0.0759, 0.0769, 0.0763, 0.0773,
         0.0769, 0.0770, 0.0771, 0.0763],
        [0.0774, 0.0770, 0.0774, 0.0773, 0.0770, 0.0760, 0.0770, 0.0763, 0.0772,
         0.0769, 0.0770, 0.0771, 0.0763],
        [0.0775, 0.0771, 0.0774, 0.0774, 0.0770, 0.0759, 0.0769, 0.0762, 0.0774,
         0.0769, 0.0769, 0.0770, 0.0763],
        [0.0775, 0.0771, 0.0775, 0.0773, 0.0770, 0.0759, 0.0769, 0.0763, 0.0772,
         0.0769, 0.0770, 0.0771, 0.0764],
        [0.0775, 0.0771, 0.0774, 0.0774, 0.0771, 0.0759, 0.0770, 0.0762, 0.0773,
         0.0769, 0.0769, 0.0771, 0.0763],
        [0.0775, 0.0771, 0.0775, 0.0774, 0.0771, 0.0759, 0.0769, 0.0761, 0.0774,
         0.0769, 0.0769, 0.0770, 0.0764],
        [0.0775, 0.0771, 0.0775, 0.0773, 0.0770, 0.0759, 0.0769, 0.0762, 0.0773,
         0.0769, 0.0770, 0.0771, 0.0763],
        [0.0775, 0.0771, 0.0774, 0.0773, 0.0771, 0.0759, 0.0769, 0.0763, 0.0773,
         0.0768, 0.0770, 0.0771, 0.0764]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0990, 0.1002, 0.0999, 0.1004, 0.1004, 0.1003, 0.0999, 0.1010, 0.1008,
         0.0982],
        [0.0990, 0.1002, 0.1000, 0.1000, 0.1002, 0.1002, 0.0999, 0.1008, 0.1007,
         0.0990],
        [0.0990, 0.1002, 0.0999, 0.1002, 0.1003, 0.1001, 0.0999, 0.1009, 0.1009,
         0.0986],
        [0.0991, 0.1002, 0.0999, 0.1001, 0.1003, 0.1001, 0.0999, 0.1008, 0.1006,
         0.0989],
        [0.0989, 0.1003, 0.0999, 0.1002, 0.1003, 0.1001, 0.0999, 0.1009, 0.1004,
         0.0991],
        [0.0987, 0.1003, 0.0999, 0.1002, 0.1002, 0.1002, 0.1000, 0.1008, 0.1005,
         0.0992],
        [0.0990, 0.1004, 0.0999, 0.1002, 0.1002, 0.1001, 0.0999, 0.1009, 0.1006,
         0.0989],
        [0.0988, 0.1003, 0.0999, 0.1002, 0.1004, 0.1002, 0.0998, 0.1010, 0.1006,
         0.0988],
        [0.0989, 0.1002, 0.0998, 0.1003, 0.1003, 0.1001, 0.0998, 0.1010, 0.1007,
         0.0990],
        [0.0983, 0.1004, 0.0996, 0.0999, 0.1002, 0.1000, 0.0997, 0.1015, 0.1016,
         0.0987]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1666, 0.1684, 0.1662, 0.1669, 0.1648, 0.1670],
        [0.1663, 0.1685, 0.1664, 0.1668, 0.1650, 0.1670],
        [0.1667, 0.1683, 0.1663, 0.1670, 0.1648, 0.1669],
        [0.1666, 0.1684, 0.1662, 0.1669, 0.1650, 0.1669],
        [0.1663, 0.1686, 0.1663, 0.1668, 0.1650, 0.1672],
        [0.1666, 0.1684, 0.1665, 0.1668, 0.1650, 0.1669]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0669, 0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0663, 0.0665, 0.0668,
         0.0666, 0.0666, 0.0671, 0.0666, 0.0664, 0.0666],
        [0.0669, 0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0664, 0.0664, 0.0668,
         0.0667, 0.0667, 0.0671, 0.0666, 0.0664, 0.0666],
        [0.0669, 0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0663, 0.0665, 0.0668,
         0.0666, 0.0667, 0.0671, 0.0667, 0.0664, 0.0666],
        [0.0669, 0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0664, 0.0665, 0.0667,
         0.0666, 0.0666, 0.0670, 0.0666, 0.0664, 0.0667],
        [0.0670, 0.0666, 0.0667, 0.0669, 0.0666, 0.0666, 0.0663, 0.0664, 0.0668,
         0.0666, 0.0667, 0.0672, 0.0667, 0.0664, 0.0666],
        [0.0669, 0.0666, 0.0667, 0.0669, 0.0666, 0.0666, 0.0664, 0.0665, 0.0668,
         0.0665, 0.0667, 0.0672, 0.0667, 0.0665, 0.0666],
        [0.0669, 0.0666, 0.0667, 0.0669, 0.0667, 0.0666, 0.0663, 0.0665, 0.0668,
         0.0666, 0.0667, 0.0672, 0.0666, 0.0664, 0.0666],
        [0.0669, 0.0665, 0.0666, 0.0668, 0.0668, 0.0666, 0.0665, 0.0664, 0.0668,
         0.0667, 0.0667, 0.0671, 0.0667, 0.0663, 0.0666],
        [0.0669, 0.0665, 0.0667, 0.0669, 0.0667, 0.0667, 0.0664, 0.0664, 0.0668,
         0.0666, 0.0667, 0.0671, 0.0667, 0.0664, 0.0666],
        [0.0669, 0.0666, 0.0667, 0.0669, 0.0667, 0.0667, 0.0663, 0.0664, 0.0668,
         0.0666, 0.0667, 0.0671, 0.0666, 0.0664, 0.0666],
        [0.0669, 0.0666, 0.0666, 0.0668, 0.0667, 0.0666, 0.0664, 0.0664, 0.0668,
         0.0667, 0.0666, 0.0671, 0.0667, 0.0664, 0.0666],
        [0.0669, 0.0666, 0.0667, 0.0669, 0.0667, 0.0666, 0.0664, 0.0664, 0.0668,
         0.0666, 0.0667, 0.0672, 0.0667, 0.0664, 0.0666],
        [0.0669, 0.0665, 0.0666, 0.0669, 0.0666, 0.0667, 0.0664, 0.0665, 0.0668,
         0.0666, 0.0667, 0.0671, 0.0667, 0.0665, 0.0666],
        [0.0669, 0.0666, 0.0666, 0.0669, 0.0667, 0.0667, 0.0663, 0.0664, 0.0668,
         0.0666, 0.0667, 0.0671, 0.0667, 0.0664, 0.0666],
        [0.0669, 0.0666, 0.0666, 0.0668, 0.0667, 0.0667, 0.0664, 0.0664, 0.0668,
         0.0666, 0.0667, 0.0671, 0.0666, 0.0665, 0.0666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.46442198753356934s
iter time cost:11.176170349121094s
-------------Round number: 132-------------
Evaluate global model
Averaged Train Loss: 0.3590
Averaged Test Accurancy: 0.8009
Std Test Accurancy: 0.0932
evaluate time cost:5.0135133266448975s
[running kmeans]: 5it [00:00, 356.85it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:5.091182231903076s
attn_optimize time cost:0.5370471477508545s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1666, 0.1684, 0.1663, 0.1670, 0.1649, 0.1669],
        [0.1663, 0.1684, 0.1665, 0.1669, 0.1650, 0.1669],
        [0.1667, 0.1682, 0.1663, 0.1670, 0.1649, 0.1668],
        [0.1666, 0.1684, 0.1663, 0.1670, 0.1650, 0.1668],
        [0.1663, 0.1685, 0.1663, 0.1668, 0.1650, 0.1671],
        [0.1665, 0.1683, 0.1665, 0.1668, 0.1650, 0.1668]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2517, 0.2475, 0.2514, 0.2493],
        [0.2516, 0.2478, 0.2513, 0.2492],
        [0.2518, 0.2476, 0.2512, 0.2493],
        [0.2516, 0.2478, 0.2513, 0.2493]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0502, 0.0501, 0.0501, 0.0501, 0.0505, 0.0498, 0.0502, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0498, 0.0494, 0.0499,
         0.0497, 0.0502, 0.0501, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0500, 0.0510],
        [0.0499, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0501, 0.0499, 0.0501, 0.0505, 0.0497, 0.0502, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0496, 0.0501, 0.0495, 0.0500, 0.0499, 0.0494, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0501, 0.0498,
         0.0501, 0.0509],
        [0.0500, 0.0504, 0.0496, 0.0500, 0.0495, 0.0501, 0.0499, 0.0494, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0496, 0.0501, 0.0498,
         0.0501, 0.0509],
        [0.0499, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0498,
         0.0500, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0501, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0495, 0.0499, 0.0499, 0.0494, 0.0498,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0501, 0.0498,
         0.0502, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0495, 0.0498,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0502, 0.0505, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0498, 0.0503, 0.0501, 0.0500, 0.0502, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0504, 0.0496, 0.0501, 0.0496, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0500, 0.0500, 0.0502, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0500, 0.0499, 0.0495, 0.0498,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0502, 0.0505, 0.0497, 0.0502, 0.0499,
         0.0501, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0501, 0.0494, 0.0500, 0.0499, 0.0494, 0.0498,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0496, 0.0501, 0.0498,
         0.0500, 0.0510],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0505, 0.0498, 0.0501, 0.0499,
         0.0501, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0495, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0502, 0.0504, 0.0497, 0.0502, 0.0499,
         0.0501, 0.0507],
        [0.0499, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0498,
         0.0496, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0512],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0499, 0.0499, 0.0494, 0.0500,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0502, 0.0505, 0.0496, 0.0501, 0.0499,
         0.0502, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0501, 0.0505, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0499, 0.0496, 0.0500, 0.0499, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0506, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0505],
        [0.0498, 0.0506, 0.0495, 0.0502, 0.0495, 0.0499, 0.0499, 0.0494, 0.0495,
         0.0497, 0.0501, 0.0499, 0.0503, 0.0503, 0.0506, 0.0497, 0.0500, 0.0497,
         0.0500, 0.0515]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0503, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0503, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0501, 0.0504, 0.0501, 0.0499, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0503, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0498, 0.0499, 0.0502, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0502, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0501, 0.0503, 0.0501, 0.0499, 0.0505,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0503, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0498, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0503, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0503, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0503, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0502],
        [0.0501, 0.0498, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0499, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0497, 0.0500, 0.0502, 0.0503, 0.0499, 0.0500, 0.0498, 0.0497,
         0.0498, 0.0498, 0.0503, 0.0498, 0.0502, 0.0506, 0.0502, 0.0499, 0.0504,
         0.0498, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1116, 0.1116, 0.1114, 0.1111, 0.1110, 0.1099, 0.1113, 0.1110, 0.1111],
        [0.1118, 0.1117, 0.1115, 0.1111, 0.1109, 0.1099, 0.1113, 0.1108, 0.1110],
        [0.1117, 0.1117, 0.1115, 0.1110, 0.1109, 0.1099, 0.1113, 0.1109, 0.1110],
        [0.1117, 0.1117, 0.1116, 0.1110, 0.1109, 0.1098, 0.1114, 0.1110, 0.1110],
        [0.1116, 0.1116, 0.1115, 0.1110, 0.1111, 0.1100, 0.1113, 0.1110, 0.1110],
        [0.1116, 0.1117, 0.1116, 0.1110, 0.1109, 0.1098, 0.1115, 0.1109, 0.1110],
        [0.1117, 0.1118, 0.1115, 0.1110, 0.1108, 0.1099, 0.1113, 0.1109, 0.1111],
        [0.1116, 0.1116, 0.1116, 0.1111, 0.1110, 0.1099, 0.1113, 0.1109, 0.1111],
        [0.1118, 0.1117, 0.1115, 0.1110, 0.1108, 0.1099, 0.1114, 0.1109, 0.1110]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1111, 0.1114, 0.1110, 0.1110, 0.1115, 0.1115, 0.1118, 0.1107, 0.1100],
        [0.1111, 0.1115, 0.1109, 0.1111, 0.1116, 0.1115, 0.1117, 0.1108, 0.1099],
        [0.1112, 0.1114, 0.1108, 0.1111, 0.1117, 0.1115, 0.1118, 0.1106, 0.1100],
        [0.1111, 0.1113, 0.1111, 0.1110, 0.1117, 0.1113, 0.1116, 0.1108, 0.1101],
        [0.1114, 0.1114, 0.1109, 0.1109, 0.1116, 0.1114, 0.1115, 0.1109, 0.1101],
        [0.1112, 0.1115, 0.1108, 0.1110, 0.1114, 0.1113, 0.1117, 0.1110, 0.1100],
        [0.1111, 0.1114, 0.1107, 0.1111, 0.1117, 0.1113, 0.1117, 0.1109, 0.1100],
        [0.1111, 0.1114, 0.1109, 0.1110, 0.1114, 0.1115, 0.1115, 0.1108, 0.1103],
        [0.1109, 0.1115, 0.1106, 0.1107, 0.1117, 0.1120, 0.1121, 0.1104, 0.1102]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0530, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0529, 0.0528,
         0.0528],
        [0.0528, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0529, 0.0529,
         0.0527],
        [0.0528, 0.0532, 0.0519, 0.0525, 0.0525, 0.0524, 0.0526, 0.0524, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0524, 0.0527, 0.0527, 0.0530, 0.0528,
         0.0529],
        [0.0527, 0.0530, 0.0519, 0.0524, 0.0526, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0523, 0.0526,
         0.0525, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0529],
        [0.0527, 0.0531, 0.0520, 0.0526, 0.0526, 0.0524, 0.0526, 0.0525, 0.0527,
         0.0527, 0.0526, 0.0527, 0.0525, 0.0525, 0.0527, 0.0526, 0.0529, 0.0527,
         0.0529],
        [0.0527, 0.0530, 0.0519, 0.0524, 0.0527, 0.0525, 0.0526, 0.0523, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0527, 0.0524, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0527, 0.0529, 0.0529,
         0.0528],
        [0.0528, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0523, 0.0525,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0529, 0.0530,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0525, 0.0525, 0.0526, 0.0527, 0.0529, 0.0528,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0528,
         0.0529],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0519, 0.0524, 0.0527, 0.0525, 0.0526, 0.0523, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0528],
        [0.0528, 0.0530, 0.0520, 0.0524, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0527, 0.0530, 0.0529,
         0.0529],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0527, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0529, 0.0529,
         0.0527],
        [0.0528, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0527, 0.0523, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0524, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0529],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0529, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0526, 0.0524, 0.0526, 0.0523, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0524, 0.0527, 0.0527, 0.0530, 0.0529,
         0.0529]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0910, 0.0909, 0.0909, 0.0907, 0.0910, 0.0906, 0.0907, 0.0910, 0.0908,
         0.0914, 0.0909],
        [0.0910, 0.0910, 0.0909, 0.0908, 0.0911, 0.0904, 0.0906, 0.0911, 0.0907,
         0.0915, 0.0908],
        [0.0909, 0.0910, 0.0909, 0.0907, 0.0912, 0.0905, 0.0906, 0.0910, 0.0908,
         0.0915, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0907, 0.0912, 0.0905, 0.0906, 0.0911, 0.0908,
         0.0915, 0.0909],
        [0.0909, 0.0909, 0.0909, 0.0907, 0.0911, 0.0905, 0.0907, 0.0911, 0.0909,
         0.0916, 0.0908],
        [0.0909, 0.0910, 0.0908, 0.0907, 0.0911, 0.0905, 0.0907, 0.0912, 0.0907,
         0.0915, 0.0909],
        [0.0910, 0.0909, 0.0909, 0.0908, 0.0912, 0.0904, 0.0907, 0.0911, 0.0908,
         0.0915, 0.0909],
        [0.0910, 0.0909, 0.0908, 0.0907, 0.0911, 0.0905, 0.0907, 0.0912, 0.0907,
         0.0916, 0.0908],
        [0.0910, 0.0910, 0.0908, 0.0907, 0.0912, 0.0904, 0.0907, 0.0911, 0.0909,
         0.0914, 0.0908],
        [0.0910, 0.0909, 0.0909, 0.0907, 0.0911, 0.0905, 0.0907, 0.0911, 0.0907,
         0.0915, 0.0908],
        [0.0910, 0.0909, 0.0909, 0.0908, 0.0911, 0.0905, 0.0906, 0.0910, 0.0907,
         0.0915, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.38097476959228516s
iter time cost:11.12180781364441s
-------------Round number: 133-------------
Evaluate global model
Averaged Train Loss: 0.3067
Averaged Test Accurancy: 0.8121
Std Test Accurancy: 0.0935
evaluate time cost:5.0199854373931885s
clients training time cost:5.195497512817383s
[running kmeans]: 3it [00:00, 333.04it/s, center_shift=0.000000, iteration=3, tol=0.000100]
attn_optimize time cost:0.6137905120849609s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1250, 0.1260, 0.1247, 0.1247, 0.1246, 0.1248, 0.1249, 0.1253],
        [0.1250, 0.1258, 0.1249, 0.1247, 0.1245, 0.1248, 0.1248, 0.1255],
        [0.1249, 0.1259, 0.1248, 0.1246, 0.1247, 0.1247, 0.1250, 0.1254],
        [0.1250, 0.1258, 0.1248, 0.1247, 0.1246, 0.1248, 0.1249, 0.1255],
        [0.1249, 0.1258, 0.1249, 0.1248, 0.1244, 0.1248, 0.1248, 0.1255],
        [0.1249, 0.1260, 0.1248, 0.1246, 0.1247, 0.1248, 0.1248, 0.1253],
        [0.1250, 0.1259, 0.1247, 0.1247, 0.1246, 0.1247, 0.1249, 0.1255],
        [0.1250, 0.1260, 0.1247, 0.1247, 0.1246, 0.1247, 0.1248, 0.1255]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0898, 0.0907, 0.0906, 0.0907, 0.0912, 0.0911, 0.0910, 0.0907, 0.0911,
         0.0918, 0.0915],
        [0.0899, 0.0907, 0.0908, 0.0906, 0.0910, 0.0912, 0.0910, 0.0908, 0.0909,
         0.0918, 0.0913],
        [0.0899, 0.0908, 0.0906, 0.0907, 0.0911, 0.0911, 0.0909, 0.0907, 0.0911,
         0.0916, 0.0915],
        [0.0900, 0.0906, 0.0907, 0.0907, 0.0910, 0.0911, 0.0910, 0.0911, 0.0909,
         0.0917, 0.0913],
        [0.0900, 0.0908, 0.0907, 0.0907, 0.0911, 0.0912, 0.0909, 0.0909, 0.0909,
         0.0916, 0.0913],
        [0.0899, 0.0907, 0.0907, 0.0906, 0.0911, 0.0911, 0.0910, 0.0908, 0.0909,
         0.0918, 0.0913],
        [0.0898, 0.0906, 0.0908, 0.0906, 0.0910, 0.0911, 0.0911, 0.0910, 0.0908,
         0.0917, 0.0914],
        [0.0899, 0.0906, 0.0907, 0.0907, 0.0910, 0.0911, 0.0910, 0.0908, 0.0909,
         0.0918, 0.0915],
        [0.0900, 0.0907, 0.0908, 0.0907, 0.0911, 0.0912, 0.0909, 0.0909, 0.0909,
         0.0916, 0.0911],
        [0.0898, 0.0908, 0.0907, 0.0906, 0.0911, 0.0912, 0.0910, 0.0907, 0.0909,
         0.0918, 0.0915],
        [0.0898, 0.0908, 0.0906, 0.0905, 0.0912, 0.0912, 0.0909, 0.0907, 0.0911,
         0.0918, 0.0915]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0506, 0.0503, 0.0506, 0.0505, 0.0504, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0494, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0495, 0.0499, 0.0502,
         0.0497, 0.0492],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0504, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0506, 0.0502, 0.0505, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0499, 0.0506, 0.0502, 0.0506, 0.0504, 0.0504, 0.0502, 0.0494, 0.0497,
         0.0501, 0.0496, 0.0499, 0.0504, 0.0502, 0.0501, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0496,
         0.0503, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0506, 0.0502, 0.0506, 0.0504, 0.0504, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0497, 0.0491],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0504, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0485],
        [0.0497, 0.0506, 0.0502, 0.0506, 0.0505, 0.0504, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0498, 0.0504, 0.0502, 0.0502, 0.0493, 0.0500, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0504, 0.0502, 0.0494, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0497, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0500, 0.0507, 0.0501, 0.0506, 0.0506, 0.0504, 0.0504, 0.0492, 0.0499,
         0.0502, 0.0493, 0.0498, 0.0506, 0.0502, 0.0501, 0.0492, 0.0499, 0.0501,
         0.0496, 0.0488]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0717, 0.0714, 0.0714, 0.0717, 0.0714, 0.0711, 0.0712, 0.0716, 0.0714,
         0.0714, 0.0719, 0.0714, 0.0711, 0.0714],
        [0.0716, 0.0713, 0.0714, 0.0716, 0.0714, 0.0712, 0.0712, 0.0716, 0.0714,
         0.0714, 0.0718, 0.0714, 0.0712, 0.0714],
        [0.0717, 0.0713, 0.0714, 0.0716, 0.0715, 0.0711, 0.0712, 0.0716, 0.0714,
         0.0714, 0.0719, 0.0714, 0.0711, 0.0714],
        [0.0716, 0.0714, 0.0714, 0.0716, 0.0714, 0.0711, 0.0712, 0.0715, 0.0714,
         0.0714, 0.0718, 0.0714, 0.0712, 0.0714],
        [0.0717, 0.0713, 0.0715, 0.0716, 0.0713, 0.0711, 0.0711, 0.0716, 0.0714,
         0.0715, 0.0719, 0.0714, 0.0712, 0.0714],
        [0.0716, 0.0713, 0.0715, 0.0717, 0.0714, 0.0711, 0.0712, 0.0716, 0.0714,
         0.0714, 0.0720, 0.0714, 0.0712, 0.0714],
        [0.0716, 0.0712, 0.0714, 0.0715, 0.0715, 0.0712, 0.0711, 0.0716, 0.0714,
         0.0715, 0.0719, 0.0714, 0.0711, 0.0714],
        [0.0716, 0.0713, 0.0715, 0.0717, 0.0714, 0.0712, 0.0711, 0.0716, 0.0713,
         0.0714, 0.0719, 0.0714, 0.0712, 0.0713],
        [0.0717, 0.0714, 0.0715, 0.0716, 0.0714, 0.0711, 0.0711, 0.0716, 0.0714,
         0.0714, 0.0719, 0.0714, 0.0712, 0.0714],
        [0.0716, 0.0714, 0.0714, 0.0716, 0.0715, 0.0711, 0.0711, 0.0716, 0.0714,
         0.0714, 0.0719, 0.0714, 0.0711, 0.0714],
        [0.0716, 0.0713, 0.0715, 0.0717, 0.0714, 0.0712, 0.0712, 0.0716, 0.0714,
         0.0714, 0.0719, 0.0714, 0.0711, 0.0714],
        [0.0716, 0.0713, 0.0714, 0.0717, 0.0714, 0.0712, 0.0712, 0.0716, 0.0714,
         0.0715, 0.0719, 0.0714, 0.0712, 0.0714],
        [0.0717, 0.0713, 0.0714, 0.0716, 0.0714, 0.0711, 0.0712, 0.0716, 0.0714,
         0.0714, 0.0719, 0.0714, 0.0712, 0.0714],
        [0.0717, 0.0713, 0.0714, 0.0716, 0.0714, 0.0711, 0.0712, 0.0716, 0.0714,
         0.0714, 0.0718, 0.0714, 0.0712, 0.0714]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1682, 0.1673, 0.1656, 0.1653, 0.1675, 0.1660],
        [0.1684, 0.1676, 0.1653, 0.1653, 0.1674, 0.1659],
        [0.1684, 0.1672, 0.1657, 0.1652, 0.1675, 0.1659],
        [0.1682, 0.1675, 0.1655, 0.1654, 0.1674, 0.1660],
        [0.1684, 0.1674, 0.1654, 0.1654, 0.1674, 0.1659],
        [0.1684, 0.1672, 0.1656, 0.1656, 0.1673, 0.1659]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1671, 0.1666, 0.1663, 0.1660, 0.1682, 0.1658],
        [0.1667, 0.1670, 0.1665, 0.1657, 0.1680, 0.1662],
        [0.1670, 0.1669, 0.1665, 0.1659, 0.1681, 0.1656],
        [0.1669, 0.1668, 0.1663, 0.1658, 0.1680, 0.1662],
        [0.1670, 0.1669, 0.1663, 0.1658, 0.1680, 0.1660],
        [0.1674, 0.1672, 0.1663, 0.1661, 0.1682, 0.1648]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0765, 0.0769, 0.0765, 0.0769, 0.0764, 0.0773, 0.0770, 0.0771,
         0.0776, 0.0771, 0.0767, 0.0768],
        [0.0770, 0.0766, 0.0770, 0.0765, 0.0768, 0.0765, 0.0773, 0.0771, 0.0771,
         0.0776, 0.0771, 0.0767, 0.0768],
        [0.0770, 0.0765, 0.0770, 0.0765, 0.0769, 0.0765, 0.0773, 0.0770, 0.0771,
         0.0775, 0.0771, 0.0767, 0.0768],
        [0.0770, 0.0766, 0.0770, 0.0765, 0.0768, 0.0764, 0.0773, 0.0771, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0767],
        [0.0770, 0.0765, 0.0769, 0.0766, 0.0767, 0.0764, 0.0773, 0.0770, 0.0772,
         0.0777, 0.0770, 0.0768, 0.0768],
        [0.0771, 0.0765, 0.0770, 0.0766, 0.0768, 0.0765, 0.0773, 0.0770, 0.0771,
         0.0776, 0.0770, 0.0768, 0.0767],
        [0.0771, 0.0764, 0.0769, 0.0764, 0.0769, 0.0763, 0.0773, 0.0770, 0.0772,
         0.0777, 0.0771, 0.0768, 0.0768],
        [0.0770, 0.0766, 0.0769, 0.0766, 0.0767, 0.0765, 0.0773, 0.0770, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0768],
        [0.0771, 0.0765, 0.0770, 0.0765, 0.0768, 0.0764, 0.0772, 0.0770, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0768],
        [0.0770, 0.0766, 0.0770, 0.0765, 0.0768, 0.0764, 0.0773, 0.0769, 0.0771,
         0.0775, 0.0772, 0.0768, 0.0768],
        [0.0770, 0.0765, 0.0768, 0.0766, 0.0769, 0.0766, 0.0773, 0.0769, 0.0772,
         0.0776, 0.0771, 0.0768, 0.0769],
        [0.0770, 0.0765, 0.0768, 0.0765, 0.0769, 0.0764, 0.0773, 0.0771, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0768],
        [0.0769, 0.0765, 0.0770, 0.0766, 0.0768, 0.0765, 0.0773, 0.0769, 0.0772,
         0.0777, 0.0770, 0.0767, 0.0768]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0501, 0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0497],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0498, 0.0499, 0.0501, 0.0502,
         0.0501, 0.0497, 0.0498, 0.0501, 0.0500, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0501, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0500, 0.0501, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0499, 0.0501, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0500, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0499, 0.0502, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0502, 0.0499, 0.0501, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0493],
        [0.0501, 0.0501, 0.0502, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0503, 0.0499, 0.0501, 0.0503, 0.0502, 0.0502,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0503, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0502, 0.0499, 0.0500, 0.0503, 0.0500, 0.0502,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0499, 0.0502, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0502, 0.0500, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0497, 0.0498, 0.0501, 0.0500, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0501, 0.0498, 0.0499, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0503, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0500, 0.0502, 0.0499, 0.0501, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0500, 0.0501, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0496],
        [0.0501, 0.0501, 0.0502, 0.0498, 0.0502, 0.0498, 0.0497, 0.0500, 0.0501,
         0.0501, 0.0496, 0.0497, 0.0503, 0.0500, 0.0504, 0.0502, 0.0503, 0.0502,
         0.0495, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.32985615730285645s
iter time cost:11.232779502868652s
-------------Round number: 134-------------
Evaluate global model
Averaged Train Loss: 0.3169
Averaged Test Accurancy: 0.8120
Std Test Accurancy: 0.0937
evaluate time cost:5.294001340866089s
clients training time cost:5.348119258880615s
attn_optimize time cost:0.521721601486206s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0503, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0498, 0.0503, 0.0499, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0499, 0.0498, 0.0504, 0.0500, 0.0500,
         0.0498, 0.0497],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0498, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0500, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0503,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0499, 0.0498, 0.0501, 0.0500, 0.0499, 0.0504, 0.0500, 0.0500,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0501, 0.0503,
         0.0500, 0.0499, 0.0498, 0.0502, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0500, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0503,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498, 0.0504, 0.0499, 0.0501,
         0.0499, 0.0494],
        [0.0503, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0503, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0503, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0503,
         0.0499, 0.0499, 0.0498, 0.0502, 0.0500, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0497, 0.0494],
        [0.0503, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0501, 0.0503,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498, 0.0502, 0.0503,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0503,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0504, 0.0499, 0.0501,
         0.0499, 0.0493],
        [0.0503, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0500, 0.0498, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0502, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0502, 0.0500, 0.0501, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0500, 0.0500, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0503, 0.0500, 0.0502, 0.0499, 0.0502, 0.0498, 0.0497, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0497, 0.0503, 0.0501, 0.0502, 0.0502, 0.0502, 0.0502,
         0.0496, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0764, 0.0768, 0.0767, 0.0768, 0.0765, 0.0773, 0.0769, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0768, 0.0766, 0.0774, 0.0770, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0769, 0.0766, 0.0773, 0.0769, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0768],
        [0.0769, 0.0765, 0.0769, 0.0767, 0.0768, 0.0764, 0.0774, 0.0770, 0.0772,
         0.0776, 0.0770, 0.0768, 0.0768],
        [0.0769, 0.0765, 0.0768, 0.0768, 0.0767, 0.0765, 0.0774, 0.0769, 0.0772,
         0.0777, 0.0769, 0.0768, 0.0768],
        [0.0770, 0.0765, 0.0769, 0.0767, 0.0767, 0.0766, 0.0774, 0.0769, 0.0772,
         0.0775, 0.0770, 0.0769, 0.0768],
        [0.0770, 0.0764, 0.0767, 0.0766, 0.0769, 0.0764, 0.0774, 0.0769, 0.0772,
         0.0777, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0768, 0.0767, 0.0766, 0.0773, 0.0769, 0.0771,
         0.0776, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0764, 0.0769, 0.0767, 0.0768, 0.0765, 0.0773, 0.0768, 0.0771,
         0.0776, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0766, 0.0768, 0.0765, 0.0774, 0.0768, 0.0771,
         0.0775, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0764, 0.0767, 0.0767, 0.0768, 0.0766, 0.0774, 0.0768, 0.0772,
         0.0775, 0.0770, 0.0768, 0.0770],
        [0.0769, 0.0765, 0.0767, 0.0766, 0.0769, 0.0764, 0.0774, 0.0770, 0.0771,
         0.0776, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0764, 0.0769, 0.0767, 0.0768, 0.0765, 0.0774, 0.0768, 0.0772,
         0.0777, 0.0770, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1437, 0.1429, 0.1417, 0.1411, 0.1431, 0.1417, 0.1458],
        [0.1439, 0.1432, 0.1415, 0.1412, 0.1431, 0.1417, 0.1453],
        [0.1439, 0.1429, 0.1419, 0.1411, 0.1432, 0.1416, 0.1454],
        [0.1437, 0.1431, 0.1416, 0.1413, 0.1431, 0.1417, 0.1455],
        [0.1439, 0.1430, 0.1415, 0.1412, 0.1430, 0.1416, 0.1458],
        [0.1438, 0.1428, 0.1416, 0.1413, 0.1429, 0.1416, 0.1460],
        [0.1440, 0.1430, 0.1412, 0.1407, 0.1432, 0.1412, 0.1467]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1003, 0.1008, 0.0997, 0.0999, 0.0995, 0.0998, 0.0999, 0.0998, 0.1000,
         0.1004],
        [0.1002, 0.1008, 0.0996, 0.0999, 0.0995, 0.0998, 0.0999, 0.0997, 0.1000,
         0.1006],
        [0.1002, 0.1008, 0.0995, 0.1000, 0.0995, 0.0999, 0.0999, 0.0998, 0.1000,
         0.1005],
        [0.1002, 0.1008, 0.0996, 0.0999, 0.0994, 0.0999, 0.0999, 0.0997, 0.1001,
         0.1006],
        [0.1001, 0.1008, 0.0995, 0.1000, 0.0995, 0.0999, 0.0999, 0.0997, 0.1001,
         0.1005],
        [0.1003, 0.1008, 0.0995, 0.1001, 0.0994, 0.0998, 0.0998, 0.0996, 0.1000,
         0.1006],
        [0.1002, 0.1007, 0.0996, 0.1000, 0.0995, 0.0999, 0.1000, 0.0997, 0.1000,
         0.1004],
        [0.1002, 0.1007, 0.0996, 0.1000, 0.0996, 0.0998, 0.1000, 0.0998, 0.0999,
         0.1004],
        [0.1003, 0.1009, 0.0995, 0.1000, 0.0994, 0.0999, 0.0998, 0.0997, 0.1000,
         0.1005],
        [0.1002, 0.1009, 0.0996, 0.0999, 0.0996, 0.0998, 0.0999, 0.0997, 0.1000,
         0.1005]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2015, 0.2008, 0.2018, 0.1992, 0.1967],
        [0.2013, 0.2005, 0.2016, 0.1988, 0.1977],
        [0.2011, 0.2005, 0.2015, 0.1990, 0.1980],
        [0.2011, 0.2009, 0.2016, 0.1993, 0.1971],
        [0.2020, 0.2014, 0.2013, 0.1981, 0.1971]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0526, 0.0526, 0.0528, 0.0529, 0.0526, 0.0526, 0.0526, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0530, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0526, 0.0527, 0.0526, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0527, 0.0526, 0.0526, 0.0528, 0.0529, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0526, 0.0525, 0.0525, 0.0524,
         0.0525, 0.0523, 0.0527, 0.0526, 0.0526, 0.0531, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0525, 0.0526, 0.0525, 0.0523,
         0.0525, 0.0523, 0.0527, 0.0526, 0.0526, 0.0530, 0.0526, 0.0524, 0.0532,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0528, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0525, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0525, 0.0526, 0.0525, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0525, 0.0526, 0.0530, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0526, 0.0526, 0.0525, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0530, 0.0526, 0.0524, 0.0532,
         0.0525],
        [0.0528, 0.0524, 0.0526, 0.0528, 0.0529, 0.0526, 0.0527, 0.0526, 0.0524,
         0.0525, 0.0523, 0.0527, 0.0526, 0.0526, 0.0530, 0.0526, 0.0524, 0.0532,
         0.0525],
        [0.0528, 0.0524, 0.0526, 0.0527, 0.0529, 0.0526, 0.0527, 0.0525, 0.0524,
         0.0526, 0.0524, 0.0527, 0.0526, 0.0526, 0.0530, 0.0526, 0.0523, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0528, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0526, 0.0526, 0.0530, 0.0526, 0.0524, 0.0532,
         0.0525],
        [0.0528, 0.0526, 0.0526, 0.0528, 0.0529, 0.0526, 0.0526, 0.0525, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0530, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0526, 0.0526, 0.0527, 0.0529, 0.0526, 0.0526, 0.0525, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0526, 0.0526, 0.0525, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0530, 0.0526, 0.0524, 0.0532,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0525, 0.0525, 0.0526, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0525, 0.0532,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0528, 0.0529, 0.0526, 0.0526, 0.0526, 0.0523,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0524, 0.0531,
         0.0526],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0525, 0.0527, 0.0525, 0.0524,
         0.0525, 0.0524, 0.0527, 0.0526, 0.0526, 0.0530, 0.0526, 0.0524, 0.0531,
         0.0525],
        [0.0528, 0.0525, 0.0526, 0.0527, 0.0529, 0.0526, 0.0526, 0.0526, 0.0524,
         0.0524, 0.0524, 0.0527, 0.0526, 0.0526, 0.0529, 0.0526, 0.0525, 0.0531,
         0.0526]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
[running kmeans]: 9it [00:00, 321.14it/s, center_shift=0.000000, iteration=9, tol=0.000100]
weights:tensor([[0.1097, 0.1111, 0.1107, 0.1113, 0.1113, 0.1112, 0.1108, 0.1121, 0.1118],
        [0.1098, 0.1112, 0.1109, 0.1110, 0.1113, 0.1112, 0.1109, 0.1119, 0.1118],
        [0.1098, 0.1111, 0.1107, 0.1111, 0.1113, 0.1111, 0.1109, 0.1119, 0.1119],
        [0.1099, 0.1112, 0.1108, 0.1111, 0.1114, 0.1111, 0.1109, 0.1119, 0.1117],
        [0.1097, 0.1114, 0.1108, 0.1112, 0.1113, 0.1111, 0.1109, 0.1121, 0.1115],
        [0.1095, 0.1114, 0.1108, 0.1112, 0.1113, 0.1113, 0.1111, 0.1119, 0.1116],
        [0.1098, 0.1114, 0.1108, 0.1112, 0.1112, 0.1111, 0.1108, 0.1120, 0.1117],
        [0.1096, 0.1114, 0.1107, 0.1112, 0.1114, 0.1112, 0.1108, 0.1121, 0.1117],
        [0.1097, 0.1112, 0.1107, 0.1113, 0.1114, 0.1111, 0.1108, 0.1121, 0.1117]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0671, 0.0668, 0.0671, 0.0670, 0.0668, 0.0668, 0.0657, 0.0668, 0.0661,
         0.0670, 0.0667, 0.0668, 0.0663, 0.0668, 0.0661],
        [0.0671, 0.0669, 0.0672, 0.0670, 0.0669, 0.0668, 0.0657, 0.0666, 0.0661,
         0.0669, 0.0667, 0.0668, 0.0663, 0.0668, 0.0662],
        [0.0672, 0.0668, 0.0672, 0.0671, 0.0669, 0.0668, 0.0657, 0.0667, 0.0661,
         0.0670, 0.0667, 0.0668, 0.0663, 0.0668, 0.0661],
        [0.0671, 0.0669, 0.0672, 0.0671, 0.0668, 0.0667, 0.0657, 0.0667, 0.0661,
         0.0670, 0.0667, 0.0667, 0.0663, 0.0668, 0.0662],
        [0.0672, 0.0669, 0.0672, 0.0671, 0.0669, 0.0667, 0.0656, 0.0666, 0.0660,
         0.0671, 0.0667, 0.0668, 0.0663, 0.0667, 0.0661],
        [0.0671, 0.0668, 0.0672, 0.0671, 0.0668, 0.0668, 0.0657, 0.0667, 0.0660,
         0.0671, 0.0668, 0.0667, 0.0663, 0.0668, 0.0661],
        [0.0671, 0.0668, 0.0672, 0.0671, 0.0668, 0.0667, 0.0658, 0.0667, 0.0661,
         0.0670, 0.0667, 0.0667, 0.0663, 0.0668, 0.0661],
        [0.0671, 0.0668, 0.0671, 0.0671, 0.0668, 0.0667, 0.0658, 0.0668, 0.0661,
         0.0670, 0.0668, 0.0667, 0.0663, 0.0668, 0.0661],
        [0.0671, 0.0668, 0.0672, 0.0671, 0.0668, 0.0668, 0.0657, 0.0667, 0.0661,
         0.0671, 0.0667, 0.0667, 0.0663, 0.0668, 0.0661],
        [0.0671, 0.0669, 0.0672, 0.0670, 0.0669, 0.0667, 0.0657, 0.0666, 0.0661,
         0.0669, 0.0667, 0.0668, 0.0663, 0.0668, 0.0662],
        [0.0671, 0.0668, 0.0671, 0.0671, 0.0668, 0.0668, 0.0657, 0.0667, 0.0661,
         0.0670, 0.0667, 0.0667, 0.0663, 0.0668, 0.0661],
        [0.0671, 0.0669, 0.0672, 0.0671, 0.0669, 0.0668, 0.0657, 0.0667, 0.0660,
         0.0671, 0.0667, 0.0667, 0.0662, 0.0668, 0.0662],
        [0.0671, 0.0669, 0.0672, 0.0671, 0.0669, 0.0667, 0.0657, 0.0667, 0.0661,
         0.0671, 0.0667, 0.0667, 0.0663, 0.0668, 0.0661],
        [0.0672, 0.0668, 0.0672, 0.0670, 0.0669, 0.0668, 0.0657, 0.0666, 0.0661,
         0.0670, 0.0667, 0.0668, 0.0663, 0.0668, 0.0661],
        [0.0671, 0.0668, 0.0671, 0.0670, 0.0669, 0.0668, 0.0658, 0.0667, 0.0661,
         0.0670, 0.0666, 0.0667, 0.0663, 0.0669, 0.0662]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.28626012802124023s
iter time cost:11.542957782745361s
-------------Round number: 135-------------
Evaluate global model
Averaged Train Loss: 0.3080
Averaged Test Accurancy: 0.8149
Std Test Accurancy: 0.0762
evaluate time cost:4.743635416030884s
[running kmeans]: 4it [00:00, 399.68it/s, center_shift=0.000000, iteration=4, tol=0.000100]
clients training time cost:5.101823568344116s
attn_optimize time cost:0.5550811290740967s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0836, 0.0832, 0.0833, 0.0836, 0.0831, 0.0835, 0.0832, 0.0833, 0.0839,
         0.0832, 0.0830, 0.0832],
        [0.0836, 0.0832, 0.0833, 0.0835, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0832, 0.0830, 0.0832],
        [0.0837, 0.0832, 0.0833, 0.0835, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0830, 0.0832],
        [0.0836, 0.0832, 0.0833, 0.0835, 0.0831, 0.0834, 0.0833, 0.0833, 0.0837,
         0.0832, 0.0830, 0.0833],
        [0.0837, 0.0831, 0.0833, 0.0834, 0.0830, 0.0836, 0.0833, 0.0833, 0.0839,
         0.0833, 0.0829, 0.0832],
        [0.0836, 0.0831, 0.0833, 0.0836, 0.0830, 0.0835, 0.0832, 0.0833, 0.0838,
         0.0833, 0.0830, 0.0831],
        [0.0837, 0.0832, 0.0833, 0.0835, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0832, 0.0830, 0.0832],
        [0.0836, 0.0832, 0.0833, 0.0835, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0829, 0.0832],
        [0.0836, 0.0831, 0.0833, 0.0836, 0.0830, 0.0835, 0.0832, 0.0833, 0.0839,
         0.0833, 0.0829, 0.0832],
        [0.0836, 0.0831, 0.0833, 0.0836, 0.0830, 0.0835, 0.0832, 0.0833, 0.0838,
         0.0833, 0.0831, 0.0832],
        [0.0837, 0.0832, 0.0833, 0.0835, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0833, 0.0830, 0.0832],
        [0.0837, 0.0832, 0.0833, 0.0835, 0.0830, 0.0835, 0.0833, 0.0833, 0.0838,
         0.0832, 0.0831, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2500, 0.2495, 0.2484, 0.2520],
        [0.2498, 0.2494, 0.2486, 0.2522],
        [0.2495, 0.2494, 0.2484, 0.2527],
        [0.2500, 0.2492, 0.2486, 0.2522]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0990, 0.1001, 0.1000, 0.1004, 0.1004, 0.1003, 0.0999, 0.1010, 0.1008,
         0.0981],
        [0.0990, 0.1001, 0.1000, 0.1000, 0.1002, 0.1002, 0.0999, 0.1008, 0.1007,
         0.0990],
        [0.0990, 0.1001, 0.1000, 0.1002, 0.1003, 0.1001, 0.0999, 0.1009, 0.1009,
         0.0985],
        [0.0991, 0.1001, 0.1000, 0.1001, 0.1003, 0.1001, 0.0999, 0.1008, 0.1007,
         0.0989],
        [0.0989, 0.1002, 0.1000, 0.1002, 0.1003, 0.1001, 0.0999, 0.1009, 0.1004,
         0.0990],
        [0.0987, 0.1002, 0.1000, 0.1002, 0.1002, 0.1002, 0.1001, 0.1008, 0.1005,
         0.0991],
        [0.0990, 0.1003, 0.1000, 0.1002, 0.1002, 0.1001, 0.0999, 0.1009, 0.1007,
         0.0989],
        [0.0988, 0.1003, 0.1000, 0.1002, 0.1004, 0.1002, 0.0998, 0.1010, 0.1007,
         0.0988],
        [0.0989, 0.1001, 0.0999, 0.1003, 0.1003, 0.1001, 0.0998, 0.1010, 0.1007,
         0.0989],
        [0.0983, 0.1003, 0.0998, 0.0999, 0.1002, 0.1000, 0.0997, 0.1015, 0.1017,
         0.0986]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0506, 0.0503, 0.0507, 0.0506, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0502, 0.0494, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0497, 0.0492],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0504, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0506, 0.0502, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0499, 0.0505, 0.0502, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0501, 0.0496, 0.0500, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0502, 0.0496, 0.0497,
         0.0503, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0506, 0.0502, 0.0506, 0.0504, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0497, 0.0491],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0485],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0504, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0498, 0.0504, 0.0502, 0.0502, 0.0493, 0.0500, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0494, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0497, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0501, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0501, 0.0507, 0.0501, 0.0506, 0.0506, 0.0504, 0.0504, 0.0492, 0.0500,
         0.0502, 0.0494, 0.0499, 0.0506, 0.0502, 0.0501, 0.0491, 0.0499, 0.0501,
         0.0496, 0.0489]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1438, 0.1427, 0.1414, 0.1411, 0.1433, 0.1418, 0.1458],
        [0.1440, 0.1431, 0.1412, 0.1412, 0.1432, 0.1418, 0.1454],
        [0.1440, 0.1427, 0.1416, 0.1411, 0.1434, 0.1418, 0.1455],
        [0.1438, 0.1429, 0.1414, 0.1413, 0.1432, 0.1419, 0.1455],
        [0.1439, 0.1428, 0.1412, 0.1412, 0.1432, 0.1418, 0.1458],
        [0.1439, 0.1426, 0.1414, 0.1413, 0.1430, 0.1417, 0.1461],
        [0.1441, 0.1428, 0.1408, 0.1407, 0.1435, 0.1413, 0.1468]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.1008, 0.0996, 0.0998, 0.0995, 0.0999, 0.1000, 0.0998, 0.0999,
         0.1004],
        [0.1002, 0.1008, 0.0996, 0.0999, 0.0996, 0.0998, 0.1000, 0.0997, 0.0999,
         0.1006],
        [0.1002, 0.1008, 0.0995, 0.0999, 0.0995, 0.0999, 0.0999, 0.0998, 0.0999,
         0.1005],
        [0.1002, 0.1008, 0.0996, 0.0999, 0.0995, 0.0999, 0.0999, 0.0997, 0.0999,
         0.1006],
        [0.1001, 0.1008, 0.0995, 0.1000, 0.0996, 0.0999, 0.1000, 0.0998, 0.0999,
         0.1005],
        [0.1002, 0.1008, 0.0995, 0.1000, 0.0994, 0.0998, 0.0999, 0.0997, 0.0999,
         0.1007],
        [0.1002, 0.1007, 0.0996, 0.0999, 0.0995, 0.0999, 0.1000, 0.0998, 0.0999,
         0.1004],
        [0.1002, 0.1007, 0.0996, 0.0999, 0.0996, 0.0998, 0.1001, 0.0998, 0.0998,
         0.1005],
        [0.1002, 0.1009, 0.0995, 0.0999, 0.0995, 0.0999, 0.0999, 0.0997, 0.0999,
         0.1006],
        [0.1002, 0.1008, 0.0996, 0.0998, 0.0996, 0.0999, 0.0999, 0.0997, 0.0998,
         0.1006]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0770, 0.0764, 0.0769, 0.0767, 0.0768, 0.0763, 0.0773, 0.0771, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0769],
        [0.0769, 0.0764, 0.0769, 0.0767, 0.0768, 0.0764, 0.0773, 0.0772, 0.0771,
         0.0775, 0.0771, 0.0767, 0.0769],
        [0.0769, 0.0764, 0.0770, 0.0767, 0.0769, 0.0764, 0.0773, 0.0771, 0.0771,
         0.0774, 0.0771, 0.0768, 0.0768],
        [0.0769, 0.0765, 0.0770, 0.0766, 0.0767, 0.0763, 0.0774, 0.0772, 0.0772,
         0.0775, 0.0771, 0.0768, 0.0768],
        [0.0770, 0.0765, 0.0769, 0.0768, 0.0767, 0.0764, 0.0774, 0.0770, 0.0772,
         0.0776, 0.0770, 0.0768, 0.0769],
        [0.0770, 0.0764, 0.0770, 0.0767, 0.0767, 0.0764, 0.0774, 0.0771, 0.0772,
         0.0775, 0.0770, 0.0768, 0.0768],
        [0.0770, 0.0763, 0.0768, 0.0766, 0.0768, 0.0763, 0.0774, 0.0771, 0.0772,
         0.0776, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0765, 0.0769, 0.0768, 0.0767, 0.0764, 0.0773, 0.0771, 0.0771,
         0.0775, 0.0771, 0.0768, 0.0770],
        [0.0770, 0.0764, 0.0770, 0.0767, 0.0768, 0.0764, 0.0773, 0.0770, 0.0771,
         0.0775, 0.0770, 0.0769, 0.0769],
        [0.0769, 0.0765, 0.0770, 0.0766, 0.0768, 0.0763, 0.0774, 0.0770, 0.0771,
         0.0774, 0.0772, 0.0769, 0.0769],
        [0.0770, 0.0764, 0.0767, 0.0767, 0.0768, 0.0765, 0.0774, 0.0770, 0.0772,
         0.0775, 0.0770, 0.0768, 0.0770],
        [0.0770, 0.0764, 0.0768, 0.0766, 0.0768, 0.0763, 0.0774, 0.0772, 0.0771,
         0.0776, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0764, 0.0770, 0.0767, 0.0768, 0.0764, 0.0774, 0.0770, 0.0772,
         0.0777, 0.0770, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.3347, 0.3332, 0.3321],
        [0.3347, 0.3328, 0.3325],
        [0.3347, 0.3331, 0.3322]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0501, 0.0502, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0502,
         0.0500, 0.0499, 0.0498, 0.0502, 0.0500, 0.0498, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0501, 0.0502, 0.0499, 0.0499, 0.0499, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0498, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0497],
        [0.0502, 0.0501, 0.0502, 0.0501, 0.0503, 0.0498, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0498, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0500, 0.0502, 0.0501, 0.0502, 0.0499, 0.0499, 0.0499, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0500, 0.0502, 0.0501, 0.0502, 0.0498, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0499, 0.0504, 0.0501, 0.0500,
         0.0497, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0499, 0.0498, 0.0498, 0.0502, 0.0500, 0.0500, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0498, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0500, 0.0502, 0.0501, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0503, 0.0501, 0.0501, 0.0500, 0.0502, 0.0498, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0499, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0503, 0.0499, 0.0499, 0.0499, 0.0502,
         0.0499, 0.0497, 0.0498, 0.0503, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501,
         0.0496, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0502, 0.0498, 0.0499, 0.0500, 0.0502,
         0.0499, 0.0498, 0.0498, 0.0503, 0.0500, 0.0498, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0503, 0.0500, 0.0501, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0497, 0.0502, 0.0500, 0.0499, 0.0503, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0499, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0502, 0.0501, 0.0499, 0.0503, 0.0502, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0500, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0493],
        [0.0503, 0.0501, 0.0501, 0.0501, 0.0503, 0.0498, 0.0499, 0.0500, 0.0503,
         0.0499, 0.0497, 0.0498, 0.0503, 0.0500, 0.0498, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0499, 0.0499, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0496],
        [0.0502, 0.0500, 0.0502, 0.0501, 0.0502, 0.0499, 0.0499, 0.0499, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0502, 0.0501, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0497, 0.0496],
        [0.0502, 0.0500, 0.0503, 0.0500, 0.0503, 0.0497, 0.0498, 0.0498, 0.0501,
         0.0500, 0.0496, 0.0496, 0.0504, 0.0501, 0.0502, 0.0502, 0.0504, 0.0502,
         0.0495, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.4153769016265869s
iter time cost:10.928573369979858s
-------------Round number: 136-------------
Evaluate global model
Averaged Train Loss: 0.3295
Averaged Test Accurancy: 0.8110
Std Test Accurancy: 0.0851
evaluate time cost:5.203314304351807s
clients training time cost:5.124721527099609s
attn_optimize time cost:0.49799370765686035s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1234, 0.1250, 0.1246, 0.1252, 0.1253, 0.1247, 0.1261, 0.1258],
        [0.1236, 0.1251, 0.1248, 0.1248, 0.1252, 0.1248, 0.1259, 0.1257],
        [0.1236, 0.1250, 0.1246, 0.1249, 0.1253, 0.1248, 0.1260, 0.1259],
        [0.1237, 0.1251, 0.1247, 0.1249, 0.1253, 0.1247, 0.1259, 0.1257],
        [0.1235, 0.1253, 0.1247, 0.1251, 0.1253, 0.1248, 0.1261, 0.1254],
        [0.1235, 0.1253, 0.1247, 0.1251, 0.1251, 0.1247, 0.1260, 0.1256],
        [0.1233, 0.1253, 0.1247, 0.1250, 0.1253, 0.1246, 0.1261, 0.1256],
        [0.1234, 0.1251, 0.1246, 0.1252, 0.1253, 0.1246, 0.1261, 0.1257]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0768, 0.0764, 0.0768, 0.0767, 0.0768, 0.0765, 0.0773, 0.0771, 0.0772,
         0.0777, 0.0771, 0.0768, 0.0769],
        [0.0768, 0.0764, 0.0769, 0.0766, 0.0767, 0.0765, 0.0774, 0.0771, 0.0772,
         0.0776, 0.0771, 0.0767, 0.0769],
        [0.0768, 0.0764, 0.0769, 0.0767, 0.0769, 0.0765, 0.0773, 0.0771, 0.0771,
         0.0776, 0.0771, 0.0767, 0.0768],
        [0.0768, 0.0765, 0.0769, 0.0766, 0.0767, 0.0764, 0.0774, 0.0771, 0.0772,
         0.0776, 0.0771, 0.0768, 0.0768],
        [0.0769, 0.0765, 0.0768, 0.0767, 0.0767, 0.0765, 0.0774, 0.0770, 0.0773,
         0.0777, 0.0769, 0.0768, 0.0769],
        [0.0769, 0.0764, 0.0769, 0.0767, 0.0767, 0.0765, 0.0774, 0.0770, 0.0772,
         0.0776, 0.0770, 0.0768, 0.0769],
        [0.0769, 0.0763, 0.0767, 0.0766, 0.0768, 0.0764, 0.0774, 0.0770, 0.0773,
         0.0778, 0.0770, 0.0769, 0.0770],
        [0.0768, 0.0765, 0.0768, 0.0768, 0.0766, 0.0765, 0.0773, 0.0770, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0770],
        [0.0769, 0.0764, 0.0769, 0.0767, 0.0767, 0.0765, 0.0773, 0.0770, 0.0772,
         0.0777, 0.0770, 0.0769, 0.0770],
        [0.0768, 0.0765, 0.0769, 0.0766, 0.0767, 0.0765, 0.0774, 0.0770, 0.0772,
         0.0776, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0764, 0.0767, 0.0767, 0.0768, 0.0766, 0.0774, 0.0769, 0.0773,
         0.0776, 0.0770, 0.0768, 0.0770],
        [0.0768, 0.0764, 0.0767, 0.0766, 0.0768, 0.0764, 0.0774, 0.0771, 0.0772,
         0.0777, 0.0771, 0.0768, 0.0769],
        [0.0768, 0.0764, 0.0769, 0.0767, 0.0768, 0.0765, 0.0774, 0.0769, 0.0772,
         0.0778, 0.0770, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
[running kmeans]: 7it [00:00, 317.89it/s, center_shift=0.000000, iteration=7, tol=0.000100]
weights:tensor([[0.0911, 0.0917, 0.0906, 0.0908, 0.0904, 0.0908, 0.0908, 0.0909, 0.0908,
         0.0909, 0.0913],
        [0.0911, 0.0916, 0.0906, 0.0909, 0.0905, 0.0907, 0.0908, 0.0908, 0.0907,
         0.0909, 0.0915],
        [0.0910, 0.0916, 0.0905, 0.0909, 0.0904, 0.0908, 0.0908, 0.0908, 0.0907,
         0.0909, 0.0914],
        [0.0911, 0.0916, 0.0906, 0.0908, 0.0904, 0.0907, 0.0908, 0.0909, 0.0906,
         0.0910, 0.0915],
        [0.0910, 0.0916, 0.0905, 0.0909, 0.0905, 0.0908, 0.0908, 0.0908, 0.0907,
         0.0910, 0.0914],
        [0.0911, 0.0916, 0.0905, 0.0910, 0.0904, 0.0907, 0.0907, 0.0909, 0.0906,
         0.0910, 0.0915],
        [0.0911, 0.0915, 0.0906, 0.0909, 0.0905, 0.0908, 0.0909, 0.0907, 0.0907,
         0.0910, 0.0913],
        [0.0911, 0.0917, 0.0905, 0.0908, 0.0903, 0.0907, 0.0908, 0.0910, 0.0907,
         0.0909, 0.0915],
        [0.0911, 0.0916, 0.0906, 0.0909, 0.0905, 0.0907, 0.0909, 0.0907, 0.0908,
         0.0909, 0.0914],
        [0.0911, 0.0917, 0.0905, 0.0909, 0.0903, 0.0908, 0.0907, 0.0909, 0.0906,
         0.0910, 0.0914],
        [0.0910, 0.0917, 0.0906, 0.0908, 0.0905, 0.0907, 0.0908, 0.0909, 0.0907,
         0.0909, 0.0914]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1438, 0.1427, 0.1415, 0.1412, 0.1431, 0.1418, 0.1459],
        [0.1441, 0.1430, 0.1413, 0.1413, 0.1430, 0.1418, 0.1454],
        [0.1440, 0.1427, 0.1417, 0.1412, 0.1432, 0.1418, 0.1455],
        [0.1438, 0.1429, 0.1415, 0.1413, 0.1430, 0.1418, 0.1456],
        [0.1440, 0.1428, 0.1413, 0.1413, 0.1430, 0.1418, 0.1459],
        [0.1439, 0.1426, 0.1415, 0.1414, 0.1429, 0.1417, 0.1461],
        [0.1442, 0.1427, 0.1410, 0.1408, 0.1432, 0.1413, 0.1468]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0717, 0.0714, 0.0715, 0.0712, 0.0715, 0.0713, 0.0714, 0.0716, 0.0715,
         0.0711, 0.0713, 0.0718, 0.0715, 0.0711],
        [0.0717, 0.0714, 0.0715, 0.0713, 0.0716, 0.0712, 0.0714, 0.0717, 0.0715,
         0.0711, 0.0712, 0.0719, 0.0715, 0.0712],
        [0.0717, 0.0714, 0.0715, 0.0712, 0.0717, 0.0712, 0.0714, 0.0717, 0.0715,
         0.0711, 0.0713, 0.0719, 0.0715, 0.0711],
        [0.0716, 0.0714, 0.0714, 0.0712, 0.0717, 0.0712, 0.0714, 0.0717, 0.0714,
         0.0712, 0.0713, 0.0719, 0.0715, 0.0711],
        [0.0716, 0.0714, 0.0715, 0.0712, 0.0716, 0.0712, 0.0714, 0.0717, 0.0715,
         0.0711, 0.0713, 0.0719, 0.0714, 0.0711],
        [0.0716, 0.0715, 0.0714, 0.0712, 0.0716, 0.0712, 0.0714, 0.0717, 0.0714,
         0.0711, 0.0712, 0.0719, 0.0715, 0.0711],
        [0.0717, 0.0714, 0.0715, 0.0712, 0.0717, 0.0711, 0.0714, 0.0716, 0.0714,
         0.0712, 0.0712, 0.0718, 0.0715, 0.0712],
        [0.0717, 0.0714, 0.0714, 0.0712, 0.0716, 0.0712, 0.0714, 0.0718, 0.0714,
         0.0711, 0.0712, 0.0719, 0.0715, 0.0712],
        [0.0718, 0.0714, 0.0714, 0.0712, 0.0716, 0.0712, 0.0714, 0.0717, 0.0715,
         0.0711, 0.0713, 0.0718, 0.0715, 0.0710],
        [0.0718, 0.0714, 0.0714, 0.0713, 0.0716, 0.0712, 0.0714, 0.0717, 0.0713,
         0.0711, 0.0713, 0.0719, 0.0715, 0.0710],
        [0.0716, 0.0714, 0.0714, 0.0712, 0.0716, 0.0711, 0.0714, 0.0717, 0.0715,
         0.0712, 0.0714, 0.0717, 0.0715, 0.0711],
        [0.0717, 0.0714, 0.0715, 0.0712, 0.0716, 0.0712, 0.0714, 0.0717, 0.0714,
         0.0711, 0.0712, 0.0718, 0.0715, 0.0712],
        [0.0717, 0.0714, 0.0714, 0.0713, 0.0716, 0.0712, 0.0714, 0.0716, 0.0715,
         0.0712, 0.0712, 0.0718, 0.0715, 0.0712],
        [0.0717, 0.0713, 0.0715, 0.0712, 0.0716, 0.0712, 0.0714, 0.0717, 0.0715,
         0.0711, 0.0714, 0.0719, 0.0715, 0.0711]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1668, 0.1665, 0.1673, 0.1671, 0.1676, 0.1648],
        [0.1668, 0.1660, 0.1677, 0.1671, 0.1676, 0.1647],
        [0.1673, 0.1663, 0.1675, 0.1669, 0.1672, 0.1649],
        [0.1670, 0.1663, 0.1673, 0.1669, 0.1676, 0.1649],
        [0.1668, 0.1662, 0.1678, 0.1668, 0.1676, 0.1649],
        [0.1663, 0.1657, 0.1676, 0.1677, 0.1678, 0.1648]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2513, 0.2511, 0.2521, 0.2455],
        [0.2509, 0.2504, 0.2517, 0.2470],
        [0.2507, 0.2504, 0.2516, 0.2473],
        [0.2513, 0.2516, 0.2511, 0.2459]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0628, 0.0616, 0.0626, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0615, 0.0622, 0.0628, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0627, 0.0617, 0.0625, 0.0620,
         0.0628, 0.0625, 0.0627, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0627, 0.0630, 0.0629, 0.0628, 0.0627, 0.0616, 0.0625, 0.0620,
         0.0628, 0.0625, 0.0627, 0.0617, 0.0622, 0.0627, 0.0620],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0628, 0.0631, 0.0630, 0.0628, 0.0627, 0.0615, 0.0625, 0.0619,
         0.0630, 0.0626, 0.0626, 0.0614, 0.0622, 0.0626, 0.0621],
        [0.0631, 0.0626, 0.0630, 0.0630, 0.0627, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0626, 0.0630, 0.0629, 0.0627, 0.0627, 0.0617, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0615, 0.0622, 0.0628, 0.0621],
        [0.0630, 0.0626, 0.0630, 0.0629, 0.0627, 0.0627, 0.0618, 0.0627, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0626, 0.0630, 0.0630, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0631, 0.0629, 0.0627, 0.0627, 0.0617, 0.0625, 0.0620,
         0.0628, 0.0626, 0.0627, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0626, 0.0630, 0.0630, 0.0627, 0.0628, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0628, 0.0621],
        [0.0630, 0.0627, 0.0631, 0.0630, 0.0627, 0.0627, 0.0617, 0.0626, 0.0619,
         0.0630, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0626, 0.0631, 0.0630, 0.0628, 0.0627, 0.0616, 0.0625, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0614, 0.0623, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0630, 0.0628, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0620],
        [0.0631, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0617, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0627, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0617, 0.0625, 0.0621,
         0.0629, 0.0625, 0.0626, 0.0616, 0.0622, 0.0628, 0.0621]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0502, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0498, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0499, 0.0498, 0.0505,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0501, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0502, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0498, 0.0500, 0.0502, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0500],
        [0.0501, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0502],
        [0.0501, 0.0498, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0497, 0.0500, 0.0502, 0.0503, 0.0499, 0.0500, 0.0498, 0.0497,
         0.0498, 0.0498, 0.0502, 0.0498, 0.0502, 0.0507, 0.0501, 0.0499, 0.0505,
         0.0498, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.22820758819580078s
iter time cost:11.16588830947876s
-------------Round number: 137-------------
Evaluate global model
Averaged Train Loss: 0.3064
Averaged Test Accurancy: 0.8195
Std Test Accurancy: 0.0751
evaluate time cost:4.766139507293701s
clients training time cost:5.001476764678955s
[running kmeans]: 4it [00:00, 307.41it/s, center_shift=0.000000, iteration=4, tol=0.000100]
attn_optimize time cost:0.4289853572845459s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0502, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0500, 0.0501, 0.0502,
         0.0501, 0.0497, 0.0499, 0.0501, 0.0498, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0498, 0.0498, 0.0504, 0.0501, 0.0500,
         0.0498, 0.0496],
        [0.0502, 0.0502, 0.0502, 0.0500, 0.0502, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0500, 0.0496, 0.0499, 0.0501, 0.0498, 0.0498, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0498, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0498, 0.0499, 0.0504, 0.0501, 0.0500,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0502, 0.0502, 0.0500, 0.0502, 0.0499, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0498, 0.0498, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0498, 0.0498, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0502, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0498, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0502, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0496, 0.0499, 0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0502, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0496, 0.0499, 0.0502, 0.0497, 0.0500, 0.0503, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0503,
         0.0499, 0.0497, 0.0499, 0.0502, 0.0498, 0.0498, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0503, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0496, 0.0498, 0.0502, 0.0498, 0.0498, 0.0504, 0.0500, 0.0501,
         0.0497, 0.0494],
        [0.0501, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0501, 0.0497, 0.0499, 0.0502, 0.0498, 0.0498, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499, 0.0502, 0.0502,
         0.0500, 0.0496, 0.0499, 0.0501, 0.0498, 0.0498, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0498, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0502, 0.0502, 0.0500, 0.0502, 0.0499, 0.0498, 0.0501, 0.0503,
         0.0500, 0.0495, 0.0499, 0.0502, 0.0498, 0.0498, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0494],
        [0.0502, 0.0501, 0.0502, 0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0502, 0.0497, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0501, 0.0501, 0.0502, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0496, 0.0499, 0.0501, 0.0499, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0502, 0.0503, 0.0499, 0.0502, 0.0499, 0.0498, 0.0500, 0.0502,
         0.0500, 0.0494, 0.0498, 0.0503, 0.0498, 0.0501, 0.0503, 0.0503, 0.0502,
         0.0496, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2007, 0.1972, 0.2000, 0.1983, 0.2038],
        [0.2008, 0.1974, 0.2000, 0.1984, 0.2035],
        [0.2009, 0.1972, 0.1998, 0.1982, 0.2038],
        [0.2008, 0.1973, 0.1997, 0.1981, 0.2041],
        [0.2010, 0.1964, 0.2001, 0.1975, 0.2050]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0499, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0497],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0499],
        [0.0502, 0.0498, 0.0500, 0.0502, 0.0501, 0.0499, 0.0501, 0.0501, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0498, 0.0500],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0498, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0498],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0497, 0.0500, 0.0501, 0.0503, 0.0498, 0.0500, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0502, 0.0498, 0.0502, 0.0507, 0.0502, 0.0499, 0.0504,
         0.0498, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1235, 0.1249, 0.1248, 0.1252, 0.1252, 0.1246, 0.1261, 0.1258],
        [0.1236, 0.1251, 0.1249, 0.1249, 0.1252, 0.1247, 0.1259, 0.1258],
        [0.1235, 0.1250, 0.1248, 0.1250, 0.1252, 0.1246, 0.1259, 0.1259],
        [0.1237, 0.1251, 0.1248, 0.1249, 0.1253, 0.1247, 0.1259, 0.1257],
        [0.1235, 0.1252, 0.1248, 0.1251, 0.1252, 0.1247, 0.1261, 0.1254],
        [0.1235, 0.1253, 0.1248, 0.1251, 0.1251, 0.1246, 0.1260, 0.1257],
        [0.1233, 0.1252, 0.1248, 0.1250, 0.1253, 0.1245, 0.1261, 0.1256],
        [0.1234, 0.1250, 0.1247, 0.1252, 0.1253, 0.1245, 0.1261, 0.1257]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1425, 0.1431, 0.1424, 0.1430, 0.1430, 0.1429, 0.1431],
        [0.1425, 0.1431, 0.1424, 0.1430, 0.1430, 0.1428, 0.1432],
        [0.1423, 0.1432, 0.1425, 0.1430, 0.1430, 0.1428, 0.1431],
        [0.1425, 0.1433, 0.1424, 0.1429, 0.1430, 0.1427, 0.1432],
        [0.1426, 0.1431, 0.1424, 0.1430, 0.1431, 0.1428, 0.1431],
        [0.1426, 0.1431, 0.1425, 0.1429, 0.1432, 0.1429, 0.1430],
        [0.1425, 0.1432, 0.1424, 0.1430, 0.1429, 0.1428, 0.1432]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2496, 0.2513, 0.2490, 0.2501],
        [0.2495, 0.2511, 0.2488, 0.2505],
        [0.2492, 0.2512, 0.2490, 0.2505],
        [0.2494, 0.2513, 0.2490, 0.2504]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0667, 0.0662, 0.0669, 0.0662, 0.0665, 0.0665, 0.0667, 0.0661, 0.0671,
         0.0669, 0.0669, 0.0673, 0.0669, 0.0666, 0.0666],
        [0.0667, 0.0663, 0.0667, 0.0661, 0.0666, 0.0665, 0.0666, 0.0662, 0.0671,
         0.0669, 0.0669, 0.0673, 0.0669, 0.0666, 0.0666],
        [0.0667, 0.0661, 0.0669, 0.0660, 0.0666, 0.0666, 0.0666, 0.0663, 0.0670,
         0.0668, 0.0670, 0.0674, 0.0668, 0.0665, 0.0667],
        [0.0667, 0.0662, 0.0667, 0.0661, 0.0666, 0.0665, 0.0666, 0.0662, 0.0670,
         0.0668, 0.0670, 0.0674, 0.0668, 0.0666, 0.0666],
        [0.0667, 0.0663, 0.0667, 0.0662, 0.0666, 0.0665, 0.0668, 0.0662, 0.0671,
         0.0669, 0.0669, 0.0672, 0.0669, 0.0666, 0.0665],
        [0.0667, 0.0663, 0.0667, 0.0662, 0.0666, 0.0664, 0.0666, 0.0661, 0.0671,
         0.0669, 0.0670, 0.0673, 0.0669, 0.0666, 0.0666],
        [0.0667, 0.0663, 0.0668, 0.0662, 0.0665, 0.0665, 0.0665, 0.0662, 0.0671,
         0.0668, 0.0670, 0.0673, 0.0668, 0.0666, 0.0666],
        [0.0668, 0.0663, 0.0667, 0.0661, 0.0666, 0.0665, 0.0666, 0.0662, 0.0671,
         0.0668, 0.0670, 0.0673, 0.0668, 0.0666, 0.0665],
        [0.0668, 0.0662, 0.0668, 0.0662, 0.0664, 0.0664, 0.0667, 0.0661, 0.0671,
         0.0668, 0.0670, 0.0674, 0.0668, 0.0667, 0.0666],
        [0.0667, 0.0663, 0.0668, 0.0661, 0.0665, 0.0666, 0.0666, 0.0662, 0.0671,
         0.0668, 0.0669, 0.0673, 0.0669, 0.0666, 0.0667],
        [0.0668, 0.0662, 0.0668, 0.0662, 0.0666, 0.0665, 0.0666, 0.0662, 0.0670,
         0.0668, 0.0669, 0.0673, 0.0668, 0.0667, 0.0667],
        [0.0667, 0.0663, 0.0667, 0.0661, 0.0666, 0.0664, 0.0666, 0.0662, 0.0671,
         0.0668, 0.0669, 0.0672, 0.0670, 0.0667, 0.0666],
        [0.0668, 0.0663, 0.0666, 0.0661, 0.0664, 0.0665, 0.0667, 0.0663, 0.0671,
         0.0668, 0.0670, 0.0672, 0.0668, 0.0666, 0.0667],
        [0.0667, 0.0663, 0.0667, 0.0662, 0.0664, 0.0664, 0.0667, 0.0661, 0.0671,
         0.0669, 0.0669, 0.0673, 0.0669, 0.0667, 0.0666],
        [0.0667, 0.0662, 0.0666, 0.0662, 0.0666, 0.0665, 0.0667, 0.0662, 0.0671,
         0.0668, 0.0670, 0.0674, 0.0668, 0.0666, 0.0666]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2516, 0.2508, 0.2520, 0.2456],
        [0.2513, 0.2503, 0.2516, 0.2467],
        [0.2510, 0.2503, 0.2515, 0.2472],
        [0.2520, 0.2511, 0.2510, 0.2458]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0616, 0.0627, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0628, 0.0631, 0.0629, 0.0627, 0.0627, 0.0617, 0.0625, 0.0620,
         0.0628, 0.0625, 0.0627, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0628, 0.0625, 0.0627, 0.0617, 0.0622, 0.0627, 0.0620],
        [0.0630, 0.0628, 0.0631, 0.0629, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0628, 0.0631, 0.0630, 0.0628, 0.0627, 0.0615, 0.0625, 0.0619,
         0.0630, 0.0626, 0.0626, 0.0614, 0.0622, 0.0626, 0.0621],
        [0.0631, 0.0627, 0.0631, 0.0630, 0.0627, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0627, 0.0630, 0.0629, 0.0627, 0.0626, 0.0617, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0626, 0.0627, 0.0618, 0.0627, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0630, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0630, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0620],
        [0.0630, 0.0628, 0.0631, 0.0629, 0.0627, 0.0626, 0.0617, 0.0625, 0.0620,
         0.0628, 0.0626, 0.0627, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0630, 0.0626, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0616, 0.0622, 0.0627, 0.0620],
        [0.0630, 0.0628, 0.0631, 0.0630, 0.0627, 0.0627, 0.0617, 0.0626, 0.0619,
         0.0630, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0627, 0.0631, 0.0630, 0.0628, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0615, 0.0623, 0.0627, 0.0620],
        [0.0630, 0.0628, 0.0631, 0.0630, 0.0627, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0620],
        [0.0631, 0.0628, 0.0631, 0.0629, 0.0627, 0.0627, 0.0617, 0.0625, 0.0620,
         0.0629, 0.0626, 0.0627, 0.0616, 0.0622, 0.0627, 0.0620],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0629, 0.0625, 0.0626, 0.0616, 0.0622, 0.0627, 0.0621]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.412708044052124s
iter time cost:10.72341251373291s
-------------Round number: 138-------------
Evaluate global model
Averaged Train Loss: 0.2969
Averaged Test Accurancy: 0.8180
Std Test Accurancy: 0.0790
evaluate time cost:5.3314454555511475s
[running kmeans]: 8it [00:00, 399.64it/s, center_shift=0.000000, iteration=8, tol=0.000100]
clients training time cost:4.889331340789795s
attn_optimize time cost:0.46855616569519043s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.1097, 0.1110, 0.1109, 0.1113, 0.1113, 0.1111, 0.1108, 0.1121, 0.1118],
        [0.1098, 0.1112, 0.1110, 0.1110, 0.1113, 0.1111, 0.1109, 0.1119, 0.1118],
        [0.1098, 0.1111, 0.1109, 0.1111, 0.1114, 0.1109, 0.1109, 0.1119, 0.1119],
        [0.1099, 0.1112, 0.1109, 0.1111, 0.1114, 0.1110, 0.1109, 0.1119, 0.1117],
        [0.1098, 0.1113, 0.1109, 0.1112, 0.1113, 0.1110, 0.1109, 0.1121, 0.1115],
        [0.1096, 0.1113, 0.1110, 0.1112, 0.1113, 0.1111, 0.1111, 0.1119, 0.1115],
        [0.1098, 0.1114, 0.1109, 0.1112, 0.1112, 0.1110, 0.1108, 0.1120, 0.1117],
        [0.1096, 0.1113, 0.1109, 0.1112, 0.1114, 0.1111, 0.1108, 0.1121, 0.1117],
        [0.1097, 0.1112, 0.1108, 0.1113, 0.1114, 0.1110, 0.1108, 0.1121, 0.1117]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0500, 0.0500, 0.0502,
         0.0501, 0.0499, 0.0498, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0497, 0.0501, 0.0498, 0.0500, 0.0504, 0.0501, 0.0500,
         0.0498, 0.0496],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0498, 0.0501, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0501, 0.0498, 0.0497, 0.0501, 0.0499, 0.0501, 0.0504, 0.0501, 0.0500,
         0.0497, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0498, 0.0497, 0.0501, 0.0498, 0.0501, 0.0504, 0.0502, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0502, 0.0501, 0.0500, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0498, 0.0499, 0.0504, 0.0501, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0500, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0498, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0494],
        [0.0503, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0497, 0.0501, 0.0498, 0.0501, 0.0504, 0.0502, 0.0501,
         0.0497, 0.0493],
        [0.0503, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0497, 0.0498, 0.0502, 0.0498, 0.0501, 0.0503, 0.0502, 0.0501,
         0.0496, 0.0493],
        [0.0503, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0503,
         0.0499, 0.0498, 0.0497, 0.0502, 0.0498, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0503, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0503,
         0.0500, 0.0497, 0.0497, 0.0501, 0.0498, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0501, 0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0500,
         0.0498, 0.0495],
        [0.0502, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0503,
         0.0500, 0.0497, 0.0497, 0.0500, 0.0499, 0.0500, 0.0504, 0.0502, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0498, 0.0500, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0493],
        [0.0503, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0497, 0.0497, 0.0502, 0.0498, 0.0500, 0.0504, 0.0502, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0498, 0.0500, 0.0503, 0.0501, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0503,
         0.0500, 0.0498, 0.0497, 0.0501, 0.0499, 0.0501, 0.0504, 0.0501, 0.0500,
         0.0497, 0.0495],
        [0.0502, 0.0501, 0.0502, 0.0499, 0.0502, 0.0499, 0.0499, 0.0499, 0.0502,
         0.0501, 0.0496, 0.0495, 0.0502, 0.0499, 0.0504, 0.0502, 0.0504, 0.0502,
         0.0495, 0.0494]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1002, 0.1008, 0.0997, 0.0998, 0.0994, 0.0998, 0.0999, 0.0998, 0.1001,
         0.1004],
        [0.1002, 0.1008, 0.0996, 0.0999, 0.0995, 0.0998, 0.0999, 0.0997, 0.1000,
         0.1006],
        [0.1001, 0.1008, 0.0995, 0.0999, 0.0995, 0.0999, 0.0999, 0.0998, 0.1001,
         0.1005],
        [0.1002, 0.1008, 0.0996, 0.0999, 0.0994, 0.0998, 0.0999, 0.0997, 0.1002,
         0.1006],
        [0.1001, 0.1008, 0.0995, 0.1000, 0.0995, 0.0999, 0.0999, 0.0997, 0.1001,
         0.1005],
        [0.1002, 0.1008, 0.0995, 0.1000, 0.0994, 0.0998, 0.0998, 0.0996, 0.1001,
         0.1007],
        [0.1001, 0.1006, 0.0996, 0.0999, 0.0995, 0.0999, 0.1000, 0.0997, 0.1001,
         0.1004],
        [0.1001, 0.1007, 0.0996, 0.0999, 0.0995, 0.0998, 0.1000, 0.0998, 0.1000,
         0.1005],
        [0.1002, 0.1009, 0.0995, 0.0999, 0.0993, 0.0999, 0.0998, 0.0997, 0.1001,
         0.1006],
        [0.1001, 0.1008, 0.0996, 0.0999, 0.0995, 0.0998, 0.0999, 0.0997, 0.1000,
         0.1006]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1247, 0.1261, 0.1258, 0.1244, 0.1250, 0.1257, 0.1233, 0.1250],
        [0.1245, 0.1261, 0.1259, 0.1245, 0.1249, 0.1258, 0.1234, 0.1250],
        [0.1246, 0.1259, 0.1259, 0.1244, 0.1251, 0.1257, 0.1234, 0.1250],
        [0.1248, 0.1260, 0.1258, 0.1244, 0.1251, 0.1256, 0.1233, 0.1250],
        [0.1247, 0.1260, 0.1258, 0.1244, 0.1250, 0.1258, 0.1234, 0.1249],
        [0.1245, 0.1260, 0.1259, 0.1245, 0.1249, 0.1257, 0.1234, 0.1249],
        [0.1245, 0.1261, 0.1259, 0.1244, 0.1248, 0.1258, 0.1234, 0.1251],
        [0.1247, 0.1260, 0.1258, 0.1246, 0.1249, 0.1257, 0.1234, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0500, 0.0499, 0.0502, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0501, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0497],
        [0.0502, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0499, 0.0502, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0498, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0498, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0502, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0498, 0.0501, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0498, 0.0499],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0498, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0502, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0498, 0.0500],
        [0.0502, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0498, 0.0500, 0.0502, 0.0503, 0.0498, 0.0500, 0.0498, 0.0497,
         0.0498, 0.0498, 0.0503, 0.0498, 0.0502, 0.0506, 0.0501, 0.0499, 0.0505,
         0.0498, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0769, 0.0763, 0.0770, 0.0767, 0.0768, 0.0763, 0.0775, 0.0770, 0.0772,
         0.0776, 0.0771, 0.0768, 0.0769],
        [0.0768, 0.0764, 0.0771, 0.0766, 0.0768, 0.0764, 0.0775, 0.0770, 0.0771,
         0.0776, 0.0771, 0.0767, 0.0769],
        [0.0768, 0.0764, 0.0771, 0.0766, 0.0769, 0.0764, 0.0774, 0.0770, 0.0771,
         0.0775, 0.0771, 0.0767, 0.0769],
        [0.0769, 0.0764, 0.0771, 0.0766, 0.0767, 0.0763, 0.0774, 0.0770, 0.0772,
         0.0776, 0.0771, 0.0768, 0.0768],
        [0.0769, 0.0764, 0.0770, 0.0767, 0.0767, 0.0764, 0.0775, 0.0769, 0.0773,
         0.0777, 0.0769, 0.0768, 0.0769],
        [0.0769, 0.0764, 0.0771, 0.0767, 0.0767, 0.0765, 0.0775, 0.0769, 0.0772,
         0.0776, 0.0770, 0.0768, 0.0768],
        [0.0769, 0.0763, 0.0769, 0.0765, 0.0768, 0.0763, 0.0775, 0.0769, 0.0773,
         0.0777, 0.0770, 0.0769, 0.0770],
        [0.0768, 0.0765, 0.0770, 0.0767, 0.0767, 0.0765, 0.0774, 0.0769, 0.0771,
         0.0776, 0.0770, 0.0768, 0.0769],
        [0.0769, 0.0764, 0.0771, 0.0766, 0.0768, 0.0764, 0.0774, 0.0769, 0.0771,
         0.0776, 0.0770, 0.0769, 0.0770],
        [0.0768, 0.0765, 0.0771, 0.0766, 0.0767, 0.0764, 0.0775, 0.0769, 0.0772,
         0.0775, 0.0771, 0.0769, 0.0769],
        [0.0769, 0.0764, 0.0768, 0.0766, 0.0768, 0.0765, 0.0775, 0.0769, 0.0773,
         0.0776, 0.0770, 0.0768, 0.0770],
        [0.0769, 0.0764, 0.0769, 0.0766, 0.0768, 0.0763, 0.0775, 0.0771, 0.0771,
         0.0776, 0.0771, 0.0768, 0.0769],
        [0.0768, 0.0764, 0.0771, 0.0766, 0.0768, 0.0764, 0.0775, 0.0769, 0.0772,
         0.0777, 0.0770, 0.0768, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0916, 0.0911, 0.0915, 0.0914, 0.0896, 0.0911, 0.0901, 0.0913, 0.0909,
         0.0912, 0.0902],
        [0.0916, 0.0912, 0.0916, 0.0914, 0.0896, 0.0909, 0.0901, 0.0913, 0.0908,
         0.0912, 0.0903],
        [0.0917, 0.0912, 0.0916, 0.0915, 0.0895, 0.0909, 0.0901, 0.0913, 0.0909,
         0.0911, 0.0902],
        [0.0916, 0.0911, 0.0916, 0.0915, 0.0896, 0.0910, 0.0901, 0.0913, 0.0909,
         0.0911, 0.0902],
        [0.0916, 0.0910, 0.0916, 0.0915, 0.0896, 0.0910, 0.0902, 0.0913, 0.0909,
         0.0912, 0.0902],
        [0.0915, 0.0910, 0.0915, 0.0915, 0.0897, 0.0911, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0902],
        [0.0916, 0.0911, 0.0916, 0.0915, 0.0896, 0.0910, 0.0900, 0.0914, 0.0909,
         0.0911, 0.0902],
        [0.0916, 0.0912, 0.0917, 0.0914, 0.0896, 0.0909, 0.0901, 0.0912, 0.0909,
         0.0911, 0.0903],
        [0.0915, 0.0911, 0.0915, 0.0915, 0.0896, 0.0910, 0.0901, 0.0913, 0.0909,
         0.0912, 0.0902],
        [0.0917, 0.0911, 0.0916, 0.0915, 0.0896, 0.0909, 0.0901, 0.0914, 0.0909,
         0.0911, 0.0902],
        [0.0916, 0.0911, 0.0915, 0.0914, 0.0897, 0.0909, 0.0902, 0.0913, 0.0908,
         0.0912, 0.0903]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1436, 0.1429, 0.1413, 0.1410, 0.1433, 0.1419, 0.1460],
        [0.1438, 0.1432, 0.1412, 0.1412, 0.1432, 0.1419, 0.1456],
        [0.1438, 0.1429, 0.1414, 0.1410, 0.1434, 0.1419, 0.1457],
        [0.1436, 0.1431, 0.1413, 0.1412, 0.1432, 0.1419, 0.1457],
        [0.1437, 0.1429, 0.1411, 0.1411, 0.1432, 0.1418, 0.1460],
        [0.1437, 0.1427, 0.1413, 0.1412, 0.1431, 0.1418, 0.1463],
        [0.1439, 0.1429, 0.1407, 0.1406, 0.1435, 0.1414, 0.1470]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.30208921432495117s
iter time cost:11.0805025100708s
-------------Round number: 139-------------
Evaluate global model
Averaged Train Loss: 0.4889
Averaged Test Accurancy: 0.7949
Std Test Accurancy: 0.0851
evaluate time cost:5.120984315872192s
clients training time cost:4.841442108154297s
[running kmeans]: 4it [00:00, 363.31it/s, center_shift=0.000000, iteration=4, tol=0.000100]
attn_optimize time cost:0.5071029663085938s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0910, 0.0908, 0.0911, 0.0910, 0.0905, 0.0909, 0.0912, 0.0908, 0.0905,
         0.0912, 0.0909],
        [0.0910, 0.0909, 0.0911, 0.0911, 0.0904, 0.0908, 0.0913, 0.0908, 0.0904,
         0.0914, 0.0909],
        [0.0910, 0.0908, 0.0911, 0.0913, 0.0904, 0.0908, 0.0912, 0.0907, 0.0903,
         0.0913, 0.0909],
        [0.0909, 0.0908, 0.0911, 0.0911, 0.0904, 0.0909, 0.0913, 0.0908, 0.0904,
         0.0914, 0.0909],
        [0.0909, 0.0909, 0.0910, 0.0911, 0.0905, 0.0909, 0.0913, 0.0907, 0.0904,
         0.0914, 0.0909],
        [0.0910, 0.0908, 0.0911, 0.0912, 0.0903, 0.0908, 0.0912, 0.0908, 0.0904,
         0.0913, 0.0910],
        [0.0910, 0.0908, 0.0910, 0.0911, 0.0904, 0.0909, 0.0914, 0.0907, 0.0904,
         0.0914, 0.0909],
        [0.0911, 0.0908, 0.0910, 0.0912, 0.0903, 0.0909, 0.0913, 0.0907, 0.0904,
         0.0913, 0.0910],
        [0.0911, 0.0909, 0.0911, 0.0913, 0.0904, 0.0908, 0.0913, 0.0907, 0.0902,
         0.0912, 0.0911],
        [0.0910, 0.0908, 0.0911, 0.0911, 0.0904, 0.0909, 0.0913, 0.0907, 0.0904,
         0.0913, 0.0909],
        [0.0911, 0.0908, 0.0911, 0.0911, 0.0904, 0.0908, 0.0912, 0.0908, 0.0904,
         0.0913, 0.0910]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1438, 0.1426, 0.1415, 0.1412, 0.1431, 0.1419, 0.1459],
        [0.1440, 0.1430, 0.1413, 0.1413, 0.1430, 0.1419, 0.1454],
        [0.1440, 0.1426, 0.1416, 0.1412, 0.1432, 0.1419, 0.1455],
        [0.1438, 0.1429, 0.1414, 0.1413, 0.1431, 0.1419, 0.1456],
        [0.1440, 0.1428, 0.1412, 0.1413, 0.1430, 0.1418, 0.1459],
        [0.1438, 0.1425, 0.1414, 0.1414, 0.1429, 0.1418, 0.1461],
        [0.1441, 0.1427, 0.1408, 0.1408, 0.1433, 0.1415, 0.1468]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0526, 0.0525, 0.0524, 0.0525,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0527, 0.0526, 0.0526, 0.0524, 0.0525,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0529, 0.0530,
         0.0527],
        [0.0528, 0.0532, 0.0519, 0.0524, 0.0525, 0.0524, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0524, 0.0527, 0.0526, 0.0530, 0.0529,
         0.0529],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0528, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0531, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0526, 0.0525, 0.0523, 0.0526,
         0.0525, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0527, 0.0530, 0.0529,
         0.0529],
        [0.0527, 0.0531, 0.0520, 0.0526, 0.0526, 0.0525, 0.0525, 0.0524, 0.0526,
         0.0527, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0526, 0.0530, 0.0528,
         0.0530],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0527, 0.0526, 0.0526, 0.0523, 0.0525,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0528, 0.0526, 0.0526, 0.0523, 0.0525,
         0.0525, 0.0527, 0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0527],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0521, 0.0525, 0.0527, 0.0525, 0.0525, 0.0523, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0528,
         0.0529],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0523, 0.0525,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0531, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0519, 0.0524, 0.0527, 0.0526, 0.0526, 0.0523, 0.0525,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0530, 0.0530,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0528, 0.0525, 0.0526, 0.0524, 0.0525,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0525, 0.0526, 0.0530, 0.0529,
         0.0529],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0525,
         0.0527, 0.0527, 0.0527, 0.0525, 0.0526, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0527],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0526, 0.0523, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0525,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0524, 0.0526, 0.0526, 0.0531, 0.0529,
         0.0529],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0525,
         0.0526, 0.0527, 0.0528, 0.0526, 0.0526, 0.0525, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0526, 0.0524, 0.0525, 0.0523, 0.0525,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0524, 0.0527, 0.0526, 0.0531, 0.0529,
         0.0529]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0507, 0.0503, 0.0507, 0.0506, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0492, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0503, 0.0497, 0.0500, 0.0504, 0.0502, 0.0503, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0489],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0501, 0.0503, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0506, 0.0503, 0.0505, 0.0504, 0.0503, 0.0502, 0.0493, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0497, 0.0492],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0507, 0.0504, 0.0506, 0.0505, 0.0504, 0.0502, 0.0493, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0505, 0.0502, 0.0503, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0493, 0.0497,
         0.0501, 0.0496, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0503, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0506, 0.0502, 0.0506, 0.0504, 0.0503, 0.0502, 0.0493, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0504, 0.0502, 0.0503, 0.0493, 0.0499, 0.0502,
         0.0497, 0.0491],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0503, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0505, 0.0502, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0485],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0504, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0498, 0.0504, 0.0502, 0.0503, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0501, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0497, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0503, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0505, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0500, 0.0508, 0.0502, 0.0506, 0.0507, 0.0504, 0.0504, 0.0491, 0.0499,
         0.0502, 0.0494, 0.0498, 0.0506, 0.0502, 0.0502, 0.0491, 0.0499, 0.0501,
         0.0496, 0.0488]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1994, 0.2006, 0.1999, 0.1993, 0.2009],
        [0.1993, 0.2007, 0.1999, 0.1993, 0.2007],
        [0.1994, 0.2007, 0.1998, 0.1991, 0.2009],
        [0.1993, 0.2007, 0.2000, 0.1993, 0.2006],
        [0.1995, 0.2005, 0.2002, 0.1993, 0.2006]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1251, 0.1249, 0.1255, 0.1246, 0.1251, 0.1254, 0.1245],
        [0.1249, 0.1250, 0.1248, 0.1254, 0.1246, 0.1252, 0.1256, 0.1244],
        [0.1251, 0.1249, 0.1249, 0.1256, 0.1248, 0.1249, 0.1254, 0.1244],
        [0.1250, 0.1253, 0.1248, 0.1255, 0.1248, 0.1250, 0.1252, 0.1245],
        [0.1248, 0.1250, 0.1250, 0.1255, 0.1249, 0.1249, 0.1253, 0.1246],
        [0.1250, 0.1250, 0.1249, 0.1253, 0.1249, 0.1249, 0.1255, 0.1246],
        [0.1249, 0.1249, 0.1249, 0.1256, 0.1248, 0.1248, 0.1254, 0.1246],
        [0.1249, 0.1250, 0.1248, 0.1253, 0.1249, 0.1252, 0.1253, 0.1245]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1249, 0.1246, 0.1253, 0.1251, 0.1260, 0.1250, 0.1244, 0.1247],
        [0.1249, 0.1244, 0.1254, 0.1254, 0.1260, 0.1248, 0.1245, 0.1246],
        [0.1249, 0.1246, 0.1253, 0.1252, 0.1261, 0.1248, 0.1245, 0.1246],
        [0.1250, 0.1245, 0.1252, 0.1251, 0.1260, 0.1248, 0.1246, 0.1247],
        [0.1249, 0.1245, 0.1254, 0.1251, 0.1258, 0.1251, 0.1246, 0.1247],
        [0.1249, 0.1246, 0.1254, 0.1252, 0.1258, 0.1248, 0.1245, 0.1248],
        [0.1249, 0.1246, 0.1253, 0.1251, 0.1260, 0.1249, 0.1245, 0.1246],
        [0.1248, 0.1246, 0.1254, 0.1252, 0.1261, 0.1249, 0.1245, 0.1247]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0500, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0500, 0.0501, 0.0505, 0.0501, 0.0498, 0.0505,
         0.0499, 0.0497],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0500, 0.0500, 0.0500, 0.0504, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0499],
        [0.0502, 0.0498, 0.0500, 0.0502, 0.0501, 0.0499, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0502, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0504, 0.0501, 0.0498, 0.0505,
         0.0500, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0499, 0.0501, 0.0502, 0.0499, 0.0501, 0.0500, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0500, 0.0500, 0.0504, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0502, 0.0501, 0.0499, 0.0500, 0.0499, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0500, 0.0500, 0.0504, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0500, 0.0500, 0.0499, 0.0504, 0.0500, 0.0497, 0.0505,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0504, 0.0501, 0.0498, 0.0506,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0497, 0.0500, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0501, 0.0499, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0500, 0.0500, 0.0504, 0.0501, 0.0498, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0500, 0.0500, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0500, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0502, 0.0502, 0.0498, 0.0500, 0.0498, 0.0497,
         0.0498, 0.0498, 0.0502, 0.0499, 0.0502, 0.0508, 0.0502, 0.0499, 0.0505,
         0.0499, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.4103727340698242s
iter time cost:10.98456597328186s
-------------Round number: 140-------------
Evaluate global model
Averaged Train Loss: 0.2828
Averaged Test Accurancy: 0.8158
Std Test Accurancy: 0.0787
evaluate time cost:5.487262964248657s
[running kmeans]: 6it [00:00, 333.05it/s, center_shift=0.000000, iteration=6, tol=0.000100]
clients training time cost:4.898860931396484s
attn_optimize time cost:0.6188044548034668s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2515, 0.2509, 0.2520, 0.2456],
        [0.2512, 0.2504, 0.2516, 0.2468],
        [0.2510, 0.2503, 0.2515, 0.2472],
        [0.2519, 0.2514, 0.2510, 0.2457]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0669, 0.0667, 0.0669, 0.0666, 0.0667, 0.0665, 0.0666, 0.0668, 0.0667,
         0.0664, 0.0664, 0.0666, 0.0671, 0.0667, 0.0663],
        [0.0669, 0.0668, 0.0668, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0663, 0.0664, 0.0666, 0.0672, 0.0667, 0.0664],
        [0.0668, 0.0668, 0.0669, 0.0666, 0.0669, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0662, 0.0663, 0.0666, 0.0671, 0.0668, 0.0663],
        [0.0668, 0.0667, 0.0668, 0.0667, 0.0669, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0664, 0.0664, 0.0666, 0.0672, 0.0668, 0.0663],
        [0.0668, 0.0668, 0.0668, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0667,
         0.0663, 0.0663, 0.0667, 0.0672, 0.0667, 0.0663],
        [0.0668, 0.0668, 0.0668, 0.0666, 0.0668, 0.0665, 0.0666, 0.0669, 0.0666,
         0.0663, 0.0664, 0.0666, 0.0672, 0.0668, 0.0663],
        [0.0668, 0.0667, 0.0668, 0.0667, 0.0669, 0.0663, 0.0666, 0.0668, 0.0666,
         0.0663, 0.0665, 0.0666, 0.0671, 0.0668, 0.0664],
        [0.0668, 0.0668, 0.0667, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0663, 0.0664, 0.0665, 0.0672, 0.0667, 0.0664],
        [0.0669, 0.0668, 0.0668, 0.0666, 0.0668, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0663, 0.0664, 0.0666, 0.0671, 0.0668, 0.0662],
        [0.0669, 0.0668, 0.0668, 0.0666, 0.0669, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0662, 0.0664, 0.0666, 0.0671, 0.0669, 0.0662],
        [0.0669, 0.0668, 0.0668, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0665,
         0.0664, 0.0664, 0.0666, 0.0672, 0.0668, 0.0662],
        [0.0668, 0.0668, 0.0668, 0.0666, 0.0669, 0.0664, 0.0667, 0.0669, 0.0667,
         0.0663, 0.0665, 0.0667, 0.0670, 0.0667, 0.0663],
        [0.0669, 0.0668, 0.0668, 0.0666, 0.0668, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0663, 0.0664, 0.0666, 0.0671, 0.0667, 0.0664],
        [0.0669, 0.0668, 0.0668, 0.0667, 0.0668, 0.0664, 0.0666, 0.0668, 0.0666,
         0.0664, 0.0664, 0.0665, 0.0671, 0.0668, 0.0664],
        [0.0668, 0.0667, 0.0668, 0.0667, 0.0668, 0.0664, 0.0666, 0.0669, 0.0666,
         0.0663, 0.0664, 0.0667, 0.0672, 0.0668, 0.0663]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0501, 0.0505, 0.0494, 0.0499, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0502, 0.0492],
        [0.0501, 0.0505, 0.0494, 0.0498, 0.0501, 0.0500, 0.0501, 0.0498, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0503, 0.0504,
         0.0501, 0.0495],
        [0.0502, 0.0506, 0.0494, 0.0498, 0.0499, 0.0499, 0.0501, 0.0498, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501, 0.0504, 0.0503,
         0.0503, 0.0489],
        [0.0501, 0.0505, 0.0494, 0.0498, 0.0500, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0502, 0.0493],
        [0.0501, 0.0505, 0.0495, 0.0499, 0.0501, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0503, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0500, 0.0504, 0.0502,
         0.0503, 0.0491],
        [0.0501, 0.0505, 0.0494, 0.0498, 0.0501, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0504,
         0.0501, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0497],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0501, 0.0500, 0.0501, 0.0497, 0.0499,
         0.0499, 0.0501, 0.0501, 0.0500, 0.0500, 0.0498, 0.0500, 0.0504, 0.0504,
         0.0501, 0.0496],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0501, 0.0493],
        [0.0501, 0.0505, 0.0495, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0502,
         0.0503, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0505, 0.0503,
         0.0501, 0.0495],
        [0.0501, 0.0505, 0.0493, 0.0498, 0.0501, 0.0500, 0.0500, 0.0497, 0.0499,
         0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0504, 0.0504,
         0.0502, 0.0495],
        [0.0501, 0.0505, 0.0494, 0.0498, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0503, 0.0494],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0493],
        [0.0501, 0.0505, 0.0494, 0.0498, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0502, 0.0493],
        [0.0501, 0.0505, 0.0493, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0499,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0505, 0.0503,
         0.0503, 0.0493],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0501, 0.0499, 0.0501, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0502, 0.0492],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0500, 0.0498, 0.0500, 0.0497, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0502, 0.0493],
        [0.0500, 0.0507, 0.0491, 0.0498, 0.0502, 0.0498, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0499, 0.0499, 0.0508, 0.0503,
         0.0508, 0.0492]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1429, 0.1423, 0.1435, 0.1430, 0.1431, 0.1425, 0.1427],
        [0.1429, 0.1422, 0.1436, 0.1433, 0.1428, 0.1426, 0.1426],
        [0.1429, 0.1423, 0.1435, 0.1432, 0.1428, 0.1426, 0.1426],
        [0.1429, 0.1423, 0.1435, 0.1430, 0.1429, 0.1427, 0.1427],
        [0.1428, 0.1424, 0.1435, 0.1432, 0.1429, 0.1425, 0.1428],
        [0.1428, 0.1424, 0.1435, 0.1430, 0.1430, 0.1426, 0.1427],
        [0.1427, 0.1424, 0.1436, 0.1432, 0.1429, 0.1425, 0.1427]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1438, 0.1429, 0.1416, 0.1411, 0.1431, 0.1417, 0.1459],
        [0.1440, 0.1432, 0.1414, 0.1412, 0.1430, 0.1417, 0.1455],
        [0.1440, 0.1429, 0.1417, 0.1411, 0.1432, 0.1416, 0.1456],
        [0.1438, 0.1431, 0.1415, 0.1412, 0.1430, 0.1417, 0.1456],
        [0.1440, 0.1430, 0.1413, 0.1412, 0.1430, 0.1416, 0.1459],
        [0.1439, 0.1428, 0.1415, 0.1413, 0.1428, 0.1416, 0.1461],
        [0.1442, 0.1430, 0.1410, 0.1406, 0.1432, 0.1412, 0.1468]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1660, 0.1668, 0.1661, 0.1657, 0.1671, 0.1683],
        [0.1660, 0.1670, 0.1662, 0.1658, 0.1670, 0.1682],
        [0.1660, 0.1669, 0.1661, 0.1655, 0.1671, 0.1684],
        [0.1659, 0.1669, 0.1662, 0.1658, 0.1669, 0.1683],
        [0.1661, 0.1667, 0.1664, 0.1657, 0.1668, 0.1683],
        [0.1662, 0.1670, 0.1661, 0.1656, 0.1668, 0.1683]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2000, 0.2010, 0.2003, 0.2011, 0.1976],
        [0.2005, 0.2013, 0.2001, 0.2005, 0.1975],
        [0.2002, 0.2010, 0.2001, 0.2011, 0.1976],
        [0.1999, 0.2015, 0.2000, 0.2010, 0.1976],
        [0.1991, 0.2014, 0.2009, 0.2012, 0.1974]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0616, 0.0627, 0.0620,
         0.0628, 0.0626, 0.0627, 0.0615, 0.0622, 0.0628, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0628, 0.0627, 0.0616, 0.0625, 0.0620,
         0.0628, 0.0625, 0.0627, 0.0616, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0627, 0.0630, 0.0629, 0.0628, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0628, 0.0625, 0.0627, 0.0617, 0.0622, 0.0627, 0.0620],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0628, 0.0631, 0.0630, 0.0628, 0.0627, 0.0615, 0.0626, 0.0619,
         0.0630, 0.0626, 0.0627, 0.0614, 0.0622, 0.0626, 0.0621],
        [0.0631, 0.0626, 0.0630, 0.0630, 0.0627, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0630, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0626, 0.0630, 0.0629, 0.0627, 0.0626, 0.0617, 0.0626, 0.0621,
         0.0629, 0.0626, 0.0626, 0.0615, 0.0622, 0.0628, 0.0621],
        [0.0630, 0.0626, 0.0630, 0.0629, 0.0627, 0.0626, 0.0618, 0.0627, 0.0621,
         0.0628, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0630, 0.0626, 0.0630, 0.0630, 0.0627, 0.0627, 0.0617, 0.0626, 0.0620,
         0.0630, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0620],
        [0.0630, 0.0627, 0.0631, 0.0629, 0.0627, 0.0626, 0.0617, 0.0626, 0.0620,
         0.0628, 0.0626, 0.0627, 0.0616, 0.0622, 0.0628, 0.0621],
        [0.0630, 0.0627, 0.0630, 0.0630, 0.0627, 0.0627, 0.0617, 0.0627, 0.0620,
         0.0629, 0.0626, 0.0626, 0.0615, 0.0622, 0.0628, 0.0620],
        [0.0630, 0.0627, 0.0631, 0.0630, 0.0627, 0.0627, 0.0616, 0.0626, 0.0619,
         0.0630, 0.0626, 0.0626, 0.0615, 0.0622, 0.0627, 0.0621],
        [0.0631, 0.0627, 0.0631, 0.0630, 0.0628, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0628, 0.0626, 0.0626, 0.0614, 0.0623, 0.0627, 0.0620],
        [0.0630, 0.0627, 0.0630, 0.0630, 0.0628, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0629, 0.0625, 0.0626, 0.0615, 0.0622, 0.0628, 0.0620],
        [0.0631, 0.0627, 0.0630, 0.0629, 0.0628, 0.0627, 0.0616, 0.0626, 0.0620,
         0.0629, 0.0626, 0.0627, 0.0615, 0.0622, 0.0627, 0.0620],
        [0.0630, 0.0627, 0.0630, 0.0629, 0.0627, 0.0627, 0.0617, 0.0626, 0.0621,
         0.0629, 0.0625, 0.0626, 0.0616, 0.0622, 0.0628, 0.0621]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1427, 0.1426, 0.1425, 0.1422, 0.1443, 0.1422],
        [0.1433, 0.1424, 0.1428, 0.1423, 0.1423, 0.1444, 0.1425],
        [0.1430, 0.1425, 0.1431, 0.1427, 0.1420, 0.1442, 0.1425],
        [0.1434, 0.1426, 0.1430, 0.1427, 0.1421, 0.1443, 0.1420],
        [0.1432, 0.1425, 0.1429, 0.1425, 0.1421, 0.1442, 0.1425],
        [0.1433, 0.1424, 0.1430, 0.1425, 0.1421, 0.1442, 0.1424],
        [0.1439, 0.1425, 0.1431, 0.1425, 0.1423, 0.1444, 0.1413]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0772, 0.0768, 0.0769, 0.0772, 0.0765, 0.0767, 0.0771, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0766, 0.0766, 0.0772, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0772, 0.0766, 0.0766, 0.0772, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0772, 0.0766, 0.0767, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0772, 0.0765, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0775, 0.0769, 0.0767, 0.0768],
        [0.0772, 0.0767, 0.0769, 0.0771, 0.0767, 0.0766, 0.0772, 0.0769, 0.0770,
         0.0774, 0.0769, 0.0766, 0.0768],
        [0.0772, 0.0767, 0.0769, 0.0772, 0.0766, 0.0766, 0.0772, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0768],
        [0.0772, 0.0768, 0.0769, 0.0772, 0.0765, 0.0766, 0.0772, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0766, 0.0766, 0.0772, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0772, 0.0766, 0.0766, 0.0772, 0.0768, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0768],
        [0.0772, 0.0767, 0.0769, 0.0772, 0.0766, 0.0766, 0.0771, 0.0768, 0.0770,
         0.0774, 0.0770, 0.0767, 0.0768],
        [0.0772, 0.0768, 0.0769, 0.0772, 0.0766, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0767, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0766, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0773, 0.0769, 0.0767, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2698075771331787s
iter time cost:11.359813928604126s
-------------Round number: 141-------------
Evaluate global model
Averaged Train Loss: 0.2908
Averaged Test Accurancy: 0.8133
Std Test Accurancy: 0.0781
evaluate time cost:5.338552951812744s
[running kmeans]: 7it [00:00, 317.89it/s, center_shift=0.000000, iteration=7, tol=0.000100]
clients training time cost:4.958083152770996s
attn_optimize time cost:0.5014553070068359s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0527, 0.0531, 0.0520, 0.0525, 0.0526, 0.0525, 0.0525, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0525,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0526, 0.0529, 0.0530,
         0.0527],
        [0.0528, 0.0532, 0.0519, 0.0524, 0.0525, 0.0524, 0.0526, 0.0524, 0.0527,
         0.0527, 0.0527, 0.0526, 0.0526, 0.0524, 0.0527, 0.0526, 0.0530, 0.0529,
         0.0529],
        [0.0527, 0.0531, 0.0519, 0.0524, 0.0526, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0525, 0.0523, 0.0526,
         0.0525, 0.0526, 0.0527, 0.0527, 0.0525, 0.0525, 0.0527, 0.0530, 0.0530,
         0.0530],
        [0.0527, 0.0531, 0.0520, 0.0526, 0.0526, 0.0524, 0.0525, 0.0525, 0.0527,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0527, 0.0526, 0.0530, 0.0528,
         0.0530],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0527, 0.0525, 0.0525, 0.0523, 0.0526,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0528],
        [0.0527, 0.0531, 0.0520, 0.0524, 0.0527, 0.0524, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0526, 0.0525, 0.0527, 0.0530, 0.0530,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0528, 0.0526, 0.0526, 0.0523, 0.0525,
         0.0525, 0.0527, 0.0527, 0.0527, 0.0526, 0.0524, 0.0526, 0.0530, 0.0530,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0525, 0.0526, 0.0530, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0521, 0.0525, 0.0527, 0.0525, 0.0525, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0530, 0.0529,
         0.0529],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0525, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0526, 0.0531, 0.0529,
         0.0528],
        [0.0527, 0.0531, 0.0519, 0.0524, 0.0527, 0.0525, 0.0525, 0.0523, 0.0525,
         0.0526, 0.0527, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0528],
        [0.0527, 0.0530, 0.0520, 0.0524, 0.0528, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0526, 0.0527, 0.0526, 0.0526, 0.0525, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0529],
        [0.0527, 0.0530, 0.0520, 0.0525, 0.0527, 0.0525, 0.0526, 0.0524, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0526, 0.0526, 0.0526, 0.0529, 0.0529,
         0.0527],
        [0.0528, 0.0531, 0.0520, 0.0524, 0.0526, 0.0525, 0.0526, 0.0523, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0528],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0527, 0.0525, 0.0525, 0.0524, 0.0525,
         0.0527, 0.0526, 0.0527, 0.0527, 0.0524, 0.0525, 0.0526, 0.0531, 0.0529,
         0.0529],
        [0.0527, 0.0531, 0.0520, 0.0525, 0.0527, 0.0525, 0.0525, 0.0524, 0.0526,
         0.0526, 0.0526, 0.0527, 0.0527, 0.0526, 0.0525, 0.0526, 0.0530, 0.0530,
         0.0528],
        [0.0527, 0.0531, 0.0519, 0.0525, 0.0526, 0.0524, 0.0525, 0.0523, 0.0526,
         0.0527, 0.0527, 0.0527, 0.0526, 0.0524, 0.0527, 0.0526, 0.0531, 0.0529,
         0.0529]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0916, 0.0911, 0.0915, 0.0914, 0.0896, 0.0910, 0.0901, 0.0913, 0.0909,
         0.0912, 0.0902],
        [0.0916, 0.0912, 0.0916, 0.0914, 0.0896, 0.0908, 0.0901, 0.0913, 0.0908,
         0.0912, 0.0903],
        [0.0917, 0.0912, 0.0916, 0.0915, 0.0895, 0.0909, 0.0901, 0.0913, 0.0909,
         0.0911, 0.0901],
        [0.0916, 0.0911, 0.0916, 0.0915, 0.0896, 0.0909, 0.0901, 0.0913, 0.0909,
         0.0911, 0.0902],
        [0.0916, 0.0910, 0.0916, 0.0915, 0.0896, 0.0910, 0.0902, 0.0913, 0.0909,
         0.0912, 0.0901],
        [0.0916, 0.0910, 0.0915, 0.0915, 0.0897, 0.0911, 0.0902, 0.0913, 0.0910,
         0.0911, 0.0902],
        [0.0916, 0.0911, 0.0916, 0.0915, 0.0896, 0.0910, 0.0901, 0.0914, 0.0909,
         0.0911, 0.0901],
        [0.0916, 0.0912, 0.0917, 0.0914, 0.0896, 0.0909, 0.0901, 0.0912, 0.0909,
         0.0912, 0.0903],
        [0.0916, 0.0911, 0.0916, 0.0915, 0.0896, 0.0910, 0.0901, 0.0913, 0.0909,
         0.0912, 0.0901],
        [0.0917, 0.0911, 0.0916, 0.0915, 0.0896, 0.0909, 0.0901, 0.0914, 0.0909,
         0.0911, 0.0902],
        [0.0916, 0.0911, 0.0916, 0.0914, 0.0896, 0.0909, 0.0902, 0.0913, 0.0908,
         0.0912, 0.0902]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0499, 0.0502, 0.0496, 0.0501, 0.0495, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0501, 0.0501, 0.0501, 0.0504, 0.0498, 0.0502, 0.0498,
         0.0500, 0.0509],
        [0.0499, 0.0502, 0.0496, 0.0500, 0.0495, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0502, 0.0501, 0.0501, 0.0501, 0.0505, 0.0497, 0.0500, 0.0498,
         0.0500, 0.0511],
        [0.0499, 0.0503, 0.0497, 0.0500, 0.0495, 0.0501, 0.0498, 0.0496, 0.0499,
         0.0498, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0495, 0.0501, 0.0494, 0.0501, 0.0499, 0.0495, 0.0498,
         0.0498, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0501, 0.0498,
         0.0501, 0.0509],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0495, 0.0502, 0.0499, 0.0494, 0.0499,
         0.0498, 0.0503, 0.0501, 0.0501, 0.0502, 0.0505, 0.0496, 0.0501, 0.0498,
         0.0500, 0.0509],
        [0.0499, 0.0503, 0.0497, 0.0499, 0.0496, 0.0501, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0501, 0.0500, 0.0501, 0.0503, 0.0497, 0.0502, 0.0498,
         0.0500, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0495, 0.0501, 0.0498, 0.0496, 0.0498,
         0.0497, 0.0503, 0.0501, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0502, 0.0496, 0.0501, 0.0495, 0.0500, 0.0499, 0.0495, 0.0498,
         0.0497, 0.0503, 0.0501, 0.0501, 0.0502, 0.0505, 0.0497, 0.0501, 0.0498,
         0.0502, 0.0510],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0500, 0.0499, 0.0495, 0.0498,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0504, 0.0498, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0501, 0.0499, 0.0495, 0.0498,
         0.0498, 0.0504, 0.0501, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0503, 0.0495, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0502, 0.0505, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0499, 0.0502, 0.0497, 0.0500, 0.0495, 0.0501, 0.0499, 0.0496, 0.0498,
         0.0498, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0508],
        [0.0499, 0.0503, 0.0497, 0.0500, 0.0494, 0.0501, 0.0499, 0.0495, 0.0498,
         0.0498, 0.0503, 0.0501, 0.0501, 0.0502, 0.0504, 0.0496, 0.0501, 0.0498,
         0.0500, 0.0511],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0496, 0.0501, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0501, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0502, 0.0499,
         0.0500, 0.0507],
        [0.0499, 0.0503, 0.0496, 0.0500, 0.0495, 0.0501, 0.0498, 0.0496, 0.0498,
         0.0496, 0.0502, 0.0501, 0.0501, 0.0502, 0.0504, 0.0497, 0.0500, 0.0498,
         0.0500, 0.0512],
        [0.0500, 0.0502, 0.0497, 0.0499, 0.0495, 0.0500, 0.0499, 0.0495, 0.0500,
         0.0498, 0.0504, 0.0501, 0.0500, 0.0502, 0.0504, 0.0496, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0501, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0499, 0.0503, 0.0496, 0.0499, 0.0496, 0.0501, 0.0499, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0505],
        [0.0498, 0.0505, 0.0495, 0.0502, 0.0494, 0.0500, 0.0499, 0.0495, 0.0495,
         0.0497, 0.0501, 0.0500, 0.0504, 0.0502, 0.0505, 0.0497, 0.0499, 0.0497,
         0.0499, 0.0516]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0499, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0501, 0.0500, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0500, 0.0501, 0.0504, 0.0501, 0.0498, 0.0505,
         0.0499, 0.0498],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0499],
        [0.0502, 0.0498, 0.0500, 0.0502, 0.0501, 0.0500, 0.0501, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0498, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0502, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0498, 0.0505,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0503, 0.0500, 0.0499, 0.0499, 0.0496,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0499, 0.0501, 0.0502, 0.0500, 0.0501, 0.0499, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0505,
         0.0498, 0.0500],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0497, 0.0505,
         0.0498, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0506,
         0.0498, 0.0500],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0496,
         0.0499, 0.0497, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0500, 0.0499, 0.0502, 0.0500, 0.0497, 0.0505,
         0.0499, 0.0501],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0502],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0501, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0500, 0.0500, 0.0502, 0.0500, 0.0498, 0.0505,
         0.0499, 0.0499],
        [0.0503, 0.0498, 0.0500, 0.0502, 0.0503, 0.0499, 0.0500, 0.0498, 0.0497,
         0.0498, 0.0498, 0.0503, 0.0499, 0.0502, 0.0506, 0.0502, 0.0499, 0.0505,
         0.0498, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1428, 0.1430, 0.1430, 0.1422, 0.1433, 0.1419, 0.1438],
        [0.1428, 0.1430, 0.1431, 0.1423, 0.1432, 0.1417, 0.1438],
        [0.1427, 0.1430, 0.1429, 0.1423, 0.1433, 0.1420, 0.1439],
        [0.1429, 0.1428, 0.1429, 0.1423, 0.1434, 0.1419, 0.1438],
        [0.1428, 0.1428, 0.1429, 0.1423, 0.1434, 0.1420, 0.1439],
        [0.1429, 0.1430, 0.1432, 0.1423, 0.1433, 0.1417, 0.1437],
        [0.1427, 0.1430, 0.1429, 0.1423, 0.1433, 0.1419, 0.1438]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1247, 0.1262, 0.1258, 0.1244, 0.1250, 0.1257, 0.1233, 0.1250],
        [0.1244, 0.1262, 0.1258, 0.1245, 0.1249, 0.1259, 0.1234, 0.1249],
        [0.1246, 0.1259, 0.1259, 0.1244, 0.1250, 0.1257, 0.1235, 0.1249],
        [0.1248, 0.1261, 0.1258, 0.1244, 0.1250, 0.1257, 0.1233, 0.1249],
        [0.1246, 0.1261, 0.1258, 0.1244, 0.1250, 0.1258, 0.1234, 0.1249],
        [0.1245, 0.1261, 0.1259, 0.1245, 0.1249, 0.1258, 0.1235, 0.1249],
        [0.1244, 0.1262, 0.1259, 0.1244, 0.1248, 0.1258, 0.1234, 0.1251],
        [0.1246, 0.1261, 0.1258, 0.1246, 0.1248, 0.1257, 0.1234, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0838, 0.0833, 0.0831, 0.0834, 0.0835, 0.0832, 0.0835, 0.0832, 0.0832,
         0.0835, 0.0834, 0.0829],
        [0.0836, 0.0833, 0.0832, 0.0833, 0.0833, 0.0832, 0.0836, 0.0831, 0.0834,
         0.0837, 0.0834, 0.0829],
        [0.0837, 0.0833, 0.0831, 0.0834, 0.0833, 0.0831, 0.0835, 0.0831, 0.0835,
         0.0838, 0.0834, 0.0828],
        [0.0837, 0.0833, 0.0831, 0.0833, 0.0834, 0.0832, 0.0836, 0.0831, 0.0833,
         0.0836, 0.0834, 0.0830],
        [0.0838, 0.0832, 0.0831, 0.0833, 0.0834, 0.0832, 0.0836, 0.0832, 0.0834,
         0.0838, 0.0834, 0.0828],
        [0.0838, 0.0834, 0.0831, 0.0833, 0.0832, 0.0832, 0.0837, 0.0832, 0.0832,
         0.0837, 0.0834, 0.0828],
        [0.0838, 0.0833, 0.0833, 0.0833, 0.0833, 0.0831, 0.0836, 0.0832, 0.0833,
         0.0836, 0.0835, 0.0828],
        [0.0836, 0.0832, 0.0832, 0.0833, 0.0834, 0.0832, 0.0836, 0.0833, 0.0833,
         0.0836, 0.0833, 0.0829],
        [0.0837, 0.0834, 0.0831, 0.0834, 0.0834, 0.0832, 0.0834, 0.0832, 0.0833,
         0.0837, 0.0834, 0.0829],
        [0.0837, 0.0833, 0.0830, 0.0833, 0.0833, 0.0832, 0.0837, 0.0832, 0.0832,
         0.0837, 0.0834, 0.0829],
        [0.0837, 0.0833, 0.0832, 0.0832, 0.0834, 0.0832, 0.0836, 0.0830, 0.0833,
         0.0837, 0.0834, 0.0829],
        [0.0836, 0.0833, 0.0832, 0.0833, 0.0834, 0.0831, 0.0835, 0.0833, 0.0835,
         0.0837, 0.0834, 0.0829]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.2778441905975342s
iter time cost:11.159011602401733s
-------------Round number: 142-------------
Evaluate global model
Averaged Train Loss: 0.2885
Averaged Test Accurancy: 0.8153
Std Test Accurancy: 0.0672
evaluate time cost:5.5477941036224365s
clients training time cost:4.953916788101196s
[running kmeans]: 6it [00:00, 272.49it/s, center_shift=0.000000, iteration=6, tol=0.000100]
attn_optimize time cost:0.55082106590271s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.2001, 0.2000, 0.2001, 0.2000, 0.1998],
        [0.2001, 0.2001, 0.2002, 0.1997, 0.1999],
        [0.2002, 0.2000, 0.2000, 0.1999, 0.1999],
        [0.2000, 0.1997, 0.1999, 0.2002, 0.2002],
        [0.2000, 0.1999, 0.1999, 0.2002, 0.2000]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1431, 0.1430, 0.1431, 0.1426, 0.1428, 0.1432, 0.1422],
        [0.1432, 0.1429, 0.1430, 0.1427, 0.1427, 0.1434, 0.1420],
        [0.1431, 0.1429, 0.1432, 0.1426, 0.1428, 0.1434, 0.1420],
        [0.1432, 0.1430, 0.1431, 0.1424, 0.1429, 0.1435, 0.1420],
        [0.1434, 0.1429, 0.1429, 0.1427, 0.1428, 0.1432, 0.1421],
        [0.1433, 0.1429, 0.1431, 0.1423, 0.1429, 0.1433, 0.1422],
        [0.1432, 0.1430, 0.1432, 0.1426, 0.1427, 0.1432, 0.1422]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0772, 0.0769, 0.0769, 0.0772, 0.0765, 0.0767, 0.0771, 0.0769, 0.0769,
         0.0775, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0766, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0775, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0766, 0.0767, 0.0771, 0.0769, 0.0769,
         0.0775, 0.0769, 0.0766, 0.0769],
        [0.0771, 0.0769, 0.0769, 0.0771, 0.0766, 0.0767, 0.0770, 0.0769, 0.0769,
         0.0774, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0772, 0.0765, 0.0767, 0.0770, 0.0768, 0.0769,
         0.0776, 0.0769, 0.0766, 0.0768],
        [0.0772, 0.0767, 0.0769, 0.0770, 0.0767, 0.0766, 0.0771, 0.0769, 0.0770,
         0.0775, 0.0769, 0.0765, 0.0768],
        [0.0772, 0.0768, 0.0769, 0.0772, 0.0766, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0775, 0.0769, 0.0766, 0.0768],
        [0.0772, 0.0769, 0.0769, 0.0772, 0.0765, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0775, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0769, 0.0768, 0.0771, 0.0766, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0775, 0.0769, 0.0765, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0772, 0.0766, 0.0766, 0.0771, 0.0768, 0.0769,
         0.0776, 0.0769, 0.0766, 0.0768],
        [0.0771, 0.0767, 0.0769, 0.0772, 0.0766, 0.0767, 0.0770, 0.0768, 0.0770,
         0.0775, 0.0769, 0.0767, 0.0768],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0765, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0775, 0.0769, 0.0766, 0.0769],
        [0.0772, 0.0768, 0.0769, 0.0771, 0.0766, 0.0766, 0.0771, 0.0769, 0.0769,
         0.0775, 0.0769, 0.0767, 0.0769]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0506, 0.0503, 0.0507, 0.0506, 0.0503, 0.0502, 0.0493, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0492, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0503, 0.0497, 0.0500, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0503, 0.0494, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0505, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0493, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0497, 0.0492],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0504, 0.0506, 0.0506, 0.0504, 0.0503, 0.0493, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0498, 0.0506, 0.0502, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0497, 0.0506, 0.0502, 0.0506, 0.0505, 0.0503, 0.0502, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0499, 0.0506, 0.0502, 0.0506, 0.0505, 0.0503, 0.0502, 0.0493, 0.0497,
         0.0501, 0.0496, 0.0500, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0503, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0497, 0.0505, 0.0502, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0497, 0.0487],
        [0.0498, 0.0506, 0.0502, 0.0506, 0.0505, 0.0503, 0.0503, 0.0493, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0502,
         0.0497, 0.0491],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0503, 0.0502, 0.0503, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0497, 0.0505, 0.0502, 0.0505, 0.0505, 0.0502, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0497, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0485],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0504, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0498, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0497, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0502, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0503, 0.0493, 0.0499, 0.0503,
         0.0497, 0.0489],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0504,
         0.0498, 0.0487],
        [0.0500, 0.0507, 0.0501, 0.0506, 0.0507, 0.0504, 0.0504, 0.0491, 0.0500,
         0.0502, 0.0494, 0.0499, 0.0506, 0.0502, 0.0501, 0.0491, 0.0499, 0.0502,
         0.0496, 0.0488]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0505, 0.0494, 0.0499, 0.0501, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0503, 0.0503,
         0.0502, 0.0492],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0501, 0.0500, 0.0500, 0.0498, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0494],
        [0.0502, 0.0506, 0.0493, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0501, 0.0504, 0.0503,
         0.0503, 0.0489],
        [0.0501, 0.0505, 0.0494, 0.0498, 0.0501, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0493],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0501, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0503, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0501, 0.0504, 0.0502,
         0.0504, 0.0491],
        [0.0501, 0.0505, 0.0494, 0.0498, 0.0501, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0502, 0.0497],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0502, 0.0500, 0.0500, 0.0497, 0.0499,
         0.0499, 0.0501, 0.0501, 0.0500, 0.0500, 0.0498, 0.0501, 0.0503, 0.0504,
         0.0501, 0.0495],
        [0.0501, 0.0504, 0.0495, 0.0499, 0.0502, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0501, 0.0493],
        [0.0501, 0.0505, 0.0495, 0.0499, 0.0501, 0.0500, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0502,
         0.0503, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0502, 0.0494],
        [0.0501, 0.0505, 0.0493, 0.0498, 0.0502, 0.0500, 0.0500, 0.0497, 0.0499,
         0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0503, 0.0504,
         0.0502, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0502, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0503, 0.0493],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0502, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0493],
        [0.0502, 0.0505, 0.0494, 0.0498, 0.0501, 0.0500, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0502, 0.0493],
        [0.0501, 0.0505, 0.0493, 0.0499, 0.0502, 0.0499, 0.0500, 0.0498, 0.0499,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0503, 0.0493],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0501, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0501, 0.0503, 0.0503,
         0.0502, 0.0492],
        [0.0501, 0.0505, 0.0493, 0.0499, 0.0500, 0.0499, 0.0500, 0.0497, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500, 0.0501, 0.0504, 0.0503,
         0.0503, 0.0493],
        [0.0500, 0.0507, 0.0491, 0.0498, 0.0503, 0.0499, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0500, 0.0498, 0.0499, 0.0500, 0.0508, 0.0503,
         0.0508, 0.0492]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1670, 0.1664, 0.1662, 0.1663, 0.1658, 0.1682],
        [0.1670, 0.1661, 0.1665, 0.1662, 0.1659, 0.1684],
        [0.1667, 0.1662, 0.1668, 0.1666, 0.1656, 0.1681],
        [0.1670, 0.1662, 0.1665, 0.1665, 0.1657, 0.1681],
        [0.1669, 0.1662, 0.1666, 0.1664, 0.1657, 0.1682],
        [0.1670, 0.1661, 0.1667, 0.1663, 0.1657, 0.1682]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1432, 0.1424, 0.1428, 0.1433, 0.1424, 0.1421, 0.1437],
        [0.1431, 0.1423, 0.1428, 0.1435, 0.1423, 0.1421, 0.1439],
        [0.1432, 0.1421, 0.1428, 0.1434, 0.1423, 0.1424, 0.1438],
        [0.1432, 0.1422, 0.1429, 0.1435, 0.1422, 0.1421, 0.1439],
        [0.1431, 0.1421, 0.1429, 0.1434, 0.1425, 0.1424, 0.1436],
        [0.1431, 0.1422, 0.1429, 0.1433, 0.1424, 0.1423, 0.1437],
        [0.1432, 0.1422, 0.1428, 0.1434, 0.1422, 0.1423, 0.1438]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0504, 0.0497, 0.0500, 0.0495, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0500, 0.0501, 0.0501, 0.0504, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0495, 0.0499, 0.0499, 0.0494, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0511],
        [0.0500, 0.0504, 0.0498, 0.0499, 0.0495, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0505, 0.0496, 0.0501, 0.0494, 0.0501, 0.0499, 0.0494, 0.0498,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0501, 0.0505, 0.0497, 0.0501, 0.0498,
         0.0500, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0499, 0.0495, 0.0501, 0.0499, 0.0493, 0.0499,
         0.0498, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0496, 0.0501, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0499, 0.0495, 0.0500, 0.0498, 0.0494, 0.0500,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0505, 0.0497, 0.0499, 0.0495, 0.0500, 0.0498, 0.0495, 0.0498,
         0.0496, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0500, 0.0499, 0.0494, 0.0498,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0496, 0.0501, 0.0498,
         0.0501, 0.0510],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0499, 0.0494, 0.0498,
         0.0496, 0.0503, 0.0500, 0.0500, 0.0502, 0.0505, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0509],
        [0.0501, 0.0504, 0.0498, 0.0500, 0.0495, 0.0501, 0.0499, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0498, 0.0500, 0.0495, 0.0500, 0.0499, 0.0495, 0.0498,
         0.0497, 0.0503, 0.0500, 0.0500, 0.0501, 0.0504, 0.0497, 0.0502, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0498, 0.0500, 0.0494, 0.0501, 0.0499, 0.0494, 0.0498,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0504, 0.0496, 0.0501, 0.0499,
         0.0499, 0.0511],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0502, 0.0500, 0.0501, 0.0501, 0.0504, 0.0498, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0498, 0.0499, 0.0495, 0.0501, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0501, 0.0504, 0.0497, 0.0502, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0495, 0.0500, 0.0499, 0.0495, 0.0498,
         0.0496, 0.0502, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0512],
        [0.0501, 0.0503, 0.0498, 0.0499, 0.0495, 0.0499, 0.0499, 0.0494, 0.0500,
         0.0498, 0.0503, 0.0500, 0.0500, 0.0502, 0.0504, 0.0496, 0.0502, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0499, 0.0496, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0501, 0.0505, 0.0498, 0.0502, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0499, 0.0496, 0.0500, 0.0499, 0.0494, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0505],
        [0.0498, 0.0507, 0.0496, 0.0502, 0.0494, 0.0499, 0.0499, 0.0494, 0.0495,
         0.0497, 0.0501, 0.0499, 0.0503, 0.0502, 0.0506, 0.0497, 0.0500, 0.0497,
         0.0499, 0.0516]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.36522555351257324s
iter time cost:11.561888456344604s
-------------Round number: 143-------------
Evaluate global model
Averaged Train Loss: 0.2816
Averaged Test Accurancy: 0.8160
Std Test Accurancy: 0.0728
evaluate time cost:5.084399938583374s
[running kmeans]: 3it [00:00, 333.06it/s, center_shift=0.000000, iteration=3, tol=0.000100]
clients training time cost:5.027747631072998s
attn_optimize time cost:0.5488700866699219s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0499, 0.0498, 0.0506,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0500, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0506,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0502, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0499],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0501, 0.0505, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0497],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0500, 0.0499, 0.0497,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0507,
         0.0499, 0.0499],
        [0.0502, 0.0498, 0.0500, 0.0502, 0.0501, 0.0499, 0.0501, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0498, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0502, 0.0502, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0501, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0497],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0498, 0.0507,
         0.0499, 0.0500],
        [0.0502, 0.0498, 0.0500, 0.0501, 0.0502, 0.0500, 0.0501, 0.0500, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0506,
         0.0498, 0.0500],
        [0.0501, 0.0498, 0.0499, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498,
         0.0499, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0506,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0498,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0498, 0.0500],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0500],
        [0.0501, 0.0499, 0.0499, 0.0501, 0.0502, 0.0500, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0499, 0.0503, 0.0500, 0.0497, 0.0506,
         0.0499, 0.0501],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0497, 0.0506,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0498,
         0.0497, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0499],
        [0.0501, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0497, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0502],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0501, 0.0499, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0499],
        [0.0502, 0.0499, 0.0500, 0.0501, 0.0502, 0.0499, 0.0499, 0.0500, 0.0497,
         0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0503, 0.0500, 0.0498, 0.0506,
         0.0499, 0.0499],
        [0.0502, 0.0497, 0.0500, 0.0502, 0.0503, 0.0498, 0.0500, 0.0498, 0.0497,
         0.0497, 0.0498, 0.0503, 0.0498, 0.0502, 0.0507, 0.0501, 0.0499, 0.0506,
         0.0498, 0.0493]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0910, 0.0904, 0.0909, 0.0907, 0.0908, 0.0904, 0.0915, 0.0912, 0.0913,
         0.0909, 0.0910],
        [0.0909, 0.0905, 0.0910, 0.0906, 0.0908, 0.0905, 0.0915, 0.0912, 0.0912,
         0.0908, 0.0910],
        [0.0909, 0.0904, 0.0911, 0.0906, 0.0909, 0.0905, 0.0915, 0.0912, 0.0912,
         0.0908, 0.0909],
        [0.0909, 0.0905, 0.0911, 0.0906, 0.0907, 0.0904, 0.0915, 0.0912, 0.0912,
         0.0909, 0.0909],
        [0.0910, 0.0905, 0.0910, 0.0908, 0.0907, 0.0904, 0.0916, 0.0911, 0.0911,
         0.0909, 0.0909],
        [0.0910, 0.0904, 0.0910, 0.0907, 0.0907, 0.0905, 0.0916, 0.0911, 0.0911,
         0.0909, 0.0909],
        [0.0911, 0.0903, 0.0909, 0.0905, 0.0909, 0.0903, 0.0916, 0.0911, 0.0912,
         0.0910, 0.0911],
        [0.0909, 0.0905, 0.0910, 0.0907, 0.0907, 0.0905, 0.0915, 0.0911, 0.0912,
         0.0909, 0.0910],
        [0.0910, 0.0904, 0.0908, 0.0906, 0.0908, 0.0906, 0.0916, 0.0910, 0.0912,
         0.0909, 0.0911],
        [0.0910, 0.0905, 0.0908, 0.0906, 0.0909, 0.0903, 0.0915, 0.0913, 0.0912,
         0.0910, 0.0910],
        [0.0909, 0.0904, 0.0911, 0.0907, 0.0908, 0.0904, 0.0916, 0.0911, 0.0912,
         0.0909, 0.0910]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0498, 0.0507, 0.0503, 0.0507, 0.0506, 0.0504, 0.0503, 0.0493, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0505, 0.0502, 0.0502, 0.0492, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0504, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0504, 0.0502, 0.0503, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0506, 0.0504, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0501, 0.0497, 0.0500, 0.0504, 0.0501, 0.0503, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0498, 0.0506, 0.0502, 0.0505, 0.0504, 0.0503, 0.0503, 0.0493, 0.0498,
         0.0501, 0.0497, 0.0500, 0.0503, 0.0501, 0.0502, 0.0494, 0.0499, 0.0502,
         0.0497, 0.0492],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0497, 0.0506, 0.0504, 0.0506, 0.0505, 0.0504, 0.0503, 0.0493, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0505, 0.0502, 0.0503, 0.0493, 0.0499, 0.0502,
         0.0498, 0.0487],
        [0.0497, 0.0506, 0.0502, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0488],
        [0.0497, 0.0506, 0.0502, 0.0506, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0506, 0.0502, 0.0506, 0.0505, 0.0503, 0.0503, 0.0493, 0.0497,
         0.0501, 0.0496, 0.0499, 0.0504, 0.0502, 0.0502, 0.0492, 0.0499, 0.0502,
         0.0498, 0.0490],
        [0.0497, 0.0505, 0.0502, 0.0506, 0.0505, 0.0503, 0.0503, 0.0495, 0.0496,
         0.0503, 0.0498, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0497, 0.0488],
        [0.0498, 0.0506, 0.0502, 0.0506, 0.0504, 0.0504, 0.0503, 0.0493, 0.0497,
         0.0502, 0.0496, 0.0499, 0.0504, 0.0502, 0.0503, 0.0493, 0.0499, 0.0502,
         0.0497, 0.0491],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0500, 0.0503, 0.0502, 0.0503, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0486],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0503, 0.0494, 0.0496,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0497, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0505, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0498, 0.0485],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0504, 0.0503, 0.0494, 0.0496,
         0.0502, 0.0497, 0.0498, 0.0504, 0.0502, 0.0503, 0.0493, 0.0500, 0.0503,
         0.0498, 0.0487],
        [0.0498, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0498,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0502, 0.0493, 0.0499, 0.0503,
         0.0497, 0.0488],
        [0.0497, 0.0506, 0.0503, 0.0506, 0.0505, 0.0503, 0.0503, 0.0494, 0.0497,
         0.0502, 0.0497, 0.0499, 0.0504, 0.0502, 0.0503, 0.0493, 0.0499, 0.0503,
         0.0497, 0.0488],
        [0.0497, 0.0505, 0.0503, 0.0505, 0.0505, 0.0503, 0.0503, 0.0495, 0.0497,
         0.0502, 0.0498, 0.0500, 0.0504, 0.0501, 0.0502, 0.0494, 0.0499, 0.0503,
         0.0498, 0.0487],
        [0.0499, 0.0507, 0.0501, 0.0506, 0.0507, 0.0504, 0.0505, 0.0491, 0.0499,
         0.0502, 0.0494, 0.0499, 0.0506, 0.0502, 0.0502, 0.0491, 0.0500, 0.0501,
         0.0496, 0.0488]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0913, 0.0909, 0.0911, 0.0906, 0.0910, 0.0907, 0.0912, 0.0907, 0.0904,
         0.0913, 0.0908],
        [0.0913, 0.0910, 0.0910, 0.0906, 0.0911, 0.0905, 0.0913, 0.0907, 0.0903,
         0.0914, 0.0908],
        [0.0912, 0.0910, 0.0911, 0.0905, 0.0912, 0.0906, 0.0913, 0.0906, 0.0902,
         0.0914, 0.0908],
        [0.0912, 0.0909, 0.0910, 0.0906, 0.0912, 0.0906, 0.0914, 0.0906, 0.0904,
         0.0914, 0.0908],
        [0.0912, 0.0909, 0.0911, 0.0906, 0.0911, 0.0906, 0.0913, 0.0907, 0.0903,
         0.0914, 0.0908],
        [0.0912, 0.0910, 0.0910, 0.0906, 0.0911, 0.0906, 0.0914, 0.0906, 0.0903,
         0.0914, 0.0908],
        [0.0913, 0.0909, 0.0910, 0.0906, 0.0911, 0.0906, 0.0914, 0.0906, 0.0903,
         0.0914, 0.0908],
        [0.0914, 0.0910, 0.0910, 0.0905, 0.0911, 0.0906, 0.0913, 0.0906, 0.0903,
         0.0914, 0.0909],
        [0.0913, 0.0910, 0.0911, 0.0905, 0.0912, 0.0906, 0.0913, 0.0906, 0.0902,
         0.0913, 0.0910],
        [0.0913, 0.0909, 0.0911, 0.0906, 0.0911, 0.0906, 0.0913, 0.0907, 0.0903,
         0.0914, 0.0908],
        [0.0913, 0.0909, 0.0910, 0.0907, 0.0910, 0.0905, 0.0912, 0.0907, 0.0904,
         0.0914, 0.0909]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2001, 0.1998, 0.1998, 0.2007, 0.1996],
        [0.2002, 0.1997, 0.2001, 0.2009, 0.1992],
        [0.2001, 0.1997, 0.2001, 0.2007, 0.1994],
        [0.2000, 0.1997, 0.2000, 0.2010, 0.1994],
        [0.2000, 0.1995, 0.2003, 0.2008, 0.1994]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1984, 0.2004, 0.2028, 0.2021, 0.1963],
        [0.1984, 0.2002, 0.2023, 0.2021, 0.1970],
        [0.1979, 0.2002, 0.2026, 0.2017, 0.1976],
        [0.1980, 0.2000, 0.2025, 0.2017, 0.1978],
        [0.1966, 0.1994, 0.2036, 0.2036, 0.1968]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2504, 0.2512, 0.2506, 0.2477],
        [0.2510, 0.2514, 0.2501, 0.2475],
        [0.2507, 0.2512, 0.2503, 0.2478],
        [0.2495, 0.2515, 0.2514, 0.2476]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0668, 0.0673, 0.0664, 0.0666, 0.0665, 0.0663, 0.0666, 0.0666, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0665, 0.0666, 0.0670],
        [0.0668, 0.0672, 0.0664, 0.0668, 0.0666, 0.0664, 0.0665, 0.0666, 0.0666,
         0.0667, 0.0666, 0.0667, 0.0664, 0.0666, 0.0671],
        [0.0668, 0.0672, 0.0664, 0.0667, 0.0666, 0.0663, 0.0666, 0.0666, 0.0668,
         0.0667, 0.0666, 0.0665, 0.0665, 0.0667, 0.0671],
        [0.0668, 0.0673, 0.0665, 0.0667, 0.0665, 0.0663, 0.0667, 0.0665, 0.0666,
         0.0667, 0.0667, 0.0665, 0.0664, 0.0668, 0.0671],
        [0.0668, 0.0672, 0.0664, 0.0667, 0.0666, 0.0663, 0.0666, 0.0666, 0.0667,
         0.0668, 0.0666, 0.0667, 0.0664, 0.0667, 0.0671],
        [0.0667, 0.0672, 0.0663, 0.0667, 0.0666, 0.0664, 0.0666, 0.0666, 0.0667,
         0.0666, 0.0666, 0.0667, 0.0665, 0.0667, 0.0671],
        [0.0668, 0.0672, 0.0663, 0.0668, 0.0667, 0.0662, 0.0665, 0.0665, 0.0667,
         0.0667, 0.0666, 0.0667, 0.0664, 0.0667, 0.0672],
        [0.0668, 0.0671, 0.0664, 0.0668, 0.0666, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0665, 0.0665, 0.0665, 0.0667, 0.0670],
        [0.0667, 0.0673, 0.0665, 0.0667, 0.0665, 0.0663, 0.0666, 0.0666, 0.0666,
         0.0668, 0.0666, 0.0665, 0.0665, 0.0666, 0.0670],
        [0.0668, 0.0672, 0.0664, 0.0668, 0.0666, 0.0663, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0665, 0.0665, 0.0665, 0.0666, 0.0670],
        [0.0668, 0.0673, 0.0663, 0.0668, 0.0666, 0.0663, 0.0665, 0.0666, 0.0667,
         0.0667, 0.0667, 0.0667, 0.0664, 0.0666, 0.0672],
        [0.0668, 0.0672, 0.0663, 0.0668, 0.0666, 0.0664, 0.0666, 0.0666, 0.0667,
         0.0666, 0.0665, 0.0665, 0.0665, 0.0667, 0.0671],
        [0.0668, 0.0672, 0.0664, 0.0668, 0.0666, 0.0664, 0.0666, 0.0667, 0.0667,
         0.0667, 0.0665, 0.0666, 0.0665, 0.0666, 0.0670],
        [0.0668, 0.0673, 0.0663, 0.0667, 0.0666, 0.0663, 0.0666, 0.0666, 0.0666,
         0.0667, 0.0666, 0.0666, 0.0664, 0.0667, 0.0671],
        [0.0668, 0.0673, 0.0664, 0.0667, 0.0666, 0.0664, 0.0666, 0.0666, 0.0666,
         0.0668, 0.0666, 0.0666, 0.0664, 0.0666, 0.0671]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1435, 0.1429, 0.1414, 0.1411, 0.1432, 0.1418, 0.1459],
        [0.1438, 0.1432, 0.1413, 0.1412, 0.1432, 0.1418, 0.1455],
        [0.1438, 0.1429, 0.1416, 0.1411, 0.1433, 0.1418, 0.1456],
        [0.1436, 0.1431, 0.1414, 0.1413, 0.1432, 0.1418, 0.1457],
        [0.1438, 0.1430, 0.1412, 0.1412, 0.1431, 0.1418, 0.1459],
        [0.1437, 0.1428, 0.1414, 0.1413, 0.1430, 0.1417, 0.1462],
        [0.1439, 0.1430, 0.1408, 0.1407, 0.1434, 0.1414, 0.1469]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.4983, 0.5017],
        [0.4987, 0.5013]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3022744655609131s
iter time cost:11.045366525650024s
-------------Round number: 144-------------
Evaluate global model
Averaged Train Loss: 0.2943
Averaged Test Accurancy: 0.8125
Std Test Accurancy: 0.0773
evaluate time cost:5.499739170074463s
clients training time cost:4.9219958782196045s
[running kmeans]: 7it [00:00, 411.40it/s, center_shift=0.000000, iteration=7, tol=0.000100]
attn_optimize time cost:0.4486715793609619s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0717, 0.0714, 0.0714, 0.0717, 0.0714, 0.0710, 0.0713, 0.0716, 0.0714,
         0.0715, 0.0719, 0.0714, 0.0711, 0.0713],
        [0.0716, 0.0713, 0.0714, 0.0716, 0.0714, 0.0711, 0.0712, 0.0716, 0.0715,
         0.0715, 0.0718, 0.0715, 0.0712, 0.0714],
        [0.0717, 0.0713, 0.0714, 0.0716, 0.0715, 0.0711, 0.0712, 0.0716, 0.0714,
         0.0715, 0.0718, 0.0715, 0.0711, 0.0713],
        [0.0716, 0.0714, 0.0714, 0.0716, 0.0714, 0.0711, 0.0713, 0.0716, 0.0714,
         0.0714, 0.0718, 0.0714, 0.0712, 0.0714],
        [0.0717, 0.0713, 0.0714, 0.0716, 0.0714, 0.0710, 0.0711, 0.0716, 0.0714,
         0.0715, 0.0719, 0.0715, 0.0711, 0.0713],
        [0.0716, 0.0713, 0.0714, 0.0717, 0.0715, 0.0710, 0.0712, 0.0716, 0.0714,
         0.0715, 0.0719, 0.0715, 0.0712, 0.0713],
        [0.0717, 0.0712, 0.0714, 0.0715, 0.0715, 0.0712, 0.0712, 0.0717, 0.0715,
         0.0715, 0.0719, 0.0715, 0.0711, 0.0713],
        [0.0716, 0.0713, 0.0714, 0.0717, 0.0714, 0.0711, 0.0712, 0.0717, 0.0714,
         0.0715, 0.0718, 0.0715, 0.0712, 0.0713],
        [0.0717, 0.0714, 0.0714, 0.0716, 0.0714, 0.0710, 0.0712, 0.0716, 0.0714,
         0.0715, 0.0719, 0.0714, 0.0712, 0.0713],
        [0.0716, 0.0714, 0.0713, 0.0716, 0.0715, 0.0711, 0.0712, 0.0716, 0.0715,
         0.0714, 0.0719, 0.0715, 0.0711, 0.0714],
        [0.0716, 0.0713, 0.0714, 0.0717, 0.0714, 0.0711, 0.0712, 0.0716, 0.0714,
         0.0715, 0.0719, 0.0715, 0.0711, 0.0713],
        [0.0716, 0.0713, 0.0714, 0.0716, 0.0714, 0.0711, 0.0712, 0.0716, 0.0714,
         0.0715, 0.0718, 0.0715, 0.0712, 0.0713],
        [0.0717, 0.0713, 0.0714, 0.0716, 0.0714, 0.0710, 0.0712, 0.0716, 0.0714,
         0.0715, 0.0718, 0.0715, 0.0712, 0.0714],
        [0.0717, 0.0713, 0.0714, 0.0716, 0.0714, 0.0711, 0.0712, 0.0716, 0.0715,
         0.0715, 0.0718, 0.0715, 0.0712, 0.0713]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1247, 0.1260, 0.1258, 0.1244, 0.1249, 0.1258, 0.1233, 0.1250],
        [0.1244, 0.1261, 0.1259, 0.1246, 0.1248, 0.1259, 0.1233, 0.1249],
        [0.1246, 0.1258, 0.1259, 0.1245, 0.1250, 0.1258, 0.1234, 0.1250],
        [0.1249, 0.1258, 0.1258, 0.1245, 0.1250, 0.1257, 0.1233, 0.1250],
        [0.1247, 0.1260, 0.1258, 0.1244, 0.1249, 0.1259, 0.1234, 0.1249],
        [0.1245, 0.1260, 0.1260, 0.1245, 0.1249, 0.1258, 0.1234, 0.1249],
        [0.1245, 0.1261, 0.1259, 0.1244, 0.1248, 0.1259, 0.1234, 0.1251],
        [0.1247, 0.1260, 0.1258, 0.1247, 0.1248, 0.1258, 0.1234, 0.1249]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0528, 0.0527, 0.0528, 0.0526, 0.0528, 0.0525, 0.0526, 0.0527, 0.0528,
         0.0527, 0.0525, 0.0524, 0.0527, 0.0525, 0.0524, 0.0530, 0.0525, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0528, 0.0527, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0524, 0.0528, 0.0524, 0.0525, 0.0531, 0.0527, 0.0526,
         0.0523],
        [0.0528, 0.0527, 0.0528, 0.0526, 0.0529, 0.0524, 0.0526, 0.0527, 0.0528,
         0.0526, 0.0524, 0.0524, 0.0527, 0.0525, 0.0524, 0.0531, 0.0526, 0.0527,
         0.0522],
        [0.0528, 0.0527, 0.0528, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0525, 0.0524, 0.0528, 0.0524, 0.0525, 0.0530, 0.0526, 0.0527,
         0.0522],
        [0.0528, 0.0527, 0.0528, 0.0527, 0.0528, 0.0524, 0.0525, 0.0527, 0.0528,
         0.0527, 0.0525, 0.0524, 0.0528, 0.0525, 0.0525, 0.0531, 0.0526, 0.0526,
         0.0522],
        [0.0528, 0.0526, 0.0527, 0.0527, 0.0527, 0.0525, 0.0525, 0.0527, 0.0529,
         0.0526, 0.0525, 0.0524, 0.0528, 0.0524, 0.0526, 0.0530, 0.0527, 0.0527,
         0.0522],
        [0.0528, 0.0528, 0.0527, 0.0526, 0.0528, 0.0525, 0.0526, 0.0526, 0.0529,
         0.0526, 0.0524, 0.0524, 0.0528, 0.0525, 0.0524, 0.0531, 0.0526, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0528, 0.0526, 0.0529, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0525, 0.0528, 0.0524, 0.0525, 0.0530, 0.0526, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0527, 0.0527, 0.0528, 0.0525, 0.0525, 0.0527, 0.0529,
         0.0526, 0.0525, 0.0524, 0.0528, 0.0524, 0.0524, 0.0531, 0.0525, 0.0527,
         0.0523],
        [0.0529, 0.0527, 0.0527, 0.0526, 0.0528, 0.0524, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0524, 0.0528, 0.0525, 0.0525, 0.0530, 0.0527, 0.0527,
         0.0522],
        [0.0528, 0.0527, 0.0528, 0.0526, 0.0529, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0523, 0.0524, 0.0529, 0.0524, 0.0526, 0.0530, 0.0527, 0.0528,
         0.0521],
        [0.0529, 0.0527, 0.0527, 0.0527, 0.0528, 0.0525, 0.0525, 0.0527, 0.0529,
         0.0525, 0.0525, 0.0524, 0.0529, 0.0525, 0.0524, 0.0531, 0.0526, 0.0527,
         0.0522],
        [0.0529, 0.0527, 0.0527, 0.0527, 0.0528, 0.0526, 0.0526, 0.0527, 0.0528,
         0.0526, 0.0524, 0.0523, 0.0528, 0.0525, 0.0525, 0.0530, 0.0526, 0.0527,
         0.0522],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0528, 0.0525, 0.0525, 0.0527, 0.0528,
         0.0527, 0.0524, 0.0525, 0.0528, 0.0525, 0.0525, 0.0529, 0.0526, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0527, 0.0527, 0.0528, 0.0525, 0.0525, 0.0527, 0.0528,
         0.0526, 0.0524, 0.0524, 0.0527, 0.0525, 0.0525, 0.0530, 0.0527, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0528, 0.0526, 0.0528, 0.0525, 0.0525, 0.0527, 0.0528,
         0.0526, 0.0524, 0.0524, 0.0528, 0.0524, 0.0525, 0.0530, 0.0525, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0527, 0.0526, 0.0528, 0.0524, 0.0525, 0.0526, 0.0529,
         0.0526, 0.0523, 0.0524, 0.0529, 0.0525, 0.0524, 0.0530, 0.0527, 0.0527,
         0.0522],
        [0.0528, 0.0527, 0.0527, 0.0527, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0525, 0.0524, 0.0528, 0.0524, 0.0525, 0.0530, 0.0527, 0.0527,
         0.0523],
        [0.0528, 0.0527, 0.0528, 0.0526, 0.0528, 0.0525, 0.0525, 0.0526, 0.0528,
         0.0526, 0.0524, 0.0524, 0.0528, 0.0525, 0.0526, 0.0531, 0.0526, 0.0527,
         0.0522]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0771, 0.0776, 0.0767, 0.0768, 0.0765, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0769, 0.0768, 0.0769, 0.0773],
        [0.0771, 0.0776, 0.0766, 0.0769, 0.0766, 0.0768, 0.0769, 0.0769, 0.0769,
         0.0769, 0.0767, 0.0769, 0.0774],
        [0.0770, 0.0775, 0.0766, 0.0769, 0.0765, 0.0769, 0.0768, 0.0770, 0.0770,
         0.0769, 0.0767, 0.0769, 0.0773],
        [0.0770, 0.0776, 0.0766, 0.0768, 0.0765, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0769, 0.0767, 0.0769, 0.0774],
        [0.0770, 0.0776, 0.0765, 0.0769, 0.0766, 0.0769, 0.0768, 0.0770, 0.0769,
         0.0769, 0.0767, 0.0769, 0.0773],
        [0.0771, 0.0776, 0.0765, 0.0769, 0.0764, 0.0768, 0.0768, 0.0770, 0.0770,
         0.0769, 0.0766, 0.0769, 0.0775],
        [0.0770, 0.0775, 0.0767, 0.0769, 0.0766, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0768, 0.0767, 0.0769, 0.0773],
        [0.0770, 0.0777, 0.0767, 0.0767, 0.0765, 0.0769, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0768, 0.0768, 0.0772],
        [0.0770, 0.0776, 0.0766, 0.0768, 0.0765, 0.0768, 0.0769, 0.0769, 0.0770,
         0.0769, 0.0768, 0.0768, 0.0773],
        [0.0770, 0.0777, 0.0765, 0.0768, 0.0765, 0.0768, 0.0768, 0.0770, 0.0770,
         0.0770, 0.0767, 0.0768, 0.0775],
        [0.0770, 0.0775, 0.0767, 0.0769, 0.0766, 0.0768, 0.0769, 0.0770, 0.0770,
         0.0768, 0.0768, 0.0768, 0.0773],
        [0.0771, 0.0777, 0.0765, 0.0769, 0.0765, 0.0769, 0.0768, 0.0769, 0.0770,
         0.0769, 0.0767, 0.0769, 0.0774],
        [0.0770, 0.0776, 0.0767, 0.0768, 0.0766, 0.0768, 0.0768, 0.0769, 0.0770,
         0.0769, 0.0767, 0.0768, 0.0774]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1674, 0.1664, 0.1662, 0.1660, 0.1682, 0.1658],
        [0.1669, 0.1669, 0.1664, 0.1657, 0.1680, 0.1661],
        [0.1673, 0.1668, 0.1664, 0.1659, 0.1681, 0.1655],
        [0.1671, 0.1667, 0.1662, 0.1658, 0.1681, 0.1662],
        [0.1672, 0.1669, 0.1662, 0.1658, 0.1681, 0.1658],
        [0.1679, 0.1670, 0.1662, 0.1661, 0.1682, 0.1646]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1416, 0.1433, 0.1431, 0.1428, 0.1446, 0.1444, 0.1402],
        [0.1415, 0.1432, 0.1430, 0.1427, 0.1441, 0.1441, 0.1414],
        [0.1416, 0.1432, 0.1430, 0.1428, 0.1443, 0.1444, 0.1407],
        [0.1414, 0.1436, 0.1428, 0.1427, 0.1442, 0.1440, 0.1412],
        [0.1413, 0.1435, 0.1429, 0.1427, 0.1445, 0.1441, 0.1411],
        [0.1414, 0.1433, 0.1429, 0.1426, 0.1444, 0.1441, 0.1413],
        [0.1404, 0.1435, 0.1425, 0.1423, 0.1452, 0.1456, 0.1406]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0499, 0.0498, 0.0495, 0.0499,
         0.0495, 0.0503, 0.0501, 0.0501, 0.0501, 0.0506, 0.0497, 0.0501, 0.0498,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0500, 0.0498, 0.0494, 0.0499,
         0.0496, 0.0503, 0.0501, 0.0502, 0.0501, 0.0506, 0.0496, 0.0500, 0.0498,
         0.0500, 0.0511],
        [0.0499, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0496, 0.0504, 0.0502, 0.0500, 0.0501, 0.0505, 0.0496, 0.0501, 0.0498,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0495, 0.0502, 0.0495, 0.0501, 0.0499, 0.0494, 0.0499,
         0.0497, 0.0503, 0.0500, 0.0501, 0.0501, 0.0506, 0.0496, 0.0500, 0.0498,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0496, 0.0500, 0.0496, 0.0501, 0.0498, 0.0493, 0.0499,
         0.0497, 0.0503, 0.0501, 0.0502, 0.0502, 0.0506, 0.0496, 0.0500, 0.0498,
         0.0501, 0.0509],
        [0.0499, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0494, 0.0500,
         0.0496, 0.0503, 0.0501, 0.0500, 0.0501, 0.0505, 0.0497, 0.0501, 0.0498,
         0.0500, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0501, 0.0505, 0.0497, 0.0501, 0.0499,
         0.0499, 0.0508],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0496, 0.0500, 0.0499, 0.0494, 0.0498,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0502, 0.0506, 0.0496, 0.0501, 0.0498,
         0.0501, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0497, 0.0500, 0.0498, 0.0495, 0.0498,
         0.0496, 0.0503, 0.0500, 0.0501, 0.0502, 0.0506, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0501, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0504, 0.0501, 0.0500, 0.0501, 0.0506, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0506],
        [0.0500, 0.0504, 0.0496, 0.0500, 0.0497, 0.0499, 0.0497, 0.0495, 0.0499,
         0.0495, 0.0504, 0.0501, 0.0501, 0.0502, 0.0506, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0499, 0.0495, 0.0498,
         0.0496, 0.0503, 0.0501, 0.0500, 0.0501, 0.0506, 0.0497, 0.0501, 0.0499,
         0.0501, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0501, 0.0498, 0.0494, 0.0498,
         0.0497, 0.0503, 0.0501, 0.0501, 0.0502, 0.0506, 0.0496, 0.0500, 0.0498,
         0.0499, 0.0511],
        [0.0500, 0.0503, 0.0496, 0.0501, 0.0497, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0500, 0.0502, 0.0500, 0.0506, 0.0497, 0.0500, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0496, 0.0504, 0.0500, 0.0501, 0.0501, 0.0505, 0.0497, 0.0502, 0.0499,
         0.0500, 0.0507],
        [0.0499, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0498,
         0.0495, 0.0502, 0.0501, 0.0501, 0.0501, 0.0506, 0.0496, 0.0499, 0.0498,
         0.0499, 0.0512],
        [0.0500, 0.0502, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0494, 0.0500,
         0.0497, 0.0504, 0.0501, 0.0500, 0.0502, 0.0505, 0.0496, 0.0501, 0.0499,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0497, 0.0499, 0.0497, 0.0495, 0.0499,
         0.0495, 0.0503, 0.0502, 0.0501, 0.0501, 0.0506, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0499, 0.0504, 0.0497, 0.0499, 0.0497, 0.0501, 0.0498, 0.0494, 0.0499,
         0.0496, 0.0504, 0.0501, 0.0501, 0.0502, 0.0506, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0505],
        [0.0498, 0.0506, 0.0495, 0.0502, 0.0496, 0.0499, 0.0499, 0.0494, 0.0495,
         0.0496, 0.0502, 0.0500, 0.0504, 0.0502, 0.0507, 0.0496, 0.0499, 0.0496,
         0.0499, 0.0516]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0916, 0.0911, 0.0915, 0.0914, 0.0896, 0.0910, 0.0901, 0.0913, 0.0910,
         0.0912, 0.0902],
        [0.0916, 0.0912, 0.0916, 0.0914, 0.0896, 0.0908, 0.0901, 0.0913, 0.0909,
         0.0912, 0.0903],
        [0.0918, 0.0912, 0.0916, 0.0915, 0.0895, 0.0909, 0.0901, 0.0913, 0.0909,
         0.0911, 0.0901],
        [0.0917, 0.0912, 0.0916, 0.0915, 0.0896, 0.0909, 0.0901, 0.0913, 0.0910,
         0.0911, 0.0902],
        [0.0917, 0.0910, 0.0916, 0.0914, 0.0896, 0.0909, 0.0902, 0.0913, 0.0909,
         0.0912, 0.0901],
        [0.0916, 0.0910, 0.0915, 0.0915, 0.0897, 0.0910, 0.0901, 0.0913, 0.0910,
         0.0911, 0.0901],
        [0.0916, 0.0911, 0.0916, 0.0915, 0.0896, 0.0909, 0.0901, 0.0914, 0.0910,
         0.0911, 0.0901],
        [0.0916, 0.0912, 0.0917, 0.0914, 0.0896, 0.0908, 0.0901, 0.0912, 0.0909,
         0.0912, 0.0902],
        [0.0916, 0.0911, 0.0915, 0.0915, 0.0896, 0.0910, 0.0901, 0.0913, 0.0910,
         0.0912, 0.0901],
        [0.0917, 0.0912, 0.0916, 0.0914, 0.0896, 0.0908, 0.0901, 0.0914, 0.0909,
         0.0911, 0.0901],
        [0.0916, 0.0911, 0.0915, 0.0914, 0.0897, 0.0909, 0.0902, 0.0913, 0.0908,
         0.0912, 0.0902]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.25798940658569336s
iter time cost:11.225483417510986s
-------------Round number: 145-------------
Evaluate global model
Averaged Train Loss: 0.2923
Averaged Test Accurancy: 0.8167
Std Test Accurancy: 0.0785
evaluate time cost:5.428614854812622s
[running kmeans]: 5it [00:00, 384.26it/s, center_shift=0.000000, iteration=5, tol=0.000100]
clients training time cost:4.780648708343506s
attn_optimize time cost:0.43439602851867676s
running k-means on cuda..
device is :cuda
device is :cuda
device is :cuda
device is :cuda
device is :cuda
weights:tensor([[0.0836, 0.0833, 0.0833, 0.0836, 0.0828, 0.0831, 0.0835, 0.0832, 0.0833,
         0.0838, 0.0833, 0.0832],
        [0.0836, 0.0832, 0.0832, 0.0836, 0.0829, 0.0830, 0.0836, 0.0833, 0.0834,
         0.0837, 0.0833, 0.0832],
        [0.0836, 0.0832, 0.0833, 0.0836, 0.0829, 0.0830, 0.0836, 0.0833, 0.0834,
         0.0838, 0.0833, 0.0832],
        [0.0836, 0.0833, 0.0833, 0.0836, 0.0829, 0.0831, 0.0835, 0.0833, 0.0833,
         0.0837, 0.0833, 0.0833],
        [0.0836, 0.0832, 0.0833, 0.0836, 0.0828, 0.0830, 0.0835, 0.0832, 0.0834,
         0.0839, 0.0833, 0.0832],
        [0.0836, 0.0831, 0.0833, 0.0835, 0.0830, 0.0830, 0.0836, 0.0833, 0.0834,
         0.0838, 0.0834, 0.0831],
        [0.0836, 0.0831, 0.0833, 0.0836, 0.0829, 0.0830, 0.0836, 0.0832, 0.0834,
         0.0838, 0.0834, 0.0831],
        [0.0836, 0.0832, 0.0833, 0.0836, 0.0828, 0.0830, 0.0836, 0.0833, 0.0834,
         0.0838, 0.0833, 0.0832],
        [0.0836, 0.0833, 0.0832, 0.0835, 0.0829, 0.0830, 0.0836, 0.0833, 0.0833,
         0.0838, 0.0834, 0.0832],
        [0.0836, 0.0832, 0.0833, 0.0836, 0.0829, 0.0830, 0.0836, 0.0832, 0.0834,
         0.0838, 0.0833, 0.0831],
        [0.0836, 0.0831, 0.0833, 0.0836, 0.0829, 0.0830, 0.0835, 0.0832, 0.0834,
         0.0838, 0.0834, 0.0832],
        [0.0837, 0.0832, 0.0833, 0.0836, 0.0829, 0.0830, 0.0835, 0.0833, 0.0834,
         0.0837, 0.0833, 0.0832]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0503, 0.0500, 0.0502, 0.0500, 0.0502, 0.0499, 0.0500, 0.0501, 0.0502,
         0.0500, 0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0503, 0.0499, 0.0501,
         0.0497, 0.0493],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0498, 0.0498, 0.0502, 0.0498, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0497, 0.0497],
        [0.0502, 0.0501, 0.0502, 0.0500, 0.0503, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0503,
         0.0499, 0.0498, 0.0499, 0.0502, 0.0498, 0.0500, 0.0504, 0.0500, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0500, 0.0498, 0.0498, 0.0501, 0.0499, 0.0500, 0.0504, 0.0500, 0.0501,
         0.0497, 0.0495],
        [0.0503, 0.0500, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0501, 0.0503,
         0.0499, 0.0498, 0.0498, 0.0502, 0.0499, 0.0501, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0502, 0.0501, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0503,
         0.0499, 0.0498, 0.0499, 0.0502, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0498, 0.0493],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0498, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0501, 0.0503,
         0.0499, 0.0498, 0.0499, 0.0502, 0.0498, 0.0499, 0.0504, 0.0499, 0.0501,
         0.0498, 0.0494],
        [0.0503, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0499, 0.0500, 0.0502,
         0.0499, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0504, 0.0501, 0.0502,
         0.0496, 0.0494],
        [0.0503, 0.0500, 0.0501, 0.0500, 0.0503, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0499, 0.0497, 0.0499, 0.0503, 0.0498, 0.0501, 0.0503, 0.0501, 0.0502,
         0.0496, 0.0494],
        [0.0503, 0.0500, 0.0501, 0.0501, 0.0502, 0.0499, 0.0499, 0.0501, 0.0503,
         0.0499, 0.0498, 0.0499, 0.0503, 0.0499, 0.0499, 0.0504, 0.0500, 0.0501,
         0.0496, 0.0494],
        [0.0503, 0.0500, 0.0501, 0.0500, 0.0502, 0.0501, 0.0499, 0.0501, 0.0502,
         0.0499, 0.0497, 0.0498, 0.0502, 0.0499, 0.0500, 0.0503, 0.0500, 0.0502,
         0.0497, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0501, 0.0502,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0497, 0.0495],
        [0.0502, 0.0500, 0.0501, 0.0501, 0.0502, 0.0500, 0.0499, 0.0501, 0.0502,
         0.0500, 0.0497, 0.0499, 0.0501, 0.0499, 0.0500, 0.0504, 0.0501, 0.0501,
         0.0497, 0.0494],
        [0.0503, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0501, 0.0503,
         0.0500, 0.0498, 0.0499, 0.0502, 0.0499, 0.0500, 0.0504, 0.0499, 0.0501,
         0.0498, 0.0493],
        [0.0503, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0498, 0.0500, 0.0503,
         0.0499, 0.0497, 0.0499, 0.0503, 0.0499, 0.0499, 0.0503, 0.0501, 0.0502,
         0.0497, 0.0494],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0498, 0.0500, 0.0502,
         0.0499, 0.0498, 0.0499, 0.0502, 0.0498, 0.0500, 0.0503, 0.0500, 0.0501,
         0.0497, 0.0496],
        [0.0502, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0499, 0.0500, 0.0502,
         0.0499, 0.0498, 0.0498, 0.0502, 0.0500, 0.0501, 0.0504, 0.0500, 0.0501,
         0.0497, 0.0496],
        [0.0503, 0.0500, 0.0502, 0.0498, 0.0503, 0.0499, 0.0498, 0.0499, 0.0502,
         0.0500, 0.0496, 0.0497, 0.0504, 0.0500, 0.0504, 0.0502, 0.0502, 0.0503,
         0.0495, 0.0495]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0496, 0.0499,
         0.0496, 0.0502, 0.0501, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0499, 0.0498, 0.0494, 0.0499,
         0.0497, 0.0502, 0.0501, 0.0502, 0.0502, 0.0505, 0.0496, 0.0500, 0.0500,
         0.0500, 0.0511],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0499,
         0.0497, 0.0503, 0.0502, 0.0500, 0.0502, 0.0504, 0.0496, 0.0501, 0.0499,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0496, 0.0501, 0.0495, 0.0501, 0.0499, 0.0494, 0.0498,
         0.0497, 0.0502, 0.0501, 0.0501, 0.0502, 0.0505, 0.0496, 0.0500, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0503, 0.0497, 0.0499, 0.0495, 0.0501, 0.0498, 0.0494, 0.0499,
         0.0497, 0.0502, 0.0501, 0.0502, 0.0503, 0.0505, 0.0495, 0.0500, 0.0500,
         0.0500, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0499, 0.0496, 0.0500, 0.0498, 0.0495, 0.0500,
         0.0497, 0.0503, 0.0501, 0.0500, 0.0501, 0.0504, 0.0497, 0.0501, 0.0499,
         0.0500, 0.0509],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0498,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0502, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0499, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0495, 0.0499, 0.0499, 0.0494, 0.0498,
         0.0496, 0.0502, 0.0501, 0.0501, 0.0502, 0.0505, 0.0496, 0.0500, 0.0499,
         0.0502, 0.0510],
        [0.0500, 0.0503, 0.0497, 0.0501, 0.0496, 0.0499, 0.0498, 0.0495, 0.0498,
         0.0496, 0.0503, 0.0500, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0500,
         0.0500, 0.0508],
        [0.0501, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0498,
         0.0497, 0.0503, 0.0501, 0.0500, 0.0502, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0506],
        [0.0500, 0.0504, 0.0496, 0.0500, 0.0496, 0.0499, 0.0497, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0502, 0.0505, 0.0497, 0.0500, 0.0500,
         0.0500, 0.0508],
        [0.0500, 0.0502, 0.0498, 0.0500, 0.0495, 0.0500, 0.0499, 0.0495, 0.0498,
         0.0497, 0.0503, 0.0501, 0.0501, 0.0502, 0.0504, 0.0496, 0.0501, 0.0500,
         0.0501, 0.0508],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0494, 0.0500, 0.0498, 0.0494, 0.0498,
         0.0497, 0.0502, 0.0501, 0.0501, 0.0503, 0.0504, 0.0496, 0.0500, 0.0499,
         0.0499, 0.0511],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0496, 0.0498,
         0.0496, 0.0502, 0.0500, 0.0502, 0.0501, 0.0504, 0.0497, 0.0500, 0.0500,
         0.0500, 0.0508],
        [0.0500, 0.0503, 0.0498, 0.0499, 0.0495, 0.0500, 0.0497, 0.0495, 0.0499,
         0.0496, 0.0503, 0.0501, 0.0501, 0.0502, 0.0504, 0.0497, 0.0502, 0.0500,
         0.0500, 0.0507],
        [0.0500, 0.0504, 0.0497, 0.0500, 0.0496, 0.0500, 0.0498, 0.0495, 0.0497,
         0.0496, 0.0502, 0.0501, 0.0501, 0.0502, 0.0504, 0.0496, 0.0499, 0.0500,
         0.0499, 0.0512],
        [0.0501, 0.0502, 0.0497, 0.0499, 0.0495, 0.0499, 0.0498, 0.0494, 0.0499,
         0.0498, 0.0503, 0.0501, 0.0500, 0.0503, 0.0504, 0.0496, 0.0501, 0.0500,
         0.0501, 0.0507],
        [0.0500, 0.0503, 0.0497, 0.0500, 0.0496, 0.0499, 0.0497, 0.0496, 0.0499,
         0.0496, 0.0503, 0.0502, 0.0501, 0.0501, 0.0504, 0.0497, 0.0501, 0.0500,
         0.0500, 0.0508],
        [0.0500, 0.0504, 0.0497, 0.0499, 0.0496, 0.0500, 0.0498, 0.0495, 0.0499,
         0.0497, 0.0503, 0.0501, 0.0501, 0.0502, 0.0505, 0.0497, 0.0501, 0.0500,
         0.0501, 0.0505],
        [0.0498, 0.0506, 0.0496, 0.0502, 0.0495, 0.0499, 0.0498, 0.0494, 0.0494,
         0.0497, 0.0501, 0.0500, 0.0504, 0.0503, 0.0506, 0.0496, 0.0499, 0.0498,
         0.0499, 0.0516]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.0502, 0.0505, 0.0494, 0.0499, 0.0500, 0.0500, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0502, 0.0492],
        [0.0502, 0.0505, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0499,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0503, 0.0504,
         0.0501, 0.0494],
        [0.0502, 0.0507, 0.0493, 0.0499, 0.0500, 0.0498, 0.0500, 0.0499, 0.0501,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0500, 0.0504, 0.0503,
         0.0503, 0.0489],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0504,
         0.0502, 0.0493],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0501, 0.0500, 0.0499, 0.0497, 0.0500,
         0.0499, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0501, 0.0504, 0.0503,
         0.0503, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0501,
         0.0501, 0.0500, 0.0501, 0.0499, 0.0499, 0.0501, 0.0500, 0.0504, 0.0502,
         0.0504, 0.0491],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0497, 0.0500,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0504,
         0.0501, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0501, 0.0498, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0497],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0501, 0.0499, 0.0500, 0.0497, 0.0499,
         0.0499, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0504,
         0.0501, 0.0496],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0501, 0.0493],
        [0.0501, 0.0505, 0.0495, 0.0499, 0.0501, 0.0499, 0.0499, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0504, 0.0503,
         0.0503, 0.0494],
        [0.0501, 0.0505, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0505, 0.0503,
         0.0502, 0.0494],
        [0.0501, 0.0505, 0.0493, 0.0498, 0.0501, 0.0499, 0.0500, 0.0497, 0.0499,
         0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0504, 0.0504,
         0.0502, 0.0495],
        [0.0501, 0.0504, 0.0494, 0.0498, 0.0502, 0.0499, 0.0500, 0.0499, 0.0499,
         0.0500, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0504, 0.0503,
         0.0503, 0.0494],
        [0.0501, 0.0504, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0503, 0.0503,
         0.0501, 0.0493],
        [0.0502, 0.0505, 0.0494, 0.0498, 0.0500, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0504,
         0.0502, 0.0493],
        [0.0501, 0.0505, 0.0493, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0499,
         0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0500, 0.0500, 0.0505, 0.0503,
         0.0503, 0.0493],
        [0.0502, 0.0505, 0.0494, 0.0499, 0.0501, 0.0499, 0.0500, 0.0498, 0.0500,
         0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0499, 0.0500, 0.0504, 0.0504,
         0.0502, 0.0492],
        [0.0501, 0.0505, 0.0493, 0.0499, 0.0500, 0.0498, 0.0500, 0.0497, 0.0500,
         0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0501, 0.0500, 0.0504, 0.0503,
         0.0503, 0.0493],
        [0.0500, 0.0507, 0.0490, 0.0499, 0.0502, 0.0498, 0.0499, 0.0497, 0.0500,
         0.0500, 0.0499, 0.0501, 0.0499, 0.0498, 0.0500, 0.0499, 0.0508, 0.0503,
         0.0508, 0.0492]], device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1672, 0.1669, 0.1651, 0.1669, 0.1669, 0.1671],
        [0.1669, 0.1670, 0.1653, 0.1668, 0.1669, 0.1670],
        [0.1671, 0.1669, 0.1652, 0.1669, 0.1669, 0.1670],
        [0.1672, 0.1670, 0.1652, 0.1668, 0.1668, 0.1671],
        [0.1672, 0.1669, 0.1650, 0.1669, 0.1669, 0.1671],
        [0.1671, 0.1668, 0.1652, 0.1668, 0.1671, 0.1671]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.2015, 0.2009, 0.2017, 0.1992, 0.1967],
        [0.2013, 0.2006, 0.2015, 0.1988, 0.1978],
        [0.2010, 0.2006, 0.2014, 0.1990, 0.1979],
        [0.2011, 0.2009, 0.2015, 0.1993, 0.1972],
        [0.2021, 0.2017, 0.2010, 0.1982, 0.1970]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1121, 0.1113, 0.1119, 0.1118, 0.1113, 0.1094, 0.1115, 0.1105, 0.1102],
        [0.1120, 0.1114, 0.1119, 0.1117, 0.1114, 0.1094, 0.1115, 0.1104, 0.1103],
        [0.1121, 0.1113, 0.1119, 0.1118, 0.1115, 0.1093, 0.1115, 0.1105, 0.1101],
        [0.1121, 0.1113, 0.1120, 0.1118, 0.1113, 0.1094, 0.1116, 0.1104, 0.1102],
        [0.1121, 0.1114, 0.1120, 0.1118, 0.1114, 0.1091, 0.1117, 0.1104, 0.1101],
        [0.1121, 0.1112, 0.1119, 0.1118, 0.1113, 0.1095, 0.1116, 0.1105, 0.1102],
        [0.1120, 0.1114, 0.1120, 0.1117, 0.1114, 0.1094, 0.1114, 0.1104, 0.1103],
        [0.1120, 0.1113, 0.1119, 0.1118, 0.1114, 0.1093, 0.1117, 0.1104, 0.1101],
        [0.1120, 0.1113, 0.1119, 0.1117, 0.1114, 0.1095, 0.1116, 0.1104, 0.1102]],
       device='cuda:0', grad_fn=<SoftmaxBackward0>)
weights:tensor([[0.1671, 0.1665, 0.1661, 0.1661, 0.1659, 0.1683],
        [0.1670, 0.1662, 0.1664, 0.1660, 0.1660, 0.1684],
        [0.1667, 0.1663, 0.1667, 0.1665, 0.1657, 0.1681],
        [0.1670, 0.1662, 0.1665, 0.1663, 0.1657, 0.1682],
        [0.1670, 0.1663, 0.1666, 0.1662, 0.1658, 0.1682],
        [0.1670, 0.1662, 0.1666, 0.1662, 0.1658, 0.1682]], device='cuda:0',
       grad_fn=<SoftmaxBackward0>)
intra_cluster_agg time cost:0.3830382823944092s
iter time cost:11.121288776397705s
-------------Round number: 146-------------
Evaluate global model
Averaged Train Loss: 0.2814
Averaged Test Accurancy: 0.8179
Std Test Accurancy: 0.0710
